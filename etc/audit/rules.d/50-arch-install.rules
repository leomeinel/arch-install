# audit.rule
# Copyright Pierre Gronau, ndaal, Germany, Cologne
# Apache 2.0 license
#
# Based on rules published here:
#
# Gov.uk auditd rules
# https://github.com/gds-operations/puppet-auditd/pull/1
# CentOS 7 hardening
# https://highon.coffee/blog/security-harden-centos-7/#auditd---audit-daemon
# Linux audit repo
# https://github.com/linux-audit/audit-userspace/tree/master/rules
# Auditd high performance linux auditing
# https://linux-audit.com/tuning-auditd-high-performance-linux-auditing/
#
# Further rules
# For PCI DSS compliance see:
# https://github.com/linux-audit/audit-userspace/blob/master/rules/30-pci-dss-v31.rules
# For NISPOM compliance see:
# https://github.com/linux-audit/audit-userspace/blob/master/rules/30-nispom.rules
# Best Practice Auditd Configuration by Neo23x0
# https://github.com/Neo23x0/auditd
# Best Practice Auditd Configuration by ndaal
# https://gitlab.com/ndaal_open_source/ndaal_public_auditd/-/tree/main/ndaal
#
# Audit does not provide additional security to your system; rather, it can
# be used to discover violations of security policies used on your system.
# These violations can further be prevented by additional security measures
# such as SELinux.
#
# Linux Audit
# The Linux Audit system provides a way to track security-relevant
# information on your system. Based on pre-configured rules, Audit
# generates log entries to record as much information about the events that
# are happening on your system as possible. This information is crucial for
# mission-critical environments to determine the violator of the security
# policy and the actions they performed.
#
# The following list summarizes some of the information that Audit is
# capable of recording in its log files:
#
# - Date and time, type, and outcome of an event.
# - Sensitivity labels of subjects and objects.
# - Association of an event with the identity of the user who triggered the
#   event.
# - All modifications to Audit configuration and attempts to access Audit
#   log files.
# - All uses of authentication mechanisms, such as SSH, Kerberos, and
#   others.
# - Changes to any trusted database, such as /etc/passwd.
# - Attempts to import or export information into or from the system.
# - Include or exclude events based on user identity, subject and object
#   labels, and other attributes.
#
# The use of the Audit system is also a requirement for a number of
# security-related certifications. Audit is designed to meet or exceed
# the requirements of the following certifications or compliance guides:
#
# - Controlled Access Protection Profile (CAPP)
# - Labeled Security Protection Profile (LSPP)
# - Rule Set Base Access Control (RSBAC)
# - National Industrial Security Program Operating Manual (NISPOM)
# - Federal Information Security Management Act (FISMA)
# - Payment Card Industry — Data Security Standard (PCI-DSS)
# - Security Technical Implementation Guides (STIG)
#
# Audit has also been:
#
# - Evaluated by National Information Assurance Partnership (NIAP) and
#   Best Security Industries (BSI).
# - Certified to LSPP/CAPP/RSBAC/EAL4+ on Red Hat Enterprise Linux 5.
# - Certified to Operating System Protection Profile / Evaluation
#   Assurance Level 4+ (OSPP/EAL4+) on Red Hat Enterprise Linux 6.
#
# SUSE
# https://documentation.suse.com/sles/15-SP5/html/SLES-all/cha-audit-comp.html
#
# USAGE
# =====
#
# See the man pages for audit, auditctl, audit.rules, ausearch, and aureport.
#
# DISCUSSION
# ==========
## Original lkml thread(s):
## - https://marc.info/?t=107815888100001&r=1&w=2
## - https://marc.info/?t=107901570800002&r=1&w=2
#
# There is a linux audit mail list where any question whether kernel design,
# setup and configuration, or usage can be discussed:
# http://www.redhat.com/mailman/listinfo/linux-audit
#
# https://github.com/Neo23x0/auditd/issues/98
##
## sed -i'' 's/\/opt\/filebeat/\/usr\/bin\/filebeat/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\ \/sbin\/auditctl/\ \/usr\/sbin\/auditctl/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\=\/sbin\/insmod/\=\/usr\/sbin\/insmod/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\=\/sbin\/modprobe/\=\/usr\/sbin\/modprobe/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\=\/sbin\/rmmod/\=\/usr\/sbin\/rmmod/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\ \/bin\/su/\ \/usr\/bin\/su/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\ \/sbin\/shutdown/\ \/usr\/sbin\/shutdown/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\ \/sbin\/poweroff/\ \/usr\/sbin\/poweroff/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\ \/sbin\/reboot/\ \/usr\/sbin\/reboot/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\ \/sbin\/halt/\ \/usr\/sbin\/halt/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\ \/bin\/hostname/\ \/usr\/bin\/hostname/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\ \/bin\/uname/\ \/usr\/bin\/uname/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\ \/bin\/nc/\ \/usr\/bin\/nc/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\ \/sbin\/iptables/\ \/usr\/sbin\/iptables/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\ \/sbin\/ip6tables/\ \/usr\/sbin\/ip6tables/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\ \/sbin\/ifconfig/\ \/usr\/sbin\/ifconfig/g' /etc/auditbeat/audit.rules.d/audit.rules
## sed -i'' 's/\ \/sbin\/xtables-nft-multi/\ \/usr\/sbin\/xtables-nft-multi/g' /etc/auditbeat/audit.rules.d/audit.rules
#
## for E in $(grep '/bin/\|/sbin/' ./audit.rules | grep -o '\/.*/[[:alnum:]]*'); do
## if [ ! -e $E ] && [ -e /usr$E ]; then echo "Diff $E"; fi
## if [ -e $E ] && [ ! -e /usr$E ]; then echo "Norm $E"; fi
## if [ ! -e $E ] && [ ! -e /usr$E ]; then echo "Nope $E"; fi
## if [ -e $E ] && [ -e /usr$E ]; then echo "Both $E"; fi;
## done
#
# b32 vs b32, b64
# At a minimum, the audit system should collect file permission changes for all users and root.
# Note that the "-F arch=b32" lines should be present even on a 64 bit system. These commands identify
# system calls for auditing. Even if the system is 64 bit it can still execute 32 bit system calls.
#
## "Adding a rule for both 32 bit and 64 bit is likely to add overhead without any benefit
## considering performance of the system."
## https://access.redhat.com/solutions/666333
##
## https://www.stigviewer.com/stig/oracle_linux_6/2021-12-03/finding/V-208899
## If the system is 64-bit and does not return a rule for both "b32" and "b64" architectures, this is a finding.
##
# choose auid!=-1 or auid!=unset
## The field auid (Audit User ID) in auditd records the ID of the user who originally logged into the session
## that generated the event. Sometimes, this value is unset, which means it has no assigned user ID. Internally,
## auditd represents this unset state by the value -1 (which corresponds to the unsigned 32-bit number 4294967295).
##
## In auditd rules, when filtering based on auid, one can write auid!=unset or equivalently auid!=-1.
## Both expressions mean the same thing: exclude events where the audit user ID is unset.
## Why use auid!=-1 for compatibility?
## The keyword unset was introduced in newer versions of auditd to make rules easier to read and write.
##
## Older versions of auditd and Linux kernels may not recognize the keyword "unset", but they always
## interpret the numeric value -1 correctly as "unset".
##
## To maintain backward compatibility with older auditd versions and ensure consistent behavior across
## many Linux distributions, it is safer to use the numeric value -1 in the rules.
##
## Functionally, auid!=-1, auid!=4294967295, and auid!=unset all filter out events with an unset audit user ID.
##
## Summary
## Using auid!=-1 is preferred when supporting older auditd setups because it is universally understood, whereas
## unset might not be recognized everywhere. Both exclude events without a valid logged-in user, helping focus
## auditing on real user actions rather than system or kernel processes.
#
# Container
## Using **auditd** within a container presents several unique challenges due
## to its reliance on kernel-level auditing and namespace separation
## in containerized environments. While containers can execute auditd, there
## are important factors to consider to ensure it works as intended and does
##not negatively impact performance or security.[1][3][5]
##
## ### Kernel-Level Limitations
##
## Auditd interacts directly with the Linux kernel using audit syscall hooks.
## If the container's underlying kernel does not enable audit features, auditd
## cannot function properly within that container. Since containers often
## share the host's kernel, auditd capabilities may be limited or
## completely unavailable depending on the host's configuration
## and security policies.
##
## ### Namespace and Capability Issues
##
## - Auditd's rules are configured at the kernel level, so changes within
##   container namespaces may not apply globally unless the relevant
##   capabilities (such as `CAP_AUDIT_CONTROL`) are granted.
## - Running auditd for each user namespace (i.e., per container) would
##   require complex kernel and orchestration system support, which is
##   generally not present in mainstream container technologies like Docker
##   or Kubernetes as of 2025.
## - Attempts to start auditd inside regular containers may fail due
##   to missing capabilities or unsupported kernel configurations.
##
## ### Performance and Data Management
##
## - Auditd can create significant performance overhead if too many events
##   are logged, especially in busy multi-tenant environments like containers.
## - Events and log queues may overflow in high-throughput scenarios, leading
##   to dropped audit records and potential loss of critical
##   security information.
## - It's vital to configure log rotation and buffer management for containers
##   to avoid disk space exhaustion and data loss.[7]
##
## ### Best Practices for Container Environments
##
## - For auditing container activity, it's often more effective to run auditd
##   at the **host level**, where it can monitor activities across all
##   containers and correlate events for security analysis.
## - If container-specific auditing is required, consider complementary or
##   alternative tools that are designed for cloud-native environments such
##   as Falco, which understands container context and supports more granular
##   Kubernetes-focused detection rules.
## - Be specific with audit rules—target critical files and operations rather
##   than blanket syscall auditing, to reduce overhead and focus
##   on relevant activity.
##
## ### Summary Table
##
## | Factor                | Consideration                                                    |
## |-----------------------|-------------------------------------------------|
## | Kernel Support        | Auditd needs kernel audit features enabled      |
## | Namespace Separation  | May need capabilities not present in containers |
## | Performance Impact    | High log volume may impact resources            |
## | Host vs. Container    | Host-level auditd often preferable              |
## | Alternatives          | Consider Falco for container-specific events    |
##
## In conclusion, running **auditd** inside containers is possible but
## generally not recommended due to kernel and namespace challenges,
## performance risks, and limited configurability. Host-level auditing
## and modern container-aware tools should be considered for robust monitoring
## in containerized environments.
#
#
## Remove any existing rules
## rules/10-base-config.rules
## This set of rules is to negate the performance effects of the audit system
## by preventing syscall auditing to work. You would use this when you want
## the best system performance without a properly working audit system.
## As a result, you only get hardwired events. If you need syscall auditing,
## delete this file and install 10-base-config.rules + other files to make
## your audit policy.

-D

# Buffer Size
## Feel free to increase this if the machine panic's
# -b 8192
# -b 16384

-b 32768

## This determine how long to wait in burst of events
## https://man7.org/linux/man-pages/man3/audit_set_backlog_wait_time.3.html

--backlog_wait_time 60000

# Failure Mode
## Possible values: 0 (silent), 1 (printk, print a failure message), 2 (panic, halt the system)

-f 1

## This rule will cause auditctl to continue loading rules when it runs
## across an unsupported field or a rule with a syntax error however it will
## report an error at exit. The normal action is to report the line and
## issue with the rule and exit immediately with an error to get the admin's
## attention to fix the rules.
## rules/12-cont-fail.rules

-c

# Ignore errors
## e.g. caused by users or files not found in the local environment
##
## This rule will cause auditctl to continue loading rules when it runs
## across an unsupported field or a rule with a syntax error but exit with
## success reason code. The normal action is to report the line and issue with
## the rule and exit immediately with an error to get the admin's attention to
## fix the rules.
## rules/12-ignore-error.rules

-i

## This suppresses syscall auditing for all tasks started
## with this rule in effect. Remove it if you need syscall
## auditing.

# -a task,never

## rules/20-dont-audit.rules
## This is for don't audit rules. We put these early because audit
### is a first match wins system. Uncomment the rules you want.

## Cron jobs fill the logs with stuff we normally don't want
#-a never,user -F subj_type=crond_t

## This prevents chrony from overwhelming the logs
#-a never,exit -F arch=x86_64 -S adjtimex -F auid=unset -F uid=chrony -F subj_type=chronyd_t

### This is not very interesting and wastes a lot of space if
### the server is public facing
#-a always,exclude -F msgtype=CRYPTO_KEY_USER

## https://chrony-project.org/
-a always,exit -F arch=b32 -F path=/etc/chrony/chrony.conf -F perm=wa -F key=chrony
-a always,exit -F arch=b64 -F path=/etc/chrony/chrony.conf -F perm=wa -F key=chrony

### This prevents chrony from overwhelming the logs
-a never,exit -F arch=b32 -S adjtimex -F "auid=-1" -F uid=chrony -F subj_type=chronyd_t -F key=chrony
-a never,exit -F arch=b64 -S adjtimex -F "auid=-1" -F uid=chrony -F subj_type=chronyd_t -F key=chrony

## ntpdate
-a always,exit -F arch=b32 -F path=/bin/ntpdate -F perm=x -F key=ntpdate
-a always,exit -F arch=b64 -F path=/bin/ntpdate -F perm=x -F key=ntpdate

-a always,exit -F arch=b32 -F path=/sbin/ntpdate -F perm=x -F key=ntpdate
-a always,exit -F arch=b64 -F path=/sbin/ntpdate -F perm=x -F key=ntpdate

-a always,exit -F arch=b32 -F path=/usr/bin/ntpdate -F perm=x -F key=ntpdate
-a always,exit -F arch=b64 -F path=/usr/bin/ntpdate -F perm=x -F key=ntpdate

-a always,exit -F arch=b32 -F path=/usr/sbin/ntpdate -F perm=x -F key=ntpdate
-a always,exit -F arch=b64 -F path=/usr/sbin/ntpdate -F perm=x -F key=ntpdate

-a always,exit -F arch=b32 -F path=/usr/local/bin/ntpdate -F perm=x -F key=ntpdate
-a always,exit -F arch=b64 -F path=/usr/local/bin/ntpdate -F perm=x -F key=ntpdate

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ntpdate -F perm=x -F key=ntpdate
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ntpdate -F perm=x -F key=ntpdate

## Make the loginuid immutable. This prevents tampering with the auid.

--loginuid-immutable

## If you are on a 64 bit platform, everything _should_ be running
## in 64 bit mode. This rule will detect any use of the 32 bit syscalls
## because this might be a sign of someone exploiting a hole in the 32
## bit ABI.
## rules/21-no32bit.rules

-a always,exit -F arch=b32 -S all -F key=32bit-abi

### NOTE:
### 1) if this is being used on a 32 bit machine, comment out the b64 lines
### 2) These rules assume that login under the root account is not allowed.
### 3) It is also assumed that 500 represents the first usable user account. To
###    be sure, look at UID_MIN in /etc/login.defs.
### 4) If these rules generate too much spurious data for your tastes, limit the
### the syscall file rules with a directory, like -F dir=/etc
### 5) You can search for the results on the key fields in the rules

## This rule will cause auditctl to continue loading rules when it runs
## across an unsupported field or a rule with a syntax error but exit with
## success reason code. The normal action is to report the line and issue with
## the rule and exit immediately with an error to get the admin's attention to
## fix the rules.
## https://github.com/linux-audit/audit-userspace/blob/master/rules/12-ignore-error.rules

-i

##  Red Hat Official Documentation:
## RHEL 8 Audit System Reference: https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/auditing-the-system_security-hardening
## Audit Rules Reference: https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/auditing-the-system_security-hardening#defining-audit-rules_auditing-the-system
## Linux Audit Documentation Project:
## Official GitHub: https://github.com/linux-audit/audit-documentation
## Audit Rules: https://github.com/linux-audit/audit-documentation/wiki/SPEC-Audit-Rules-Format
## Kernel Documentation:
## Kernel.org Audit Documentation: https://www.kernel.org/doc/html/latest/audit/index.html

# -r 0      # No limit (dangerous in production!)
# -r 100    # Conservative, good for high-activity systems
# -r 500    # Moderate, balance between coverage and performance
-r 1000   # Aggressive, for systems that need detailed logging

# Self Auditing

## Audit the audit logs
### Successful and unsuccessful attempts to read information from the audit records
### PCI-DSS
### 10.5 Secure audit trails so they cannot be altered
### The audit system protects audit logs by virtue of being the root user.
### That means that no normal user can tamper with the audit trail. If for
### some reason you suspect that admins may be malicious or that their acct
### could be compromised, then enable the remote logging plugin and get the
### logs off the system to assure that there is an unaltered copy.

### 10.5.1 Limit viewing of audit trails to those with a job-related need.
### The audit daemon by default limits viewing of the audit trail to root.
### If someone that is not an admin has a job related need to see logs, then
### create a unique group for people with this need and set the log_group
### configuration item in auditd.conf

### 10.5.2 Protect audit trail files from unauthorized modifications.
### See discussion in 10.5 above

### 10.5.3 Promptly back up audit trail files to a centralized log server
### See discussion in 10.5 above

### 10.5.4 Write logs for external-facing technologies onto a secure,
### centralized, internal log serve
### See discussion in 10.5 above

### 10.5.5 Use file-integrity monitoring or change-detection software on logs
### -a always,exit -F dir=/var/log/audit/ -F perm=wa -F key=10.5.5-modification-audit

-a always,exit -F arch=b32 -F dir=/var/log/audit/ -F perm=wa -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F dir=/var/log/audit/ -F perm=wa -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F dir=/var/log/journal/ -F perm=wa -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F dir=/var/log/journal/ -F perm=wa -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F dir=/var/log/ -F perm=wa -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F dir=/var/log/ -F perm=wa -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

### Parameters for auditd (disp*) which were used in RHEL7 do not exist in RHEL8 onwards.
### https://access.redhat.com/solutions/6053441
###
# disp_qos = lossless
# dispatcher = /sbin/audispd

## Indicator Removal
### T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b32 -F dir=/var/log/secure/ -F perm=wra -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F dir=/var/log/secure/ -F perm=wra -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/var/log/auth.log -F perm=wra -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/var/log/auth.log -F perm=wra -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

## Auditd configuration
### Modifications to audit configuration that occur while the audit collection functions are operating
-a always,exit -F arch=b32 -F path=/etc/audit/auditd.conf -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/etc/audit/auditd.conf -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/etc/audit/syslog.conf -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/etc/audit/syslog.conf -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/etc/audit/audit-stop.rules -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/etc/audit/audit-stop.rules -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/etc/audit/audisp-filter.conf -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/etc/audit/audisp-filter.conf -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/etc/audit/rules.d/audit.rules -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/etc/audit/rules.d/audit.rules -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/etc/audit/audit.key -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/etc/audit/audit.key -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/etc/init.d/auditd -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/etc/init.d/auditd -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F dir=/etc/audit/ -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F dir=/etc/audit/ -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/etc/audit/plugins.d/syslog.conf -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/etc/audit/plugins.d/syslog.conf -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F dir=/etc/audit/plugins.d/ -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F dir=/etc/audit/plugins.d/ -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/etc/audit/plugins.d/af_unix.conf -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/etc/audit/plugins.d/af_unix.conf -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/etc/libaudit.conf -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/etc/libaudit.conf -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F dir=/etc/audisp/ -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F dir=/etc/audisp/ -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F dir=/etc/sysconfig/auditd/ -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F dir=/etc/sysconfig/auditd/ -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

## Monitor for use of audit management tools
### T1005_Data_From_Local_System_Audit_Log
### auditd
-a always,exit -F arch=b32 -F path=/bin/auditd -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/bin/auditd -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/sbin/auditd -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/sbin/auditd -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/usr/bin/auditd -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/bin/auditd -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/usr/sbin/auditd -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/sbin/auditd -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

### auditctl
-a always,exit -F arch=b32 -F path=/sbin/auditctl -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/sbin/auditctl -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/usr/sbin/auditctl -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/sbin/auditctl -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

### augenrules
-a always,exit -F arch=b32 -F path=/bin/augenrules -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/bin/augenrules -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/sbin/augenrules -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/sbin/augenrules -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log


-a always,exit -F arch=b32 -F path=/usr/bin/augenrules -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/bin/augenrules -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/usr/sbin/augenrules -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/sbin/augenrules -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

## Access to all audit trails
## PCI-DSS
## 10.2.3 Access to all audit trails.

### ausearch
### PCI-DSS
### 10.2.3 Access to all audit trails.
-a always,exit -F arch=b32 -F path=/bin/ausearch -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/bin/ausearch -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/sbin/ausearch -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/sbin/ausearch -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/usr/bin/ausearch -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/bin/ausearch -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/usr/sbin/ausearch -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/sbin/ausearch -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

### PCI-DSS
### 10.2.4 Invalid logical access attempts. This is naturally met by pam. You
### can find these events with: ausearch --start today -m user_login -sv no -i

### PCI-DSS
### 10.2.5.a Use of I&A mechanisms is logged. Pam naturally handles this.
### you can find the events with:
### ausearch --start today -m user_auth,user_chauthtok -i

### aureport
### PCI-DSS
### 10.2.3 Access to all audit trails.
-a always,exit -F arch=b32 -F path=/sbin/aureport -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/sbin/aureport -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/usr/sbin/aureport -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/sbin/aureport -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

### aulast
### PCI-DSS
### 10.2.3 Access to all audit trails.
-a always,exit -F arch=b32 -F path=/bin/aulast -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/bin/aulast -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/sbin/aulast -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/sbin/aulast -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log


-a always,exit -F arch=b32 -F path=/usr/bin/aulast -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/bin/aulast -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/usr/sbin/aulast -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/sbin/aulast -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

### aulastlog
### https://linux.die.net/man/8/aulastlog
### PCI-DSS
### 10.2.3 Access to all audit trails.
-a always,exit -F arch=b32 -F path=/bin/aulastlog -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/bin/aulastlog -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/sbin/aulastlog -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/sbin/aulastlog -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/usr/bin/aulastlog -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/bin/aulastlog -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/usr/sbin/aulastlog -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/sbin/aulastlog -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

### auvirt
### PCI-DSS
### 10.2.3 Access to all audit trails.
-a always,exit -F arch=b32 -F path=/bin/auvirt -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/bin/auvirt -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/sbin/auvirt -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/sbin/auvirt -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/usr/bin/auvirt -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/bin/auvirt -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F path=/usr/sbin/auvirt -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/usr/sbin/auvirt -F perm=x -F key=T1005_Data_From_Local_System_Audit_Log

## auditbeat
### https://www.elastic.co/guide/en/beats/auditbeat/index.html
-a always,exit -F arch=b32 -F path=/etc/beat/auditbeat.yml -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F path=/etc/beat/auditbeat.yml -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F dir=/etc/beat/ -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F dir=/etc/beat/ -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

-a always,exit -F arch=b32 -F dir=/usr/share/beats/config/ -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F dir=/usr/share/beats/config/ -F perm=wa -F key=T1005_Data_From_Local_System_Audit_Log

### lib64/ld-linux-x86-64.so.2
-a always,exit -F arch=b32 -F exe=/lib64/ld-linux-x86-64.so.2 -F key=T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b64 -F exe=/lib64/ld-linux-x86-64.so.2 -F key=T1005_Data_From_Local_System_Audit_Log

# logrotate
## https://github.com/logrotate/logrotate
-a always,exit -F arch=b32 -F path=/etc/logrotate.conf -F perm=wa -F key=T1053_Scheduled_Task_Job
-a always,exit -F arch=b64 -F path=/etc/logrotate.conf -F perm=wa -F key=T1053_Scheduled_Task_Job

-a always,exit -F arch=b32 -F path=/etc/logrotate.d/syslog -F perm=wa -F key=T1053_Scheduled_Task_Job
-a always,exit -F arch=b64 -F path=/etc/logrotate.d/syslog -F perm=wa -F key=T1053_Scheduled_Task_Job

-a always,exit -F arch=b32 -F dir=/etc/logrotate.d/ -F perm=wa -F key=T1053_Scheduled_Task_Job
-a always,exit -F arch=b64 -F dir=/etc/logrotate.d/ -F perm=wa -F key=T1053_Scheduled_Task_Job

-a always,exit -F arch=b32 -F path=/bin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job
-a always,exit -F arch=b64 -F path=/bin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job

-a always,exit -F arch=b32 -F path=/sbin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job
-a always,exit -F arch=b64 -F path=/sbin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job

-a always,exit -F arch=b32 -F path=/usr/bin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job
-a always,exit -F arch=b64 -F path=/usr/bin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job

-a always,exit -F arch=b32 -F path=/usr/sbin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job
-a always,exit -F arch=b64 -F path=/usr/sbin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job

-a always,exit -F arch=b32 -F path=/usr/local/bin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job
-a always,exit -F arch=b64 -F path=/usr/local/bin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job

-a always,exit -F arch=b32 -F path=/usr/local/sbin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job
-a always,exit -F arch=b64 -F path=/usr/local/sbin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job

-a always,exit -F arch=b32 -F path=/snap/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job
-a always,exit -F arch=b64 -F path=/snap/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job

-a always,exit -F arch=b32 -F path=/snap/bin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job
-a always,exit -F arch=b64 -F path=/snap/bin/logrotate -F perm=x -F key=T1053_Scheduled_Task_Job

# journald
## https://www.man7.org/linux/man-pages/man5/journald.conf.5.html
-a always,exit -F arch=b32 -F path=/etc/systemd/journald.conf -F perm=wa -F key=journald
-a always,exit -F arch=b64 -F path=/etc/systemd/journald.conf -F perm=wa -F key=journald

-a always,exit -F arch=b32 -F path=/run/systemd/journald.conf -F perm=wa -F key=journald
-a always,exit -F arch=b64 -F path=/run/systemd/journald.conf -F perm=wa -F key=journald

-a always,exit -F arch=b32 -F path=/usr/local/lib/systemd/journald.conf -F perm=wa -F key=journald
-a always,exit -F arch=b64 -F path=/usr/local/lib/systemd/journald.conf -F perm=wa -F key=journald

-a always,exit -F arch=b32 -F dir=/etc/systemd/journald.conf.d/ -F perm=wa -F key=journald
-a always,exit -F arch=b64 -F dir=/etc/systemd/journald.conf.d/ -F perm=wa -F key=journald

-a always,exit -F arch=b32 -F dir=/var/log/journal/ -F perm=wa -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F dir=/var/log/journal/ -F perm=wa -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F dir=/run/log/journal/ -F perm=wa -F key=journald
-a always,exit -F arch=b64 -F dir=/run/log/journal/ -F perm=wa -F key=journald

-a always,exit -F arch=b32 -F dir=/run/systemd/journald.conf.d/ -F perm=wa -F key=journald
-a always,exit -F arch=b64 -F dir=/run/systemd/journald.conf.d/ -F perm=wa -F key=journald

-a always,exit -F arch=b32 -F dir=/usr/lib/systemd/journald.conf.d/ -F perm=wa -F key=journald
-a always,exit -F arch=b64 -F dir=/usr/lib/systemd/journald.conf.d/ -F perm=wa -F key=journald

-a always,exit -F arch=b32 -F dir=/usr/local/lib/systemd/journald.conf.d/ -F perm=wa -F key=journald
-a always,exit -F arch=b64 -F dir=/usr/local/lib/systemd/journald.conf.d/ -F perm=wa -F key=journald

### journalctl
-a always,exit -F arch=b32 -F path=/bin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/bin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/sbin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/sbin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/usr/bin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/usr/bin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/usr/sbin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/usr/sbin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/usr/local/bin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/usr/local/bin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/usr/local/sbin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/usr/local/sbin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/snap/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/snap/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/snap/bin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/snap/bin/journalctl -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

## logger
-a always,exit -F arch=b32 -F path=/bin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/bin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/sbin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/sbin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/usr/bin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/usr/bin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/usr/sbin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/usr/sbin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/usr/local/bin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/usr/local/bin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/usr/local/sbin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/usr/local/sbin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/snap/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/snap/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/snap/bin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/snap/bin/logger -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

## clog
-a always,exit -F arch=b32 -F path=/bin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/bin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/sbin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/sbin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/usr/bin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/usr/bin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/usr/sbin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/usr/sbin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/usr/local/bin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/usr/local/bin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/usr/local/sbin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/usr/local/sbin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/snap/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/snap/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

-a always,exit -F arch=b32 -F path=/snap/bin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs
-a always,exit -F arch=b64 -F path=/snap/bin/clog -F perm=x -F key=T1070.002_Indicator_Removal_Clear_Linux_or_Mac_System_Logs

# logwatch
## T1005_Data_From_Local_System_Audit_Log
-a always,exit -F arch=b32 -F path=/etc/logwatch/conf/logwatch.conf -F perm=wa -F key=logwatch
-a always,exit -F arch=b64 -F path=/etc/logwatch/conf/logwatch.conf -F perm=wa -F key=logwatch

-a always,exit -F arch=b32 -F path=/etc/logwatch/conf/ignore.conf -F perm=wa -F key=logwatch
-a always,exit -F arch=b64 -F path=/etc/logwatch/conf/ignore.conf -F perm=wa -F key=logwatch

-a always,exit -F arch=b32 -F path=/etc/logwatch/conf/services/sshd.conf -F perm=wa -F key=logwatch
-a always,exit -F arch=b64 -F path=/etc/logwatch/conf/services/sshd.conf -F perm=wa -F key=logwatch

-a always,exit -F arch=b32 -F dir=/etc/logwatch/conf/ -F perm=wa -F key=logwatch
-a always,exit -F arch=b64 -F dir=/etc/logwatch/conf/ -F perm=wa -F key=logwatch

-a always,exit -F arch=b32 -F path=/usr/share/logwatch/default.conf/logwatch.conf -F perm=wa -F key=logwatch
-a always,exit -F arch=b64 -F path=/usr/share/logwatch/default.conf/logwatch.conf -F perm=wa -F key=logwatch

-a always,exit -F arch=b32 -F dir=/usr/share/logwatch/default.conf/ -F perm=wa -F key=logwatch
-a always,exit -F arch=b64 -F dir=/usr/share/logwatch/default.conf/ -F perm=wa -F key=logwatch

-a always,exit -F arch=b32 -F dir=/usr/share/logwatch/scripts/ -F perm=wa -F key=logwatch
-a always,exit -F arch=b64 -F dir=/usr/share/logwatch/scripts/ -F perm=wa -F key=logwatch

-a always,exit -F arch=b32 -F path=/usr/sbin/logwatch -F perm=x -F key=logwatch
-a always,exit -F arch=b64 -F path=/usr/sbin/logwatch -F perm=x -F key=logwatch

# AIDE
-a always,exit -F arch=b32 -F path=/etc/aide/aide.conf -F perm=wa -F key=aide
-a always,exit -F arch=b64 -F path=/etc/aide/aide.conf -F perm=wa -F key=aide

-a always,exit -F arch=b32 -F path=/etc/aide.conf -F perm=wa -F key=aide
-a always,exit -F arch=b64 -F path=/etc/aide.conf -F perm=wa -F key=aide

# Keep an eye on container
## Use these rules if you want to log container events
## watch for container creation
## https://github.com/linux-audit/audit-userspace/blob/master/rules/41-containers.rules
-a always,exit -F arch=b32 -S clone -F a0&0x7C020000 -F key=container-create
-a always,exit -F arch=b64 -S clone -F a0&0x7C020000 -F key=container-create

## watch for containers that may change their configuration
## https://github.com/linux-audit/audit-userspace/blob/master/rules/41-containers.rules
-a always,exit -F arch=b32 -S unshare,setns -F key=container-config
-a always,exit -F arch=b64 -S unshare,setns -F key=container-config

# Keep an eye on Docker

-a always,exit -F arch=b32 -F dir=/etc/docker/ -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F dir=/etc/docker/ -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/etc/default/docker -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/etc/default/docker -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/etc/docker/daemon.json -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/etc/docker/daemon.json -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/etc/init.d/docker -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/etc/init.d/docker -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/usr/bin/docker -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/bin/docker -F perm=x -F key=docker

-a always,exit -F arch=b32 -F path=/usr/sbin/docker -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/sbin/docker -F perm=x -F key=docker

## macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/docker -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/local/bin/docker -F perm=x -F key=docker

-a always,exit -F arch=b32 -F path=/usr/local/sbin/docker -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/local/sbin/docker -F perm=x -F key=docker

## docker-init
-a always,exit -F arch=b32 -F path=/usr/bin/docker-init -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/bin/docker-init -F perm=x -F key=docker

-a always,exit -F arch=b32 -F path=/usr/sbin/docker-init -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/sbin/docker-init -F perm=x -F key=docker

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/docker-init -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/local/bin/docker-init -F perm=x -F key=docker

## docker-proxy
-a always,exit -F arch=b32 -F path=/usr/bin/docker-proxy -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/bin/docker-proxy -F perm=x -F key=docker

-a always,exit -F arch=b32 -F path=/usr/sbin/docker-proxy -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/sbin/docker-proxy -F perm=x -F key=docker

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/docker-proxy -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/local/bin/docker-proxy -F perm=x -F key=docker

## dockerd
-a always,exit -F arch=b32 -F path=/usr/bin/dockerd -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/bin/dockerd -F perm=x -F key=docker

-a always,exit -F arch=b32 -F path=/usr/sbin/dockerd -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/sbin/dockerd -F perm=x -F key=docker

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/dockerd -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/local/bin/dockerd -F perm=x -F key=docker

## ovrouter
-a always,exit -F arch=b32 -F path=/usr/bin/ovrouter -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/bin/ovrouter -F perm=x -F key=docker

-a always,exit -F arch=b32 -F path=/usr/sbin/ovrouter -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/sbin/ovrouter -F perm=x -F key=docker

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/ovrouter -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/local/bin/ovrouter -F perm=x -F key=docker

-a always,exit -F arch=b32 -F path=/var/lib/docker -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/var/lib/docker -F perm=x -F key=docker

-a always,exit -F arch=b32 -F path=/lib/systemd/system/docker.service -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/lib/systemd/system/docker.service -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/docker.service -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/docker.service -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/lib/systemd/system/docker.socket -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/lib/systemd/system/docker.socket -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/docker.socket -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/docker.socket -F perm=wa -F key=docker

## docker-containerd
-a always,exit -F arch=b32 -F path=/etc/containerd/config.toml -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/etc/containerd/config.toml -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/var/lib/containerd/io.containerd.metadata.v1.bolt/meta.db -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/var/lib/containerd/io.containerd.metadata.v1.bolt/meta.db -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/metadata.db -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/metadata.db -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F dir=/var/run/containerd/io.containerd.runtime.v2.task/ -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F dir=/var/run/containerd/io.containerd.runtime.v2.task/ -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/usr/bin/docker-containerd -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/bin/docker-containerd -F perm=x -F key=docker

-a always,exit -F arch=b32 -F path=/usr/sbin/docker-containerd -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/sbin/docker-containerd -F perm=x -F key=docker

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/docker-containerd -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/local/bin/docker-containerd -F perm=x -F key=docker

## docker-runc
-a always,exit -F arch=b32 -F path=/usr/bin/docker-runc -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/bin/docker-runc -F perm=x -F key=docker

-a always,exit -F arch=b32 -F path=/usr/sbin/docker-runc -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/sbin/docker-runc -F perm=x -F key=docker

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/docker-runc -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/local/bin/docker-runc -F perm=x -F key=docker

## The current rule:
## -a always,exit -F arch=b32 -F dir=/var/lib/docker/ -F perm=wa -F key=docker
## -a always,exit -F arch=b64 -F dir=/var/lib/docker/ -F perm=wa -F key=docker
## will create a lot of logs on hosts running docker because
## the watched dir includes the docker volumes so that actions
## inside any container running on the hosts will trigger
## the rule.
## https://github.com/Neo23x0/auditd/pull/95
# -a always,exit -F arch=b32 -F dir=/var/lib/docker/ -F perm=wa -F key=docker
# -a always,exit -F arch=b64 -F dir=/var/lib/docker/ -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F dir=/var/lib/docker/containers/ -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F dir=/var/lib/docker/containers/ -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F dir=/etc/docker/ -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F dir=/etc/docker/ -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/etc/sysconfig/docker -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/etc/sysconfig/docker -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/etc/sysconfig/docker-storage -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/etc/sysconfig/docker-storage -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/lib/systemd/system/docker.service -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/lib/systemd/system/docker.service -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/docker.service -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/docker.service -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/lib/systemd/system/docker.socket -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/lib/systemd/system/docker.socket -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/docker.socket -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/docker.socket -F perm=wa -F key=docker

## CoreOS
### https://support.coreos.com/hc/en-us/articles/115005437348-Enabling-auditd
-a always,exit -F arch=b32 -F path=/run/torcx/bin/docker -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/run/torcx/bin/docker -F perm=x -F key=docker

## docker-compose
-a always,exit -F arch=b32 -F path=/usr/bin/docker-runc -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/bin/docker-runc -F perm=x -F key=docker

-a always,exit -F arch=b32 -F path=/usr/bin/docker-compose -F perm=x -F key=docker-compose
-a always,exit -F arch=b64 -F path=/usr/bin/docker-compose -F perm=x -F key=docker-compose

-a always,exit -F arch=b32 -F path=/usr/sbin/docker-compose -F perm=x -F key=docker-compose
-a always,exit -F arch=b64 -F path=/usr/sbin/docker-compose -F perm=x -F key=docker-compose

## docker-registry
-a always,exit -F arch=b32 -F path=/etc/docker/registry/config.yml -F perm=wa -F key=docker-registry
-a always,exit -F arch=b64 -F path=/etc/docker/registry/config.yml -F perm=wa -F key=docker-registry

-a always,exit -F arch=b32 -F path=/lib/systemd/system/docker-registry.service -F perm=wa -F key=docker-registry
-a always,exit -F arch=b64 -F path=/lib/systemd/system/docker-registry.service -F perm=wa -F key=docker-registry

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/docker-registry.service -F perm=wa -F key=docker-registry
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/docker-registry.service -F perm=wa -F key=docker-registry

-a always,exit -F arch=b32 -F path=/etc/init.d/docker-registry -F perm=wa -F key=docker-registry
-a always,exit -F arch=b64 -F path=/etc/init.d/docker-registry -F perm=wa -F key=docker-registry

-a always,exit -F arch=b32 -F path=/usr/bin/docker-registry -F perm=x -F key=docker-registry
-a always,exit -F arch=b64 -F path=/usr/bin/docker-registry -F perm=x -F key=docker-registry

-a always,exit -F arch=b32 -F path=/usr/sbin/docker-registry -F perm=x -F key=docker-registry
-a always,exit -F arch=b64 -F path=/usr/sbin/docker-registry -F perm=x -F key=docker-registry

## Keep an eye on podman
### https://github.com/containers/podman
### https://podman.io/
-a always,exit -F arch=b32 -F path=/usr/bin/podman -F perm=x -F key=podman
-a always,exit -F arch=b64 -F path=/usr/bin/podman -F perm=x -F key=podman

-a always,exit -F arch=b32 -F path=/usr/sbin/podman -F perm=x -F key=podman
-a always,exit -F arch=b64 -F path=/usr/sbin/podman -F perm=x -F key=podman

-a always,exit -F arch=b32 -F path=/etc/containers/registries.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/etc/containers/registries.conf -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/etc/containers/storage.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/etc/containers/storage.conf -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/etc/containers/mounts.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/etc/containers/mounts.conf -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/etc/containers/libpod.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/etc/containers/libpod.conf -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/etc/containers/policy.json -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/etc/containers/policy.json -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F dir=/etc/containers/ -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F dir=/etc/containers/ -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/etc/cni/net.d/87-podman-bridge.conflist -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/etc/cni/net.d/87-podman-bridge.conflist -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/tmpfiles.d/podman-docker.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/tmpfiles.d/podman-docker.conf -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/share/containers/mounts.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/share/containers/mounts.conf -F perm=wa -F key=podman

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/podman -F perm=x -F key=podman
-a always,exit -F arch=b64 -F path=/usr/local/bin/podman -F perm=x -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/podman-auto-update.service -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/podman-auto-update.service -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/podman-auto-update.timer -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/podman-auto-update.timer -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/podman-restart.service -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/podman-restart.service -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/podman.service -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/podman.service -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/podman.socket -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/podman.socket -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/user/podman.service -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/user/podman.service -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/user/podman.socket -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/user/podman.socket -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/share/containers/registries.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/share/containers/registries.conf -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/share/containers/storage.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/share/containers/storage.conf -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/share/containers/mounts.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/share/containers/mounts.conf -F perm=wa -F key=podman

### podman on SUSE SLES
#### https://documentation.suse.com/en-us/sle-containers/all/html/SLE-container-guide/cha-podman-overview.html
-a always,exit -F arch=b32 -F path=/usr/bin/podman -F perm=x -F key=podman
-a always,exit -F arch=b64 -F path=/usr/bin/podman -F perm=x -F key=podman

-a always,exit -F arch=b32 -F path=/usr/sbin/podman -F perm=x -F key=podman
-a always,exit -F arch=b64 -F path=/usr/sbin/podman -F perm=x -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/podman-auto-update.service -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/podman-auto-update.service -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/podman-auto-update.timer -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/podman-auto-update.timer -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/podman-restart.service -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/podman-restart.service -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/podman.service -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/podman.service -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/podman.socket -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/podman.socket -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/user/podman.service -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/user/podman.service -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/user/podman.socket -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/user/podman.socket -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/etc/containers/registries.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/etc/containers/registries.conf -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/etc/containers/storage.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/etc/containers/storage.conf -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/etc/containers/mounts.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/etc/containers/mounts.conf -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/share/containers/mounts.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/share/containers/mounts.conf -F perm=wa -F key=podman

### podman on Red Hat RHEL
#### https://www.redhat.com/en/blog/working-linux-containers-rhel-8-podman-image-builder-and-web-console
-a always,exit -F arch=b32 -F path=/usr/bin/podman -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/bin/podman -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/sbin/podman -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/sbin/podman -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/io.podman.service -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/io.podman.service -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/io.podman.socket -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/io.podman.socket -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/user/io.podman.service -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/user/io.podman.service -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/user/io.podman.socket -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/user/io.podman.socket -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/etc/containers/registries.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/etc/containers/registries.conf -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/etc/containers/storage.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/etc/containers/storage.conf -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/etc/containers/mounts.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/etc/containers/mounts.conf -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F path=/usr/share/containers/mounts.conf -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F path=/usr/share/containers/mounts.conf -F perm=wa -F key=podman

### CRI-O
#### https://github.com/cri-o
-a always,exit -F arch=b32 -F path=/etc/containers/registries.conf -F perm=wa -F key=CRI-O
-a always,exit -F arch=b64 -F path=/etc/containers/registries.conf -F perm=wa -F key=CRI-O

-a always,exit -F arch=b32 -F path=/etc/crio/crio.conf.d/01-log-level.conf -F perm=wa -F key=CRI-O
-a always,exit -F arch=b64 -F path=/etc/crio/crio.conf.d/01-log-level.conf -F perm=wa -F key=CRI-O

-a always,exit -F arch=b32 -F dir=/etc/crio/crio.conf.d/ -F perm=wa -F key=CRI-O
-a always,exit -F arch=b64 -F dir=/etc/crio/crio.conf.d/ -F perm=wa -F key=CRI-O

-a always,exit -F arch=b32 -F path=/usr/local/bin/crio -F perm=x -F key=CRI-O
-a always,exit -F arch=b64 -F path=/usr/local/bin/crio -F perm=x -F key=CRI-O

## lxc
### https://www.man7.org/linux/man-pages/man5/lxc.conf.5.html
-a always,exit -F arch=b32 -F path=/etc/lxc/default.conf perm=wa -F key=lxc
-a always,exit -F arch=b64 -F path=/etc/lxc/default.conf perm=wa -F key=lxc

-a always,exit -F arch=b32 -F dir=/etc/lxc/ perm=wa -F key=lxc
-a always,exit -F arch=b64 -F dir=/etc/lxc/ perm=wa -F key=lxc

-a always,exit -F arch=b32 -F path=/usr/bin/lxc-start perm=wa -F key=lxc
-a always,exit -F arch=b64 -F path=/usr/bin/lxc-start perm=wa -F key=lxc

-a always,exit -F arch=b32 -F path=/usr/bin/lxc-stop perm=wa -F key=lxc
-a always,exit -F arch=b64 -F path=/usr/bin/lxc-stop perm=wa -F key=lxc

-a always,exit -F arch=b32 -F path=/usr/bin/lxc-update-config -F key=lxc
-a always,exit -F arch=b64 -F path=/usr/bin/lxc-update-config -F key=lxc

## Auditing Kubernetes, Docker, and Containerd 🐳
## This section includes rules for Kubernetes and various container runtimes
## to monitor for unauthorized changes and activities.

# Watch for container creation and configuration changes
-a always,exit -F arch=b32 -S clone -F a0&0x7C020000 -F key=container-create
-a always,exit -F arch=b64 -S clone -F a0&0x7C020000 -F key=container-create

-a always,exit -F arch=b32 -S unshare,setns -F key=container-config
-a always,exit -F arch=b64 -S unshare,setns -F key=container-config

# --- Core Kubernetes Components ---
## Monitor the kubelet service and its configuration
-a always,exit -F arch=b32 -F path=/var/lib/kubelet/ -F perm=wa -F key=k8s-kubelet-config
-a always,exit -F arch=b64 -F path=/var/lib/kubelet/ -F perm=wa -F key=k8s-kubelet-config

-a always,exit -F arch=b32 -F path=/var/lib/kubelet/kubeconfig -F perm=wa -F key=k8s-kubelet-config
-a always,exit -F arch=b64 -F path=/var/lib/kubelet/kubeconfig -F perm=wa -F key=k8s-kubelet-config

-a always,exit -F arch=b32 -F path=/etc/kubernetes/kubelet.conf -F perm=wa -F key=k8s-kubelet-config
-a always,exit -F arch=b64 -F path=/etc/kubernetes/kubelet.conf -F perm=wa -F key=k8s-kubelet-config

# Monitor kube-proxy
-a always,exit -F arch=b32 -F path=/etc/kubernetes/kube-proxy.conf -F perm=wa -F key=k8s-kube-proxy
-a always,exit -F arch=b64 -F path=/etc/kubernetes/kube-proxy.conf -F perm=wa -F key=k8s-kube-proxy

-a always,exit -F arch=b32 -F path=/var/lib/kube-proxy/ -F perm=wa -F key=k8s-kube-proxy
-a always,exit -F arch=b64 -F path=/var/lib/kube-proxy/ -F perm=wa -F key=k8s-kube-proxy

# Monitor API server authentication files
-a always,exit -F arch=b32 -F path=/etc/kubernetes/pki/ -F perm=wa -F key=k8s-pki
-a always,exit -F arch=b64 -F path=/etc/kubernetes/pki/ -F perm=wa -F key=k8s-pki

# Monitor static pods and manifest changes
-a always,exit -F arch=b32 -F dir=/etc/kubernetes/manifests/ -F perm=wa -F key=k8s-manifests
-a always,exit -F arch=b64 -F dir=/etc/kubernetes/manifests/ -F perm=wa -F key=k8s-manifests

# Monitor the main Kubernetes binaries
-a always,exit -F arch=b32 -F path=/usr/bin/kubelet -F perm=x -F key=k8s-binary
-a always,exit -F arch=b64 -F path=/usr/bin/kubelet -F perm=x -F key=k8s-binary

-a always,exit -F arch=b32 -F path=/usr/bin/kube-proxy -F perm=x -F key=k8s-binary
-a always,exit -F arch=b64 -F path=/usr/bin/kube-proxy -F perm=x -F key=k8s-binary

-a always,exit -F arch=b32 -F path=/usr/bin/kubectl -F perm=x -F key=k8s-binary
-a always,exit -F arch=b64 -F path=/usr/bin/kubectl -F perm=x -F key=k8s-binary

-a always,exit -F arch=b32 -F path=/usr/bin/crictl -F perm=x -F key=k8s-binary
-a always,exit -F arch=b64 -F path=/usr/bin/crictl -F perm=x -F key=k8s-binary

# --- Container Runtimes (CRI) ---
## The following rules are for popular container runtimes used by Kubernetes.

# Rules for containerd
-a always,exit -F arch=b32 -F path=/usr/bin/containerd -F perm=x -F key=containerd
-a always,exit -F arch=b64 -F path=/usr/bin/containerd -F perm=x -F key=containerd

-a always,exit -F arch=b32 -F path=/etc/containerd/config.toml -F perm=wa -F key=containerd
-a always,exit -F arch=b64 -F path=/etc/containerd/config.toml -F perm=wa -F key=containerd

-a always,exit -F arch=b32 -F dir=/var/lib/containerd/ -F perm=wa -F key=containerd
-a always,exit -F arch=b64 -F dir=/var/lib/containerd/ -F perm=wa -F key=containerd

-a always,exit -F arch=b32 -F dir=/var/run/containerd/ -F perm=wa -F key=containerd
-a always,exit -F arch=b64 -F dir=/var/run/containerd/ -F perm=wa -F key=containerd

# Rules for CRI-O
-a always,exit -F arch=b32 -F path=/usr/bin/crio -F perm=x -F key=crio
-a always,exit -F arch=b64 -F path=/usr/bin/crio -F perm=x -F key=crio

-a always,exit -F arch=b32 -F dir=/etc/crio/ -F perm=wa -F key=crio
-a always,exit -F arch=b64 -F dir=/etc/crio/ -F perm=wa -F key=crio

-a always,exit -F arch=b32 -F dir=/var/lib/crio/ -F perm=wa -F key=crio
-a always,exit -F arch=b64 -F dir=/var/lib/crio/ -F perm=wa -F key=crio

# Rules for Docker
-a always,exit -F arch=b32 -F path=/usr/bin/dockerd -F perm=x -F key=docker
-a always,exit -F arch=b64 -F path=/usr/bin/dockerd -F perm=x -F key=docker

-a always,exit -F arch=b32 -F path=/etc/docker/daemon.json -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F path=/etc/docker/daemon.json -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F dir=/var/lib/docker/ -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F dir=/var/lib/docker/ -F perm=wa -F key=docker

-a always,exit -F arch=b32 -F dir=/etc/sysconfig/docker -F perm=wa -F key=docker
-a always,exit -F arch=b64 -F dir=/etc/sysconfig/docker -F perm=wa -F key=docker

# --- Podman Rules ---
## Podman is another popular container engine.
-a always,exit -F arch=b32 -F path=/usr/bin/podman -F perm=x -F key=podman
-a always,exit -F arch=b64 -F path=/usr/bin/podman -F perm=x -F key=podman

-a always,exit -F arch=b32 -F dir=/etc/containers/ -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F dir=/etc/containers/ -F perm=wa -F key=podman

-a always,exit -F arch=b32 -F dir=/usr/share/containers/ -F perm=wa -F key=podman
-a always,exit -F arch=b64 -F dir=/usr/share/containers/ -F perm=wa -F key=podman

# --- System-wide and Low-Level Auditing ---
## Monitor for processes that change namespaces or modify kernel parameters
-a always,exit -F arch=b32 -S setns,unshare,clone -F key=namespace-change
-a always,exit -F arch=b64 -S setns,unshare,clone -F key=namespace-change

-a always,exit -F arch=b32 -S mount,pivot_root -F key=fs-change
-a always,exit -F arch=b64 -S mount,pivot_root -F key=fs-change

-a always,exit -F arch=b32 -S ptrace -F key=ptrace-attempt
-a always,exit -F arch=b64 -S ptrace -F key=ptrace-attempt

## Kubernetes
### API Server config
-a always,exit -F arch=b32 -F path=/etc/kubernetes/admin.conf -F perm=wa -F key=k8s-admin-config
-a always,exit -F arch=b64 -F path=/etc/kubernetes/admin.conf -F perm=wa -F key=k8s-admin-config

### Controller Manager
-a always,exit -F arch=b32 -F path=/etc/kubernetes/controller-manager.conf -F perm=wa -F key=k8s-controller-config
-a always,exit -F arch=b64 -F path=/etc/kubernetes/controller-manager.conf -F perm=wa -F key=k8s-controller-config

### Scheduler
-a always,exit -F arch=b32 -F path=/etc/kubernetes/scheduler.conf -F perm=wa -F key=k8s-scheduler-config
-a always,exit -F arch=b64 -F path=/etc/kubernetes/scheduler.conf -F perm=wa -F key=k8s-scheduler-config

### etcd
-a always,exit -F arch=b32 -F dir=/etc/kubernetes/pki/etcd/ -F perm=wa -F key=etcd-pki
-a always,exit -F arch=b64 -F dir=/etc/kubernetes/pki/etcd/ -F perm=wa -F key=etcd-pki

-a always,exit -F arch=b32 -F dir=/var/lib/etcd/ -F perm=wa -F key=etcd-data
-a always,exit -F arch=b64 -F dir=/var/lib/etcd/ -F perm=wa -F key=etcd-data

### kubernetes
-a always,exit -F arch=b32 -F dir=/etc/kubernetes/ -F perm=wa -F key=kubernetes
-a always,exit -F arch=b64 -F dir=/etc/kubernetes/ -F perm=wa -F key=kubernetes

### CNI Plugin Monitoring:
-a always,exit -F arch=b32 -F dir=/etc/cni/net.d/ -F perm=wa -F key=cni-config
-a always,exit -F arch=b64 -F dir=/etc/cni/net.d/ -F perm=wa -F key=cni-config

-a always,exit -F arch=b32 -F dir=/etc/cni/ -F perm=wa -F key=cni
-a always,exit -F arch=b64 -F dir=/etc/cni/ -F perm=wa -F key=cni

-a always,exit -F arch=b32 -F dir=/opt/cni/bin/ -F perm=wa -F key=cni-binaries
-a always,exit -F arch=b64 -F dir=/opt/cni/bin/ -F perm=wa -F key=cni-binaries

### aks-auditd
#### kube-system
#### https://github.com/Azure/aks-auditd

-a always,exit -F arch=b32 -S execve -F key=procmon
-a always,exit -F arch=b64 -S execve -F key=procmon

## Virtualization stuff

### qemu
#### https://gitlab.com/qemu-project/qemu
-a always,exit -F arch=b32 -F path=/usr/bin/qemu-img -F perm=x -F key=qemu-img
-a always,exit -F arch=b64 -F path=/usr/bin/qemu-img -F perm=x -F key=qemu-img

-a always,exit -F arch=b32 -F path=/usr/bin/qemu-kvm -F perm=x -F key=qemu-kvm
-a always,exit -F arch=b64 -F path=/usr/bin/qemu-kvm -F perm=x -F key=qemu-kvm

-a always,exit -F arch=b32 -F path=/usr/bin/qemu -F perm=x -F key=qemu
-a always,exit -F arch=b64 -F path=/usr/bin/qemu -F perm=x -F key=qemu

-a always,exit -F arch=b32 -F path=/usr/bin/qemu-system-x86_64 -F perm=x -F key=qemu-system-x86_64
-a always,exit -F arch=b64 -F path=/usr/bin/qemu-system-x86_64 -F perm=x -F key=qemu-system-x86_64

-a always,exit -F arch=b32 -F path=/usr/libexec/qemu-bridge-helper -F "auid>=500" -F "auid!=-1" -F perm=x -F key=qemu-bridge-helper
-a always,exit -F arch=b64 -F path=/usr/libexec/qemu-bridge-helper -F "auid>=500" -F "auid!=-1" -F perm=x -F key=qemu-bridge-helper

#### qemu on macOS
##### https://wiki.qemu.org/Hosts/Mac
-a always,exit -F arch=b32 -F path=/usr/local/bin/qemu-edid -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/qemu-edid -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/qemu-img -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/qemu-img -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/qemu-io -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/qemu-io -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/qemu-nbd -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/qemu-nbd -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/qemu-storage-daemon -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/qemu-storage-daemon -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/qemu-system-x86_64 -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/qemu-system-x86_64 -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/qemu-system-arm -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/qemu-system-arm -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

### UTM
#### https://mac.getutm.app/
-a always,exit -F arch=b32 -F path=/usr/local/bin/utmctl -F perm=x -F key=utm
-a always,exit -F arch=b64 -F path=/usr/local/bin/utmctl -F perm=x -F key=utm

### aqemu
#### https://github.com/tobimensch/aqemu
-a always,exit -F arch=b32 -F path=/usr/bin/aqemu -F perm=x -F key=aqemu
-a always,exit -F arch=b64 -F path=/usr/bin/aqemu -F perm=x -F key=aqemu

-a always,exit -F arch=b32 -F path=/usr/sbin/aqemu -F perm=x -F key=aqemu
-a always,exit -F arch=b64 -F path=/usr/sbin/aqemu -F perm=x -F key=aqemu

### VirtualBox
#### https://github.com/Virtualbox-OSE/Virtualbox
-a always,exit -F arch=b32 -F path=/etc/default/virtualbox -F perm=wa -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/etc/default/virtualbox -F perm=wa -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/etc/init.d/vboxdrv -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/etc/init.d/vboxdrv -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/etc/init.d/virtualbox -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/etc/init.d/virtualbox -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/virtualbox -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/virtualbox -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/virtualbox -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/virtualbox -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/virt-manager -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/virt-manager -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/virt-manager -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/virt-manager -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/lib/udev/VBoxCreateUSBNode.sh -F perm=wax -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/lib/udev/VBoxCreateUSBNode.sh -F perm=wax -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/lib/udev/VBoxCreateUSBNode.sh -F perm=wax -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/lib/udev/VBoxCreateUSBNode.sh -F perm=wax -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/lib/udev/rules.d/60-virtualbox.rules -F perm=wa -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/lib/udev/rules.d/60-virtualbox.rules -F perm=wa -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/lib/udev/rules.d/60-virtualbox.rules -F perm=wa -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/lib/udev/rules.d/60-virtualbox.rules -F perm=wa -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/VBoxBalloonCtrl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/VBoxBalloonCtrl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/VBoxBalloonCtrl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/VBoxBalloonCtrl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/VBoxHeadless -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/VBoxHeadless -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/VBoxHeadless -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/VBoxHeadless -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/VBoxManage -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/VBoxManage -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/VBoxManage -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/VBoxManage -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/VBoxSDL -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/VBoxSDL -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/VBoxSDL -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/VBoxSDL -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/vbox-img -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/vbox-img -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/vbox-img -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/vbox-img -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/vboxballoonctrl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/vboxballoonctrl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/vboxballoonctrl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/vboxballoonctrl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/vboxheadless -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/vboxheadless -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/vboxheadless -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/vboxheadless -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/vboximg-mount -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/vboximg-mount -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/vboximg-mount -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/vboximg-mount -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/vboxmanage -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/vboxmanage -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/vboxmanage -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/vboxmanage -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/vboxsdl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/vboxsdl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/vboxsdl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/vboxsdl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/vboxwebsrv -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/vboxwebsrv -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/vboxwebsrv -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/vboxwebsrv -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/etc/init.d/vboxadd-service -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/etc/init.d/vboxadd-service -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

#### VirtualBox on macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/VirtualBox -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/VirtualBox -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/VirtualBoxVM -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/VirtualBoxVM -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/VBoxManage -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/VBoxManage -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/VBoxAudioTest -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/VBoxAudioTest -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/VBoxAutostart -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/VBoxAutostart -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/VBoxBugReport -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/VBoxBugReport -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/VBoxBalloonCtrl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/VBoxBalloonCtrl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/VBoxDTrace -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/VBoxDTrace -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/VBoxVRDP -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/VBoxVRDP -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/VBoxHeadless -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/VBoxHeadless -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/VBoxManage -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/VBoxManage -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/VirtualBoxVM -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/VirtualBoxVM -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vboximg-mount -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vboximg-mount -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vboxwebsrv -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vboxwebsrv -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vbox-img -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vbox-img -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F dir=/Library/LaunchDaemons/org.virtualbox.startup.plist -F perm=wa -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F dir=/Library/LaunchDaemons/org.virtualbox.startup.plist -F perm=wa -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F dir=/Library/Application Support/VirtualBox/LaunchDaemons/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F dir=/Library/Application Support/VirtualBox/LaunchDaemons/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F dir=/Library/Application Support/VirtualBox/VBoxDrv.kext/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F dir=/Library/Application Support/VirtualBox/VBoxDrv.kext/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F dir=Library/Application Support/VirtualBox/VBoxUSB.kext/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F dir=Library/Application Support/VirtualBox/VBoxUSB.kext/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F dir=/Library/Application Support/VirtualBox/VBoxNetFlt.kext/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F dir=/Library/Application Support/VirtualBox/VBoxNetFlt.kext/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F dir=/Library/Application Support/VirtualBox/VBoxNetAdp.kext/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F dir=/Library/Application Support/VirtualBox/VBoxNetAdp.kext/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

### VMware Fusion on macOS
#### https://docs.vmware.com/en/VMware-Fusion/index.html

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-aewp -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-aewp -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-rawdiskAuthTool -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-rawdiskAuthTool -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-vmdkserver -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-vmdkserver -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-authd -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-authd -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-rawdiskCreator -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-rawdiskCreator -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-vmx -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-vmx -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-cloneBootCamp -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-cloneBootCamp -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-remotemks -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-remotemks -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-vmx-debug -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-vmx-debug -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-id -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-id -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-usbarbitrator -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-usbarbitrator -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-vmx-stats -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-vmx-stats -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-ntfs -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-ntfs -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmrun -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmrun -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/vmware-vdiskmanager -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/vmware-vdiskmanager -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F dir=/Library/Application Support/VMware/VMware Fusion/AdminWritable/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F dir=/Library/Application Support/VMware/VMware Fusion/AdminWritable/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F dir=/Library/Application Support/VMware/VMware Fusion/Shared/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F dir=/Library/Application Support/VMware/VMware Fusion/Shared/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

#### Tools images ("/Library/Application Support/VMware Fusion/isoimages/")
-a always,exit -F arch=b32 -F dir=/Library/Application Support/VMware Fusion/isoimages/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F dir=/Library/Application Support/VMware Fusion/isoimages/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F dir=/Library/Application Support/VMware/VMware Fusion/isoimages/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F dir=/Library/Application Support/VMware/VMware Fusion/isoimages/ -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

#### https://communities.vmware.com/t5/VMware-Fusion-Documents/A-Beginner-s-Guide-to-VMware-Fusion/ta-p/2797381
#### Fusion UI log ("/Users/yourusername/Library/Logs/VMware Fusion/vmware-vmfusion.log")
# -w /Users/yourusername/Library/Logs/VMware Fusion -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
#### Just as the vmware-vmx process creates vmware.log, the Fusion UI process creates this log.
#### Like vmware.log, this is a rotating log.
#### You shouldn't normally have to deal with these, Fusion should automatically take care
#### of connecting them to the guest when you choose Virtual Machine > Install VMware Tools.
#### User-wide configuration, essentially .vmx defaults. Individual .vmx files override this.
#### ("/Users/yourusername/Library/Preferences/VMware Fusion/config")
# -w /Users/yourusername/Library/Preferences/VMware -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
#### User-wide preferences, mostly UI controls. Individual .vmx settings do not override this because
#### these settings do not apply to individual VMs. ("/Users/yourusername/Library/Preferences/VMware Fusion/preferences")
# -w /Users/yourusername/Library/Preferences/VMware Fusion/preferences -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
#### Note the difference between the config and preferences files is mostly by convention,
#### it's possible (but bad practice) to mix entries between them. This doesn't always work, though.

### Parallels Desktop on macOS
#### https://www.parallels.com/products/desktop/
-a always,exit -F arch=b32 -F path=/usr/local/bin/prl_convert -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/prl_convert -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/prl_disk_tool -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/prl_disk_tool -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/prl_perf_ctl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/prl_perf_ctl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/prlcore2dmp -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/prlcore2dmp -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/prlctl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/prlctl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/prlexec -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/prlexec -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/prlsrvctl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/prlsrvctl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/Library/Preferences/Parallels -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/Library/Preferences/Parallels -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

### Xen
-a always,exit -F arch=b32 -F dir=/etc/xen/ -F perm=wa -F key=xen
-a always,exit -F arch=b64 -F dir=/etc/xen/ -F perm=wa -F key=xen

#### Monitoring Xen Management Tool Execution (execve)
-a always,exit -F arch=b32 -S execve -F path=/usr/sbin/xl -F key=xen_management
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/xl -F key=xen_management

-a always,exit -F arch=b32 -S execve -F path=/usr/sbin/xm -F key=xen_management
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/xm -F key=xen_management

-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/xend -F key=xen_management
-a always,exit -F arch=b32 -S execve -F path=/usr/sbin/xend -F key=xen_management

#### /etc/xen/ - configs (open for writes, create, unlink/delete, rename, chmod, chown, etc.)
-a always,exit -F arch=b32 -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F dir=/etc/xen/ -F key=xen_config
-a always,exit -F arch=b64 -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F dir=/etc/xen/ -F key=xen_config

#### /var/lib/xen/ - VM storage changes
-a always,exit -F arch=b32 -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F dir=/var/lib/xen/ -F key=xen_vm_storage
-a always,exit -F arch=b64 -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F dir=/var/lib/xen/ -F key=xen_vm_storage

#### Bootloader Directory Changes (/boot/)
-a always,exit -F arch=b32 -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F dir=/boot/ -F key=xen_boot
-a always,exit -F arch=b64 -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F dir=/boot/ -F key=xen_boot

#### Module Loads/Unloads
-a always,exit -F arch=b32 -S init_module -S delete_module -F key=module_change
-a always,exit -F arch=b64 -S init_module -S delete_module -F key=module_change

### KVM
#### Adding -F "auid>=500" -F "auid!=-1" to your auditd rules ensures that
#### you only log actions performed by “real” user accounts
#### (not system services or anonymous users)

#### Monitoring Execution of KVM/QEMU/Libvirt Tools
-a always,exit -F arch=b32 -S execve -F path=/usr/bin/qemu-system-x86_64 -F "auid>=500" -F "auid!=-1" -F key=kvm_tool
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/qemu-system-x86_64 -F "auid>=500" -F "auid!=-1" -F key=kvm_tool

-a always,exit -F arch=b32 -S execve -F path=/usr/bin/virsh -F "auid>=500" -F "auid!=-1" -F key=kvm_tool
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/virsh -F "auid>=500" -F "auid!=-1" -F key=kvm_tool

-a always,exit -F arch=b32 -S execve -F path=/usr/sbin/libvirtd -F "auid>=500" -F "auid!=-1" -F key=kvm_tool
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/libvirtd -F "auid>=500" -F "auid!=-1" -F key=kvm_tool

-a always,exit -F arch=b32 -S execve -F path=/usr/bin/virt-install -F "auid>=500" -F "auid!=-1" -F key=kvm_tool
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/virt-install -F "auid>=500" -F "auid!=-1" -F key=kvm_tool

#### Monitoring Configuration and VM Storage Changes
##### /etc/libvirt/ — VM and network configuration files
-a always,exit -F arch=b32 -F dir=/etc/libvirt/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F key=kvm_config
-a always,exit -F arch=b64 -F dir=/etc/libvirt/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F key=kvm_config

#-a always,exit -F arch=b64 -F dir=/etc/libvirt/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=kvm_config
#-a always,exit -F arch=b32 -F dir=/etc/libvirt/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=kvm_config

##### /var/lib/libvirt/ — VM disk images and runtime data
-a always,exit -F arch=b32 -F dir=/var/lib/libvirt/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F key=kvm_storage
-a always,exit -F arch=b64 -F dir=/var/lib/libvirt/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F key=kvm_storage

#-a always,exit -F arch=b64 -F dir=/var/lib/libvirt/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=kvm_storage
#-a always,exit -F arch=b32 -F dir=/var/lib/libvirt/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=kvm_storage

#### (Optional) Monitoring Filesystem Mount/Unmount Events
-a always,exit -F arch=b32 -S mount -S umount2 -F key=kvm_mount
-a always,exit -F arch=b64 -S mount -S umount2 -F key=kvm_mount

#-a always,exit -F arch=b64 -S mount -S umount2 -F "auid>=500" -F "auid!=-1" -F key=kvm_mount
#-a always,exit -F arch=b32 -S mount -S umount2 -F "auid>=500" -F "auid!=-1" -F key=kvm_mount

#### (Optional) Module Load/Unload for KVM Kernel Modules
-a always,exit -F arch=b32 -S init_module -S delete_module -F key=module_change
-a always,exit -F arch=b64 -S init_module -S delete_module -F key=module_change

#-a always,exit -F arch=b64 -S init_module -S delete_module -F "auid>=500" -F "auid!=-1" -F key=module_change
#-a always,exit -F arch=b32 -S init_module -S delete_module -F "auid>=500" -F "auid!=-1" -F key=module_change
# If you want to catch all module loads/unloads (including on boot), omit the auid filters from these rules.

### Nutanix AHV (Acropolis Hypervisor)
#### Monitor Nutanix AHV Management Tool Executions
-a always,exit -F arch=b32 -S execve -F path=/usr/local/nutanix/bin/acli -F "auid>=500" -F "auid!=-1" -F key=ahv_tool
-a always,exit -F arch=b64 -S execve -F path=/usr/local/nutanix/bin/acli -F "auid>=500" -F "auid!=-1" -F key=ahv_tool

-a always,exit -F arch=b32 -S execve -F path=/usr/local/nutanix/bin/acropolis -F "auid>=500" -F "auid!=-1" -F key=ahv_tool
-a always,exit -F arch=b64 -S execve -F path=/usr/local/nutanix/bin/acropolis -F "auid>=500" -F "auid!=-1" -F key=ahv_tool

-a always,exit -F arch=b32 -S execve -F path=/usr/bin/virsh -F "auid>=500" -F "auid!=-1" -F key=ahv_tool
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/virsh -F "auid>=500" -F "auid!=-1" -F key=ahv_tool

-a always,exit -F arch=b32 -S execve -F path=/usr/bin/qemu-system-x86_64 -F "auid>=500" -F "auid!=-1" -F key=ahv_tool
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/qemu-system-x86_64 -F "auid>=500" -F "auid!=-1" -F key=ahv_tool

#### Monitor Configuration and VM Image Storage Changes
##### /etc/nutanix/ for cluster/hypervisor configuration
-a always,exit -F arch=b32 -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F dir=/etc/nutanix/ -F "auid>=500" -F "auid!=-1" -F key=ahv_config
-a always,exit -F arch=b64 -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F dir=/etc/nutanix/ -F "auid>=500" -F "auid!=-1" -F key=ahv_config

##### Common VM disk/data storage for KVM on AHV (adjust if your layout differs)
-a always,exit -F arch=b64 -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F dir=/var/lib/libvirt/ -F "auid>=500" -F "auid!=-1" -F key=ahv_vm_storage
-a always,exit -F arch=b32 -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F dir=/var/lib/libvirt/ -F "auid>=500" -F "auid!=-1" -F key=ahv_vm_storage

### Monitor Filesystem Mount/Unmount (Optional, may be noisy)
-a always,exit -F arch=b32 -S mount -S umount2 -F "auid>=500" -F "auid!=-1" -F key=ahv_mount
-a always,exit -F arch=b64 -S mount -S umount2 -F "auid>=500" -F "auid!=-1" -F key=ahv_mount

### Monitor Kernel Module Loads/Unloads (Optional)
-a always,exit -F arch=b32 -S init_module -S delete_module -F "auid>=500" -F "auid!=-1" -F key=module_change
-a always,exit -F arch=b64 -S init_module -S delete_module -F "auid>=500" -F "auid!=-1" -F key=module_change

# Filters

### We put these early because audit is a first match wins system.

## Ignore SELinux AVC records
## https://github.com/Neo23x0/auditd/issues/10

#-a always,exclude -F msgtype=AVC

## Ignore current working directory records
## https://github.com/Neo23x0/auditd/pull/144

-a always,exclude -F msgtype=CWD

## Ignore EOE records (End Of Event, not needed)

-a always,exclude -F msgtype=EOE

## Cron jobs fill the logs with stuff we normally don't want (works with SELinux)

-a never,user -F subj_type=crond_t
-a never,exit -F subj_type=crond_t

## VMware tools
## enable it if you are using a VMware environment
## https://kb.vmware.com/s/article/1014294
#-a exit,never -F arch=b32 -F path=/usr/lib/vmware-tools -S fork -F success=0 -F subj_type=initrc_t -F exit=-2 -F key=VMware_tools
#-a exit,never -F arch=b64 -F path=/usr/lib/vmware-tools -S fork -F success=0 -F subj_type=initrc_t -F exit=-2 -F key=VMware_tools

#-a exit,never -F arch=b32 -F exe=/usr/bin/vmtoolsd -S all -F key=VMware_tools
#-a exit,never -F arch=b64 -F exe=/usr/bin/vmtoolsd -S all -F key=VMware_tools

#-a exit,never -F arch=b32 -F dir=/etc/vmware-tools/ -S fork -F success=0 -F subj_type=initrc_t -F exit=-2 -F key=VMware_tools
#-a exit,never -F arch=b64 -F dir=/etc/vmware-tools/ -S fork -F success=0 -F subj_type=initrc_t -F exit=-2 -F key=VMware_tools

## High Volume Event Filter (especially on Linux Workstations)
### https://github.com/bfuzzy1/auditd-attack/blob/master/auditd-attack/auditd-attack.rules

-a always,exit -F arch=b32 -F dir=/dev/shm/ -F perm=w -F "auid>=500" -F "auid!=-1" -F key=sharedmem-create
-a always,exit -F arch=b64 -F dir=/dev/shm/ -F perm=w -F "auid>=500" -F "auid!=-1" -F key=sharedmem-create

# -a never,exit -F arch=b32 -F dir=/dev/shm/ -F key=sharedmemaccess
# -a never,exit -F arch=b64 -F dir=/dev/shm/ -F key=sharedmemaccess

-a never,exit -F arch=b32 -F dir=/var/lock/lvm/ -F key=locklvm
-a never,exit -F arch=b64 -F dir=/var/lock/lvm/ -F key=locklvm

## Filebeat
### https://www.elastic.co/guide/en/beats/filebeat/current/directory-layout.html

-a never,exit -F arch=b32 -F dir=/opt/filebeat/ -F perm=wa -F key=filebeat
-a never,exit -F arch=b64 -F dir=/opt/filebeat/ -F perm=wa -F key=filebeat

-a always,exit -F arch=b32 -F dir=/etc/filebeat/ -F perm=wa -F key=filebeat
-a always,exit -F arch=b64 -F dir=/etc/filebeat/ -F perm=wa -F key=filebeat

-a always,exit -F arch=b32 -F dir=/usr/share/filebeat/ -F perm=wa -F key=filebeat
-a always,exit -F arch=b64 -F dir=/usr/share/filebeat/ -F perm=wa -F key=filebeat

-a always,exit -F arch=b64 -F dir=/usr/share/filebeat/bin/ -F perm=x -F key=filebeat
-a always,exit -F arch=b32 -F dir=/usr/share/filebeat/bin/ -F perm=x -F key=filebeat

### macOS
#### https://www.elastic.co/guide/en/beats/filebeat/7.17/directory-layout.html
-a always,exit -F arch=b32 -F dir=/usr/local/var/homebrew/linked/filebeat-full/ -F perm=x -F key=filebeat
-a always,exit -F arch=b64 -F dir=/usr/local/var/homebrew/linked/filebeat-full/ -F perm=x -F key=filebeat

-a always,exit -F arch=b32 -F dir=/usr/local/var/homebrew/linked/filebeat-full/bin/ -F perm=x -F key=filebeat
-a always,exit -F arch=b64 -F dir=/usr/local/var/homebrew/linked/filebeat-full/bin/ -F perm=x -F key=filebeat

-a always,exit -F arch=b32 -F dir=/usr/local/etc/filebeat/ -F perm=wa -F key=filebeat
-a always,exit -F arch=b64 -F dir=/usr/local/etc/filebeat/ -F perm=wa -F key=filebeat

## More information on how to filter events
### https://access.redhat.com/solutions/2482221

# Rules

## Kernel parameters
### Depending on your system and kernel, the sysctl.conf file might be called or located in the following locations:
###
### /etc/sysctl.conf
###
### /etc/sysctl.d/*.conf
###
### /run/sysctl.d/*.conf
###
### /usr/local/lib/sysctl.d/*.conf
###
### /usr/lib/sysctl.d/*.conf
###
### /lib/sysctl.d/*.conf
-a always,exit -F arch=b32 -F path=/etc/sysctl.conf -F perm=wa -F key=sysctl
-a always,exit -F arch=b64 -F path=/etc/sysctl.conf -F perm=wa -F key=sysctl

-a always,exit -F arch=b32 -F dir=/etc/sysctl.d/ -F perm=wa -F key=sysctl
-a always,exit -F arch=b64 -F dir=/etc/sysctl.d/ -F perm=wa -F key=sysctl

-a always,exit -F arch=b32 -F dir=/run/sysctl.d/ -F perm=wa -F key=sysctl
-a always,exit -F arch=b64 -F dir=/run/sysctl.d/ -F perm=wa -F key=sysctl

-a always,exit -F arch=b32 -F dir=/usr/local/lib/sysctl.d/ -F perm=wa -F key=sysctl
-a always,exit -F arch=b64 -F dir=/usr/local/lib/sysctl.d/ -F perm=wa -F key=sysctl

-a always,exit -F arch=b32 -F dir=/usr/lib/sysctl.d/ -F perm=wa -F key=sysctl
-a always,exit -F arch=b64 -F dir=/usr/lib/sysctl.d/ -F perm=wa -F key=sysctl

-a always,exit -F arch=b32 -F dir=/lib/sysctl.d/ -F perm=wa -F key=sysctl
-a always,exit -F arch=b64 -F dir=/lib/sysctl.d/ -F perm=wa -F key=sysctl

-a always,exit -F arch=b32 -F path=/bin/sysctl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/sysctl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/sysctl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/sysctl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/sysctl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/sysctl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/sysctl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/sysctl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/sysctl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/sysctl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/sysctl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/sysctl -F perm=x -F key=T1083_File_and_Directory_Discovery

## Ensure auditd Collects Information on Kernel Module Loading and Unloading

-a always,exit -F arch=b32 -F path=/bin/insmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/bin/insmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/sbin/insmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/sbin/insmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/bin/insmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/bin/insmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/sbin/insmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/sbin/insmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/local/bin/insmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/local/bin/insmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/local/sbin/insmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/local/sbin/insmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/bin/modprobe -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/bin/modprobe -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/sbin/modprobe -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/sbin/modprobe -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/bin/modprobe -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/bin/modprobe -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/sbin/modprobe -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/sbin/modprobe -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/local/bin/modprobe -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/local/bin/modprobe -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/local/sbin/modprobe -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/local/sbin/modprobe -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/bin/rmmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/bin/rmmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/sbin/rmmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/sbin/rmmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/bin/rmmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/bin/rmmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/sbin/rmmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/sbin/rmmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/local/bin/rmmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/local/bin/rmmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rmmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rmmod -F "auid!=-1" -F perm=x -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -S finit_module -S init_module -S delete_module -F "auid!=-1" -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -S finit_module -S init_module -S delete_module -F "auid!=-1" -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

## Modprobe configuration

-a always,exit -F arch=b32 -F path=/etc/modprobe.conf -F perm=wa -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/etc/modprobe.conf -F perm=wa -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F dir=/etc/modprobe.d/ -F perm=wa -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F dir=/etc/modprobe.d/ -F perm=wa -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F dir=/usr/lib/modprobe.d/ -F perm=wa -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F dir=/usr/lib/modprobe.d/ -F perm=wa -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/lib/modprobe.d/fbdev-blacklist.conf -F perm=wa -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/lib/modprobe.d/fbdev-blacklist.conf -F perm=wa -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/lib/modprobe.d/aliases.conf -F perm=wa -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/lib/modprobe.d/aliases.conf -F perm=wa -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

-a always,exit -F arch=b32 -F path=/usr/lib/modprobe.d/systemd.conf -F perm=wa -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions
-a always,exit -F arch=b64 -F path=/usr/lib/modprobe.d/systemd.conf -F perm=wa -F key=T1547.006_Boot_or_Logon_Autostart_Execution_Kernel_Modules_and_Extensions

## KExec usage (all actions)

-a always,exit -F arch=b32 -S kexec_load -F key=KEXEC
-a always,exit -F arch=b64 -S kexec_load -F key=KEXEC

-a always,exit -F arch=b32 -S sys_kexec_load -F key=KEXEC
-a always,exit -F arch=b64 -S sys_kexec_load -F key=KEXEC

-a always,exit -F arch=b64 -S kexec_load -S kexec_file_load -F key=KEXEC
-a always,exit -F arch=b64 -S kexec_load -S kexec_file_load -F key=KEXEC

## Special files

-a always,exit -F arch=b32 -S mknod -S mknodat -F key=specialfiles
-a always,exit -F arch=b64 -S mknod -S mknodat -F key=specialfiles

## Mount operations (only attributable)

-a always,exit -F arch=b32 -S mount -S umount2 -F "auid!=-1" -F key=mount
-a always,exit -F arch=b64 -S mount -S umount2 -F "auid!=-1" -F key=mount

-a always,exit -F arch=b32 -S move_mount -F "auid!=-1" -F key=mount
-a always,exit -F arch=b64 -S move_mount -F "auid!=-1" -F key=mount

## Change swap (only attributable)

-a always,exit -F arch=b32 -S swapon -S swapoff -F "auid!=-1" -F key=swap
-a always,exit -F arch=b64 -S swapon -S swapoff -F "auid!=-1" -F key=swap

## Time Related Events
### PCI-DSS
### 10.4.2b Time data is protected.
### We will place rules to check time synchronization
# -a always,exit -F arch=b32 -F uid!=ntp -S adjtimex -S settimeofday -S clock_settime -F key=time
# -a always,exit -F arch=b64 -F uid!=ntp -S adjtimex -S settimeofday -S clock_settime -F key=time
#
# -a always,exit -F arch=b32 -S adjtimex -S settimeofday -S clock_settime -F key=time
# -a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -F key=time
#
# -a always,exit -F arch=b32 -S adjtimex -S settimeofday -S clock_settime -F "auid>=500" -F "auid!=-1" -F exit=0 -F key=time
# -a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -F "auid>=500" -F "auid!=-1" -F exit=0 -F key=time
#
# -a always,exit -F arch=b32 -S clock_settime -F "auid>=500" -F "auid!=-1" -F exit=0 -F key=time
# -a always,exit -F arch=b64 -S clock_settime -F "auid>=500" -F "auid!=-1" -F exit=0 -F key=time

-a always,exit -F arch=b32 -F uid!=ntp -S adjtimex -S settimeofday -S clock_settime -F key=T1070.006_Indicator_Removal_Timestomp
-a always,exit -F arch=b64 -F uid!=ntp -S adjtimex -S settimeofday -S clock_settime -F key=T1070.006_Indicator_Removal_Timestomp

-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S clock_settime -F key=T1070.006_Indicator_Removal_Timestomp
-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -F key=T1070.006_Indicator_Removal_Timestomp

-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S clock_settime -F "auid>=500" -F "auid!=-1" -F exit=0 -F key=T1070.006_Indicator_Removal_Timestomp
-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -F "auid>=500" -F "auid!=-1" -F exit=0 -F key=T1070.006_Indicator_Removal_Timestomp

-a always,exit -F arch=b32 -S clock_settime -F "auid>=500" -F "auid!=-1" -F exit=0 -F key=T1070.006_Indicator_Removal_Timestomp
-a always,exit -F arch=b64 -S clock_settime -F "auid>=500" -F "auid!=-1" -F exit=0 -F key=T1070.006_Indicator_Removal_Timestomp

-a always,exit -F arch=b32 -S clock_settime -F key=T1070.006_Indicator_Removal_Timestomp
-a always,exit -F arch=b64 -S clock_settime -F key=T1070.006_Indicator_Removal_Timestomp

### timesyncd
-a always,exit -F arch=b32 -F path=/etc/systemd/timesyncd.conf -F perm=wa -F key=T1124_System_Time_Discovery
-a always,exit -F arch=b64 -F path=/etc/systemd/timesyncd.conf -F perm=wa -F key=T1124_System_Time_Discovery

### utimes
# -a always,exit -F arch=b32 -S utimes -F key=time
# -a always,exit -F arch=b64 -S utimes -F key=time

-a always,exit -F arch=b32 -S utimes -F key=T1070.006_Indicator_Removal_Timestomp
-a always,exit -F arch=b64 -S utimes -F key=T1070.006_Indicator_Removal_Timestomp

### utimensat
-a always,exit -F arch=b32 -S utimensat -F key=T1070.006_Indicator_Removal_Timestomp
-a always,exit -F arch=b64 -S utimensat -F key=T1070.006_Indicator_Removal_Timestomp

### Local time zone
-a always,exit -F arch=b32 -F path=/etc/localtime -F perm=wa -F key=T1070.006_Indicator_Removal_Timestomp
-a always,exit -F arch=b64 -F path=/etc/localtime -F perm=wa -F key=T1070.006_Indicator_Removal_Timestomp

## timeout
-a always,exit -F arch=b32 -F path=/bin/timeout -F perm=x -F key=T1497.003_Virtualization_Sandbox_Evasion_Time_Based_Evasion
-a always,exit -F arch=b64 -F path=/bin/timeout -F perm=x -F key=T1497.003_Virtualization_Sandbox_Evasion_Time_Based_Evasion

-a always,exit -F arch=b32 -F path=/sbin/timeout -F perm=x -F key=T1497.003_Virtualization_Sandbox_Evasion_Time_Based_Evasion
-a always,exit -F arch=b64 -F path=/sbin/timeout -F perm=x -F key=T1497.003_Virtualization_Sandbox_Evasion_Time_Based_Evasion

-a always,exit -F arch=b32 -F path=/usr/bin/timeout -F perm=x -F key=T1497.003_Virtualization_Sandbox_Evasion_Time_Based_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/timeout -F perm=x -F key=T1497.003_Virtualization_Sandbox_Evasion_Time_Based_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/timeout -F perm=x -F key=T1497.003_Virtualization_Sandbox_Evasion_Time_Based_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/timeout -F perm=x -F key=T1497.003_Virtualization_Sandbox_Evasion_Time_Based_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/timeout -F perm=x -F key=T1497.003_Virtualization_Sandbox_Evasion_Time_Based_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/timeout -F perm=x -F key=T1497.003_Virtualization_Sandbox_Evasion_Time_Based_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/sbin/timeout -F perm=x -F key=T1497.003_Virtualization_Sandbox_Evasion_Time_Based_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/sbin/timeout -F perm=x -F key=T1497.003_Virtualization_Sandbox_Evasion_Time_Based_Evasion

### This prevents chrony from overwhelming the logs
#### -a never,exit -F arch=b64 -S adjtimex -F "auid=unset" -F uid=chrony -F subj_type=chronyd_t
#### This rule suppresses the time-change event when chrony does time updates
#### https://github.com/linux-audit/audit-userspace/blob/master/rules/22-ignore-chrony.rules
-a never,exit -F arch=b32 -S adjtimex -F "auid=unset" -F uid=chrony -F subj_type=chronyd_t
-a never,exit -F arch=b64 -S adjtimex -F "auid=unset" -F uid=chrony -F subj_type=chronyd_t

## Stunnel
### https://www.stunnel.org
-a always,exit -F arch=b32 -F path=/etc/stunnel/stunnel.conf -F perm=wa -F key=T1079_Multilayer_Encryption
-a always,exit -F arch=b64 -F path=/etc/stunnel/stunnel.conf -F perm=wa -F key=T1079_Multilayer_Encryption

-a always,exit -F arch=b32 -F path=/etc/stunnel/stunnel.pem -F perm=wa -F key=T1079_Multilayer_Encryption
-a always,exit -F arch=b64 -F path=/etc/stunnel/stunnel.pem -F perm=wa -F key=T1079_Multilayer_Encryption

-a always,exit -F arch=b32 -F path=/usr/bin/stunnel -F perm=x -F key=T1079_Multilayer_Encryption
-a always,exit -F arch=b64 -F path=/usr/bin/stunnel -F perm=x -F key=T1079_Multilayer_Encryption

-a always,exit -F arch=b32 -F path=/usr/sbin/stunnel -F perm=x -F key=T1079_Multilayer_Encryption
-a always,exit -F arch=b64 -F path=/usr/sbin/stunnel -F perm=x -F key=T1079_Multilayer_Encryption

## Cron configuration & scheduled jobs
### https://www.man7.org/linux/man-pages/man8/cron.8.html
-a always,exit -F arch=b32 -F path=/var/spool/atspool -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/var/spool/atspool -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/etc/cron.allow -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/etc/cron.allow -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/etc/cron.deny -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/etc/cron.deny -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/cron.d/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/cron.d/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/cron.daily/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/cron.daily/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/cron.hourly/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/cron.hourly/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/cron.weekly/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/cron.weekly/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/cron.monthly/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/cron.monthly/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/etc/crontab -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/etc/crontab -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/var/spool/cron/root -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/var/spool/cron/root -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/var/spool/cron/crontabs/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/var/spool/cron/crontabs/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/etc/at.allow -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/etc/at.allow -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/etc/at.deny -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/etc/at.deny -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/var/spool/at/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/var/spool/at/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/etc/anacrontab -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/etc/anacrontab -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

### macOS
-a always,exit -F arch=b32 -F dir=/var/at/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/var/at/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/private/var/at/tabs/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/private/var/at/tabs/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/Library/StartupItems/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/Library/StartupItems/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/System/Library/StartupItems/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/System/Library/StartupItems/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/Library/LaunchAgents/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/Library/LaunchAgents/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/System/Library/LaunchAgents/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/System/Library/LaunchAgents/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/usr/lib/cron/jobs/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/usr/lib/cron/jobs/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/usr/lib/cron/tabs/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/usr/lib/cron/tabs/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/etc/periodic.conf -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/etc/periodic.conf -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/etc/periodic.conf.local -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/etc/periodic.conf.local -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/periodic/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/periodic/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/daily.local/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/daily.local/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/weekly.local/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/weekly.local/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/monthly.local/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/monthly.local/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/periodic/daily/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/periodic/daily/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/periodic/weekly/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/periodic/weekly/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/periodic/monthly/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/periodic/monthly/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/usr/local/etc/periodic/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/usr/local/etc/periodic/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/etc/crontab -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/etc/crontab -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/Library/LaunchDaemons/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/Library/LaunchDaemons/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/System/Library/LaunchDaemons/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/System/Library/LaunchDaemons/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

### at
-a always,exit -F arch=b32 -F path=/bin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/bin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/sbin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/sbin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/bin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/bin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/sbin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/sbin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/local/bin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/local/bin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/local/sbin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/local/sbin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/snap/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/snap/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/snap/bin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/snap/bin/at -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

### atd
-a always,exit -F arch=b32 -F path=/bin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/bin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/sbin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/sbin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/bin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/bin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/sbin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/sbin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/local/bin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/local/bin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/local/sbin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/local/sbin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/snap/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/snap/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/snap/bin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/snap/bin/atd -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

### atq
-a always,exit -F arch=b32 -F path=/bin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/bin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/sbin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/sbin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/bin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/bin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/sbin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/sbin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/local/bin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/local/bin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/local/sbin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/local/sbin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/snap/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/snap/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/snap/bin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/snap/bin/atq -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

### atrm
-a always,exit -F arch=b32 -F path=/bin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/bin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/sbin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/sbin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/bin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/bin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/sbin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/sbin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/local/bin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/local/bin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/usr/local/sbin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/usr/local/sbin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/snap/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/snap/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F path=/snap/bin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/snap/bin/atrm -F perm=x -F key=T1053.003_Scheduled_Task_Job_Cron

## systemd.timer
### https://www.man7.org/linux/man-pages/man5/systemd.timer.5.html
### https://documentation.suse.com/smart/systems-management/html/systemd-working-with-timers/index.html
-a always,exit -F arch=b32 -F dir=/etc/systemd/system/ -F perm=wa -F key=T1053.006_Scheduled_Task_Systemd_Timers
-a always,exit -F arch=b64 -F dir=/etc/systemd/system/ -F perm=wa -F key=T1053.006_Scheduled_Task_Systemd_Timers

-a always,exit -F arch=b32 -F dir=/usr/lib/systemd/system/ -F perm=wa -F key=T1053.006_Scheduled_Task_Systemd_Timers
-a always,exit -F arch=b64 -F dir=/usr/lib/systemd/system/ -F perm=wa -F key=T1053.006_Scheduled_Task_Systemd_Timers

-a always,exit -F arch=b32 -F dir=/run/systemd/transient/ -F perm=wa -F key=T1053.006_Scheduled_Task_Systemd_Timers
-a always,exit -F arch=b64 -F dir=/run/systemd/transient/ -F perm=wa -F key=T1053.006_Scheduled_Task_Systemd_Timers

# T1562.001_Impair_Defenses_Disable_or_Modify_Tools
## ldconfig
-a always,exit -F arch=b32 -F path=/bin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/bin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/sbin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/sbin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/snap/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/snap/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/ldconfig -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

## loginctl
-a always,exit -F arch=b32 -F path=/bin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/bin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/sbin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/sbin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/snap/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/snap/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/loginctl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

## nice
-a always,exit -F arch=b32 -F path=/bin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/bin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/sbin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/sbin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/snap/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/snap/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/nice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

## renice
-a always,exit -F arch=b32 -F path=/bin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/bin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/sbin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/sbin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/snap/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/snap/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/renice -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

## setfacl
-a always,exit -F arch=b32 -F path=/bin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/bin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/sbin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/sbin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/snap/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/snap/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/setfacl -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

## User, group, password databases
## PCI-DSS
## 10.2.5.c All changes, additions, or deletions to any account are logged
## This is implicitly covered by shadow-utils. We will place some rules
## in case someone tries to hand edit the trusted databases

### /etc/group
#### In addition to auditing new user and group accounts, these watches will alert the system administrator(s)
#### to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_group
-a always,exit -F arch=b32 -F path=/etc/group -F perm=wa -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/etc/group -F perm=wa -F key=T1087_Account_Discovery

### /etc/passwd
-a always,exit -F arch=b32 -F path=/etc/passwd -S open -S openat -F "auid>=500" -F "auid!=-1" -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/etc/passwd -S open -S openat -F "auid>=500" -F "auid!=-1" -F key=T1087_Account_Discovery

#### In addition to auditing new user and group accounts, these watches will alert the system administrator(s)
#### to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_passwd
-a always,exit -F arch=b32 -F path=/etc/passwd -F perm=wra -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/etc/passwd -F perm=wra -F key=T1087_Account_Discovery

### /etc/shadow
-a always,exit -F arch=b32 -F path=/etc/shadow -S open -S openat -F "auid>=500" -F "auid!=-1" -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/etc/shadow -S open -S openat -F "auid>=500" -F "auid!=-1" -F key=T1087_Account_Discovery

#### In addition to auditing new user and group accounts, these watches will alert the system administrator(s)
#### to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_shadow
-a always,exit -F arch=b32 -F path=/etc/shadow -F perm=wa -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/etc/shadow -F perm=wa -F key=T1087_Account_Discovery

### /etc/gshadow
#### In addition to auditing new user and group accounts, these watches will alert the system administrator(s)
#### to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_gshadow
-a always,exit -F arch=b32 -F path=/etc/gshadow -F perm=wra -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/etc/gshadow -F perm=wra -F key=T1087_Account_Discovery

### In addition to auditing new user and group accounts, these watches will alert the system administrator(s)
### to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.
### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_opasswd
### -w /etc/security/opasswd -F perm=wa -F key=audit_rules_usergroup_modification
-a always,exit -F arch=b32 -F path=/etc/security/opasswd -F perm=wa -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/etc/security/opasswd -F perm=wa -F key=T1087_Account_Discovery

### nologin
-a always,exit -F arch=b32 -F path=/sbin/nologin -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/sbin/nologin -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/nologin -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/nologin -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F dir=/etc/sudoers.d/ -F perm=wa -F key=actions
-a always,exit -F arch=b64 -F dir=/etc/sudoers.d/ -F perm=wa -F key=actions

## T1548_Abuse_Elevation_Control_Mechanism
### sudoers
-a always,exit -F arch=b32 -F path=/etc/sudoers -S open -S openat -F "auid>=500" -F "auid!=-1" -F key=T1548_Abuse_Elevation_Control_Mechanism
-a always,exit -F arch=b64 -F path=/etc/sudoers -S open -S openat -F "auid>=500" -F "auid!=-1" -F key=T1548_Abuse_Elevation_Control_Mechanism

### visudo
-a always,exit -F arch=b32 -F path=/usr/bin/visudo -F perm=x -F key=T1548_Abuse_Elevation_Control_Mechanism
-a always,exit -F arch=b64 -F path=/usr/bin/visudo -F perm=x -F key=T1548_Abuse_Elevation_Control_Mechanism

-a always,exit -F arch=b32 -F path=/usr/sbin/visudo -F perm=x -F key=T1548_Abuse_Elevation_Control_Mechanism
-a always,exit -F arch=b64 -F path=/usr/sbin/visudo -F perm=x -F key=T1548_Abuse_Elevation_Control_Mechanism

## /etc/rc.d/rc
### A script that manages system runlevels and startup services.
-a always,exit -F arch=b32 -F path=/etc/rc.d/rc -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts
-a always,exit -F arch=b64 -F path=/etc/rc.d/rc -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts

-a always,exit -F arch=b32 -F dir=/etc/rc.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts
-a always,exit -F arch=b64 -F dir=/etc/rc.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts

-a always,exit -F arch=b32 -F dir=/etc/rc0.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts
-a always,exit -F arch=b64 -F dir=/etc/rc0.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts

-a always,exit -F arch=b32 -F dir=/etc/rc1.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts
-a always,exit -F arch=b64 -F dir=/etc/rc1.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts

-a always,exit -F arch=b32 -F dir=/etc/rc2.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts
-a always,exit -F arch=b64 -F dir=/etc/rc2.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts

-a always,exit -F arch=b32 -F dir=/etc/rc3.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts
-a always,exit -F arch=b64 -F dir=/etc/rc3.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts

-a always,exit -F arch=b32 -F dir=/etc/rc4.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts
-a always,exit -F arch=b64 -F dir=/etc/rc4.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts

-a always,exit -F arch=b32 -F dir=/etc/rc5.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts
-a always,exit -F arch=b64 -F dir=/etc/rc5.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts

-a always,exit -F arch=b32 -F dir=/etc/rc6.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts
-a always,exit -F arch=b64 -F dir=/etc/rc6.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts

## /etc/rc.d/rc.sysinit
### A script responsible for system initialization tasks at boot time, including hardware initialization and mounting filesystems.
-a always,exit -F arch=b32 -F path=/etc/rc.d/rc.sysinit -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts
-a always,exit -F arch=b64 -F path=/etc/rc.d/rc.sysinit -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts

## /etc/rc.d/rcX.d/
### A directory containing symbolic links to scripts that control services started or stopped at various runlevels (X represents the runlevel number).
-a always,exit -F arch=b32 -F dir=/etc/rc.d/rcX.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts
-a always,exit -F arch=b64 -F dir=/etc/rc.d/rcX.d/ -F perm=wa -F key=T1037.004_Boot_or_Logon_Initialization_Scripts:_RC_Scripts

## subuid
-a always,exit -F arch=b32 -F path=/etc/subuid -F perm=wra -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/etc/subuid -F perm=wra -F key=T1087_Account_Discovery

## subgid
-a always,exit -F arch=b32 -F path=/etc/subgid -F perm=wra -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/etc/subgid -F perm=wra -F key=T1087_Account_Discovery

## T1169_Sudo

### Ensure auditd Collects System Administrator Actions
#### The actions taken by system administrators should be audited to keep a record of what was executed
#### on the system, as well as, for accountability purposes.
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_sysadmin_actions
-a always,exit -F arch=b32 -F path=/etc/sudoers -F perm=wa -F key=T1169_Sudo
-a always,exit -F arch=b64 -F path=/etc/sudoers -F perm=wa -F key=T1169_Sudo

-a always,exit -F arch=b32 -F dir=/etc/sudoers.d/ -F perm=wa -F key=T1169_Sudo
-a always,exit -F arch=b64 -F dir=/etc/sudoers.d/ -F perm=wa -F key=T1169_Sudo

#### The purpose of this rule is to detect when an admin may be abusing power
#### by looking in user's home dir.
#### https://github.com/linux-audit/audit-userspace/blob/master/rules/32-power-abuse.rules
-a always,exit -F arch=b32 -F dir=/home/ -F "auid=0" -F "auid>=500" -F "auid!=-1" -C "auid!=obj_uid" -F key=T1169_Sudo
-a always,exit -F arch=b64 -F dir=/home/ -F "auid=0" -F "auid>=500" -F "auid!=-1" -C "auid!=obj_uid" -F key=T1169_Sudo

## passwd
## -w /usr/bin/passwd -F perm=x -F key=passwd_modification
-a always,exit -F arch=b32 -F path=/bin/passwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/passwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/sbin/passwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/passwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/passwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/passwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/passwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/passwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/bin/passwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/passwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/sbin/passwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/passwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/snap/passwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/passwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/snap/bin/passwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/bin/passwd -F perm=x -F key=T1078_Valid_Accounts

#
## Tools to change group identifiers
### T1078_Valid_Accounts
### -w /usr/sbin/groupadd -F perm=x -F key=group_modification
### -w /usr/sbin/groupmod -F perm=x -F key=group_modification
### -w /usr/sbin/addgroup -F perm=x -F key=group_modification
### -w /usr/sbin/useradd -F perm=x -F key=user_modification
### -w /usr/sbin/userdel -F perm=x -F key=user_modification
### -w /usr/sbin/usermod -F perm=x -F key=user_modification
### -w /usr/sbin/adduser -F perm=x -F key=user_modification

-a always,exit -F arch=b32 -F path=/usr/sbin/groupadd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/groupadd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/addgroup -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/addgroup -F perm=x -F key=T1078_Valid_Accounts

## newgrp
-a always,exit -F arch=b32 -F path=/bin/newgrp -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/newgrp -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/sbin/newgrp -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/newgrp -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/newgrp -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/newgrp -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/newgrp -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/newgrp -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/bin/newgrp -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/newgrp -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/sbin/newgrp -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/newgrp -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/snap/newgrp -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/newgrp -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/snap/bin/newgrp -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/bin/newgrp -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/useradd -F perm=x -F key=T1136_Create_Account_Domain_Account
-a always,exit -F arch=b64 -F path=/usr/sbin/useradd -F perm=x -F key=T1136_Create_Account_Domain_Account

-a always,exit -F arch=b32 -F path=/usr/sbin/adduser -F perm=x -F key=T1136_Create_Account_Domain_Account
-a always,exit -F arch=b64 -F path=/usr/sbin/adduser -F perm=x -F key=T1136_Create_Account_Domain_Account

-a always,exit -F arch=b32 -F path=/usr/sbin/newusers -F perm=x -F key=T1136_Create_Account_Domain_Account
-a always,exit -F arch=b64 -F path=/usr/sbin/newusers -F perm=x -F key=T1136_Create_Account_Domain_Account

-a always,exit -F arch=b32 -F path=/usr/sbin/groupmod -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/groupmod -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/usermod -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/usermod -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/userdel -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/userdel -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/deluser -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/deluser -F perm=x -F key=T1078_Valid_Accounts

## expiry
-a always,exit -F arch=b32 -F path=/bin/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/sbin/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/usr/bin/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/usr/sbin/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/usr/local/bin/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/usr/local/sbin/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/snap/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/snap/bin/expiry -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/bin/expiry -F perm=x -F key=T1078_Valid_Accounts

## lockfile
-a always,exit -F arch=b32 -F path=/bin/lockfile -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/lockfile -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/sbin/lockfile -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/lockfile -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/lockfile -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/lockfile -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/lockfile -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/lockfile -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/bin/lockfile -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/lockfile -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lockfile -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lockfile -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/snap/lockfile -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/lockfile -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/snap/bin/lockfile -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/bin/lockfile -F perm=x -F key=T1078_Valid_Accounts

## newgidmap
-a always,exit -F arch=b32 -F path=/bin/newgidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/newgidmap -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/sbin/newgidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/newgidmap -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/newgidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/newgidmap -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/newgidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/newgidmap -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/bin/newgidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/newgidmap -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/sbin/newgidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/newgidmap -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/snap/newgidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/newgidmap -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/snap/bin/newgidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/bin/newgidmap -F perm=x -F key=T1078_Valid_Accounts

## newuidmap
-a always,exit -F arch=b32 -F path=/bin/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/sbin/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/usr/bin/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/usr/sbin/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/usr/local/bin/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/usr/local/sbin/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/snap/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b32 -F path=/snap/bin/newuidmap -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/bin/newuidmap -F perm=x -F key=T1078_Valid_Accounts

## T1136_Create_Account_Domain_Account
-a always,exit -F arch=b32 -F path=/usr/bin/realm -F perm=x -F key=T1136_Create_Account_Domain_Account
-a always,exit -F arch=b64 -F path=/usr/bin/realm -F perm=x -F key=T1136_Create_Account_Domain_Account

-a always,exit -F arch=b32 -F path=/usr/sbin/realm -F perm=x -F key=T1136_Create_Account_Domain_Account
-a always,exit -F arch=b64 -F path=/usr/sbin/realm -F perm=x -F key=T1136_Create_Account_Domain_Account

-a always,exit -F arch=b32 -F path=/usr/bin/adcli -F perm=x -F key=T1136_Create_Account_Domain_Account
-a always,exit -F arch=b64 -F path=/usr/bin/adcli -F perm=x -F key=T1136_Create_Account_Domain_Account

-a always,exit -F arch=b32 -F path=/usr/sbin/adcli -F perm=x -F key=T1136_Create_Account_Domain_Account
-a always,exit -F arch=b64 -F path=/usr/sbin/adcli -F perm=x -F key=T1136_Create_Account_Domain_Account

## Login configuration and information
### -w /etc/login.defs -F perm=wa -F key=login
### -w /etc/securetty -F perm=wa -F key=login
### -w /var/log/faillog -F perm=wa -F key=login
### -w /var/log/lastlog -F perm=wa -F key=login
### -w /var/log/tallylog -F perm=wa -F key=login

-a always,exit -F arch=b32 -F path=/etc/login.defs -F perm=wa -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/etc/login.defs -F perm=wa -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/etc/securetty -F perm=wa -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/etc/securetty -F perm=wa -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/etc/usertty -F perm=wa -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/etc/usertty -F perm=wa -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/etc/nologin -F perm=wa -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/etc/nologin -F perm=wa -F key=T1082_System_Information_Discovery

### Record Attempts to Alter Logon and Logout Events
#### https://man7.org/linux/man-pages/man5/faillog.5.html
-a always,exit -F arch=b32 -F path=/var/log/faillog -F perm=wa -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/var/log/faillog -F perm=wa -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/var/run/faillock -F perm=wa -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/var/run/faillock -F perm=wa -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/var/log/lastlog -F perm=wa -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/var/log/lastlog -F perm=wa -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/var/log/tallylog -F perm=wa -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/var/log/tallylog -F perm=wa -F key=T1082_System_Information_Discovery

## Network Environment

### Changes to hostname
#### The network environment should not be modified by anything other than administrator action.
#### Any change to network parameters should be audited.
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_networkconfig_modification
-a always,exit -F arch=b32 -S sethostname -S setdomainname -F key=network_modifications
-a always,exit -F arch=b64 -S sethostname -S setdomainname -F key=network_modifications

### Detect Remote Shell Use
-a always,exit -F arch=b32 -F exe=/bin/bash -F success=1 -S connect -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F exe=/bin/bash -F success=1 -S connect -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F exe=/usr/bin/bash -F success=1 -S connect -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F exe=/usr/bin/bash -F success=1 -S connect -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F exe=/bin/sh -F success=1 -S connect -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F exe=/bin/sh -F success=1 -S connect -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F exe=/usr/bin/sh -F success=1 -S connect -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F exe=/usr/bin/sh -F success=1 -S connect -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### Changes to other files
-a always,exit -F arch=b32 -F dir=/etc/network/ -F perm=wa -F key=network_modifications
-a always,exit -F arch=b64 -F dir=/etc/network/ -F perm=wa -F key=network_modifications

-a always,exit -F arch=b32 -F dir=/etc/NetworkManager/ -F perm=wa -F key=network_modifications
-a always,exit -F arch=b64 -F dir=/etc/NetworkManager/ -F perm=wa -F key=network_modifications

-a always,exit -F arch=b32 -F dir=/etc/NetworkManager/system-connections/ -F perm=wa -F key=network_modifications
-a always,exit -F arch=b64 -F dir=/etc/NetworkManager/system-connections/ -F perm=wa -F key=network_modifications

## T1016_System_Network_Configuration_Discovery

### ip
-a always,exit -F arch=b32 -F path=/bin/ip -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/bin/ip -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/sbin/ip -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/sbin/ip -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/ip -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ip -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ip -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ip -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ip -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ip -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ip -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ip -F perm=x -F key=T1016_System_Network_Configuration_Discovery

### ifconfig
-a always,exit -F arch=b32 -F path=/bin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/bin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/sbin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/sbin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery

### check_raid
-a always,exit -F arch=b32 -F path=/bin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/bin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/sbin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/sbin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/snap/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/snap/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/snap/bin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/snap/bin/check_raid -F perm=x -F key=T1016_System_Network_Configuration_Discovery

### check_statusfile
-a always,exit -F arch=b32 -F path=/bin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/bin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/sbin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/sbin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/snap/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/snap/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/snap/bin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/snap/bin/check_statusfile -F perm=x -F key=T1016_System_Network_Configuration_Discovery

### nmcli
-a always,exit -F arch=b32 -F path=/bin/nmcli -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/bin/nmcli -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/sbin/nmcli -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/sbin/nmcli -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/nmcli -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/nmcli -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/nmcli -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/nmcli -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/nmcli -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/nmcli -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/nmcli -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/nmcli -F perm=x -F key=T1016_System_Network_Configuration_Discovery

### traceroute
-a always,exit -F arch=b32 -F path=/bin/traceroute -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/bin/traceroute -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/sbin/traceroute -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/sbin/traceroute -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/traceroute -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/traceroute -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/traceroute -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/traceroute -F perm=x -F key=T1016_System_Network_Configuration_Discovery

### tracepath
-a always,exit -F arch=b32 -F path=/bin/tracepath -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/bin/tracepath -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/sbin/tracepath -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/sbin/tracepath -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/tracepath -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/tracepath -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/tracepath -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/tracepath -F perm=x -F key=T1016_System_Network_Configuration_Discovery

### sysctl
-a always,exit -F arch=b32 -F path=/usr/bin/sysctl -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/sysctl -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/sysctl -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/sysctl -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/proc/sys/net/ipv4/ip_forward -F perm=wa -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/proc/sys/net/ipv4/ip_forward -F perm=wa -F key=T1016_System_Network_Configuration_Discovery

### /etc/sysconfig/network
#### The network environment should not be modified by anything other than administrator action.
#### Any change to network parameters should be audited.
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_networkconfig_modification
-a always,exit -F arch=b32 -F path=/etc/sysconfig/network -F perm=wa -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/etc/sysconfig/network -F perm=wa -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/etc/sysconfig/network-scripts/ifcfg-device -F perm=wa -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/etc/sysconfig/network-scripts/ifcfg-device -F perm=wa -F key=T1016_System_Network_Configuration_Discovery

### Changes to issue
### The network environment should not be modified by anything other than administrator action.
### Any change to network parameters should be audited.
### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_networkconfig_modification
# -w /etc/issue -F perm=wa -F key=etcissue
# -w /etc/issue.net -F perm=wa -F key=etcissue

-a always,exit -F arch=b32 -F path=/etc/issue -F perm=wa -F key=etcissue
-a always,exit -F arch=b64 -F path=/etc/issue -F perm=wa -F key=etcissue

-a always,exit -F arch=b32 -F path=/etc/issue.net -F perm=wa -F key=etcissue
-a always,exit -F arch=b64 -F path=/etc/issue.net -F perm=wa -F key=etcissue

## System startup scripts
### -w /etc/inittab -F perm=wa -F key=init
### -w /etc/init.d/ -F perm=wa -F key=init
### -w /etc/init/ -F perm=wa -F key=init
-a always,exit -F arch=b32 -F path=/etc/inittab -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F path=/etc/inittab -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/init.d/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/init.d/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

-a always,exit -F arch=b32 -F dir=/etc/init/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron
-a always,exit -F arch=b64 -F dir=/etc/init/ -F perm=wa -F key=T1053.003_Scheduled_Task_Job_Cron

## Library search paths
### https://www.man7.org/linux/man-pages/man8/ld.so.8.html
# -w /etc/ld.so.conf -F perm=wa -F key=libpath
# -w /etc/ld.so.conf.d/ -F perm=wa -F key=libpath

-a always,exit -F arch=b32 -F path=/etc/ld.so.conf -F perm=wa -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/etc/ld.so.conf -F perm=wa -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F dir=/etc/ld.so.conf.d/ -F perm=wa -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F dir=/etc/ld.so.conf.d/ -F perm=wa -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/etc/ld.so.conf.d/libc.conf -F perm=wa -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/etc/ld.so.conf.d/libc.conf -F perm=wa -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/etc/ld.so.conf.d/x86_64-linux-gnu.conf -F perm=wa -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/etc/ld.so.conf.d/x86_64-linux-gnu.conf -F perm=wa -F key=T1055_Process_Injection

## Systemwide library preloads (LD_PRELOAD)
# -w /etc/ld.so.preload -F perm=wa -F key=systemwide_preloads
-a always,exit -F arch=b32 -F path=/etc/ld.so.preload -F perm=wa -F key=T1574_Hijack_Execution_Flow
-a always,exit -F arch=b64 -F path=/etc/ld.so.preload -F perm=wa -F key=T1574_Hijack_Execution_Flow

## Pam configuration
### T1556_Modify_Authentication_Process
-a always,exit -F arch=b32 -F path=/etc/pam.conf -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules
-a always,exit -F arch=b64 -F path=/etc/pam.conf -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules

-a always,exit -F arch=b32 -F path=/etc/security/limits.conf -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules
-a always,exit -F arch=b64 -F path=/etc/security/limits.conf -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules

-a always,exit -F arch=b32 -F path=/etc/security/pam_env.conf -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules
-a always,exit -F arch=b64 -F path=/etc/security/pam_env.conf -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules

-a always,exit -F arch=b32 -F dir=/etc/security/limits.d/ -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules
-a always,exit -F arch=b64 -F dir=/etc/security/limits.d/ -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules

-a always,exit -F arch=b32 -F dir=/etc/security/ -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules
-a always,exit -F arch=b64 -F dir=/etc/security/ -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules

### namespace
-a always,exit -F arch=b32 -F path=/etc/security/namespace.conf -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules
-a always,exit -F arch=b64 -F path=/etc/security/namespace.conf -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules

-a always,exit -F arch=b32 -F path=/etc/security/namespace.init -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules
-a always,exit -F arch=b64 -F path=/etc/security/namespace.init -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules

-a always,exit -F arch=b32 -F dir=/etc/security/namespace.d/ -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules
-a always,exit -F arch=b64 -F dir=/etc/security/namespace.d/ -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules

### pam_unix.so
-a always,exit -F arch=b32 -F path=/usr/lib64/security/pam_unix.so -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules
-a always,exit -F arch=b64 -F path=/usr/lib64/security/pam_unix.so -F perm=wa -F key=T1556.003_Modify_Authentication_Process_Pluggable_Authentication_Modules

### pam.d
-a always,exit -F arch=b32 -F path=/etc/pam.d/common-password -F perm=wa -F key=T1201_Password_Policy_Discovery
-a always,exit -F arch=b64 -F path=/etc/pam.d/common-password -F perm=wa -F key=T1201_Password_Policy_Discovery

-a always,exit -F arch=b32 -F dir=/etc/pam.d/ -F perm=wa -F key=T1201_Password_Policy_Discovery
-a always,exit -F arch=b64 -F dir=/etc/pam.d/ -F perm=wa -F key=T1201_Password_Policy_Discovery

### others
-a always,exit -F arch=b32 -F path=/etc/security/sepermit.conf -F perm=wa -F key=T1071_Application_Layer_Protocol
-a always,exit -F arch=b64 -F path=/etc/security/sepermit.conf -F perm=wa -F key=T1071_Application_Layer_Protocol

-a always,exit -F arch=b32 -F path=/etc/security/time.conf -F perm=wa -F key=T1071_Application_Layer_Protocol
-a always,exit -F arch=b64 -F path=/etc/security/time.conf -F perm=wa -F key=T1071_Application_Layer_Protocol

-a always,exit -F arch=b32 -F path=/etc/security/access.conf -F perm=wa -F key=T1556_Modify_Authentication_Process
-a always,exit -F arch=b64 -F path=/etc/security/access.conf -F perm=wa -F key=T1556_Modify_Authentication_Process

-a always,exit -F arch=b32 -F path=/etc/security/group.conf -F perm=wa -F key=T1556_Modify_Authentication_Process
-a always,exit -F arch=b64 -F path=/etc/security/group.conf -F perm=wa -F key=T1556_Modify_Authentication_Process

-a always,exit -F arch=b32 -F path=/etc/security/user.conf -F perm=wa -F key=T1556_Modify_Authentication_Process
-a always,exit -F arch=b64 -F path=/etc/security/user.conf -F perm=wa -F key=T1556_Modify_Authentication_Process

-a always,exit -F arch=b32 -F path=/etc/security/faillock.conf -F perm=wa -F key=T1556_Modify_Authentication_Process
-a always,exit -F arch=b64 -F path=/etc/security/faillock.conf -F perm=wa -F key=T1556_Modify_Authentication_Process

-a always,exit -F arch=b32 -F path=/etc/security/pwquality.conf -F perm=wa -F key=T1556_Modify_Authentication_Process
-a always,exit -F arch=b64 -F path=/etc/security/pwquality.conf -F perm=wa -F key=T1556_Modify_Authentication_Process

## Mail configuration
-a always,exit -F arch=b32 -F path=/etc/aliases -F perm=wa -F key=mail
-a always,exit -F arch=b64 -F path=/etc/aliases -F perm=wa -F key=mail

### https://www.postfix.org/
-a always,exit -F arch=b32 -F path=/etc/postfix/master.cf -F perm=wa -F key=mail
-a always,exit -F arch=b64 -F path=/etc/postfix/master.cf -F perm=wa -F key=mail

-a always,exit -F arch=b32 -F path=/etc/postfix/main.cf -F perm=wa -F key=mail
-a always,exit -F arch=b64 -F path=/etc/postfix/main.cf -F perm=wa -F key=mail

-a always,exit -F arch=b32 -F path=/etc/postfix/relay_domains.db -F perm=x -F key=mail
-a always,exit -F arch=b64 -F path=/etc/postfix/relay_domains.db -F perm=x -F key=mail

-a always,exit -F arch=b32 -F path=/etc/postfix/transport.db -F perm=x -F key=mail
-a always,exit -F arch=b64 -F path=/etc/postfix/transport.db -F perm=x -F key=mail

-a always,exit -F arch=b32 -F path=/etc/postfix/user_map.db -F perm=x -F key=mail
-a always,exit -F arch=b64 -F path=/etc/postfix/user_map.db -F perm=x -F key=mail

-a always,exit -F arch=b32 -F dir=/etc/postfix/ -F perm=wa -F key=mail
-a always,exit -F arch=b64 -F dir=/etc/postfix/ -F perm=wa -F key=mail

### https://www.exim.org/
-a always,exit -F arch=b32 -F path=/etc/smtpd/smtpd.conf -F perm=wa -F key=mail
-a always,exit -F arch=b64 -F path=/etc/smtpd/smtpd.conf -F perm=wa -F key=mail

-a always,exit -F arch=b32 -F dir=/etc/exim4/ -F perm=wa -F key=mail
-a always,exit -F arch=b64 -F dir=/etc/exim4/ -F perm=wa -F key=mail

## SSH configuration
### OpenSSH
### -w /etc/ssh/sshd_config -F key=sshd
### -w /etc/ssh/sshd_config.d -F key=sshd
-a always,exit -F arch=b32 -F path=/usr/sbin/sshd -F perm=x -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/sshd -F perm=x -F key=T1021_Remote_Services

-a always,exit -F arch=b32 -F path=/etc/pam.d/sshd -F perm=wa -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -F path=/etc/pam.d/sshd -F perm=wa -F key=T1021_Remote_Services

-a always,exit -F arch=b32 -F path=/etc/ssh/sshd_config -F perm=wa -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -F path=/etc/ssh/sshd_config -F perm=wa -F key=T1021_Remote_Services

-a always,exit -F arch=b32 -F path=/etc/ssh/ssh_config -F perm=wa -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -F path=/etc/ssh/ssh_config -F perm=wa -F key=T1021_Remote_Services

-a always,exit -F arch=b32 -F dir=/etc/ssh/ -F perm=wa -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -F dir=/etc/ssh/ -F perm=wa -F key=T1021_Remote_Services

-a always,exit -F arch=b32 -F dir=/etc/ssh/sshd_config.d/ -F perm=wa -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -F dir=/etc/ssh/sshd_config.d/ -F perm=wa -F key=T1021_Remote_Services

-a always,exit -F arch=b32 -F dir=/etc/ssh/ssh_config.d/ -F perm=wa -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -F dir=/etc/ssh/ssh_config.d/ -F perm=wa -F key=T1021_Remote_Services

### root ssh key tampering
-a always,exit -F arch=b32 -S open,openat -F path=/root/.ssh/authorized_keys -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -S open,openat -F path=/root/.ssh/authorized_keys -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=T1021_Remote_Services

-a always,exit -F arch=b32 -F dir=/root/.ssh/ -F perm=wa -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -F dir=/root/.ssh/ -F perm=wa -F key=T1021_Remote_Services

-a always,exit -F arch=b32 -S open,openat -F path=/home/vagrant/.ssh/authorized_keys -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -S open,openat -F path=/home/vagrant/.ssh/authorized_keys -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=T1021_Remote_Services

-a always,exit -F arch=b32 -F dir=/home/vagrant/.ssh/ -F perm=wa -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -F dir=/home/vagrant/.ssh/ -F perm=wa -F key=T1021_Remote_Services

### dropbear
#### https://github.com/mkj/dropbear/tree/master
-a always,exit -F arch=b32 -F path=/etc/config/dropbear -F perm=wa -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -F path=/etc/config/dropbear -F perm=wa -F key=T1021_Remote_Services

-a always,exit -F arch=b32 -F path=/etc/default/dropbear -F perm=wa -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -F path=/etc/default/dropbear -F perm=wa -F key=T1021_Remote_Services

-a always,exit -F arch=b32 -F path=/lib/systemd/system/dropbear.service -F perm=wa -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -F path=/lib/systemd/system/dropbear.service -F perm=wa -F key=T1021_Remote_Services

-a always,exit -F arch=b32 -F dir=/etc/dropbear/ -F perm=wa -F key=T1021_Remote_Services
-a always,exit -F arch=b64 -F dir=/etc/dropbear/ -F perm=wa -F key=T1021_Remote_Services

# Systemd
## T1543_Create_or_Modify_System_Process
-a always,exit -F arch=b32 -F path=/bin/systemctl -F perm=x -F key=T1543_Create_or_Modify_System_Process
-a always,exit -F arch=b64 -F path=/bin/systemctl -F perm=x -F key=T1543_Create_or_Modify_System_Process

-a always,exit -F arch=b32 -F dir=/etc/systemd/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process
-a always,exit -F arch=b64 -F dir=/etc/systemd/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process

-a always,exit -F arch=b32 -F dir=/etc/systemd/system/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process
-a always,exit -F arch=b64 -F dir=/etc/systemd/system/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process

-a always,exit -F arch=b32 -F dir=/usr/lib/systemd/system/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process
-a always,exit -F arch=b64 -F dir=/usr/lib/systemd/system/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process

## https://systemd.network/systemd.generator.html
-a always,exit -F arch=b32 -F dir=/etc/systemd/system-generators/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process
-a always,exit -F arch=b64 -F dir=/etc/systemd/system-generators/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process

-a always,exit -F arch=b32 -F dir=/usr/local/lib/systemd/system-generators/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process
-a always,exit -F arch=b64 -F dir=/usr/local/lib/systemd/system-generators/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process

-a always,exit -F arch=b32 -F dir=/usr/lib/systemd/system-generators/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process
-a always,exit -F arch=b64 -F dir=/usr/lib/systemd/system-generators/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process

-a always,exit -F arch=b32 -F dir=/etc/systemd/user-generators/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process
-a always,exit -F arch=b64 -F dir=/etc/systemd/user-generators/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process

-a always,exit -F arch=b32 -F dir=/usr/local/lib/systemd/user-generators/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process
-a always,exit -F arch=b64 -F dir=/usr/local/lib/systemd/user-generators/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process

-a always,exit -F arch=b32 -F dir=/lib/systemd/system-generators/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process
-a always,exit -F arch=b64 -F dir=/lib/systemd/system-generators/ -F perm=wa -F key=T1543_Create_or_Modify_System_Process

## SELinux events that modify the system's Mandatory Access Controls (MAC)
### The system's mandatory access policy (SELinux) should not be arbitrarily changed by anything
### other than administrator action. All changes to MAC policy should be audited.
### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_mac_modification
-a always,exit -F arch=b32 -F path=/etc/selinux/targeted/setrans.conf -F perm=wa -F key=MAC-policy
-a always,exit -F arch=b64 -F path=/etc/selinux/targeted/setrans.conf -F perm=wa -F key=MAC-policy

-a always,exit -F arch=b32 -F dir=/etc/selinux/ -F perm=wa -F key=MAC-policy
-a always,exit -F arch=b64 -F dir=/etc/selinux/ -F perm=wa -F key=MAC-policy

-a always,exit -F arch=b32 -F dir=/usr/share/selinux/ -F perm=wa -F key=MAC-policy
-a always,exit -F arch=b64 -F dir=/usr/share/selinux/ -F perm=wa -F key=MAC-policy

## apparmor
-a always,exit -F arch=b32 -F path=/etc/apparmor/parser.conf -F perm=wa -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/etc/apparmor/parser.conf -F perm=wa -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F dir=/etc/apparmor/ -F perm=wa -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F dir=/etc/apparmor/ -F perm=wa -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F dir=/etc/apparmor.d/ -F perm=wa -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F dir=/etc/apparmor.d/ -F perm=wa -F key=T1055_Process_Injection

### aa-enabled
-a always,exit -F arch=b32 -F path=/usr/bin/aa-enabled -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/bin/aa-enabled -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/usr/sbin/aa-enabled -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/sbin/aa-enabled -F perm=x -F key=T1055_Process_Injection

### aa-exec
-a always,exit -F arch=b32 -F path=/usr/bin/aa-exec -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/bin/aa-exec -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/usr/sbin/aa-exec -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/sbin/aa-exec -F perm=x -F key=T1055_Process_Injection

### aa-remove-unknown
-a always,exit -F arch=b32 -F path=/usr/bin/aa-remove-unknown -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/bin/aa-remove-unknown -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/usr/sbin/aa-remove-unknown -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/sbin/aa-remove-unknown -F perm=x -F key=T1055_Process_Injection

### aa-status
-a always,exit -F arch=b32 -F path=/usr/bin/aa-status -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/bin/aa-status -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/usr/sbin/aa-status -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/sbin/aa-status -F perm=x -F key=T1055_Process_Injection

### aa-teardown
-a always,exit -F arch=b32 -F path=/usr/bin/aa-teardown -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/bin/aa-teardown -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/usr/sbin/aa-teardown -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/sbin/aa-teardown -F perm=x -F key=T1055_Process_Injection

### apparmor_status
-a always,exit -F arch=b32 -F path=/usr/bin/apparmor_status -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/bin/apparmor_status -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/usr/sbin/apparmor_status -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/sbin/apparmor_status -F perm=x -F key=T1055_Process_Injection

### apparmor_parser
-a always,exit -F arch=b32 -F path=/bin/apparmor_parser -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/bin/apparmor_parser -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/sbin/apparmor_parser -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/sbin/apparmor_parser -F perm=x -F key=T1055_Process_Injection

## Process ID change (switching accounts) applications
### T1169_Sudo
### -w /bin/su -F perm=x -F key=priv_esc
### -w /usr/bin/sudo -F perm=x -F key=priv_esc
### -w /etc/sudoers -F perm=rw -F key=priv_esc
### -w /etc/sudoers.d -F perm=rw -F key=priv_esc
-a always,exit -F arch=b32 -F path=/bin/su -F perm=x -F key=T1169_Sudo
-a always,exit -F arch=b64 -F path=/bin/su -F perm=x -F key=T1169_Sudo

-a always,exit -F arch=b32 -F path=/usr/bin/su -F perm=x -F key=T1169_Sudo
-a always,exit -F arch=b64 -F path=/usr/bin/su -F perm=x -F key=T1169_Sudo

### sudo
-a always,exit -F arch=b32 -F path=/bin/sudo -F perm=x -F key=T1169_Sudo
-a always,exit -F arch=b64 -F path=/bin/sudo -F perm=x -F key=T1169_Sudo

-a always,exit -F arch=b32 -F path=/usr/bin/sudo -F perm=x -F key=T1169_Sudo
-a always,exit -F arch=b64 -F path=/usr/bin/sudo -F perm=x -F key=T1169_Sudo

## Power state

### shutdown
-a always,exit -F arch=b32 -F path=/sbin/shutdown -F perm=x -F key=power
-a always,exit -F arch=b64 -F path=/sbin/shutdown -F perm=x -F key=power

-a always,exit -F arch=b32 -F path=/usr/sbin/shutdown -F perm=x -F key=power
-a always,exit -F arch=b64 -F path=/usr/sbin/shutdown -F perm=x -F key=power

### poweroff
-a always,exit -F arch=b32 -F path=/sbin/poweroff -F perm=x -F key=power
-a always,exit -F arch=b64 -F path=/sbin/poweroff -F perm=x -F key=power

-a always,exit -F arch=b32 -F path=/usr/sbin/poweroff -F perm=x -F key=power
-a always,exit -F arch=b64 -F path=/usr/sbin/poweroff -F perm=x -F key=power

### reboot
-a always,exit -F arch=b32 -F path=/sbin/reboot -F perm=x -F key=power
-a always,exit -F arch=b64 -F path=/sbin/reboot -F perm=x -F key=power

-a always,exit -F arch=b32 -F path=/usr/sbin/reboot -F perm=x -F key=power
-a always,exit -F arch=b64 -F path=/usr/sbin/reboot -F perm=x -F key=power

### halt
-a always,exit -F arch=b32 -F path=/sbin/halt -F perm=x -F key=power
-a always,exit -F arch=b64 -F path=/sbin/halt -F perm=x -F key=power

-a always,exit -F arch=b32 -F path=/usr/sbin/halt -F perm=x -F key=power
-a always,exit -F arch=b64 -F path=/usr/sbin/halt -F perm=x -F key=power

## Pre-OS Boot
### https://attack.mitre.org/techniques/T1542/003/
-a always,exit -F arch=b32 -F dir=/boot/grub/ -S open,openat,execve -F "auid>=500" -F key=T1542.003_Pre-OS_Boot_Bootkit
-a always,exit -F arch=b64 -F dir=/boot/grub/ -S open,openat,execve -F "auid>=500" -F key=T1542.003_Pre-OS_Boot_Bootkit

### Fedora
-a always,exit -F arch=b32 -F path=/boot/grub2/grub.cfg -F perm=wa -F key=T1542.003_Pre-OS_Boot_Bootkit
-a always,exit -F arch=b64 -F path=/boot/grub2/grub.cfg -F perm=wa -F key=T1542.003_Pre-OS_Boot_Bootkit

### Debian and Ubuntu
-a always,exit -F arch=b32 -F path=/boot/grub/grub.cfg -F perm=wa -F key=T1542.003_Pre-OS_Bootkit
-a always,exit -F arch=b64 -F path=/boot/grub/grub.cfg -F perm=wa -F key=T1542.003_Pre-OS_Bootkit

### ESP mounted directly (UEFI systems)
-a always,exit -F arch=b32 -F path=/efi/grub/grub.cfg -F perm=wa -F key=T1542.003_Pre-OS_Bootkit
-a always,exit -F arch=b64 -F path=/efi/grub/grub.cfg -F perm=wa -F key=T1542.003_Pre-OS_Bootkit


## Privileged Command Execution Related Events

##- Use of privileged commands (unsuccessful and successful)
## You can run the following commands to generate the rules (don't forget to
## add arch=b32 rules, too):
## https://github.com/linux-audit/audit-userspace/blob/master/rules/31-privileged.rules
#find /bin -type f -perm -04000 2>/dev/null | awk '{ printf "-a always,exit -F arch=b64 -F dir=%s -F perm=x -F "auid>=500" -F "auid!=-1" -F key=privileged\n", $1 }' > priv.rules
#find /sbin -type f -perm -04000 2>/dev/null | awk '{ printf "-a always,exit -F arch=b64 -F dir=%s -F perm=x -F "auid>=500" -F "auid!=-1" -F key=privileged\n", $1 }' >> priv.rules
#find /usr/bin -type f -perm -04000 2>/dev/null | awk '{ printf "-a always,exit -F arch=b64 -F dir=%s -F perm=x -F "auid>=500" -F "auid!=-1" -F key=privileged\n", $1 }' >> priv.rules
#find /usr/sbin -type f -perm -04000 2>/dev/null | awk '{ printf "-a always,exit -F arch=b64 -F dir=%s -F perm=x -F "auid>=500" -F "auid!=-1" -F key=privileged\n", $1 }' >> priv.rules
#filecap /bin 2>/dev/null | sed '1d' | awk '{ printf "-a always,exit -F dir=%s -F arch=b64 -F perm=x -F "auid>=500" -F "auid!=-1" -F key=privileged\n", $2 }' >> priv.rules
#filecap /sbin 2>/dev/null | sed '1d' | awk '{ printf "-a always,exit -F dir=%s -F arch=b64 -F perm=x -F "auid>=500" -F "auid!=-1" -F key=privileged\n", $2 }' >> priv.rules
#filecap /usr/bin 2>/dev/null | sed '1d' | awk '{ printf "-a always,exit -F arch=b64 -F dir=%s -F perm=x -F "auid>=500" -F "auid!=-1" -F key=privileged\n", $2 }' >> priv.rules
#filecap /usr/sbin 2>/dev/null | sed '1d' | awk '{ printf "-a always,exit -F arch=b64 -F dir=%s -F perm=x -F "auid>=500" -F "auid!=-1" -F key=privileged\n", $2 }' >> priv.rules

### execve
-a always,exit -F arch=b32 -S execve -F euid=0 -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S execve -F euid=0 -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### ping
-a always,exit -F arch=b32 -F path=/bin/ping -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/ping -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/bin/ping6 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/ping6 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### fping
-a always,exit -F arch=b32 -F path=/bin/fping -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/fping -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/sbin/fping -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/fping -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/bin/fping -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/fping -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/sbin/fping -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/fping -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/bin/fping6 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/fping6 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/sbin/fping6 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/fping6 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/bin/fping6 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/fping6 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/sbin/fping6 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/fping6 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### umount
-a always,exit -F arch=b32 -F path=/bin/umount -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/umount -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/umount -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/umount -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### mount
-a always,exit -F arch=b32 -F path=/bin/mount -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/mount -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/mount -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/mount -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### fusermount
-a always,exit -F arch=b32 -F path=/bin/fusermount -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/fusermount -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/fusermount -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/fusermount -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### NFS mount
-a always,exit -F arch=b32 -F path=/sbin/mount.nfs -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/mount.nfs -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/mount.nfs -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/mount.nfs -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/sbin/mount.nfs4 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/mount.nfs4 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/mount.nfs4 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/mount.nfs4 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### usernetctl
-a always,exit -F arch=b32 -F path=/sbin/usernetctl -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/usernetctl -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/usernetctl -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/usernetctl -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

#-a always,exit -F arch=b32 -F path=/bin/usernetctl -F perm=x -F key=T1078_Valid_Accounts
#-a always,exit -F arch=b64 -F path=/bin/usernetctl -F perm=x -F key=T1078_Valid_Accounts

#-a always,exit -F arch=b32 -F path=/sbin/usernetctl -F perm=x -F key=T1078_Valid_Accounts
#-a always,exit -F arch=b64 -F path=/sbin/usernetctl -F perm=x -F key=T1078_Valid_Accounts

#-a always,exit -F arch=b32 -F path=/usr/bin/usernetctl -F perm=x -F key=T1078_Valid_Accounts
#-a always,exit -F arch=b64 -F path=/usr/bin/usernetctl -F perm=x -F key=T1078_Valid_Accounts

#-a always,exit -F arch=b32 -F path=/usr/sbin/usernetctl -F perm=x -F key=T1078_Valid_Accounts
#-a always,exit -F arch=b64 -F path=/usr/sbin/usernetctl -F perm=x -F key=T1078_Valid_Accounts

#-a always,exit -F arch=b32 -F path=/usr/local/bin/usernetctl -F perm=x -F key=T1078_Valid_Accounts
#-a always,exit -F arch=b64 -F path=/usr/local/bin/usernetctl -F perm=x -F key=T1078_Valid_Accounts

#-a always,exit -F arch=b32 -F path=/usr/local/sbin/usernetctl -F perm=x -F key=T1078_Valid_Accounts
#-a always,exit -F arch=b64 -F path=/usr/local/sbin/usernetctl -F perm=x -F key=T1078_Valid_Accounts

#-a always,exit -F arch=b32 -F path=/snap/usernetctl -F perm=x -F key=T1078_Valid_Accounts
#-a always,exit -F arch=b64 -F path=/snap/usernetctl -F perm=x -F key=T1078_Valid_Accounts

#-a always,exit -F arch=b32 -F path=/snap/bin/usernetctl -F perm=x -F key=T1078_Valid_Accounts
#-a always,exit -F arch=b64 -F path=/snap/bin/usernetctl -F perm=x -F key=T1078_Valid_Accounts

### pwck
-a always,exit -F arch=b32 -F path=/sbin/pwck -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/pwck -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/pwck -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/pwck -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### wall
-a always,exit -F arch=b32 -F path=/sbin/wall -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/wall -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/wall -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/wall -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### netreport
-a always,exit -F arch=b32 -F path=/sbin/netreport -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/netreport -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/netreport -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/netreport -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### postdrop
#### V-72175 - All uses of the postdrop command must be audited.
-a always,exit -F arch=b32 -F path=/sbin/postdrop -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/postdrop -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/postdrop -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/postdrop -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### postqueue
#### V-72177 - All uses of the postqueue command must be audited.
-a always,exit -F arch=b32 -F path=/sbin/postqueue -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/postqueue -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/postqueue -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/postqueue -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### polkit
-a always,exit -F arch=b32 -F path=/lib/polkit-1/polkit-agent-helper-1 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/lib/polkit-1/polkit-agent-helper-1 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/lib/polkit-1/polkit-agent-helper-1 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/lib/polkit-1/polkit-agent-helper-1 -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### System Security Services Daemon (SSSD)
#### T1078_Valid_Accounts
#### https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system-level_authentication_guide/configuring_services
#### https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_authentication_and_authorization_in_rhel/index
-a always,exit -F arch=b32 -F path=/etc/nsswitch.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/etc/nsswitch.conf -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/etc/krb5.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/etc/krb5.conf -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F dir=/etc/krb5.conf.d/ -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F dir=/etc/krb5.conf.d/ -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/etc/krb5.keytab -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/etc/krb5.keytab -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/etc/openldap/ldap.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/etc/openldap/ldap.conf -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F dir=/etc/openldap/ -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F dir=/etc/openldap/ -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/etc/sssd/sssd.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/etc/sssd/sssd.conf -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F dir=/etc/sssd/ -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F dir=/etc/sssd/ -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/share/sssd/sssd.api.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/share/sssd/sssd.api.conf -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/share/sssd/sssd.api.d/sssd-ad.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/share/sssd/sssd.api.d/sssd-ad.conf -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/share/sssd/sssd.api.d/sssd-simple.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/share/sssd/sssd.api.d/sssd-simple.conf -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/share/sssd/sssd.api.d/sssd-proxy.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/share/sssd/sssd.api.d/sssd-proxy.conf -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/share/sssd/sssd.api.d/sssd-files.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/share/sssd/sssd.api.d/sssd-files.conf -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/share/sssd/sssd.api.d/sssd-ldap.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/share/sssd/sssd.api.d/sssd-ldap.conf -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/share/sssd/sssd.api.d/sssd-ipa.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/share/sssd/sssd.api.d/sssd-ipa.conf -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/share/sssd/sssd.api.d/sssd-krb5.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/share/sssd/sssd.api.d/sssd-krb5.conf -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/libexec/sssd/p11_child -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/libexec/sssd/p11_child -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/libexec/sssd/krb5_child -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/libexec/sssd/krb5_child -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/libexec/sssd/ldap_child -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/libexec/sssd/ldap_child -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/libexec/sssd/selinux_child -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/libexec/sssd/selinux_child -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/libexec/sssd/proxy_child -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/libexec/sssd/proxy_child -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### Xorg
-a always,exit -F arch=b32 -F path=/bin/Xorg -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/Xorg -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/Xorg -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/Xorg -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/bin/Xorg -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/Xorg -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### chfn
-a always,exit -F arch=b32 -F path=/bin/chfn -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/chfn -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/chfn -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/chfn -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/chfn -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/chfn -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/bin/chfn -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/chfn -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/sbin/chfn -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/chfn -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

### userhelper
### V-72157 - All uses of the userhelper command must be audited.
-a always,exit -F arch=b32 -F path=/sbin/userhelper -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/userhelper -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/userhelper -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/userhelper -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/sbin/userhelper -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/userhelper -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

### staprun
-a always,exit -F arch=b32 -F path=/bin/staprun -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/staprun -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/staprun -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/staprun -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/staprun -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/staprun -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/bin/staprun -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/staprun -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/sbin/staprun -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/staprun -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

### gpasswd
### V-72153 - All uses of the gpasswd command must be audited.
-a always,exit -F arch=b32 -F path=/bin/gpasswd -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/gpasswd -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/gpasswd -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/gpasswd -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/gpasswd -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/gpasswd -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/bin/gpasswd -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/gpasswd -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/sbin/gpasswd -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/gpasswd -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

### chage
-a always,exit -F arch=b32 -F path=/bin/chage -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/chage -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/chage -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/chage -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/chage -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/chage -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/bin/chage -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/chage -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/sbin/chage -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/chage -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

### chsh
-a always,exit -F arch=b32 -F path=/bin/chsh -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/chsh -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/chsh -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/chsh -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/chsh -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/chsh -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/bin/chsh -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/chsh -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/sbin/chsh -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/chsh -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

### dbus
-a always,exit -F arch=b32 -F path=/lib64/dbus-1/dbus-daemon-launch-helper -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/lib64/dbus-1/dbus-daemon-launch-helper -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/lib64/dbus-1/dbus-daemon-launch-helper -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/lib64/dbus-1/dbus-daemon-launch-helper -F "auid>=500" -F "auid!=-1" -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/share/dbus-1/session.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/share/dbus-1/session.conf -F perm=wa -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/share/dbus-1/system.conf -F perm=wa -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/share/dbus-1/system.conf -F perm=wa -F key=T1078_Valid_Accounts

### freedesktop
#### https://freedesktop.org/
-a always,exit -F arch=b32 -F path=/usr/share/dbus-1/system.d/org.freedesktop.timedate1.conf -F perm=wa -F key=freedesktop
-a always,exit -F arch=b64 -F path=/usr/share/dbus-1/system.d/org.freedesktop.timedate1.conf -F perm=wa -F key=freedesktop

-a always,exit -F arch=b32 -F path=/usr/share/dbus-1/system.d/org.freedesktop.login1.conf -F perm=wa -F key=freedesktop
-a always,exit -F arch=b64 -F path=/usr/share/dbus-1/system.d/org.freedesktop.login1.conf -F perm=wa -F key=freedesktop

-a always,exit -F arch=b32 -F path=/usr/share/dbus-1/system.d/org.freedesktop.hostname1.conf -F perm=wa -F key=freedesktop
-a always,exit -F arch=b64 -F path=/usr/share/dbus-1/system.d/org.freedesktop.hostname1.conf -F perm=wa -F key=freedesktop

-a always,exit -F arch=b32 -F path=/usr/share/dbus-1/system.d/org.freedesktop.locale1.conf -F perm=wa -F key=freedesktop
-a always,exit -F arch=b64 -F path=/usr/share/dbus-1/system.d/org.freedesktop.locale1.conf -F perm=wa -F key=freedesktop

-a always,exit -F arch=b32 -F path=/usr/share/dbus-1/system.d/org.freedesktop.network1.conf -F perm=wa -F key=freedesktop
-a always,exit -F arch=b64 -F path=/usr/share/dbus-1/system.d/org.freedesktop.network1.conf -F perm=wa -F key=freedesktop

-a always,exit -F arch=b32 -F path=/usr/share/dbus-1/system.d/org.freedesktop.systemd1.conf -F perm=wa -F key=freedesktop
-a always,exit -F arch=b64 -F path=/usr/share/dbus-1/system.d/org.freedesktop.systemd1.conf -F perm=wa -F key=freedesktop

### vte-2.91
-a always,exit -F path=/lib64/vte-2.91/gnome-pty-helper -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/lib64/vte-2.91/gnome-pty-helper -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### kde4
-a always,exit -F path=/usr/libexec/kde4/kpac_dhcp_helper -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/libexec/kde4/kdesud -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

### setfiles
-a always,exit -F arch=b32 -F path=/usr/bin/setfiles -F "auid>=500" -F "auid!=-1" -F perm=x -F key=-T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/setfiles -F "auid>=500" -F "auid!=-1" -F perm=x -F key=-T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/setfiles -F "auid>=500" -F "auid!=-1" -F perm=x -F key=-T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/setfiles -F "auid>=500" -F "auid!=-1" -F perm=x -F key=-T1078_Valid_Accounts

### spice-gtk
-a always,exit -F path=/usr/libexec/spice-gtk-x86_64/spice-client-glib-usb-acl-helper -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F path=/usr/sbin/userdel -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

# V-72159 - All uses of the su command must be audited.
-a always,exit -F path=/bin/su -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/bin/chgrp -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

# V-72185 - All uses of the pam_timestamp_check command must be audited.
-a always,exit -F path=/sbin/pam_timestamp_check -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

# V-72151 - All uses of the unix_chkpwd command must be audited.
## unix_chkpwd
-a always,exit -F arch=b32 -F path=/bin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/bin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/sbin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/sbin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/bin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/bin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/sbin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/sbin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/bin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/bin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/usr/local/sbin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/usr/local/sbin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/snap/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F arch=b32 -F path=/snap/bin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F arch=b64 -F path=/snap/bin/unix_chkpwd -F perm=x -F key=T1078_Valid_Accounts

# -a always,exit -F path=/sbin/unix_chkpwd -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F path=/usr/sbin/suexec -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/sbin/usermod -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/sbin/newusers -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/sbin/groupdel -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

# V-72135 - All uses of the semanage command must be audited.
-a always,exit -F path=/usr/sbin/semanage -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/sbin/ccreds_validate -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

# V-72179 - All uses of the ssh-keysign command must be audited.
-a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/libexec/ssh-keysign -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/bin/rlogin -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

# V-72169 - All uses of the sudoedit command must be audited.
-a always,exit -F path=/usr/bin/sudoedit -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/bin/at -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/bin/rsh -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/bin/kgrantpty -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/bin/crontab -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

# V-72161 - All uses of the sudo command must be audited.
-a always,exit -F path=/usr/bin/sudo -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/bin/rcp -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
# duplicate for documentation research
# -a always,exit -F path=/usr/bin/passwd -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F path=/usr/bin/getfacl -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/bin/setfacl -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/bin/chacl -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

-a always,exit -F path=/usr/bin/chcon -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/bin/newgrp -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/bin/newrole -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts
-a always,exit -F path=/usr/bin/kpac_dhcp_helper -F "auid>=500" -F "auid!=-1" -F perm=x -F key=T1078_Valid_Accounts

# V-72137 - All uses of the setsebool command must be audited.
-a always,exit -F path=/usr/sbin/setsebool -F "auid>=500" -F "auid!=-1" -F perm=x -F key=V-72137


## Media Export Related Events
### Ensure auditd Collects Information on Exporting to Media (successful)

-a always,exit -F arch=b32 -S mount -F "auid>=500" -F "auid!=-1" -F key=T1052_Exfiltration_Over_Physical_Medium
-a always,exit -F arch=b64 -S mount -F "auid>=500" -F "auid!=-1" -F key=T1052_Exfiltration_Over_Physical_Medium

## Session initiation information
### T1108_Redundant_Access
### -w /var/run/utmp -F perm=wa -F key=session
### -w /var/log/btmp -F perm=wa -F key=session
### -w /var/log/wtmp -F perm=wa -F key=session

### Manual editing of these files may indicate nefarious activity, such as an attacker attempting
### to remove evidence of an intrusion.
### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_session_events
-a always,exit -F arch=b32 -F path=/var/run/utmp -F perm=wa -F key=T1108_Redundant_Access
-a always,exit -F arch=b64 -F path=/var/run/utmp -F perm=wa -F key=T1108_Redundant_Access

-a always,exit -F arch=b32 -F path=/var/log/btmp -F perm=wa -F key=T1108_Redundant_Access
-a always,exit -F arch=b64 -F path=/var/log/btmp -F perm=wa -F key=T1108_Redundant_Access

-a always,exit -F arch=b32 -F path=/var/log/wtmp -F perm=wa -F key=T1108_Redundant_Access
-a always,exit -F arch=b64 -F path=/var/log/wtmp -F perm=wa -F key=T1108_Redundant_Access

## Discretionary Access Control (DAC) modifications
### -a always,exit -F arch=b32 -S chmod -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b32 -S chown -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b32 -S fchmod -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b32 -S fchmodat -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b32 -S fchown -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b32 -S fchownat -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b32 -S fremovexattr -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b32 -S fsetxattr -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b32 -S lchown -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b32 -S lremovexattr -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b32 -S lsetxattr -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b32 -S removexattr -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b32 -S setxattr -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b64 -S chmod -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b64 -S chown -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b64 -S fchmod -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b64 -S fchmodat -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b64 -S fchown -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b64 -S fchownat -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b64 -S fremovexattr -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b64 -S fsetxattr -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b64 -S lchown -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b64 -S lremovexattr -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b64 -S lsetxattr -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b64 -S removexattr -F "auid>=500" -F "auid!=-1" -F key=perm_mod
### -a always,exit -F arch=b64 -S setxattr -F "auid>=500" -F "auid!=-1" -F key=perm_mod

-a always,exit -F arch=b32 -S chmod -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S chmod -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S chown -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S chown -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S fchmod -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S fchmod -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S fchmodat -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S fchmodat -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S fchown -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S fchown -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S fchownat -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S fchownat -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S lchown -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S lchown -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### removexattr
-a always,exit -F arch=b32 -S removexattr -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S removexattr -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S removexattr -F "auid=0" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S removexattr -F "auid=0" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### lremovexattr
-a always,exit -F arch=b32 -S lremovexattr -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S lremovexattr -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S lremovexattr -F "auid=0" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S lremovexattr -F "auid=0" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### fremovexattr
-a always,exit -F arch=b32 -S fremovexattr -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S fremovexattr -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S fremovexattr -F "auid=0" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S fremovexattr -F "auid=0" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### lsetxattr
-a always,exit -F arch=b32 -S lsetxattr -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S lsetxattr -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S lsetxattr -F "auid=0" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S lsetxattr -F "auid=0" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### setxattr
-a always,exit -F arch=b32 -S setxattr -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S setxattr -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S setxattr -F "auid=0" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S setxattr -F "auid=0" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### fsetxattr
-a always,exit -F arch=b32 -S fsetxattr -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S fsetxattr -F "auid>=500" -F "auid!=-1" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S fsetxattr -F "auid=0" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S fsetxattr -F "auid=0" -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -C "auid!=uid" -S execve -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -C "auid!=uid" -S execve -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S setuid -S setgid -S setreuid -S setregid -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S setuid -S setgid -S setreuid -S setregid -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -S setuid -S setgid -S setreuid -S setregid -F exit=EPERM -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -S setuid -S setgid -S setreuid -S setregid -F exit=EPERM -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### capsh
-a always,exit -F arch=b32 -F path=/bin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/bin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/sbin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/sbin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/bin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/bin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/sbin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/sbin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/bin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/bin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/sbin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/sbin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/bin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/bin/capsh -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### choom
-a always,exit -F arch=b32 -F path=/bin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/bin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/sbin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/sbin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/bin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/bin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/sbin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/sbin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/bin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/bin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/sbin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/sbin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/bin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/bin/choom -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### ionice
-a always,exit -F arch=b32 -F path=/bin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/bin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/sbin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/sbin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/bin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/bin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/sbin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/sbin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/bin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/bin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/bin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/bin/ionice -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### ksu
-a always,exit -F arch=b32 -F path=/bin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/bin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/sbin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/sbin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/bin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/bin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/sbin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/sbin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/bin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/bin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/bin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/bin/ksu -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### setarch
-a always,exit -F arch=b32 -F path=/bin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/bin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/sbin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/sbin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/bin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/bin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/sbin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/sbin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/bin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/bin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/sbin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/sbin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/bin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/bin/setarch -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### setlock
-a always,exit -F arch=b32 -F path=/bin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/bin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/sbin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/sbin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/bin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/bin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/sbin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/sbin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/bin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/bin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/sbin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/sbin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/bin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/bin/setlock -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### sg
-a always,exit -F arch=b32 -F path=/bin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/bin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/sbin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/sbin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/bin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/bin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/sbin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/sbin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/bin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/bin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/sbin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/sbin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/bin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/bin/sg -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### softlimit
-a always,exit -F arch=b32 -F path=/bin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/bin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/sbin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/sbin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/bin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/bin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/sbin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/sbin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/bin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/bin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/sbin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/sbin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/bin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/bin/softlimit -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### taskset
-a always,exit -F arch=b32 -F path=/bin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/bin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/sbin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/sbin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/bin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/bin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/sbin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/sbin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/bin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/bin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/usr/local/sbin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/usr/local/sbin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

-a always,exit -F arch=b32 -F path=/snap/bin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid
-a always,exit -F arch=b64 -F path=/snap/bin/taskset -F perm=x -F key=T1548.001_Abuse_Elevation_Control_Mechanism_Setuid_and_Setgid

### getdents
### https://github.com/deep-security/auditd-config/blob/master/audit.rules
-a always,exit -F arch=b32 -S getdents -S getdents -F "auid>=500" -F "auid!=-1" -F exit=0 -F key=DIR_LIST
-a always,exit -F arch=b64 -S getdents -S getdents -F "auid>=500" -F "auid!=-1" -F exit=0 -F key=DIR_LIST

-a always,exit -F arch=b32 -S getdents -S getdents64 -F "auid>=500" -F "auid!=-1" -F exit=0 -F key=DIR_LIST
-a always,exit -F arch=b64 -S getdents -S getdents64 -F "auid>=500" -F "auid!=-1" -F exit=0 -F key=DIR_LIST

# Special Rules

## AWS specific rules
-a always,exit -F arch=b32 -F path=/usr/bin/aws -F perm=wax -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/aws -F perm=wax -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/aws -F perm=wax -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/aws -F perm=wax -F key=T1087_Account_Discovery

## Reconnaissance

### -w /usr/bin/whoami -F perm=x -F key=recon
### -w /usr/bin/id -F perm=x -F key=recon
### -w /bin/hostname -F perm=x -F key=recon
### -w /bin/uname -F perm=x -F key=recon
### -w /etc/issue -F perm=r -F key=recon
### -w /etc/hostname -F perm=r -F key=recon

-a always,exit -F arch=b32 -F path=/usr/bin/getent -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/getent -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/getent -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/getent -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/getent -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/getent -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/getent -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/getent -F perm=x -F key=T1087_Account_Discovery

### nologin
-a always,exit -F arch=b32 -F path=/bin/nologin -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/bin/nologin -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/sbin/nologin -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/sbin/nologin -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/nologin -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/nologin -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/nologin -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/nologin -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/nologin -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/nologin -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/nologin -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/nologin -F perm=x -F key=T1087_Account_Discovery

### who
-a always,exit -F arch=b32 -F path=/bin/who -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/bin/who -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/sbin/who -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/sbin/who -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/who -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/who -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/who -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/who -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/who -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/who -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/who -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/who -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/whoami -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/whoami -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/whoami -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/whoami -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/whoami -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/whoami -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/whoami -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/whoami -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/id -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/id -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/id -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/id -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/id -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/id -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/id -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/id -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/bin/uname -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/bin/uname -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/sbin/uname -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/sbin/uname -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/uname -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/uname -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/uname -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/uname -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/groups -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/groups -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/groups -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/groups -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/groups -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/groups -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/groups -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/groups -F perm=x -F key=T1087_Account_Discovery

## users
-a always,exit -F arch=b32 -F path=/bin/users -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/bin/users -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/sbin/users -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/sbin/users -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/users -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/users -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/users -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/users -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/users -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/users -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/users -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/users -F perm=x -F key=T1087_Account_Discovery

## ldapsearch
-a always,exit -F arch=b32 -F path=/usr/bin/ldapsearch -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ldapsearch -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ldapsearch -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ldapsearch -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ldapsearch -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ldapsearch -F perm=x -F key=T1087_Account_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ldapsearch -F perm=x -F key=T1087_Account_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ldapsearch -F perm=x -F key=T1087_Account_Discovery

## Suspicious activity
### -w /usr/bin/wget -F perm=x -F key=susp_activity
### -w /usr/bin/curl -F perm=x -F key=susp_activity
### -w /usr/bin/base64 -F perm=x -F key=susp_activity
### -w /bin/nc -F perm=x -F key=susp_activity
### -w /bin/netcat -F perm=x -F key=susp_activity
### -w /usr/bin/ncat -F perm=x -F key=susp_activity
### -w /usr/bin/ssh -F perm=x -F key=susp_activity
### -w /usr/bin/scp -F perm=x -F key=susp_activity
### -w /usr/bin/sftp -F perm=x -F key=susp_activity
### -w /usr/bin/ftp -F perm=x -F key=susp_activity
### -w /usr/bin/socat -F perm=x -F key=susp_activity
### -w /usr/bin/wireshark -F perm=x -F key=susp_activity
### -w /usr/bin/tshark -F perm=x -F key=susp_activity
### -w /usr/bin/rawshark -F perm=x -F key=susp_activity
### -w /usr/bin/rdesktop -F perm=x -F key=susp_activity
### -w /usr/bin/nmap -F perm=x -F key=susp_activity
### -w /usr/bin/systemd-detect-virt -F perm=x -F key=susp_activity

## T1219 Remote Access Tools
## credits to Mitre https://attack.mitre.org/techniques/T1219/
##
## An adversary may use legitimate remote access tools to establish an interactive command and control channel within a network.
## Remote access tools create a session between two trusted hosts through a graphical interface, a command line interaction, a protocol tunnel via development or management software, or hardware-level access such as KVM (Keyboard, Video, Mouse) over IP solutions.
## Desktop support software (usually graphical interface) and remote management software (typically command line interface) allow a user to control a computer remotely as if they are a local user inheriting the user or software permissions.
## This software is commonly used for troubleshooting, software installation, and system management.[1][2][3]
## Adversaries may similarly abuse response features included in EDR and other defensive tools that enable remote access.
##
## Remote access tools may be installed and used post-compromise as an alternate communications channel for redundant access or to establish an interactive remote desktop session with the target system.
## It may also be used as a malware component to establish a reverse connection or back-connect to a service or adversary-controlled system.
##
## Installation of many remote access tools may also include persistence (e.g., the software's installation routine creates a Windows Service).
## Remote access modules/features may also exist as part of otherwise existing software (e.g., Google Chrome’s Remote Desktop).

## wget
-a always,exit -F arch=b32 -F path=/bin/wget -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/wget -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/sbin/wget -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/sbin/wget -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/wget -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/wget -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/wget -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/wget -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/wget -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/wget -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/wget -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/wget -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/snap/wget -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/snap/wget -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/wget -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/wget -F perm=x -F key=T1219_Remote_Access_Tools

## curl
-a always,exit -F arch=b32 -F path=/bin/curl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/curl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/sbin/curl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/sbin/curl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/curl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/curl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/curl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/curl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/curl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/curl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/curl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/curl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/snap/curl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/snap/curl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/curl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/curl -F perm=x -F key=T1219_Remote_Access_Tools

## wcurl
-a always,exit -F arch=b32 -F path=/bin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/sbin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/sbin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/snap/wcurl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/snap/wcurl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/lib/x86_64-linux-gnu/wcurl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/lib/x86_64-linux-gnu/wcurl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/lib/i386-linux-gnu/wcurl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/lib/i386-linux-gnu/wcurl -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/lib/aarch64-linux-gnu/wcurl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/lib/aarch64-linux-gnu/wcurl -F perm=x -F key=T1219_Remote_Access_Tools

#### macOS
-a always,exit -F arch=b32 -F path=/usr/local/opt/curl/bin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/opt/curl/bin/wcurl -F perm=x -F key=T1219_Remote_Access_Tools

### libcurl.so.4
-a always,exit -F arch=b32 -F path=/usr/lib/x86_64-linux-gnu/libcurl.so.4 -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/lib/x86_64-linux-gnu/libcurl.so.4 -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/lib/i386-linux-gnu/libcurl.so.4 -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/lib/i386-linux-gnu/libcurl.so.4 -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/lib/aarch64-linux-gnu/libcurl.so.4 -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/lib/aarch64-linux-gnu/libcurl.so.4 -F perm=x -F key=T1219_Remote_Access_Tools

### libcurl.so.4.8.0
-a always,exit -F arch=b32 -F path=/usr/lib/x86_64-linux-gnu/libcurl.so.4.8.0 -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/lib/x86_64-linux-gnu/libcurl.so.4.8.0 -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/lib/i386-linux-gnu/libcurl.so.4.8.0 -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/lib/i386-linux-gnu/libcurl.so.4.8.0 -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/lib/aarch64-linux-gnu/libcurl.so.4.8.0 -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/lib/aarch64-linux-gnu/libcurl.so.4.8.0 -F perm=x -F key=T1219_Remote_Access_Tools

### nc
-a always,exit -F arch=b32 -F path=/bin/nc -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/nc -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/sbin/nc -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/sbin/nc -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/nc -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/nc -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/nc -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/nc -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/nc -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/nc -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/nc -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/nc -F perm=x -F key=T1219_Remote_Access_Tools

### netcat
-a always,exit -F arch=b32 -F path=/bin/netcat -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/netcat -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/sbin/netcat -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/sbin/netcat -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/netcat -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/netcat -F perm=x -F key=T1219_Remote_Access_Tools

#### Added to catch netcat on Ubuntu
-a always,exit -F arch=b32 -F path=/bin/nc.openbsd -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/nc.openbsd -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/bin/nc.traditional -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/nc.traditional -F perm=x -F key=T1219_Remote_Access_Tools

#### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/netcat -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/netcat -F perm=x -F key=T1219_Remote_Access_Tools

### ncat
-a always,exit -F arch=b32 -F path=/bin/ncat -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/ncat -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/sbin/ncat -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/sbin/ncat -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/ncat -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ncat -F perm=x -F key=T1219_Remote_Access_Tools

### ss
-a always,exit -F arch=b32 -F path=/bin/ss -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/ss -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/sbin/ss -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/sbin/ss -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/ss -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ss -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/ss -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/ss -F perm=x -F key=T1219_Remote_Access_Tools

#### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/ss -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/ss -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ss -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ss -F perm=x -F key=T1219_Remote_Access_Tools

# Double placeholder
# -w /usr/bin/ssh -F perm=x -F key=T1219_Remote_Access_Tools
# -w /usr/local/bin/ssh -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/scp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/scp -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/scp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/scp -F perm=x -F key=T1219_Remote_Access_Tools

### sftp
-a always,exit -F arch=b32 -F path=/usr/bin/sftp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/sftp -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/sftp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/sftp -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/sftp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/sftp -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/ftp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ftp -F perm=x -F key=T1219_Remote_Access_Tools

### socat
-a always,exit -F arch=b32 -F path=/usr/bin/socat -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/socat -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/socat -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/socat -F perm=x -F key=T1219_Remote_Access_Tools

## tshark
-a always,exit -F arch=b32 -F path=/usr/bin/tshark -F perm=x -F key=T1049_System_Network_Connections_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/tshark -F perm=x -F key=T1049_System_Network_Connections_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/tshark -F perm=x -F key=T1049_System_Network_Connections_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/tshark -F perm=x -F key=T1049_System_Network_Connections_Discovery
### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/tshark -F perm=x -F key=T1049_System_Network_Connections_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/tshark -F perm=x -F key=T1049_System_Network_Connections_Discovery

## rawshark
-a always,exit -F arch=b32 -F path=/usr/bin/rawshark -F perm=x -F key=T1049_System_Network_Connections_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/rawshark -F perm=x -F key=T1049_System_Network_Connections_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/rawshark -F perm=x -F key=T1049_System_Network_Connections_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/rawshark -F perm=x -F key=T1049_System_Network_Connections_Discovery
### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/rawshark -F perm=x -F key=T1049_System_Network_Connections_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/rawshark -F perm=x -F key=T1049_System_Network_Connections_Discovery

## rdesktop
-a always,exit -F arch=b32 -F path=/usr/bin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools

## wlfreerdp
-a always,exit -F arch=b32 -F path=/usr/bin/wlfreerdp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/wlfreerdp -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/wlfreerdp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/wlfreerdp -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/wlfreerdp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/wlfreerdp -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/wlfreerdp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/wlfreerdp -F perm=x -F key=T1219_Remote_Access_Tools

## xfreerdp
-a always,exit -F arch=b32 -F path=/usr/bin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools

## freerdp-shadow-cli
-a always,exit -F arch=b32 -F path=/usr/bin/freerdp-shadow-cli -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/freerdp-shadow-cli -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/freerdp-shadow-cli -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/freerdp-shadow-cli -F perm=x -F key=T1219_Remote_Access_Tools

## nmap
-a always,exit -F arch=b32 -F path=/usr/bin/nmap -F perm=x -F key=T1049_System_Network_Connections_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/nmap -F perm=x -F key=T1049_System_Network_Connections_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/nmap -F perm=x -F key=T1049_System_Network_Connections_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/nmap -F perm=x -F key=T1049_System_Network_Connections_Discovery
### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/nmap -F perm=x -F key=T1049_System_Network_Connections_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/nmap -F perm=x -F key=T1049_System_Network_Connections_Discovery

## https://www.trendmicro.com/en_us/research/23/i/earth-lusca-employs-new-linux-backdoor.html
-a always,exit -F arch=b32 -F path=/dev/ptmx -F perm=wa -F key=susp_activity_Earth_Lusca
-a always,exit -F arch=b64 -F path=/dev/ptmx -F perm=wa -F key=susp_activity_Earth_Lusca

-a always,exit -F arch=b32 -F dir=/dev/pts/ -F perm=wa -F key=susp_activity_Earth_Lusca
-a always,exit -F arch=b64 -F dir=/dev/pts/ -F perm=wa -F key=susp_activity_Earth_Lusca

## Sbin suspicious activity

### ifconfig
-a always,exit -F arch=b32 -F path=/sbin/ifconfig -F perm=x -F key=sbin_susp
-a always,exit -F arch=b64 -F path=/sbin/ifconfig -F perm=x -F key=sbin_susp

-a always,exit -F arch=b32 -F path=/usr/sbin/ifconfig -F perm=x -F key=sbin_susp
-a always,exit -F arch=b64 -F path=/usr/sbin/ifconfig -F perm=x -F key=sbin_susp

### tcpdump
-a always,exit -F arch=b32 -F path=/usr/bin/tcpdump -F perm=x -F key=sbin_susp
-a always,exit -F arch=b64 -F path=/usr/bin/tcpdump -F perm=x -F key=sbin_susp

-a always,exit -F arch=b32 -F path=/usr/sbin/tcpdump -F perm=x -F key=sbin_susp
-a always,exit -F arch=b64 -F path=/usr/sbin/tcpdump -F perm=x -F key=sbin_susp

-a always,exit -F arch=b32 -F path=/usr/local/bin/tcpdump -F perm=x -F key=sbin_susp
-a always,exit -F arch=b64 -F path=/usr/local/bin/tcpdump -F perm=x -F key=sbin_susp

-a always,exit -F arch=b32 -F path=/usr/local/sbin/tcpdump -F perm=x -F key=sbin_susp
-a always,exit -F arch=b64 -F path=/usr/local/sbin/tcpdump -F perm=x -F key=sbin_susp

## getenforce
-a always,exit -F arch=b32 -F path=/usr/bin/getenforce -F perm=x -F key=T1518_Software_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/getenforce -F perm=x -F key=T1518_Software_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/getenforce -F perm=x -F key=T1518_Software_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/getenforce -F perm=x -F key=T1518_Software_Discovery

### may indicate privilege escalation CVE-2021-3560

#### dbus-send invocation
-a always,exit -F arch=b32 -F path=/usr/bin/dbus-send -F perm=x -F key=dbus_send
-a always,exit -F arch=b64 -F path=/usr/bin/dbus-send -F perm=x -F key=dbus_send

-a always,exit -F arch=b32 -F path=/usr/sbin/dbus-send -F perm=x -F key=dbus_send
-a always,exit -F arch=b64 -F path=/usr/sbin/dbus-send -F perm=x -F key=dbus_send

#### gdbus
-a always,exit -F arch=b32 -F path=/usr/bin/gdbus -F perm=x -F key=gdubs_call
-a always,exit -F arch=b64 -F path=/usr/bin/gdbus -F perm=x -F key=gdubs_call

-a always,exit -F arch=b32 -F path=/usr/sbin/gdbus -F perm=x -F key=gdubs_call
-a always,exit -F arch=b64 -F path=/usr/sbin/gdbus -F perm=x -F key=gdubs_call

#### busctl
-a always,exit -F arch=b32 -F path=/usr/bin/busctl -F perm=x -F key=busctl_call
-a always,exit -F arch=b64 -F path=/usr/bin/busctl -F perm=x -F key=busctl_call

-a always,exit -F arch=b32 -F path=/usr/sbin/busctl -F perm=x -F key=busctl_call
-a always,exit -F arch=b64 -F path=/usr/sbin/busctl -F perm=x -F key=busctl_call

# T1562 Impair Defenses
# credits to https://attack.mitre.org/techniques/T1562/
# Adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.
# This not only involves impairing preventative defenses, such as firewalls and anti-virus, but also detection capabilities
# that defenders can use to audit activity and identify malicious behavior. This may also span both native defenses as well
# as supplemental capabilities installed by users and administrators.
#
# Adversaries may also impair routine operations that contribute to defensive hygiene, such as blocking users from logging out,
# preventing a system from shutting down, or disabling or modifying the update process. Adversaries could also target event
# aggregation and analysis mechanisms, or otherwise disrupt these procedures by altering other system components.
# These restrictions can further enable malicious operations as well as the continued propagation of incidents.

# T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
## ufw
-a always,exit -F arch=b32 -F path=/bin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ufw -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/etc/default/ufw -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/etc/default/ufw -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/etc/logrotate.d/ufw -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/etc/logrotate.d/ufw -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/etc/rsyslog.d/20-ufw.conf -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/etc/rsyslog.d/20-ufw.conf -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/ufw.service -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/ufw.service -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F dir=/etc/ufw/applications.d/ -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F dir=/etc/ufw/applications.d/ -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F dir=/etc/ufw/ -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F dir=/etc/ufw/ -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## iptables
-a always,exit -F arch=b32 -F path=/bin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/iptables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/etc/arno-iptables-firewall/firewall.conf -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/etc/arno-iptables-firewall/firewall.conf -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/etc/arno-iptables-firewall/custom-rules -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/etc/arno-iptables-firewall/custom-rules -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/etc/init.d/arno-iptables-firewall -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/etc/init.d/arno-iptables-firewall -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/etc/logrotate.d/arno-iptables-firewall -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/etc/logrotate.d/arno-iptables-firewall -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/etc/rsyslog.d/arno-iptables-firewall.conf -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/etc/rsyslog.d/arno-iptables-firewall.conf -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/arno-iptables-firewall.service -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/arno-iptables-firewall.service -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F dir=/etc/arno-iptables-firewall/plugins/ -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F dir=/etc/arno-iptables-firewall/plugins/ -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F dir=/etc/arno-iptables-firewall/ -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F dir=/etc/arno-iptables-firewall/ -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F dir=/etc/ufw/ -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F dir=/etc/ufw/ -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ip6tables
-a always,exit -F arch=b32 -F path=/bin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ip6tables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## arptables-nft
-a always,exit -F arch=b32 -F path=/bin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/arptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## arptables-nft-restore
-a always,exit -F arch=b32 -F path=/bin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/arptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## arptables-nft-save
-a always,exit -F arch=b32 -F path=/bin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/arptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## arptables-translate
-a always,exit -F arch=b32 -F path=/bin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/arptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ebtables
-a always,exit -F arch=b32 -F path=/bin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ebtables -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ebtables-nft
-a always,exit -F arch=b32 -F path=/bin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ebtables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ebtables-nft-restore
-a always,exit -F arch=b32 -F path=/bin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ebtables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ebtables-nft-save
-a always,exit -F arch=b32 -F path=/bin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ebtables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ebtables-translate
-a always,exit -F arch=b32 -F path=/bin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ebtables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ip6tables-apply
-a always,exit -F arch=b32 -F path=/bin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ip6tables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ip6tables-legacy
-a always,exit -F arch=b32 -F path=/bin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ip6tables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ip6tables-legacy-restore
-a always,exit -F arch=b32 -F path=/bin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ip6tables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ip6tables-legacy-save
-a always,exit -F arch=b32 -F path=/bin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ip6tables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ip6tables-nft
-a always,exit -F arch=b32 -F path=/bin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ip6tables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ip6tables-nft-restore
-a always,exit -F arch=b32 -F path=/bin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ip6tables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ip6tables-nft-save
-a always,exit -F arch=b32 -F path=/bin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ip6tables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ip6tables-restore-translate
-a always,exit -F arch=b32 -F path=/bin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ip6tables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## ip6tables-translate
-a always,exit -F arch=b32 -F path=/bin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/ip6tables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## iptables-apply
-a always,exit -F arch=b32 -F path=/bin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/iptables-apply -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## iptables-legacy
-a always,exit -F arch=b32 -F path=/bin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/iptables-legacy -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## iptables-legacy-restore
-a always,exit -F arch=b32 -F path=/bin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/iptables-legacy-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## iptables-legacy-save
-a always,exit -F arch=b32 -F path=/bin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/iptables-legacy-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## iptables-nft
-a always,exit -F arch=b32 -F path=/bin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/iptables-nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## iptables-nft-restore
-a always,exit -F arch=b32 -F path=/bin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/iptables-nft-restore -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## iptables-nft-save
-a always,exit -F arch=b32 -F path=/bin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/iptables-nft-save -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## iptables-restore-translate
-a always,exit -F arch=b32 -F path=/bin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/iptables-restore-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## iptables-translate
-a always,exit -F arch=b32 -F path=/bin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/iptables-translate -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## nfnl_osf
-a always,exit -F arch=b32 -F path=/bin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/nfnl_osf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## xtables-legacy-multi
-a always,exit -F arch=b32 -F path=/bin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/xtables-legacy-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## xtables-monitor
-a always,exit -F arch=b32 -F path=/bin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/xtables-monitor -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## xtables-nft-multi
-a always,exit -F arch=b32 -F path=/bin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/xtables-nft-multi -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## nft
-a always,exit -F arch=b32 -F path=/bin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/nft -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/etc/nftables.conf -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/etc/nftables.conf -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/nftables.service -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/nftables.service -F perm=wa -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## pfsense typically for macOS and BSD Derivates
### pf
-a always,exit -F arch=b32 -F path=/bin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/pf -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

### pfctl
-a always,exit -F arch=b32 -F path=/bin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/pfctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

### configctl
-a always,exit -F arch=b32 -F path=/bin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/configctl -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

### php
-a always,exit -F arch=b32 -F path=/bin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/bin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/sbin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/sbin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/bin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/bin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/sbin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/sbin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/bin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/bin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/usr/local/sbin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/usr/local/sbin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

-a always,exit -F arch=b32 -F path=/snap/bin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall
-a always,exit -F arch=b64 -F path=/snap/bin/php -F perm=x -F key=T1562.004_Impair_Defenses_Disable_or_Modify_System_Firewall

## PCI-DSS
## 10.2.1 Implement audit trails to detect user accesses to cardholder data
## This would require a watch on the database that excludes the daemon's
## access. This rule is commented out due to needing a dir name
#-a always,exit -F dir=dir-to-db -F "auid>=500" -F "auid!=-1" -F uid!=daemon-acct -F perm=r -F key=10.2.1-cardholder-access

## PCI-DSS
## 10.2.2 Log administrative action. To meet this, you need to enable tty
## logging. The pam config below should be placed into su and sudo pam stacks.
## session required pam_tty_audit.so disable=* enable=root

## pkexec invocation
### may indicate privilege escalation CVE-2021-4034
### A local privilege escalation vulnerability was found on polkit's pkexec
### utility. The pkexec application is a setuid tool designed to allow
### unprivileged users to run commands as privileged users according
### predefined policies. The current version of pkexec doesn't handle the
### calling parameters count correctly and ends trying to execute environment
### variables as commands. An attacker can leverage this by crafting
### environment variables in such a way it'll induce pkexec to execute
### arbitrary code. When successfully executed the attack can cause a local
### privilege escalation given unprivileged users administrative rights on
### the target machine.
###
### References
### https://nvd.nist.gov/vuln/detail/CVE-2021-4034
### https://access.redhat.com/security/vulnerabilities/RHSB-2022-001
### https://bugzilla.redhat.com/show_bug.cgi?id=2025869
### https://gitlab.freedesktop.org/polkit/polkit/-/commit/a2bf5c9c83b6ae46cbd5c779d3055bff81ded683
### https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt
### http://packetstormsecurity.com/files/166196/Polkit-pkexec-Local-Privilege-Escalation.html
### https://www.suse.com/support/kb/doc/?id=000020564
### http://packetstormsecurity.com/files/166200/Polkit-pkexec-Privilege-Escalation.html

## Special case for pkexec. It is not audit aware, specifically watch it
-a always,exit -F arch=b32 -F path=/usr/bin/pkexec -F perm=x -F key=pkexec
-a always,exit -F arch=b64 -F path=/usr/bin/pkexec -F perm=x -F key=pkexec

-a always,exit -F arch=b32 -F path=/usr/sbin/pkexec -F perm=x -F key=pkexec
-a always,exit -F arch=b64 -F path=/usr/sbin/pkexec -F perm=x -F key=pkexec

## Special case for systemd-run. It is not audit aware, specifically watch it
-a always,exit -F arch=b32 -F path=/usr/bin/systemd-run -F perm=x -F "auid!=-1" -F key=systemd-run
-a always,exit -F arch=b64 -F path=/usr/bin/systemd-run -F perm=x -F "auid!=-1" -F key=systemd-run

# AF_SECURITY -------------------------------------------------------------------------------
## Uncomment only if tap interface is configured
#-a always,exit -F arch=b64 -S socket -F a0=14 -F key=net
## AF_KEY
#-a always,exit -F arch=b64 -S socket -F a0=15 -F key=net
## AF_NETLINK
#-a always,exit -F arch=b64 -S socket -F a0=16 -F key=net
## AF_PACKET
#-a always,exit -F arch=b64 -S socket -F a0=17 -F key=net
## AF_LLC
#-a always,exit -F arch=b64 -S socket -F a0=26 -F key=net
## AF_XDP
#-a always,exit -F arch=b64 -S socket -F a0=44 -F key=net
## AF_INET + SOCK_RAW
#-a always,exit -F arch=b64 -S socket -F a1=3 -F key=net
#-a always,exit -F arch=b64 -S listen -F key=net

## Suspicious shells
## susp_shell -> T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
## T1059 Command and Scripting Interpreter
## credits to Mitre https://attack.mitre.org/techniques/T1059/
## Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries.
## These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms.
## Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of Unix Shell while Windows installations include the Windows Command Shell and PowerShell.

### https://gtfobins.github.io/gtfobins/ash/
-a always,exit -F arch=b32 -F path=/bin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/ash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://gtfobins.github.io/gtfobins/bash/
-a always,exit -F arch=b32 -F path=/bin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://gtfobins.github.io/gtfobins/busybox/
-a always,exit -F arch=b32 -F path=/bin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/busybox -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://clustershell.readthedocs.io/
-a always,exit -F arch=b32 -F path=/etc/clustershell/clush.conf -F perm=wa -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/etc/clustershell/clush.conf -F perm=wa -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

#### clush
-a always,exit -F arch=b32 -F path=/bin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell^

-a always,exit -F arch=b32 -F path=/sbin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/clush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### crush
### https://github.com/liljencrantz/crush/
-a always,exit -F arch=b32 -F path=/bin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/crush -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### csh
### https://gtfobins.github.io/gtfobins/csh/
-a always,exit -F arch=b32 -F path=/bin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/csh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### dash
### https://gtfobins.github.io/gtfobins/dash/
-a always,exit -F arch=b32 -F path=/bin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/dash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://gtfobins.github.io/gtfobins/fish/
-a always,exit -F arch=b32 -F path=/bin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/fish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://linux.die.net/man/1/ginsh
### https://gtfobins.github.io/gtfobins/ginsh/
-a always,exit -F arch=b32 -F path=/bin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/ginsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://gtfobins.github.io/gtfobins/luatex/
#### lua
-a always,exit -F arch=b32 -F path=/bin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/lua -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

#### lualatex
-a always,exit -F arch=b32 -F path=/bin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/lualatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

#### luatex
-a always,exit -F arch=b32 -F path=/bin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/luatex -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://gtfobins.github.io/gtfobins/ksh/
-a always,exit -F arch=b32 -F path=/bin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/ksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://gtfobins.github.io/gtfobins/ksshell/
-a always,exit -F arch=b32 -F path=/bin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/ksshell -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://gtfobins.github.io/gtfobins/posh/
-a always,exit -F arch=b32 -F path=/bin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/posh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### rbash
#### rbash
-a always,exit -F arch=b32 -F path=/bin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/rbash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

#### resh
-a always,exit -F arch=b32 -F path=/bin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/resh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### sh
-a always,exit -F arch=b32 -F path=/bin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

## sash
-a always,exit -F arch=b32 -F path=/bin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/sash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

#### Solaris
-a always,exit -F arch=b32 -F path=/usr/xpg4/bin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/xpg4/bin/sh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### tcsh
-a always,exit -F arch=b32 -F path=/bin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/tcsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://gtfobins.github.io/gtfobins/tclsh/
-a always,exit -F arch=b32 -F path=/bin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/tclsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://github.com/tmux/tmux
#### https://gtfobins.github.io/gtfobins/tmux/
## tmux
-a always,exit -F arch=b32 -F path=/bin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/tmux -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://gtfobins.github.io/gtfobins/wish/
## wish
-a always,exit -F arch=b32 -F path=/bin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/wish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://xon.sh/
-a always,exit -F arch=b32 -F path=/etc/xonsh/xonshrc -F perm=wa -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/etc/xonsh/xonshrc -F perm=wa -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F dir=/etc/xonsh/ -F perm=wa -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F dir=/etc/xonsh/ -F perm=wa -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

#### xonsh
-a always,exit -F arch=b32 -F path=/bin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/xonsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### http://mirbsd.de/mksh
-a always,exit -F arch=b32 -F path=/etc/mkshrc -F perm=wa -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/etc/mkshrc -F perm=wa -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/etc/skel/.mkshrc -F perm=wa -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/etc/skel/.mkshrc -F perm=wa -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

#### lksh
-a always,exit -F arch=b32 -F path=/bin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/lksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

#### mksh
-a always,exit -F arch=b32 -F path=/bin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/mksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

#### rlksh
-a always,exit -F arch=b32 -F path=/bin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/rlksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

#### rmksh
-a always,exit -F arch=b32 -F path=/bin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/rmksh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://elv.sh/
## elvish
-a always,exit -F arch=b32 -F path=/bin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/elvish -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://github.com/xxh/xxh
-a always,exit -F arch=b32 -F path=/bin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

#### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/xxh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/xxh.bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/xxh.bash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/xxh.xsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/xxh.xsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/xxh.zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/xxh.zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://gtfobins.github.io/gtfobins/yash/
-a always,exit -F arch=b32 -F path=/bin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/yash -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://gtfobins.github.io/gtfobins/zsh/
-a always,exit -F arch=b32 -F path=/bin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/zsh -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### https://github.com/koenw/resh
-a always,exit -F arch=b32 -F path=/etc/resh.toml -F perm=wa -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/etc/resh.toml -F perm=wa -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

## Shell/profile configurations
## T1546 Event Triggered Execution
## credits to Mitre https://attack.mitre.org/techniques/T1546/
##
## Adversaries may establish persistence and/or elevate privileges using system mechanisms that trigger execution based on specific events.
## Various operating systems have means to monitor and subscribe to events such as logons or other user activity such as running specific applications/binaries.
## Cloud environments may also support various functions and services that monitor and can be invoked in response to specific cloud events.
##
## Adversaries may abuse these mechanisms as a means of maintaining persistent access to a victim via repeatedly executing malicious code.
## After gaining access to a victim system, adversaries may create/modify event triggers to point to malicious content that will be executed whenever the event trigger is invoked.
##
## Since the execution can be proxied by an account with higher permissions, such as SYSTEM or service accounts,
## an adversary may be able to abuse these triggered execution mechanisms to escalate their privileges.
##
### https://github.com/bfuzzy/auditd-attack/blob/master/auditd-attack.rules
### -w /etc/profile.d/ -F perm=wa -F key=shell_profiles
### -w /etc/profile -F perm=wa -F key=shell_profiles
### -w /etc/shells -F perm=wa -F key=shell_profiles
### -w /etc/bashrc -F perm=wa -F key=shell_profiles
### -w /etc/csh.cshrc -F perm=wa -F key=shell_profiles
### -w /etc/csh.login -F perm=wa -F key=shell_profiles
### -w /etc/fish/ -F perm=wa -F key=shell_profiles
### -w /etc/zsh/ -F perm=wa -F key=shell_profiles

-a always,exit -F arch=b32 -F path=/etc/profile -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F path=/etc/profile -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F path=/etc/shells -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F path=/etc/shells -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F path=/etc/bashrc -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F path=/etc/bashrc -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F path=/etc/bashrc_Apple_Terminal -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F path=/etc/bashrc_Apple_Terminal -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F path=/etc/csh.cshrc -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F path=/etc/csh.cshrc -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F path=/etc/csh.login -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F path=/etc/csh.login -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F dir=/etc/fish/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F dir=/etc/fish/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F dir=/etc/open/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F dir=/etc/open/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F dir=/etc/rbashrc/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F dir=/etc/rbashrc/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F dir=/etc/sh/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F dir=/etc/sh/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F dir=/etc/xonsh/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F dir=/etc/xonsh/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F dir=/etc/zsh/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F dir=/etc/zsh/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F dir=/etc/zshenv/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F dir=/etc/zshenv/ -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F path=/etc/zshrc -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F path=/etc/zshrc -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F path=/etc/zshrc_Apple_Terminal -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F path=/etc/zshrc_Apple_Terminal -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

-a always,exit -F arch=b32 -F path=/etc/zprofile -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification
-a always,exit -F arch=b64 -F path=/etc/zprofile -F perm=wa -F key=T1546.004_Event_Triggered_Execution_Unix_Shell_Configuration_Modification

# Web Server Activity
## Change the number "33" to the ID of your WebServer user. Default: www-data:x:33:33
-a always,exit -F arch=b32 -S execve -F euid=33 -F key=detect_execve_www
-a always,exit -F arch=b64 -S execve -F euid=33 -F key=detect_execve_www

## Injection
### These rules watch for code injection by the ptrace facility.
### This could indicate someone trying to do something bad or just debugging
### https://github.com/linux-audit/audit-userspace/blob/master/rules/42-injection.rules
### -a always,exit -F arch=b32 -S ptrace -F key=tracing
### -a always,exit -F arch=b64 -S ptrace -F key=tracing
### -a always,exit -F arch=b32 -S ptrace -F a0=0x4 -F key=code_injection
### -a always,exit -F arch=b64 -S ptrace -F a0=0x4 -F key=code_injection
### -a always,exit -F arch=b32 -S ptrace -F a0=0x5 -F key=data_injection
### -a always,exit -F arch=b64 -S ptrace -F a0=0x5 -F key=data_injection
### -a always,exit -F arch=b32 -S ptrace -F a0=0x6 -F key=register_injection
### -a always,exit -F arch=b64 -S ptrace -F a0=0x6 -F key=register_injection
## T1055 Process Injection
## credits to Mitre https://attack.mitre.org/techniques/T1055/
##
## Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges.
## Process injection is a method of executing arbitrary code in the address space of a separate live process.
## Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges.
## Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process.
##
## There are many different ways to inject code into a process, many of which abuse legitimate functionalities.
## These implementations exist for every major OS but are typically platform specific.
##
## More sophisticated samples may perform multiple process injections to segment modules and further evade detection,
## utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.

-a always,exit -F arch=b32 -S ptrace -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -S ptrace -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -S ptrace -F a0=0x4 -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -S ptrace -F a0=0x4 -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -S ptrace -F a0=0x5 -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -S ptrace -F a0=0x5 -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -S ptrace -F a0=0x6 -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -S ptrace -F a0=0x6 -F key=T1055_Process_Injection

### bpftrace
-a always,exit -F arch=b32 -F path=/bin/bpftrace -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/bin/bpftrace -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/sbin/bpftrace -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/sbin/bpftrace -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/usr/bin/bpftrace -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/bin/bpftrace -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/usr/sbin/bpftrace -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/sbin/bpftrace -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/usr/local/bin/bpftrace -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/local/bin/bpftrace -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/usr/local/sbin/bpftrace -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/usr/local/sbin/bpftrace -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/snap/bpftrace -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/snap/bpftrace -F perm=x -F key=T1055_Process_Injection

-a always,exit -F arch=b32 -F path=/snap/bin/bpftrace -F perm=x -F key=T1055_Process_Injection
-a always,exit -F arch=b64 -F path=/snap/bin/bpftrace -F perm=x -F key=T1055_Process_Injection

## Privilege Abuse
### The purpose of this rule is to detect when an admin may be abusing power by looking in user's home dir.
### https://github.com/Neo23x0/auditd/issues/143

-a always,exit -F dir=/home/ -F uid=0 -F "auid>=500" -F "auid!=-1" -C "auid!=obj_uid" -F key=power_abuse

# Socket Creations
# will catch both IPv4 and IPv6
## T1011 Exfiltration Over Other Network Medium
## credits to Mitre https://attack.mitre.org/techniques/T1011/
##
## Exfiltration consists of techniques that adversaries may use to steal data from your network.
## Once they’ve collected data, adversaries often package it to avoid detection while removing it.
## This can include compression and encryption. Techniques for getting data out of a target network
## typically include transferring it over their command and control channel or an alternate channel
## and may also include putting size limits on the transmission.

-a always,exit -F arch=b32 -S socket -F a0=2 -F key=T1011.001_Exfiltration_Over_Other_Network_Medium
-a always,exit -F arch=b64 -S socket -F a0=2 -F key=T1011.001_Exfiltration_Over_Other_Network_Medium

-a always,exit -F arch=b32 -S socket -F a0=10 -F key=T1011.001_Exfiltration_Over_Other_Network_Medium
-a always,exit -F arch=b64 -S socket -F a0=10 -F key=T1011.001_Exfiltration_Over_Other_Network_Medium

## Timestomping (noisy)
### The main purpose of this rule is to detect any attempt of timestomping.
#-a always,exit -F arch=b32 -S utimensat -F key=timestamp-changed
#-a always,exit -F arch=b64 -S utimensat -F key=timestamp-changed

# Software Management
## T1072 Software Deployment Tools
## credits to Mitre https://attack.mitre.org/techniques/T1072/
##
## Adversaries may gain access to and use centralized software suites installed within an enterprise to execute commands and move laterally through the network.
## Configuration management and software deployment applications may be used in an enterprise network or cloud environment for routine administration purposes.
## These systems may also be integrated into CI/CD pipelines. Examples of such solutions include: SCCM, HBSS, Altiris, AWS Systems Manager, Microsoft Intune, Azure Arc, and GCP Deployment Manager.
##
## Access to network-wide or enterprise-wide endpoint management software may enable an adversary to achieve remote code execution on all connected systems.
## The access may be used to laterally move to other systems, gather information, or cause a specific effect, such as wiping the hard drives on all endpoints.
##
## SaaS-based configuration management services may allow for broad Cloud Administration Command on cloud-hosted instances, as well as the execution of arbitrary commands on on-premises endpoints.
## For example, Microsoft Configuration Manager allows Global or Intune Administrators to run scripts as SYSTEM on on-premises devices joined to Entra ID.[1]
## Such services may also utilize Web Protocols to communicate back to adversary owned infrastructure.[2]
##
## Network infrastructure devices may also have configuration management tools that can be similarly abused by adversaries.[3]
##
## The permissions required for this action vary by system configuration; local credentials may be sufficient with direct access to the third-party system, or specific domain credentials may be required.
## However, the system may require an administrative account to log in or to access specific functionality.

## RPM (Redhat/CentOS)
### -w /usr/bin/rpm -F perm=x -F key=software_mgmt
### -w /usr/bin/yum -F perm=x -F key=software_mgmt

### rpm
-a always,exit -F arch=b32 -F path=/usr/bin/rpm -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/rpm -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/rpm -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/rpm -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/etc/rpmrc -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/rpmrc -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/lib/rpm/rpmrc -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/lib/rpm/rpmrc -F perm=wa -F key=T1072_Software_Deployment_Tools

### yum
-a always,exit -F arch=b32 -F path=/etc/yum/yum.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/yum/yum.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/yum.repos.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/yum.repos.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/yum -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/yum -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/yum -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/yum -F perm=x -F key=T1072_Software_Deployment_Tools

## DNF (Fedora/RedHat 8/CentOS 8)
### T1072_Software_Deployment_Tools
### https://github.com/rpm-software-management/dnf
### https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_software_with_the_dnf_tool/assembly_configuring-yum_managing-software-with-the-dnf-tool
### -w /usr/bin/dnf -F perm=x -F key=software_mgmt

-a always,exit -F arch=b32 -F path=/etc/dnf/dnf.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/dnf/dnf.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/dnf/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/dnf/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/yum.repos.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/yum.repos.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

#### dnf
-a always,exit -F arch=b32 -F path=/bin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/dnf -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/dnf -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/dnf -F perm=x -F key=T1072_Software_Deployment_Tools

#### dnf-3
-a always,exit -F arch=b32 -F path=/bin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/dnf-3 -F perm=x -F key=T1072_Software_Deployment_Tools

## YAST/Zypper/RPM (SuSE)
### T1072_Software_Deployment_Tools
### https://documentation.suse.com/smart/systems-management/html/concept-zypper/index.html
### -w /sbin/yast -F perm=x -F key=software_mgmt
### -w /sbin/yast2 -F perm=x -F key=software_mgmt
### -w /bin/rpm -F perm=x -F key=software_mgmt
### -w /usr/bin/zypper -F key=software_mgmt

### https://www.suse.com/support/kb/doc/?id=000019262
-a always,exit -F arch=b32 -F path=/etc/zypp/zypp.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/zypp/zypp.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/zypp/repos.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/zypp/repos.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/zypp/credentials.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/zypp/credentials.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

### zypper
-a always,exit -F arch=b32 -F path=/bin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/zypper -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/zypper -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/zypper -F perm=x -F key=T1072_Software_Deployment_Tools

### yast
-a always,exit -F arch=b32 -F path=/bin/yast -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/yast -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/yast -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/yast -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/yast -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/yast -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/yast -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/yast -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/yast -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/yast -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/yast -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/yast -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/yast -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/yast -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/yast -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/yast -F perm=x -F key=T1072_Software_Deployment_Tools

### yast2
-a always,exit -F arch=b32 -F path=/bin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/yast2 -F perm=x -F key=T1072_Software_Deployment_Tools

## DPKG / APT-GET (Debian/Ubuntu)
### T1072_Software_Deployment_Tools
-a always,exit -F arch=b32 -F path=/etc/apt/listchanges.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/apt/listchanges.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/etc/apt/apt.conf.d/20listchanges -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/apt/apt.conf.d/20listchanges -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/etc/apt/apt.conf.d/50apt-file.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/apt/apt.conf.d/50apt-file.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/etc/apt/apt.conf.d/10apt-listbugs -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/apt/apt.conf.d/10apt-listbugs -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/etc/logrotate.d/apt -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/logrotate.d/apt -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/etc/logrotate.d/dpkg -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/logrotate.d/dpkg -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/etc/cron.daily/apt-compat -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/cron.daily/apt-compat -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/etc/cron.daily/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/cron.daily/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/apt/apt.conf.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/apt/apt.conf.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/apt/sources.list.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/apt/sources.list.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/apt/keyrings/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/apt/keyrings/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/apt/trusted.gpg.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/apt/trusted.gpg.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/apt/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/apt/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/dpkg/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/dpkg/ -F perm=wa -F key=T1072_Software_Deployment_Tools

#### dpkg
-a always,exit -F arch=b32 -F path=/usr/bin/dpkg -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/dpkg -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/dpkg -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/dpkg -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/dpkg -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/dpkg -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/dpkg -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/dpkg -F perm=x -F key=T1072_Software_Deployment_Tools

#### apt
-a always,exit -F arch=b32 -F path=/bin/apt -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/apt -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/apt -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/apt -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/apt -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/apt -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/apt -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/apt -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/apt -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/apt -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apt -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apt -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/apt -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/apt -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/apt -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/apt -F perm=x -F key=T1072_Software_Deployment_Tools

#### apt-get
-a always,exit -F arch=b32 -F path=/bin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/apt-get -F perm=x -F key=T1072_Software_Deployment_Tools

#### apt-key
-a always,exit -F arch=b32 -F path=/bin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/apt-key -F perm=x -F key=T1072_Software_Deployment_Tools

#### apt-cache
-a always,exit -F arch=b32 -F path=/bin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/apt-cache -F perm=x -F key=T1072_Software_Deployment_Tools

#### apt-cdrom
-a always,exit -F arch=b32 -F path=/bin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/apt-cdrom -F perm=x -F key=T1072_Software_Deployment_Tools

#### apt-mark
-a always,exit -F arch=b32 -F path=/bin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/apt-mark -F perm=x -F key=T1072_Software_Deployment_Tools

#### apt-rdepends
-a always,exit -F arch=b32 -F path=/bin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/apt-rdepends -F perm=x -F key=T1072_Software_Deployment_Tools

#### apt-file
-a always,exit -F arch=b32 -F path=/bin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/apt-file -F perm=x -F key=T1072_Software_Deployment_Tools

#### apt-listbugs
-a always,exit -F arch=b32 -F path=/bin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/apt-listbugs -F perm=x -F key=T1072_Software_Deployment_Tools

#### apt-listchanges
-a always,exit -F arch=b32 -F path=/bin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/apt-listchanges -F perm=x -F key=T1072_Software_Deployment_Tools

#### apt-sortpkgs
-a always,exit -F arch=b32 -F path=/bin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/apt-sortpkgs -F perm=x -F key=T1072_Software_Deployment_Tools

#### apt-add-repository
-a always,exit -F arch=b32 -F path=/bin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/apt-add-repository -F perm=x -F key=T1072_Software_Deployment_Tools

#### apt-config
-a always,exit -F arch=b32 -F path=/bin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/apt-config -F perm=x -F key=T1072_Software_Deployment_Tools

#### aptitude
-a always,exit -F arch=b32 -F path=/bin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/aptitude -F perm=x -F key=T1072_Software_Deployment_Tools

#### wajig
-a always,exit -F arch=b32 -F path=/bin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/wajig -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/wajig -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/wajig -F perm=x -F key=T1072_Software_Deployment_Tools

#### snap
-a always,exit -F arch=b32 -F path=/bin/snap -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/snap -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/snap -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/snap -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/snap -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/snap -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/snap -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/snap -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/snap -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/snap -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/snap -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/snap -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/snap -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/snap -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/snap -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/snap -F perm=x -F key=T1072_Software_Deployment_Tools

## Pacman (Arch Linux)
### T1072_Software_Deployment_Tools
### https://wiki.archlinux.org/title/Pacman

-a always,exit -F arch=b32 -F path=/etc/pacman.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/pacman.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/pacman.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/pacman.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## APK (Alpine Linux)
### T1072_Software_Deployment_Tools
### https://wiki.alpinelinux.org/wiki/Alpine_Linux_package_management
-a always,exit -F arch=b32 -F path=/etc/apk/repositories -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/apk/repositories -F perm=wa -F key=T1072_Software_Deployment_Tools

## PIP(3) (Python installs)
### T1072_Software_Deployment_Tools
### -w /usr/bin/pip -F perm=x -F key=software_mgmt
### -w /usr/bin/pip3 -F perm=x -F key=software_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/pip -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/pip -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/pip -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/pip -F perm=x -F key=T1072_Software_Deployment_Tools

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/pip -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/pip -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/pip3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/pip3 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/pip3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/pip3 -F perm=x -F key=T1072_Software_Deployment_Tools

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/pip3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/pip3 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/pipx -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/pipx -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/pipx -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/pipx -F perm=x -F key=T1072_Software_Deployment_Tools

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/pipx -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/pipx -F perm=x -F key=T1072_Software_Deployment_Tools

## Python
### T1072_Software_Deployment_Tools
-a always,exit -F arch=b32 -F path=/usr/bin/python -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/python -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/python -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/python -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/python2 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/python2 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/python2 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/python2 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/python2.7 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/python2.7 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/python2.7 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/python2.7 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/python3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/python3 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/python3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/python3 -F perm=x -F key=T1072_Software_Deployment_Tools

#### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/python3 -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/python3 -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/opt/rh/rh-python36/root/usr/bin/python -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/opt/rh/rh-python36/root/usr/bin/python -F perm=x -F key=T1072_Software_Deployment_Tools

## conda
### T1072_Software_Deployment_Tools
### https://docs.conda.io/projects/conda/en/latest/user-guide/configuration/use-condarc.html
-a always,exit -F arch=b32 -F path=/etc/conda/.condarc -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/conda/.condarc -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/etc/conda/condarc -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/conda/condarc -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/conda/condarc.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/conda/condarc.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/var/lib/conda/.condarc -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/var/lib/conda/.condarc -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/var/lib/conda/condarc -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/var/lib/conda/condarc -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/var/lib/conda/condarc.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/var/lib/conda/condarc.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## npm
### T1072_Software_Deployment_Tools
### https://www.npmjs.com
### https://docs.npmjs.com/cli/v6/commands/npm-audit

-a always,exit -F arch=b32 -F path=/etc/npmrc -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/npmrc -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/bin/npm -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/npm -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/npm -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/npm -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/npm -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/npm -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/npm -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/npm -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/npm -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/npm -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/npm -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/npm -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/npm -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/npm -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/npm -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/npm -F perm=x -F key=T1072_Software_Deployment_Tools

## Comprehensive Perl Archive Network (CPAN) (CPAN installs)
### T1072_Software_Deployment_Tools
### https://www.cpan.org

-a always,exit -F arch=b32 -F path=/usr/bin/cpan -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/cpan -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/cpan -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/cpan -F perm=x -F key=T1072_Software_Deployment_Tools

## Ruby (RubyGems installs)
### T1072_Software_Deployment_Tools
### https://rubygems.org

-a always,exit -F arch=b32 -F path=/etc/gemrc -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/gemrc -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/gem -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/gem -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/gem -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/gem -F perm=x -F key=T1072_Software_Deployment_Tools

## Composer (PHP)
### T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/etc/composer/config.json -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/composer/config.json -F perm=wa -F key=T1072_Software_Deployment_Tools

## Guix
### T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/var/guix/profiles/per-user/root/guix-profile/manifest.scm -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/var/guix/profiles/per-user/root/guix-profile/manifest.scm -F perm=wa -F key=T1072_Software_Deployment_Tools

## LuaRocks (Lua installs)
### T1072_Software_Deployment_Tools
### https://luarocks.org
-a always,exit -F arch=b32 -F path=/bin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/luarocks -F perm=x -F key=T1072_Software_Deployment_Tools

## Cargo
### T1072_Software_Deployment_Tools
### https://doc.rust-lang.org/cargo/

-a always,exit -F arch=b32 -F path=/etc/cargo/config.toml -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/cargo/config.toml -F perm=wa -F key=T1072_Software_Deployment_Tools

## Portage
### T1072_Software_Deployment_Tools
### https://wiki.gentoo.org/wiki/Portage

-a always,exit -F arch=b32 -F path=/etc/portage/make.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/portage/make.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

## Paludis
### T1072_Software_Deployment_Tools
### https://paludis.exherbo.org/

-a always,exit -F arch=b32 -F path=/etc/paludis/paludis.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/paludis/paludis.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

## Conary
### T1072_Software_Deployment_Tools
### http://wiki.rpath.com/wiki/Conary

-a always,exit -F arch=b32 -F path=/etc/conary/conary.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/conary/conary.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

## Slackpkg
### T1072_Software_Deployment_Tools
### https://docs.slackware.com/slackware:slackpkg

-a always,exit -F arch=b32 -F path=/etc/slackpkg/slackpkg.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/slackpkg/slackpkg.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

## ZeroInstall
### T1072_Software_Deployment_Tools
### https://docs.0install.net/

-a always,exit -F arch=b32 -F dir=/etc/0install/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/0install/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## Pisi
### T1072_Software_Deployment_Tools
### https://wiki.pisilinux.org/wiki/Package_Management

-a always,exit -F arch=b32 -F path=/etc/pisi.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/pisi.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

## Aurman
### T1072_Software_Deployment_Tools
### https://github.com/polygamma/aurman#usage

-a always,exit -F arch=b32 -F path=/etc/aurman.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/aurman.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

## Pkg (FreeBSD)
### T1072_Software_Deployment_Tools
### https://www.freebsd.org/cgi/man.cgi?query=pkg&sektion=8

-a always,exit -F arch=b32 -F path=/usr/local/etc/pkg.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/etc/pkg.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

## Opkg
### T1072_Software_Deployment_Tools
### https://openwrt.org/docs/guide-user/additional-software/opkg

-a always,exit -F arch=b32 -F path=/etc/opkg/opkg.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/opkg/opkg.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

## Pkg_Add (OpenBSD)
### T1072_Software_Deployment_Tools
### https://man.openbsd.org/pkg_info.1

-a always,exit -F arch=b32 -F path=/etc/pkg.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/pkg.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

## Pkgin (NetBSD)
### T1072_Software_Deployment_Tools
### https://pkgin.net/

-a always,exit -F arch=b32 -F path=/usr/pkg/etc/pkgin/repositories.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/pkg/etc/pkgin/repositories.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

## Ipkg
### T1072_Software_Deployment_Tools
### https://git.yoctoproject.org/ipkg-utils/

-a always,exit -F arch=b32 -F path=/etc/ipkg.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/ipkg.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

## Swupd (Clear Linux)
### T1072_Software_Deployment_Tools
### https://www.clearlinux.org/clear-linux-documentation/guides/clear/swupd.html#updates

-a always,exit -F arch=b32 -F path=/usr/share/clear/config/swupd.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/share/clear/config/swupd.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

## Yay (Yet Another Yogurt, AUR Helper for Arch Linux)
### T1072_Software_Deployment_Tools
### https://github.com/Jguer/yay#usage

-a always,exit -F arch=b32 -F path=/etc/pacman.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/pacman.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/pacman.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/pacman.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## Equo (Entropy, Sabayon Linux)
### T1072_Software_Deployment_Tools
### https://www.sabayon.org/

-a always,exit -F arch=b32 -F dir=/etc/entropy/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/entropy/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## SliTaz Tazpkg
### T1072_Software_Deployment_Tools
### http://doc.slitaz.org/en:handbook:packages

# Monitor changes to installed package receipts and metadata
-a always,exit -F arch=b32 -F dir=/var/lib/tazpkg/installed/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/var/lib/tazpkg/installed/ -F perm=wa -F key=T1072_Software_Deployment_Tools

# Monitor changes to Cookutils config (if used)
-a always,exit -F arch=b32 -F path=/etc/slitaz/cook.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/slitaz/cook.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

# (Optional) Monitor the Tazpkg log for tampering
-a always,exit -F arch=b32 -F path=/var/log/slitaz/tazpkg.log -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/var/log/slitaz/tazpkg.log -F perm=wa -F key=T1072_Software_Deployment_Tools

## KISS Linux
### T1072_Software_Deployment_Tools
### https://k1ss.org/package-manager

# Monitor changes to installed package manifests and metadata
-a always,exit -F arch=b32 -F dir=/var/db/kiss/installed/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/var/db/kiss/installed/ -F perm=wa -F key=T1072_Software_Deployment_Tools

# Monitor changes to the main repo config
-a always,exit -F arch=b32 -F path=/etc/kiss-repo.conf -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/kiss-repo.conf -F perm=wa -F key=T1072_Software_Deployment_Tools

# (Optional) Monitor the KISS cache for tampering
-a always,exit -F arch=b32 -F dir=/var/cache/kiss/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/var/cache/kiss/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## X Binary Package System (XBPS installs, Void Linux)
### T1072_Software_Deployment_Tools
### https://github.com/void-linux/xbps
### Repositories can be declared in a configuration file of the configuration or system configuration directories:
### <sysconfdir>/xbps.d - The configuration directory (set to /etc/xbps.d)
### <sharedir>/xbps.d - The system directory (set to /usr/share/xbps.d)

-a always,exit -F arch=b32 -F path=/usr/bin/xbps -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/xbps -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/xbps -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/xbps -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/xbps.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/xbps.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/usr/share/xbps.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/usr/share/xbps.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## brew on macOS (brew installs)
### T1072_Software_Deployment_Tools
### https://brew.sh
-a always,exit -F arch=b32 -F path=/bin/brew -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/brew -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/brew -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/brew -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/brew -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/brew -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/brew -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/brew -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/brew -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/brew -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/brew -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/brew -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/brew -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/brew -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/brew -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/brew -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/usr/local/etc/brew/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/usr/local/etc/brew/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/usr/local/Homebrew/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/usr/local/Homebrew/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## Flatpak
### T1072_Software_Deployment_Tools
### https://docs.flatpak.org
-a always,exit -F arch=b32 -F dir=/etc/flatpak/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/flatpak/ -F perm=wa -F key=T1072_Software_Deployment_Tools

#### flatpak
-a always,exit -F arch=b32 -F path=/bin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/flatpak -F perm=x -F key=T1072_Software_Deployment_Tools

## Snap
### T1072_Software_Deployment_Tools
### https://snapcraft.io/docs

-a always,exit -F arch=b32 -F dir=/etc/snap/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/snap/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## Nix/NixOS
### T1072_Software_Deployment_Tools
### https://nixos.org/manual/nix/stable

-a always,exit -F arch=b32 -F path=/etc/nixos/configuration.nix -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/nixos/configuration.nix -F perm=wa -F key=T1072_Software_Deployment_Tools

# Special Software

## IBM Bigfix BESClient
### T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S open -F dir=/opt/BESClient/ -F success=0 -F key=soft_besclient
-a always,exit -F arch=b64 -S open -F dir=/opt/BESClient/ -F success=0 -F key=soft_besclient

-a always,exit -F arch=b32 -F dir=/var/opt/BESClient/ -F perm=wa -F key=soft_besclient
-a always,exit -F arch=b64 -F dir=/var/opt/BESClient/ -F perm=wa -F key=soft_besclient

## Ansible
### T1072_Software_Deployment_Tools
### https://docs.ansible.com/ansible/latest/reference_appendices/config.html
-a always,exit -F arch=b32 -F path=/etc/ansible/ansible.cfg -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/etc/ansible/ansible.cfg -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/ansible/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/ansible/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/usr/share/ansible/collections/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/usr/share/ansible/collections/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## ansible
-a always,exit -F arch=b32 -F path=/bin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/ansible -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/ansible -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/ansible -F perm=x -F key=T1072_Software_Deployment_Tools

### ansible-playbook
-a always,exit -F arch=b32 -F path=/bin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/ansible-playbook -F perm=x -F key=T1072_Software_Deployment_Tools

### ansible-test
-a always,exit -F arch=b32 -F path=/bin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/ansible-test -F perm=x -F key=T1072_Software_Deployment_Tools

### ansible-vault
-a always,exit -F arch=b32 -F path=/bin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/bin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/sbin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/sbin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/ansible-vault -F perm=x -F key=T1072_Software_Deployment_Tools

### Monitor file open/access for .ansible directory
-a always,exit -F arch=b32 -F dir=/root/.ansible/ -S openat,open -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/root/.ansible/ -S openat,open -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/home/vagrant/.ansible/ -S openat,open -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/home/vagrant/.ansible/ -S openat,open -F perm=wa -F key=T1072_Software_Deployment_Tools

### Ansible AWX
-a always,exit -F arch=b32 -F dir=/var/lib/awx/projects/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/var/lib/awx/projects/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## Terraform
### Monitoring Execution of Terraform Commands
-a always,exit -F arch=b32 -S execve -F path=/bin/terraform -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/bin/terraform -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S execve -F path=/sbin/terraform -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/sbin/terraform -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S execve -F path=/usr/bin/terraform -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/terraform -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S execve -F path=/usr/sbin/terraform -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/terraform -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S execve -F path=/usr/local/bin/terraform -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/usr/local/bin/terraform -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S execve -F path=/usr/local/sbin/terraform -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/usr/local/sbin/terraform -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

### Monitoring Changes to Terraform Configuration and State Files
-a always,exit -F arch=b32 -F dir=/etc/terraform/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/terraform/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

## OpenTofu
### Monitoring Execution of OpenTofu Commands
-a always,exit -F arch=b32 -S execve -F path=/bin/tofu -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/bin/tofu -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S execve -F path=/sbin/tofu -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/sbin/tofu -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S execve -F path=/usr/bin/tofu -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/tofu -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S execve -F path=/usr/sbin/tofu -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/tofu -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S execve -F path=/usr/local/bin/tofu -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/usr/local/bin/tofu -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S execve -F path=/usr/local/sbin/tofu -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/usr/local/sbin/tofu -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

### Monitoring Changes to OpenTofu Configuration and State Files
-a always,exit -F arch=b32 -F dir=/etc/opentofu/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/opentofu/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/etc/tofu/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/tofu/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

## Pulumi
### Monitoring Pulumi CLI Executions
-a always,exit -F arch=b32 -S execve -F path=/usr/bin/pulumi -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/pulumi -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S execve -F path=/usr/sbin/pulumi -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/pulumi -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S execve -F path=/usr/local/bin/pulumi -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/usr/local/bin/pulumi -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -S execve -F path=/usr/local/sbin/pulumi -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -S execve -F path=/usr/local/sbin/pulumi -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

### Monitoring Changes to Pulumi Configuration, Project, and State Files
-a always,exit -F arch=b64 -F dir=/etc/pulumi/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b32 -F dir=/etc/pulumi/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=T1072_Software_Deployment_Tools

## CHEF
### T1072_Software_Deployment_Tools
### https://www.chef.io/chef/

-a always,exit -F arch=b32 -F dir=/etc/chef/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/chef/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## Puppet
### T1072_Software_Deployment_Tools
### https://puppet.com
### https://github.com/puppetlabs/docs-archive
### https://serverfault.com/questions/846267/is-etc-puppetlabs-puppet-puppet-conf-on-puppet4-equivilent-to-etc-puppet-puppe

### Puppet Node
-a always,exit -F arch=b32 -F dir=/etc/puppet/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/puppet/ -F perm=wa -F key=T1072_Software_Deployment_Tools

#### GDS specific secrets
-a always,exit -F arch=b32 -F dir=/etc/puppet/ssl/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/puppet/ssl/ -F perm=wa -F key=T1072_Software_Deployment_Tools

### Puppet Server
#### https://www.puppet.com/docs/puppet/7/server/configuration#webserverconf
-a always,exit -F arch=b32 -F dir=/etc/puppetlabs/puppetserver/conf.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/puppetlabs/puppetserver/conf.d/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## Salt
### T1072_Software_Deployment_Tools
### https://saltproject.io
### https://docs.saltproject.io/en/latest/ref/configuration/master.html

-a always,exit -F arch=b32 -F dir=/etc/salt/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/salt/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/usr/local/etc/salt/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/usr/local/etc/salt/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## Otter
### T1072_Software_Deployment_Tools
### https://inedo.com/otter

-a always,exit -F arch=b32 -F dir=/etc/otter/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/etc/otter/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## Pulumi
### T1072_Software_Deployment_Tools
### https://www.pulumi.com/docs/install/
-a always,exit -F arch=b32 -F dir=/usr/bin/pulumi/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/usr/bin/pulumi/ -F perm=wa -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F dir=/usr/sbin/pulumi/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/usr/sbin/pulumi/ -F perm=wa -F key=T1072_Software_Deployment_Tools

#### macOS
-a always,exit -F arch=b32 -F dir=/usr/local/bin/pulumi/ -F perm=wa -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F dir=/usr/local/bin/pulumi/ -F perm=wa -F key=T1072_Software_Deployment_Tools

## Go
### T1072_Software_Deployment_Tools
-a always,exit -F arch=b32 -F path=/usr/bin/go -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/go -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/go -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/go -F perm=x -F key=T1072_Software_Deployment_Tools

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/go -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/go -F perm=x -F key=T1072_Software_Deployment_Tools

## Nim
### T1072_Software_Deployment_Tools
-a always,exit -F arch=b32 -F path=/usr/bin/nim -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/nim -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/nim -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/nim -F perm=x -F key=T1072_Software_Deployment_Tools

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/nim -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/nim -F perm=x -F key=T1072_Software_Deployment_Tools

## Ruby
### T1072_Software_Deployment_Tools
-a always,exit -F arch=b32 -F path=/usr/bin/ruby -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ruby -F perm=x -F key=T1072_Software_Deployment_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/ruby -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/ruby -F perm=x -F key=T1072_Software_Deployment_Tools

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/ruby -F perm=x -F key=T1072_Software_Deployment_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/ruby -F perm=x -F key=T1072_Software_Deployment_Tools

## Kubelet
-a always,exit -F arch=b32 -F path=/usr/bin/kubelet -F key=kubelet
-a always,exit -F arch=b64 -F path=/usr/bin/kubelet -F key=kubelet

-a always,exit -F arch=b32 -F path=/usr/sbin/kubelet -F key=kubelet
-a always,exit -F arch=b64 -F path=/usr/sbin/kubelet -F key=kubelet

# update-ca
-a always,exit -F arch=b32 -F path=/usr/bin/update-ca-trust -F perm=x -F key=update-ca-trust
-a always,exit -F arch=b64 -F path=/usr/bin/update-ca-trust -F perm=x -F key=update-ca-trust

-a always,exit -F arch=b32 -F path=/usr/sbin/update-ca-trust -F perm=x -F key=update-ca-trust
-a always,exit -F arch=b64 -F path=/usr/sbin/update-ca-trust -F perm=x -F key=update-ca-trust

-a always,exit -F arch=b32 -F path=/usr/bin/update-ca-certificates -F perm=x -F key=update-ca-certificates
-a always,exit -F arch=b64 -F path=/usr/bin/update-ca-certificates -F perm=x -F key=update-ca-certificates

-a always,exit -F arch=b32 -F path=/usr/sbin/update-ca-certificates -F perm=x -F key=update-ca-certificates
-a always,exit -F arch=b64 -F path=/usr/sbin/update-ca-certificates -F perm=x -F key=update-ca-certificates

# openssl (Syscall Rules Only)

## Monitor file operations on OpenSSL libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libssl.so -F perm=rwxa -S open,openat -F key=openssl_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libssl.so -F perm=rwxa -S open,openat -F key=openssl_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libssl.so.1.1 -F perm=rwxa -S open,openat -F key=openssl_lib11_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libssl.so.1.1 -F perm=rwxa -S open,openat -F key=openssl_lib11_access

-a always,exit -F arch=b32 -F path=/usr/lib/libssl.so.3 -F perm=rwxa -S open,openat -F key=openssl_lib3_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libssl.so.3 -F perm=rwxa -S open,openat -F key=openssl_lib3_access

-a always,exit -F arch=b32 -F path=/usr/lib/libcrypto.so -F perm=rwxa -S open,openat -F key=openssl_crypto_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libcrypto.so -F perm=rwxa -S open,openat -F key=openssl_crypto_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libcrypto.so.1.1 -F perm=rwxa -S open,openat -F key=openssl_crypto11_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libcrypto.so.1.1 -F perm=rwxa -S open,openat -F key=openssl_crypto11_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libcrypto.so.3 -F perm=rwxa -S open,openat -F key=openssl_crypto3_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libcrypto.so.3 -F perm=rwxa -S open,openat -F key=openssl_crypto3_lib_access

-a always,exit -F arch=b32 -F path=/usr/local/lib/libssl.so -F perm=rwxa -S open,openat -F key=openssl_lib_access
-a always,exit -F arch=b64 -F path=/usr/local/lib64/libssl.so -F perm=rwxa -S open,openat -F key=openssl_lib_access

-a always,exit -F arch=b32 -F path=/usr/local/lib/libcrypto.so -F perm=rwxa -S open,openat -F key=openssl_crypto_lib_access
-a always,exit -F arch=b64 -F path=/usr/local/lib64/libcrypto.so -F perm=rwxa -S open,openat -F key=openssl_crypto_lib_access

## Monitor OpenSSL header files
-a always,exit -F arch=b32 -F dir=/usr/include/openssl/ -F perm=r -S open,openat -F key=openssl_headers
-a always,exit -F arch=b64 -F dir=/usr/include/openssl/ -F perm=r -S open,openat -F key=openssl_headers

-a always,exit -F arch=b32 -F dir=/usr/local/include/openssl/ -F perm=r -S open,openat -F key=openssl_headers
-a always,exit -F arch=b64 -F dir=/usr/local/include/openssl/ -F perm=r -S open,openat -F key=openssl_headers

## Monitor execve calls for OpenSSL binaries
-a always,exit -F arch=b32 -F path=/usr/bin/openssl -S execve -F key=openssl_exec
-a always,exit -F arch=b64 -F path=/usr/bin/openssl -S execve -F key=openssl_exec

-a always,exit -F arch=b32 -F path=/usr/local/bin/openssl -S execve -F key=openssl_exec
-a always,exit -F arch=b64 -F path=/usr/local/bin/openssl -S execve -F key=openssl_exec

-a always,exit -F arch=b32 -F path=/usr/bin/c_rehash -S execve -F key=openssl_crehash_exec
-a always,exit -F arch=b64 -F path=/usr/bin/c_rehash -S execve -F key=openssl_crehash_exec

## Monitor socket creation for SSL/TLS
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=1 -F success=1 -F key=openssl_tcp_socket
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=1 -F success=1 -F key=openssl_tcp_socket

-a always,exit -F arch=b32 -S socket -F a0=10 -F a1=1 -F success=1 -F key=openssl_tcp6_socket
-a always,exit -F arch=b64 -S socket -F a0=10 -F a1=1 -F success=1 -F key=openssl_tcp6_socket

-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=2 -F success=1 -F key=openssl_udp_socket
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=2 -F success=1 -F key=openssl_udp_socket

## Monitor bind calls on SSL/TLS and DTLS ports
-a always,exit -F arch=b32 -S bind -F exit=0 -F key=openssl_bind_success
-a always,exit -F arch=b64 -S bind -F exit=0 -F key=openssl_bind_success

## Monitor listen calls (for server applications)
-a always,exit -F arch=b32 -S listen -F success=1 -F key=openssl_listen
-a always,exit -F arch=b64 -S listen -F success=1 -F key=openssl_listen

## Monitor accept/accept4 calls (incoming connections)
-a always,exit -F arch=b32 -S accept,accept4 -F success=1 -F key=openssl_accept
-a always,exit -F arch=b64 -S accept,accept4 -F success=1 -F key=openssl_accept

## Monitor connect calls (outgoing connections)
-a always,exit -F arch=b32 -S connect -F success=1 -F key=openssl_connect_success
-a always,exit -F arch=b64 -S connect -F success=1 -F key=openssl_connect_success

-a always,exit -F arch=b32 -S connect -F exit=-ECONNREFUSED -F key=openssl_connect_refused
-a always,exit -F arch=b64 -S connect -F exit=-ECONNREFUSED -F key=openssl_connect_refused

-a always,exit -F arch=b64 -S connect -F exit=-ETIMEDOUT -F key=openssl_connect_timeout

## Monitor certificate and key file operations
-a always,exit -F arch=b32 -F dir=/etc/ssl/certs/ -F perm=r -S open,openat -F key=openssl_cert_read
-a always,exit -F arch=b64 -F dir=/etc/ssl/certs/ -F perm=r -S open,openat -F key=openssl_cert_read

-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -F perm=r -S open,openat -F key=openssl_key_read
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -F perm=r -S open,openat -F key=openssl_key_read

-a always,exit -F arch=b32 -F dir=/etc/pki/tls/ -F perm=r -S open,openat -F key=openssl_pki_tls_access
-a always,exit -F arch=b64 -F dir=/etc/pki/tls/ -F perm=r -S open,openat -F key=openssl_pki_tls_access

-a always,exit -F arch=b32 -F dir=/etc/pki/ca-trust/ -F perm=r -S open,openat -F key=openssl_ca_trust_access
-a always,exit -F arch=b64 -F dir=/etc/pki/ca-trust/ -F perm=r -S open,openat -F key=openssl_ca_trust_access

## Monitor failed access to sensitive directories
-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EACCES -F key=openssl_key_denied
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EACCES -F key=openssl_key_denied

-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EPERM -F key=openssl_key_denied
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EPERM -F key=openssl_key_denied

## Monitor OpenSSL configuration files
-a always,exit -F arch=b32 -F path=/etc/ssl/openssl.cnf -F perm=rwa -S open,openat -F key=openssl_config_file
-a always,exit -F arch=b64 -F path=/etc/ssl/openssl.cnf -F perm=rwa -S open,openat -F key=openssl_config_file

-a always,exit -F arch=b32 -F path=/usr/lib/ssl/openssl.cnf -F perm=rwa -S open,openat -F key=openssl_config_file
-a always,exit -F arch=b64 -F path=/usr/lib/ssl/openssl.cnf -F perm=rwa -S open,openat -F key=openssl_config_file

-a always,exit -F arch=b32 -F dir=/usr/lib/ssl/certs/ -F perm=r -S open,openat -F key=openssl_certs_dir
-a always,exit -F arch=b64 -F dir=/usr/lib/ssl/certs/ -F perm=r -S open,openat -F key=openssl_certs_dir

## Monitor memory mapping of crypto libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libssl.so -S mmap,mprotect -F key=openssl_lib_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libssl.so -S mmap,mprotect -F key=openssl_lib_mmap

-a always,exit -F arch=b32 -F path=/usr/lib/libcrypto.so -S mmap,mprotect -F key=openssl_crypto_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libcrypto.so -S mmap,mprotect -F key=openssl_crypto_mmap

## Monitor random number generation access
-a always,exit -F arch=b32 -F path=/dev/random -F perm=r -S open,openat -F key=openssl_random
-a always,exit -F arch=b64 -F path=/dev/random -F perm=r -S open,openat -F key=openssl_random

-a always,exit -F arch=b32 -F path=/dev/urandom -F perm=r -S open,openat -F key=openssl_urandom
-a always,exit -F arch=b64 -F path=/dev/urandom -F perm=r -S open,openat -F key=openssl_urandom

-a always,exit -F arch=b32 -S getrandom -F key=openssl_getrandom
-a always,exit -F arch=b64 -S getrandom -F key=openssl_getrandom

## Monitor OpenSSL random seed files
-a always,exit -F arch=b32 -F path=/home/vagrant/.rnd -F perm=rw -S open,openat -F key=openssl_rnd_seed
-a always,exit -F arch=b64 -F path=/home/vagrant/.rnd -F perm=rw -S open,openat -F key=openssl_rnd_seed

-a always,exit -F arch=b32 -F path=/root/.rnd -F perm=rw -S open,openat -F key=openssl_rnd_seed
-a always,exit -F arch=b64 -F path=/root/.rnd -F perm=rw -S open,openat -F key=openssl_rnd_seed

-a always,exit -F arch=b32 -F dir=/home/ -F path=.rnd -F perm=rw -S open,openat -F key=openssl_user_rnd_seed
-a always,exit -F arch=b64 -F dir=/home/ -F path=.rnd -F perm=rw -S open,openat -F key=openssl_user_rnd_seed

## Monitor shared memory operations (for session caching)
-a always,exit -F arch=b32 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -S shmctl -F key=T1559_Inter-Process_Communication

## Example with exe filter: Monitor shared memory from OpenSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/apache2 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/sbin/apache2 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -F exe=/usr/sbin/postfix -S shmctl -F key=T1559_Inter-Process_Communication

## Monitor semaphore operations (for thread synchronization)
-a always,exit -F arch=b32 -S semget,semop,semctl -F key=openssl_semaphore
-a always,exit -F arch=b64 -S semget,semop,semctl -F key=openssl_semaphore

## Example with exe filter: Monitor semaphore operations from OpenSSL servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/apache2 -S semget,semop,semctl -F key=openssl_apache_semaphore
-a always,exit -F arch=b64 -F exe=/usr/sbin/apache2 -S semget,semop,semctl -F key=openssl_apache_semaphore

-a always,exit -F arch=b32 -F exe=/usr/sbin/dovecot -S semget,semop,semctl -F key=openssl_dovecot_semaphore
-a always,exit -F arch=b64 -F exe=/usr/sbin/dovecot -S semget,semop,semctl -F key=openssl_dovecot_semaphore

## Monitor file descriptor operations
-a always,exit -F arch=b32 -S dup,dup2,dup3 -F success=1 -F key=openssl_fd_dup
-a always,exit -F arch=b64 -S dup,dup2,dup3 -F success=1 -F key=openssl_fd_dup

-a always,exit -F arch=b64 -S fcntl -F a1=1 -F key=openssl_fcntl_dupfd
-a always,exit -F arch=b64 -S fcntl -F a1=2 -F key=openssl_fcntl_setfd

## Example with exe filter: Monitor FD operations from OpenSSL applications
-a always,exit -F arch=b32 -F exe=/usr/bin/curl -S dup,dup2,dup3 -F success=1 -F key=openssl_curl_fd_dup
-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S dup,dup2,dup3 -F success=1 -F key=openssl_curl_fd_dup

#-a always,exit -F arch=b64 -F exe=/usr/bin/wget -S fcntl -F a1=1 -F key=openssl_wget_fcntl_dupfd
-a always,exit -F arch=b64 -F exe=/usr/sbin/sshd -S fcntl -F a1=2 -F key=openssl_sshd_fcntl_setfd

## Monitor socket options
-a always,exit -F arch=b32 -S setsockopt -F success=1 -F key=openssl_setsockopt
-a always,exit -F arch=b64 -S setsockopt -F success=1 -F key=openssl_setsockopt

-a always,exit -F arch=b64 -S getsockopt -F success=1 -F key=openssl_getsockopt

## Example with exe filter: Monitor socket options from OpenSSL clients
-a always,exit -F arch=b32 -F exe=/usr/bin/curl -S setsockopt -F success=1 -F key=openssl_curl_setsockopt
-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S setsockopt -F success=1 -F key=openssl_curl_setsockopt

#-a always,exit -F arch=b64 -F exe=/usr/bin/wget -S getsockopt -F success=1 -F key=openssl_wget_getsockopt
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S setsockopt -F success=1 -F key=openssl_nginx_setsockopt

## Monitor I/O operations on sockets
-a always,exit -F arch=b32 -S sendto,sendmsg -F success=1 -F key=openssl_send
-a always,exit -F arch=b64 -S sendto,sendmsg -F success=1 -F key=openssl_send

-a always,exit -F arch=b32 -S recvfrom,recvmsg -F success=1 -F key=openssl_recv
-a always,exit -F arch=b64 -S recvfrom,recvmsg -F success=1 -F key=openssl_recv

-a always,exit -F arch=b64 -S read,write -F success=1 -F key=openssl_io

## Example with exe filter: Monitor I/O from OpenSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/apache2 -S sendto,sendmsg -F success=1 -F key=openssl_apache_send
-a always,exit -F arch=b64 -F exe=/usr/sbin/apache2 -S sendto,sendmsg -F success=1 -F key=openssl_apache_send

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S recvfrom,recvmsg -F success=1 -F key=openssl_nginx_recv
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S recvfrom,recvmsg -F success=1 -F key=openssl_nginx_recv

-a always,exit -F arch=b64 -F exe=/usr/sbin/postfix -S read,write -F success=1 -F key=openssl_postfix_io

## Monitor poll/select operations (for async I/O)
-a always,exit -F arch=b32 -S poll,select -F success=1 -F key=openssl_poll
-a always,exit -F arch=b64 -S poll,ppoll,select,pselect6 -F success=1 -F key=openssl_poll

## Example with exe filter: Monitor async I/O from OpenSSL servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/apache2 -S poll,select -F success=1 -F key=openssl_apache_poll
-a always,exit -F arch=b64 -F exe=/usr/sbin/apache2 -S poll,ppoll,select,pselect6 -F success=1 -F key=openssl_apache_poll

-a always,exit -F arch=b32 -F exe=/usr/sbin/redis-server -S poll,select -F success=1 -F key=openssl_redis_poll
-a always,exit -F arch=b64 -F exe=/usr/sbin/redis-server -S poll,ppoll,select,pselect6 -F success=1 -F key=openssl_redis_poll

## Monitor epoll operations (for high-performance servers)
-a always,exit -F arch=b32 -S epoll_create -F success=1 -F key=openssl_epoll_create
-a always,exit -F arch=b64 -S epoll_create,epoll_create1 -F success=1 -F key=openssl_epoll_create

-a always,exit -F arch=b64 -S epoll_ctl -F success=1 -F key=openssl_epoll_ctl
-a always,exit -F arch=b64 -S epoll_wait,epoll_pwait -F success=1 -F key=openssl_epoll_wait

## Example with exe filter: Monitor epoll from OpenSSL-enabled servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S epoll_create -F success=1 -F key=openssl_nginx_epoll_create
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S epoll_create,epoll_create1 -F success=1 -F key=openssl_nginx_epoll_create

-a always,exit -F arch=b64 -F exe=/usr/sbin/haproxy -S epoll_ctl -F success=1 -F key=openssl_haproxy_epoll_ctl
-a always,exit -F arch=b64 -F exe=/usr/bin/node -S epoll_wait,epoll_pwait -F success=1 -F key=openssl_node_epoll_wait

## Monitor privilege changes
-a always,exit -F arch=b32 -S setuid,setreuid -F success=1 -F key=openssl_setuid
-a always,exit -F arch=b64 -S setuid,setreuid,setresuid -F success=1 -F key=openssl_setuid

-a always,exit -F arch=b32 -S setgid,setregid -F success=1 -F key=openssl_setgid
-a always,exit -F arch=b64 -S setgid,setregid,setresgid -F success=1 -F key=openssl_setgid

## Example with exe filter: Monitor privilege drops from OpenSSL services
-a always,exit -F arch=b32 -F exe=/usr/sbin/apache2 -S setuid,setreuid -F success=1 -F key=openssl_apache_setuid
-a always,exit -F arch=b64 -F exe=/usr/sbin/apache2 -S setuid,setreuid,setresuid -F success=1 -F key=openssl_apache_setuid

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S setgid,setregid -F success=1 -F key=openssl_nginx_setgid
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S setgid,setregid,setresgid -F success=1 -F key=openssl_nginx_setgid

-a always,exit -F arch=b64 -F exe=/usr/sbin/postfix -S setuid,setreuid,setresuid -F success=1 -F key=openssl_postfix_setuid

## Monitor capability changes
-a always,exit -F arch=b32 -S capset -F success=1 -F key=openssl_capabilities
-a always,exit -F arch=b64 -S capset -F success=1 -F key=openssl_capabilities

## Example with exe filter: Monitor capability changes from OpenSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/apache2 -S capset -F success=1 -F key=openssl_apache_capabilities
-a always,exit -F arch=b64 -F exe=/usr/sbin/apache2 -S capset -F success=1 -F key=openssl_apache_capabilities

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S capset -F success=1 -F key=openssl_nginx_capabilities
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S capset -F success=1 -F key=openssl_nginx_capabilities

## Monitor process creation and termination
-a always,exit -F arch=b32 -S clone,fork,vfork -F success=1 -F key=openssl_process_create
-a always,exit -F arch=b64 -S clone,fork,vfork -F success=1 -F key=openssl_process_create

-a always,exit -F arch=b64 -S exit,exit_group -F key=openssl_process_exit

## Example with exe filter: Monitor process operations from OpenSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/apache2 -S clone,fork,vfork -F success=1 -F key=openssl_apache_fork
-a always,exit -F arch=b64 -F exe=/usr/sbin/apache2 -S clone,fork,vfork -F success=1 -F key=openssl_apache_fork

-a always,exit -F arch=b32 -F exe=/usr/sbin/postfix -S clone,fork,vfork -F success=1 -F key=openssl_postfix_fork
-a always,exit -F arch=b64 -F exe=/usr/sbin/postfix -S clone,fork,vfork -F success=1 -F key=openssl_postfix_fork

-a always,exit -F arch=b64 -F exe=/usr/bin/openssl -S exit,exit_group -F key=openssl_tool_exit

## Monitor signal handling (for graceful shutdown)
-a always,exit -F arch=b32 -S kill,tkill,tgkill -F a1=15 -F key=openssl_sigterm
-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=15 -F key=openssl_sigterm

-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=2 -F key=openssl_sigint

## Example with exe filter: Monitor signals to/from OpenSSL applications
-a always,exit -F arch=b32 -F exe=/usr/bin/systemctl -S kill,tkill,tgkill -F a1=15 -F key=openssl_systemctl_sigterm
-a always,exit -F arch=b64 -F exe=/usr/bin/systemctl -S kill,tkill,tgkill -F a1=15 -F key=openssl_systemctl_sigterm

-a always,exit -F arch=b32 -F exe=/usr/sbin/service -S kill,tkill,tgkill -F a1=15 -F key=openssl_service_sigterm
-a always,exit -F arch=b64 -F exe=/usr/sbin/service -S kill,tkill,tgkill -F a1=15 -F key=openssl_service_sigterm

-a always,exit -F arch=b64 -F exe=/usr/bin/killall -S kill,tkill,tgkill -F a1=2 -F key=openssl_killall_sigint

## Monitor time operations (for certificate validity checking)
-a always,exit -F arch=b32 -S clock_gettime -F a0=0 -F key=openssl_clock_realtime
-a always,exit -F arch=b64 -S clock_gettime -F a0=0 -F key=openssl_clock_realtime

-a always,exit -F arch=b64 -S gettimeofday -F key=openssl_gettimeofday

## Example with exe filter: Monitor time operations from OpenSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/apache2 -S clock_gettime -F a0=0 -F key=openssl_apache_time
-a always,exit -F arch=b64 -F exe=/usr/sbin/apache2 -S clock_gettime -F a0=0 -F key=openssl_apache_time

-a always,exit -F arch=b32 -F exe=/usr/bin/curl -S clock_gettime -F a0=0 -F key=openssl_curl_time
-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S clock_gettime -F a0=0 -F key=openssl_curl_time

-a always,exit -F arch=b64 -F exe=/usr/bin/openssl -S gettimeofday -F key=openssl_tool_time

## Monitor memory operations
-a always,exit -F arch=b32 -S mlock,mlockall -F success=1 -F key=openssl_mlock
-a always,exit -F arch=b64 -S mlock,mlock2,mlockall -F success=1 -F key=openssl_mlock

-a always,exit -F arch=b64 -S munlock,munlockall -F success=1 -F key=openssl_munlock

## Monitor namespace operations (for containerized deployments)
-a always,exit -F arch=b32 -S setns,unshare -F success=1 -F key=openssl_namespace
-a always,exit -F arch=b64 -S setns,unshare -F success=1 -F key=openssl_namespace

## Monitor chroot operations (for jailed environments)
-a always,exit -F arch=b32 -S chroot -F key=openssl_chroot
-a always,exit -F arch=b64 -S chroot -F key=openssl_chroot

## Monitor library loading
-a always,exit -F arch=b32 -F dir=/lib/ -F path=libssl -S open,openat -F key=openssl_lib_load
-a always,exit -F arch=b32 -F dir=/usr/lib/ -F path=libssl -S open,openat -F key=openssl_lib_load

-a always,exit -F arch=b64 -F dir=/lib64/ -F path=libssl -S open,openat -F key=openssl_lib_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/ -F path=libssl -S open,openat -F key=openssl_lib_load

-a always,exit -F arch=b32 -F dir=/lib/ -F path=libcrypto -S open,openat -F key=openssl_crypto_load
-a always,exit -F arch=b32 -F dir=/usr/lib/ -F path=libcrypto -S open,openat -F key=openssl_crypto_load

-a always,exit -F arch=b64 -F dir=/lib64/ -F path=libcrypto -S open,openat -F key=openssl_crypto_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/ -F path=libcrypto -S open,openat -F key=openssl_crypto_load

## Monitor engine loading (OpenSSL 1.x)
-a always,exit -F arch=b32 -F dir=/usr/lib/engines/ -F perm=r -S open,openat -F key=openssl_engines
-a always,exit -F arch=b64 -F dir=/usr/lib64/engines/ -F perm=r -S open,openat -F key=openssl_engines

-a always,exit -F arch=b32 -F dir=/usr/lib/engines-1.1/ -F perm=r -S open,openat -F key=openssl_engines11
-a always,exit -F arch=b64 -F dir=/usr/lib64/engines-1.1/ -F perm=r -S open,openat -F key=openssl_engines11

## Monitor provider loading (OpenSSL 3.x)
-a always,exit -F arch=b32 -F dir=/usr/lib/ossl-modules/ -F perm=r -S open,openat -F key=openssl_providers
-a always,exit -F arch=b64 -F dir=/usr/lib64/ossl-modules/ -F perm=r -S open,openat -F key=openssl_providers

## Monitor FIPS module operations
-a always,exit -F arch=b32 -F path=/usr/lib/ossl-modules/fips.so -F perm=r -S open,openat -F key=openssl_fips_module
-a always,exit -F arch=b64 -F path=/usr/lib64/ossl-modules/fips.so -F perm=r -S open,openat -F key=openssl_fips_module

-a always,exit -F arch=b32 -F path=/etc/ssl/fipsmodule.cnf -F perm=r -S open,openat -F key=openssl_fips_config
-a always,exit -F arch=b64 -F path=/etc/ssl/fipsmodule.cnf -F perm=r -S open,openat -F key=openssl_fips_config

## Monitor application-specific paths
-a always,exit -F arch=b32 -F dir=/var/lib/openssl/ -F perm=rwa -S open,openat -F key=openssl_var_lib
-a always,exit -F arch=b64 -F dir=/var/lib/openssl/ -F perm=rwa -S open,openat -F key=openssl_var_lib

-a always,exit -F arch=b32 -F dir=/opt/openssl/ -F perm=rwa -S open,openat -F key=openssl_opt
-a always,exit -F arch=b64 -F dir=/opt/openssl/ -F perm=rwa -S open,openat -F key=openssl_opt

## Monitor web server OpenSSL usage
-a always,exit -F arch=b32 -F exe=/usr/sbin/apache2 -S open,openat -F path=libssl -F key=openssl_apache_load
-a always,exit -F arch=b64 -F exe=/usr/sbin/apache2 -S open,openat -F path=libssl -F key=openssl_apache_load

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S open,openat -F path=libssl -F key=openssl_nginx_load
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S open,openat -F path=libssl -F key=openssl_nginx_load

## Monitor mail server OpenSSL usage
-a always,exit -F arch=b32 -F exe=/usr/sbin/postfix -S open,openat -F path=libssl -F key=openssl_postfix_load
-a always,exit -F arch=b64 -F exe=/usr/sbin/postfix -S open,openat -F path=libssl -F key=openssl_postfix_load

-a always,exit -F arch=b32 -F exe=/usr/sbin/dovecot -S open,openat -F path=libssl -F key=openssl_dovecot_load
-a always,exit -F arch=b64 -F exe=/usr/sbin/dovecot -S open,openat -F path=libssl -F key=openssl_dovecot_load

## Monitor database OpenSSL usage
-a always,exit -F arch=b32 -F exe=/usr/sbin/mysqld -S open,openat -F path=libssl -F key=openssl_mysql_load
-a always,exit -F arch=b64 -F exe=/usr/sbin/mysqld -S open,openat -F path=libssl -F key=openssl_mysql_load

-a always,exit -F arch=b32 -F exe=/usr/bin/postgres -S open,openat -F path=libssl -F key=openssl_postgres_load
-a always,exit -F arch=b64 -F exe=/usr/bin/postgres -S open,openat -F path=libssl -F key=openssl_postgres_load

## Monitor VPN OpenSSL usage
-a always,exit -F arch=b32 -F exe=/usr/sbin/openvpn -S open,openat -F path=libssl -F key=openssl_openvpn_load
-a always,exit -F arch=b64 -F exe=/usr/sbin/openvpn -S open,openat -F path=libssl -F key=openssl_openvpn_load

# LibreSSL (Syscall Rules Only)

## Monitor file operations on LibreSSL libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libssl.so -F perm=rwxa -S open,openat -F key=libressl_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libssl.so -F perm=rwxa -S open,openat -F key=libressl_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libcrypto.so -F perm=rwxa -S open,openat -F key=libressl_crypto_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libcrypto.so -F perm=rwxa -S open,openat -F key=libressl_crypto_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libtls.so -F perm=rwxa -S open,openat -F key=libressl_tls_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libtls.so -F perm=rwxa -S open,openat -F key=libressl_tls_lib_access

-a always,exit -F arch=b32 -F path=/usr/local/lib/libssl.so -F perm=rwxa -S open,openat -F key=libressl_lib_access
-a always,exit -F arch=b64 -F path=/usr/local/lib64/libssl.so -F perm=rwxa -S open,openat -F key=libressl_lib_access

-a always,exit -F arch=b32 -F path=/usr/local/lib/libcrypto.so -F perm=rwxa -S open,openat -F key=libressl_crypto_lib_access
-a always,exit -F arch=b64 -F path=/usr/local/lib64/libcrypto.so -F perm=rwxa -S open,openat -F key=libressl_crypto_lib_access

-a always,exit -F arch=b32 -F path=/usr/local/lib/libtls.so -F perm=rwxa -S open,openat -F key=libressl_tls_lib_access
-a always,exit -F arch=b64 -F path=/usr/local/lib64/libtls.so -F perm=rwxa -S open,openat -F key=libressl_tls_lib_access

## Monitor LibreSSL header files
-a always,exit -F arch=b32 -F dir=/usr/include/openssl/ -F perm=r -S open,openat -F key=libressl_headers
-a always,exit -F arch=b64 -F dir=/usr/include/openssl/ -F perm=r -S open,openat -F key=libressl_headers

-a always,exit -F arch=b32 -F dir=/usr/include/tls/ -F perm=r -S open,openat -F key=libressl_tls_headers
-a always,exit -F arch=b64 -F dir=/usr/include/tls/ -F perm=r -S open,openat -F key=libressl_tls_headers

-a always,exit -F arch=b32 -F dir=/usr/local/include/openssl/ -F perm=r -S open,openat -F key=libressl_headers
-a always,exit -F arch=b64 -F dir=/usr/local/include/openssl/ -F perm=r -S open,openat -F key=libressl_headers

-a always,exit -F arch=b32 -F dir=/usr/local/include/tls/ -F perm=r -S open,openat -F key=libressl_tls_headers
-a always,exit -F arch=b64 -F dir=/usr/local/include/tls/ -F perm=r -S open,openat -F key=libressl_tls_headers

## Monitor execve calls for LibreSSL/OpenSSL binaries
-a always,exit -F arch=b32 -F path=/usr/bin/openssl -S execve -F key=libressl_openssl_exec
-a always,exit -F arch=b64 -F path=/usr/bin/openssl -S execve -F key=libressl_openssl_exec

-a always,exit -F arch=b32 -F path=/usr/local/bin/openssl -S execve -F key=libressl_openssl_exec
-a always,exit -F arch=b64 -F path=/usr/local/bin/openssl -S execve -F key=libressl_openssl_exec

-a always,exit -F arch=b32 -F path=/usr/bin/ocspcheck -S execve -F key=libressl_ocspcheck_exec
-a always,exit -F arch=b64 -F path=/usr/bin/ocspcheck -S execve -F key=libressl_ocspcheck_exec

-a always,exit -F arch=b32 -F path=/usr/local/bin/ocspcheck -S execve -F key=libressl_ocspcheck_exec
-a always,exit -F arch=b64 -F path=/usr/local/bin/ocspcheck -S execve -F key=libressl_ocspcheck_exec

-a always,exit -F arch=b32 -F path=/usr/bin/nc -S execve -F key=libressl_nc_exec
-a always,exit -F arch=b64 -F path=/usr/bin/nc -S execve -F key=libressl_nc_exec

## Monitor socket creation for SSL/TLS
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=1 -F success=1 -F key=libressl_tcp_socket
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=1 -F success=1 -F key=libressl_tcp_socket

-a always,exit -F arch=b32 -S socket -F a0=10 -F a1=1 -F success=1 -F key=libressl_tcp6_socket
-a always,exit -F arch=b64 -S socket -F a0=10 -F a1=1 -F success=1 -F key=libressl_tcp6_socket

## Monitor bind calls on SSL/TLS ports
-a always,exit -F arch=b32 -S bind -F exit=0 -F key=libressl_bind_success
-a always,exit -F arch=b64 -S bind -F exit=0 -F key=libressl_bind_success

## Monitor listen calls (for server applications)
-a always,exit -F arch=b32 -S listen -F success=1 -F key=libressl_listen
-a always,exit -F arch=b64 -S listen -F success=1 -F key=libressl_listen

## Monitor accept/accept4 calls (incoming connections)
-a always,exit -F arch=b32 -S accept,accept4 -F success=1 -F key=libressl_accept
-a always,exit -F arch=b64 -S accept,accept4 -F success=1 -F key=libressl_accept

## Monitor connect calls (outgoing connections)
-a always,exit -F arch=b32 -S connect -F success=1 -F key=libressl_connect_success
-a always,exit -F arch=b64 -S connect -F success=1 -F key=libressl_connect_success

-a always,exit -F arch=b32 -S connect -F exit=-ECONNREFUSED -F key=libressl_connect_refused
-a always,exit -F arch=b64 -S connect -F exit=-ECONNREFUSED -F key=libressl_connect_refused

-a always,exit -F arch=b64 -S connect -F exit=-ETIMEDOUT -F key=libressl_connect_timeout

## Monitor certificate and key file operations
-a always,exit -F arch=b32 -F dir=/etc/ssl/certs/ -F perm=r -S open,openat -F key=libressl_cert_read
-a always,exit -F arch=b64 -F dir=/etc/ssl/certs/ -F perm=r -S open,openat -F key=libressl_cert_read

-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -F perm=r -S open,openat -F key=libressl_key_read
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -F perm=r -S open,openat -F key=libressl_key_read

-a always,exit -F arch=b32 -F dir=/etc/pki/ -F perm=r -S open,openat -F key=libressl_pki_access
-a always,exit -F arch=b64 -F dir=/etc/pki/ -F perm=r -S open,openat -F key=libressl_pki_access

-a always,exit -F arch=b64 -F dir=/etc/pki/tls/ -F perm=r -S open,openat -F key=libressl_pki_tls_access

-a always,exit -F arch=b64 -F dir=/etc/pki/ca-trust/ -F perm=r -S open,openat -F key=libressl_ca_trust_access

## Monitor failed access to sensitive directories
-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EACCES -F key=libressl_key_denied
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EACCES -F key=libressl_key_denied

-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EPERM -F key=libressl_key_denied
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EPERM -F key=libressl_key_denied

## Monitor LibreSSL configuration directories
-a always,exit -F arch=b32 -F dir=/etc/libressl/ -F perm=rwa -S open,openat -F key=libressl_config
-a always,exit -F arch=b64 -F dir=/etc/libressl/ -F perm=rwa -S open,openat -F key=libressl_config

-a always,exit -F arch=b64 -F dir=/usr/local/etc/libressl/ -F perm=rwa -S open,openat -F key=libressl_config

-a always,exit -F arch=b32 -F path=/etc/ssl/openssl.cnf -F perm=rwa -S open,openat -F key=libressl_openssl_config
-a always,exit -F arch=b64 -F path=/etc/ssl/openssl.cnf -F perm=rwa -S open,openat -F key=libressl_openssl_config

## Monitor memory mapping of crypto libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libssl.so -S mmap,mprotect -F key=libressl_lib_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libssl.so -S mmap,mprotect -F key=libressl_lib_mmap

-a always,exit -F arch=b32 -F path=/usr/lib/libcrypto.so -S mmap,mprotect -F key=libressl_crypto_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libcrypto.so -S mmap,mprotect -F key=libressl_crypto_mmap

-a always,exit -F arch=b32 -F path=/usr/lib/libtls.so -S mmap,mprotect -F key=libressl_tls_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libtls.so -S mmap,mprotect -F key=libressl_tls_mmap

-a always,exit -F arch=b64 -F path=/usr/local/lib64/libssl.so -S mmap,mprotect -F key=libressl_lib_mmap

-a always,exit -F arch=b64 -F path=/usr/local/lib64/libcrypto.so -S mmap,mprotect -F key=libressl_crypto_mmap

## Monitor random number generation access
-a always,exit -F arch=b32 -F path=/dev/random -F perm=r -S open,openat -F key=libressl_random
-a always,exit -F arch=b64 -F path=/dev/random -F perm=r -S open,openat -F key=libressl_random

-a always,exit -F arch=b32 -F path=/dev/urandom -F perm=r -S open,openat -F key=libressl_urandom
-a always,exit -F arch=b64 -F path=/dev/urandom -F perm=r -S open,openat -F key=libressl_urandom

-a always,exit -F arch=b32 -S getrandom -F key=libressl_getrandom
-a always,exit -F arch=b64 -S getrandom -F key=libressl_getrandom

-a always,exit -F arch=b32 -S getentropy -F key=libressl_getentropy
-a always,exit -F arch=b64 -S getentropy -F key=libressl_getentropy

## Monitor shared memory operations (for session caching)
-a always,exit -F arch=b32 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -S shmctl -F key=T1559_Inter-Process_Communication

## Example with exe filter: Monitor shared memory from LibreSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/httpd -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/sbin/httpd -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -F exe=/usr/sbin/smtpd -S shmctl -F key=T1559_Inter-Process_Communication

## Monitor semaphore operations (for thread synchronization)
-a always,exit -F arch=b32 -S semget,semop,semctl -F key=libressl_semaphore
-a always,exit -F arch=b64 -S semget,semop,semctl -F key=libressl_semaphore

## Example with exe filter: Monitor semaphore operations from LibreSSL servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/httpd -S semget,semop,semctl -F key=libressl_httpd_semaphore
-a always,exit -F arch=b64 -F exe=/usr/sbin/httpd -S semget,semop,semctl -F key=libressl_httpd_semaphore

-a always,exit -F arch=b32 -F exe=/usr/sbin/ntpd -S semget,semop,semctl -F key=libressl_ntpd_semaphore
-a always,exit -F arch=b64 -F exe=/usr/sbin/ntpd -S semget,semop,semctl -F key=libressl_ntpd_semaphore

## Monitor file descriptor operations
-a always,exit -F arch=b32 -S dup,dup2,dup3 -F success=1 -F key=libressl_fd_dup
-a always,exit -F arch=b64 -S dup,dup2,dup3 -F success=1 -F key=libressl_fd_dup

-a always,exit -F arch=b64 -S fcntl -F a1=1 -F key=libressl_fcntl_dupfd

-a always,exit -F arch=b64 -S fcntl -F a1=2 -F key=libressl_fcntl_setfd

## Example with exe filter: Monitor FD operations from LibreSSL applications
-a always,exit -F arch=b32 -F exe=/usr/bin/ftp -S dup,dup2,dup3 -F success=1 -F key=libressl_ftp_fd_dup
-a always,exit -F arch=b64 -F exe=/usr/bin/ftp -S dup,dup2,dup3 -F success=1 -F key=libressl_ftp_fd_dup

-a always,exit -F arch=b64 -F exe=/usr/sbin/sshd -S fcntl -F a1=1 -F key=libressl_sshd_fcntl_dupfd
-a always,exit -F arch=b64 -F exe=/usr/bin/nc -S fcntl -F a1=2 -F key=libressl_nc_fcntl_setfd

## Monitor socket options
-a always,exit -F arch=b32 -S setsockopt -F success=1 -F key=libressl_setsockopt
-a always,exit -F arch=b64 -S setsockopt -F success=1 -F key=libressl_setsockopt

-a always,exit -F arch=b64 -S getsockopt -F success=1 -F key=libressl_getsockopt

## Example with exe filter: Monitor socket options from LibreSSL clients
-a always,exit -F arch=b32 -F exe=/usr/bin/ftp -S setsockopt -F success=1 -F key=libressl_ftp_setsockopt
-a always,exit -F arch=b64 -F exe=/usr/bin/ftp -S setsockopt -F success=1 -F key=libressl_ftp_setsockopt

-a always,exit -F arch=b64 -F exe=/usr/bin/ldapsearch -S getsockopt -F success=1 -F key=libressl_ldap_getsockopt
-a always,exit -F arch=b64 -F exe=/usr/bin/lynx -S setsockopt -F success=1 -F key=libressl_lynx_setsockopt

## Monitor I/O operations on sockets
-a always,exit -F arch=b32 -S sendto,sendmsg -F success=1 -F key=libressl_send
-a always,exit -F arch=b64 -S sendto,sendmsg -F success=1 -F key=libressl_send

-a always,exit -F arch=b32 -S recvfrom,recvmsg -F success=1 -F key=libressl_recv
-a always,exit -F arch=b64 -S recvfrom,recvmsg -F success=1 -F key=libressl_recv

-a always,exit -F arch=b64 -S read,write -F success=1 -F key=libressl_io

## Example with exe filter: Monitor I/O from LibreSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/smtpd -S sendto,sendmsg -F success=1 -F key=libressl_smtpd_send
-a always,exit -F arch=b64 -F exe=/usr/sbin/smtpd -S sendto,sendmsg -F success=1 -F key=libressl_smtpd_send

-a always,exit -F arch=b32 -F exe=/usr/sbin/httpd -S recvfrom,recvmsg -F success=1 -F key=libressl_httpd_recv
-a always,exit -F arch=b64 -F exe=/usr/sbin/httpd -S recvfrom,recvmsg -F success=1 -F key=libressl_httpd_recv

-a always,exit -F arch=b64 -F exe=/usr/bin/tmux -S read,write -F success=1 -F key=libressl_tmux_io

## Monitor poll/select operations (for async I/O)
-a always,exit -F arch=b32 -S poll,select -F success=1 -F key=libressl_poll
-a always,exit -F arch=b64 -S poll,ppoll,select,pselect6 -F success=1 -F key=libressl_poll

## Example with exe filter: Monitor async I/O from LibreSSL servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/httpd -S poll,select -F success=1 -F key=libressl_httpd_poll
-a always,exit -F arch=b64 -F exe=/usr/sbin/httpd -S poll,ppoll,select,pselect6 -F success=1 -F key=libressl_httpd_poll

-a always,exit -F arch=b32 -F exe=/usr/sbin/relayd -S poll,select -F success=1 -F key=libressl_relayd_poll
-a always,exit -F arch=b64 -F exe=/usr/sbin/relayd -S poll,ppoll,select,pselect6 -F success=1 -F key=libressl_relayd_poll

## Monitor epoll operations (for high-performance servers)
-a always,exit -F arch=b32 -S epoll_create -F success=1 -F key=libressl_epoll_create
-a always,exit -F arch=b64 -S epoll_create,epoll_create1 -F success=1 -F key=libressl_epoll_create

-a always,exit -F arch=b64 -S epoll_ctl -F success=1 -F key=libressl_epoll_ctl

-a always,exit -F arch=b64 -S epoll_wait,epoll_pwait -F success=1 -F key=libressl_epoll_wait

## Example with exe filter: Monitor epoll from LibreSSL-enabled servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S epoll_create -F success=1 -F key=libressl_nginx_epoll_create
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S epoll_create,epoll_create1 -F success=1 -F key=libressl_nginx_epoll_create

-a always,exit -F arch=b64 -F exe=/usr/sbin/haproxy -S epoll_ctl -F success=1 -F key=libressl_haproxy_epoll_ctl
-a always,exit -F arch=b64 -F exe=/usr/sbin/varnish -S epoll_wait,epoll_pwait -F success=1 -F key=libressl_varnish_epoll_wait

## Monitor kqueue operations (BSD compatibility)
-a always,exit -F arch=b32 -S kqueue -F success=1 -F key=libressl_kqueue
-a always,exit -F arch=b64 -S kqueue -F success=1 -F key=libressl_kqueue

-a always,exit -F arch=b32 -S kevent -F success=1 -F key=libressl_kevent
-a always,exit -F arch=b64 -S kevent -F success=1 -F key=libressl_kevent

## Monitor privilege changes
-a always,exit -F arch=b32 -S setuid,setreuid -F success=1 -F key=libressl_setuid
-a always,exit -F arch=b64 -S setuid,setreuid,setresuid -F success=1 -F key=libressl_setuid

-a always,exit -F arch=b32 -S setgid,setregid -F success=1 -F key=libressl_setgid
-a always,exit -F arch=b64 -S setgid,setregid,setresgid -F success=1 -F key=libressl_setgid

## Example with exe filter: Monitor privilege drops from LibreSSL services
-a always,exit -F arch=b32 -F exe=/usr/sbin/httpd -S setuid,setreuid -F success=1 -F key=libressl_httpd_setuid
-a always,exit -F arch=b64 -F exe=/usr/sbin/httpd -S setuid,setreuid,setresuid -F success=1 -F key=libressl_httpd_setuid

-a always,exit -F arch=b32 -F exe=/usr/sbin/smtpd -S setgid,setregid -F success=1 -F key=libressl_smtpd_setgid
-a always,exit -F arch=b64 -F exe=/usr/sbin/smtpd -S setgid,setregid,setresgid -F success=1 -F key=libressl_smtpd_setgid

-a always,exit -F arch=b64 -F exe=/usr/sbin/ntpd -S setuid,setreuid,setresuid -F success=1 -F key=libressl_ntpd_setuid

## Monitor capability changes
-a always,exit -F arch=b32 -S capset -F success=1 -F key=libressl_capabilities
-a always,exit -F arch=b64 -S capset -F success=1 -F key=libressl_capabilities

## Example with exe filter: Monitor capability changes from LibreSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/httpd -S capset -F success=1 -F key=libressl_httpd_capabilities
-a always,exit -F arch=b64 -F exe=/usr/sbin/httpd -S capset -F success=1 -F key=libressl_httpd_capabilities

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S capset -F success=1 -F key=libressl_nginx_capabilities
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S capset -F success=1 -F key=libressl_nginx_capabilities

## Monitor process creation and termination
-a always,exit -F arch=b32 -S clone,fork,vfork -F success=1 -F key=libressl_process_create
-a always,exit -F arch=b64 -S clone,fork,vfork -F success=1 -F key=libressl_process_create

-a always,exit -F arch=b64 -S exit,exit_group -F key=libressl_process_exit

## Example with exe filter: Monitor process operations from LibreSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/httpd -S clone,fork,vfork -F success=1 -F key=libressl_httpd_fork
-a always,exit -F arch=b64 -F exe=/usr/sbin/httpd -S clone,fork,vfork -F success=1 -F key=libressl_httpd_fork

-a always,exit -F arch=b32 -F exe=/usr/sbin/smtpd -S clone,fork,vfork -F success=1 -F key=libressl_smtpd_fork
-a always,exit -F arch=b64 -F exe=/usr/sbin/smtpd -S clone,fork,vfork -F success=1 -F key=libressl_smtpd_fork

-a always,exit -F arch=b64 -F exe=/usr/bin/openssl -S exit,exit_group -F key=libressl_openssl_exit

## Monitor signal handling (for graceful shutdown)
-a always,exit -F arch=b32 -S kill,tkill,tgkill -F a1=15 -F key=libressl_sigterm
-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=15 -F key=libressl_sigterm

-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=2 -F key=libressl_sigint

## Example with exe filter: Monitor signals to/from LibreSSL applications
-a always,exit -F arch=b32 -F exe=/usr/bin/systemctl -S kill,tkill,tgkill -F a1=15 -F key=libressl_systemctl_sigterm
-a always,exit -F arch=b64 -F exe=/usr/bin/systemctl -S kill,tkill,tgkill -F a1=15 -F key=libressl_systemctl_sigterm

-a always,exit -F arch=b32 -F exe=/usr/sbin/rcctl -S kill,tkill,tgkill -F a1=15 -F key=libressl_rcctl_sigterm
-a always,exit -F arch=b64 -F exe=/usr/sbin/rcctl -S kill,tkill,tgkill -F a1=15 -F key=libressl_rcctl_sigterm

-a always,exit -F arch=b64 -F exe=/usr/bin/pkill -S kill,tkill,tgkill -F a1=2 -F key=libressl_pkill_sigint

## Monitor time operations (for certificate validity checking)
-a always,exit -F arch=b32 -S clock_gettime -F a0=0 -F key=libressl_clock_realtime
-a always,exit -F arch=b64 -S clock_gettime -F a0=0 -F key=libressl_clock_realtime

-a always,exit -F arch=b64 -S gettimeofday -F key=libressl_gettimeofday

## Example with exe filter: Monitor time operations from LibreSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/ntpd -S clock_gettime -F a0=0 -F key=libressl_ntpd_time
-a always,exit -F arch=b64 -F exe=/usr/sbin/ntpd -S clock_gettime -F a0=0 -F key=libressl_ntpd_time

-a always,exit -F arch=b32 -F exe=/usr/bin/ftp -S clock_gettime -F a0=0 -F key=libressl_ftp_time
-a always,exit -F arch=b64 -F exe=/usr/bin/ftp -S clock_gettime -F a0=0 -F key=libressl_ftp_time

-a always,exit -F arch=b64 -F exe=/usr/bin/openssl -S gettimeofday -F key=libressl_openssl_time

## Monitor memory operations
-a always,exit -F arch=b32 -S mlock,mlockall -F success=1 -F key=libressl_mlock
-a always,exit -F arch=b64 -S mlock,mlock2,mlockall -F success=1 -F key=libressl_mlock

-a always,exit -F arch=b64 -S munlock,munlockall -F success=1 -F key=libressl_munlock

## Monitor namespace operations (for containerized deployments)
-a always,exit -F arch=b32 -S setns,unshare -F success=1 -F key=libressl_namespace
-a always,exit -F arch=b64 -S setns,unshare -F success=1 -F key=libressl_namespace

## Monitor chroot operations (for jailed environments)
-a always,exit -F arch=b32 -S chroot -F key=libressl_chroot
-a always,exit -F arch=b64 -S chroot -F key=libressl_chroot

## Monitor pledge/unveil (OpenBSD security features if available)
-a always,exit -F arch=b32 -S pledge -F key=libressl_pledge
-a always,exit -F arch=b64 -S pledge -F key=libressl_pledge

-a always,exit -F arch=b32 -S unveil -F key=libressl_unveil
-a always,exit -F arch=b64 -S unveil -F key=libressl_unveil

## Monitor library loading
-a always,exit -F arch=b32 -F dir=/lib/ -F path=libssl -S open,openat -F key=libressl_lib_load
-a always,exit -F arch=b32 -F dir=/usr/lib/ -F path=libssl -S open,openat -F key=libressl_lib_load

-a always,exit -F arch=b64 -F dir=/lib64/ -F path=libssl -S open,openat -F key=libressl_lib_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/ -F path=libssl -S open,openat -F key=libressl_lib_load

-a always,exit -F arch=b32 -F dir=/lib/ -F path=libcrypto -S open,openat -F key=libressl_crypto_load
-a always,exit -F arch=b32 -F dir=/usr/lib/ -F path=libcrypto -S open,openat -F key=libressl_crypto_load

-a always,exit -F arch=b64 -F dir=/lib64/ -F path=libcrypto -S open,openat -F key=libressl_crypto_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/ -F path=libcrypto -S open,openat -F key=libressl_crypto_load

## Monitor application-specific paths
-a always,exit -F arch=b32 -F dir=/var/lib/libressl/ -F perm=rwa -S open,openat -F key=libressl_var_lib
-a always,exit -F arch=b64 -F dir=/var/lib/libressl/ -F perm=rwa -S open,openat -F key=libressl_var_lib

-a always,exit -F arch=b64 -F dir=/opt/libressl/ -F perm=rwa -S open,openat -F key=libressl_opt
-a always,exit -F arch=b32 -F dir=/etc/ssl/ -F perm=rwa -S open,openat -F key=libressl_etc_ssl

-a always,exit -F arch=b64 -F dir=/etc/ssl/ -F perm=rwa -S open,openat -F key=libressl_etc_ssl

## Monitor OpenBSD base system with LibreSSL
-a always,exit -F arch=b32 -F exe=/usr/sbin/httpd -S open,openat -F path=libssl -F key=libressl_openbsd_httpd
-a always,exit -F arch=b64 -F exe=/usr/sbin/httpd -S open,openat -F path=libssl -F key=libressl_openbsd_httpd

-a always,exit -F arch=b32 -F exe=/usr/sbin/smtpd -S open,openat -F path=libssl -F key=libressl_opensmtpd
-a always,exit -F arch=b64 -F exe=/usr/sbin/smtpd -S open,openat -F path=libssl -F key=libressl_opensmtpd

-a always,exit -F arch=b32 -F exe=/usr/sbin/ntpd -S open,openat -F path=libssl -F key=libressl_openntpd
-a always,exit -F arch=b64 -F exe=/usr/sbin/ntpd -S open,openat -F path=libssl -F key=libressl_openntpd

-a always,exit -F arch=b32 -F exe=/usr/sbin/relayd -S open,openat -F path=libssl -F key=libressl_relayd
-a always,exit -F arch=b64 -F exe=/usr/sbin/relayd -S open,openat -F path=libssl -F key=libressl_relayd

## Monitor Portable LibreSSL applications
-a always,exit -F arch=b32 -F exe=/usr/bin/rpki-client -S open,openat -F path=libssl -F key=libressl_rpki_client
-a always,exit -F arch=b64 -F exe=/usr/bin/rpki-client -S open,openat -F path=libssl -F key=libressl_rpki_client

-a always,exit -F arch=b32 -F exe=/usr/sbin/acme-client -S open,openat -F path=libssl -F key=libressl_acme_client
-a always,exit -F arch=b64 -F exe=/usr/sbin/acme-client -S open,openat -F path=libssl -F key=libressl_acme_client

## Monitor engine/provider loading (LibreSSL engines)
-a always,exit -F arch=b32 -F dir=/usr/lib/engines/ -F perm=r -S open,openat -F key=libressl_engines
-a always,exit -F arch=b64 -F dir=/usr/lib64/engines/ -F perm=r -S open,openat -F key=libressl_engines

-a always,exit -F arch=b32 -F dir=/usr/local/lib/engines/ -F perm=r -S open,openat -F key=libressl_engines
-a always,exit -F arch=b64 -F dir=/usr/local/lib64/engines/ -F perm=r -S open,openat -F key=libressl_engines

# WolfSSL (Syscall Rules Only)

## Monitor file operations on WolfSSL libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libwolfssl.so -F perm=rwxa -S open,openat -F key=wolfssl_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libwolfssl.so -F perm=rwxa -S open,openat -F key=wolfssl_lib_access

-a always,exit -F arch=b32 -F path=/usr/local/lib/libwolfssl.so -F perm=rwxa -S open,openat -F key=wolfssl_lib_access
-a always,exit -F arch=b64 -F path=/usr/local/lib64/libwolfssl.so -F perm=rwxa -S open,openat -F key=wolfssl_lib_access

-a always,exit -F arch=b32 -F path=/opt/wolfssl/lib/libwolfssl.so -F perm=rwxa -S open,openat -F key=wolfssl_opt_lib_access
-a always,exit -F arch=b64 -F path=/opt/wolfssl/lib64/libwolfssl.so -F perm=rwxa -S open,openat -F key=wolfssl_opt_lib_access

## Monitor WolfSSL static libraries (commonly used in embedded)
-a always,exit -F arch=b32 -F path=/usr/lib/libwolfssl.a -F perm=r -S open,openat -F key=wolfssl_static_lib
-a always,exit -F arch=b64 -F path=/usr/lib64/libwolfssl.a -F perm=r -S open,openat -F key=wolfssl_static_lib

-a always,exit -F arch=b32 -F path=/usr/local/lib/libwolfssl.a -F perm=r -S open,openat -F key=wolfssl_static_lib
-a always,exit -F arch=b64 -F path=/usr/local/lib64/libwolfssl.a -F perm=r -S open,openat -F key=wolfssl_static_lib

## Monitor WolfSSL header files
-a always,exit -F arch=b32 -F dir=/usr/include/wolfssl/ -F perm=r -S open,openat -F key=wolfssl_headers
-a always,exit -F arch=b64 -F dir=/usr/include/wolfssl/ -F perm=r -S open,openat -F key=wolfssl_headers

-a always,exit -F arch=b32 -F dir=/usr/local/include/wolfssl/ -F perm=r -S open,openat -F key=wolfssl_headers
-a always,exit -F arch=b64 -F dir=/usr/local/include/wolfssl/ -F perm=r -S open,openat -F key=wolfssl_headers

-a always,exit -F arch=b32 -F dir=/usr/include/cyassl/ -F perm=r -S open,openat -F key=wolfssl_cyassl_compat
-a always,exit -F arch=b64 -F dir=/usr/include/cyassl/ -F perm=r -S open,openat -F key=wolfssl_cyassl_compat

## Monitor execve calls for WolfSSL binaries
-a always,exit -F arch=b32 -F path=/usr/bin/wolfssl-client -S execve -F key=wolfssl_client_exec
-a always,exit -F arch=b64 -F path=/usr/bin/wolfssl-client -S execve -F key=wolfssl_client_exec

-a always,exit -F arch=b32 -F path=/usr/bin/wolfssl-server -S execve -F key=wolfssl_server_exec
-a always,exit -F arch=b64 -F path=/usr/bin/wolfssl-server -S execve -F key=wolfssl_server_exec

-a always,exit -F arch=b32 -F path=/usr/local/bin/wolfssl-client -S execve -F key=wolfssl_client_exec
-a always,exit -F arch=b64 -F path=/usr/local/bin/wolfssl-client -S execve -F key=wolfssl_client_exec

-a always,exit -F arch=b32 -F path=/usr/local/bin/wolfssl-server -S execve -F key=wolfssl_server_exec
-a always,exit -F arch=b64 -F path=/usr/local/bin/wolfssl-server -S execve -F key=wolfssl_server_exec

## Monitor socket creation for SSL/TLS
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=1 -F success=1 -F key=wolfssl_tcp_socket
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=1 -F success=1 -F key=wolfssl_tcp_socket

-a always,exit -F arch=b32 -S socket -F a0=10 -F a1=1 -F success=1 -F key=wolfssl_tcp6_socket
-a always,exit -F arch=b64 -S socket -F a0=10 -F a1=1 -F success=1 -F key=wolfssl_tcp6_socket

-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=2 -F success=1 -F key=wolfssl_udp_socket
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=2 -F success=1 -F key=wolfssl_udp_socket

## Monitor bind calls on SSL/TLS and DTLS ports
-a always,exit -F arch=b32 -S bind -F exit=0 -F key=wolfssl_bind_success
-a always,exit -F arch=b64 -S bind -F exit=0 -F key=wolfssl_bind_success

## Monitor listen calls (for server applications)
-a always,exit -F arch=b32 -S listen -F success=1 -F key=wolfssl_listen
-a always,exit -F arch=b64 -S listen -F success=1 -F key=wolfssl_listen

## Monitor accept/accept4 calls (incoming connections)
-a always,exit -F arch=b32 -S accept,accept4 -F success=1 -F key=wolfssl_accept
-a always,exit -F arch=b64 -S accept,accept4 -F success=1 -F key=wolfssl_accept

## Monitor connect calls (outgoing connections)
-a always,exit -F arch=b32 -S connect -F success=1 -F key=wolfssl_connect_success
-a always,exit -F arch=b64 -S connect -F success=1 -F key=wolfssl_connect_success

-a always,exit -F arch=b32 -S connect -F exit=-ECONNREFUSED -F key=wolfssl_connect_refused
-a always,exit -F arch=b64 -S connect -F exit=-ECONNREFUSED -F key=wolfssl_connect_refused

-a always,exit -F arch=b64 -S connect -F exit=-ETIMEDOUT -F key=wolfssl_connect_timeout

## Monitor certificate and key file operations
-a always,exit -F arch=b32 -F dir=/etc/wolfssl/ -F perm=r -S open,openat -F key=wolfssl_config_read
-a always,exit -F arch=b64 -F dir=/etc/wolfssl/ -F perm=r -S open,openat -F key=wolfssl_config_read

-a always,exit -F arch=b32 -F dir=/usr/local/etc/wolfssl/ -F perm=r -S open,openat -F key=wolfssl_config_read
-a always,exit -F arch=b64 -F dir=/usr/local/etc/wolfssl/ -F perm=r -S open,openat -F key=wolfssl_config_read

-a always,exit -F arch=b32 -F dir=/etc/ssl/certs/ -F perm=r -S open,openat -F key=wolfssl_cert_read
-a always,exit -F arch=b64 -F dir=/etc/ssl/certs/ -F perm=r -S open,openat -F key=wolfssl_cert_read

-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -F perm=r -S open,openat -F key=wolfssl_key_read
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -F perm=r -S open,openat -F key=wolfssl_key_read

-a always,exit -F arch=b32 -F dir=/etc/pki/wolfssl/ -F perm=r -S open,openat -F key=wolfssl_pki_access
-a always,exit -F arch=b64 -F dir=/etc/pki/wolfssl/ -F perm=r -S open,openat -F key=wolfssl_pki_access

## Monitor failed access to sensitive directories
-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EACCES -F key=wolfssl_key_denied
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EACCES -F key=wolfssl_key_denied

-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EPERM -F key=wolfssl_key_denied
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EPERM -F key=wolfssl_key_denied

## Monitor memory mapping of crypto libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libwolfssl.so -S mmap,mprotect -F key=wolfssl_lib_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libwolfssl.so -S mmap,mprotect -F key=wolfssl_lib_mmap

-a always,exit -F arch=b64 -F path=/usr/local/lib64/libwolfssl.so -S mmap,mprotect -F key=wolfssl_lib_mmap

## Monitor random number generation access
-a always,exit -F arch=b32 -F path=/dev/random -F perm=r -S open,openat -F key=wolfssl_random
-a always,exit -F arch=b64 -F path=/dev/random -F perm=r -S open,openat -F key=wolfssl_random

-a always,exit -F arch=b32 -F path=/dev/urandom -F perm=r -S open,openat -F key=wolfssl_urandom
-a always,exit -F arch=b64 -F path=/dev/urandom -F perm=r -S open,openat -F key=wolfssl_urandom

-a always,exit -F arch=b32 -S getrandom -F key=wolfssl_getrandom
-a always,exit -F arch=b64 -S getrandom -F key=wolfssl_getrandom

## Monitor hardware RNG/crypto access (for embedded)
-a always,exit -F arch=b32 -F path=/dev/hwrng -F perm=r -S open,openat -F key=wolfssl_hwrng
-a always,exit -F arch=b64 -F path=/dev/hwrng -F perm=r -S open,openat -F key=wolfssl_hwrng

-a always,exit -F arch=b32 -F path=/dev/crypto -F perm=rw -S open,openat -F key=wolfssl_devcrypto
-a always,exit -F arch=b64 -F path=/dev/crypto -F perm=rw -S open,openat -F key=wolfssl_devcrypto

## Monitor shared memory operations (for session caching)
-a always,exit -F arch=b32 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -S shmctl -F key=T1559_Inter-Process_Communication

## Example with exe filter: Monitor shared memory from WolfSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/lighttpd -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/sbin/lighttpd -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -F exe=/usr/bin/mariadb -S shmctl -F key=T1559_Inter-Process_Communication

## Monitor semaphore operations (for thread synchronization)
-a always,exit -F arch=b32 -S semget,semop,semctl -F key=wolfssl_semaphore
-a always,exit -F arch=b64 -S semget,semop,semctl -F key=wolfssl_semaphore

## Example with exe filter: Monitor semaphore operations from WolfSSL servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/lighttpd -S semget,semop,semctl -F key=wolfssl_lighttpd_semaphore
-a always,exit -F arch=b64 -F exe=/usr/sbin/lighttpd -S semget,semop,semctl -F key=wolfssl_lighttpd_semaphore

-a always,exit -F arch=b32 -F exe=/usr/sbin/haproxy -S semget,semop,semctl -F key=wolfssl_haproxy_semaphore
-a always,exit -F arch=b64 -F exe=/usr/sbin/haproxy -S semget,semop,semctl -F key=wolfssl_haproxy_semaphore

## Monitor file descriptor operations
-a always,exit -F arch=b32 -S dup,dup2,dup3 -F success=1 -F key=wolfssl_fd_dup
-a always,exit -F arch=b64 -S dup,dup2,dup3 -F success=1 -F key=wolfssl_fd_dup

-a always,exit -F arch=b64 -S fcntl -F a1=1 -F key=wolfssl_fcntl_dupfd

-a always,exit -F arch=b64 -S fcntl -F a1=2 -F key=wolfssl_fcntl_setfd

## Example with exe filter: Monitor FD operations from WolfSSL applications
-a always,exit -F arch=b32 -F exe=/usr/bin/curl -S dup,dup2,dup3 -F success=1 -F key=wolfssl_curl_fd_dup
-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S dup,dup2,dup3 -F success=1 -F key=wolfssl_curl_fd_dup

-a always,exit -F arch=b64 -F exe=/usr/sbin/strongswan -S fcntl -F a1=1 -F key=wolfssl_strongswan_fcntl_dupfd
#-a always,exit -F arch=b64 -F exe=/usr/bin/wget -S fcntl -F a1=2 -F key=wolfssl_wget_fcntl_setfd

## Monitor socket options
-a always,exit -F arch=b32 -S setsockopt -F success=1 -F key=wolfssl_setsockopt
-a always,exit -F arch=b64 -S setsockopt -F success=1 -F key=wolfssl_setsockopt

-a always,exit -F arch=b64 -S getsockopt -F success=1 -F key=wolfssl_getsockopt

## Example with exe filter: Monitor socket options from WolfSSL clients
-a always,exit -F arch=b32 -F exe=/usr/bin/curl -S setsockopt -F success=1 -F key=wolfssl_curl_setsockopt
-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S setsockopt -F success=1 -F key=wolfssl_curl_setsockopt

-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S getsockopt -F success=1 -F key=wolfssl_nginx_getsockopt
-a always,exit -F arch=b64 -F exe=/usr/bin/ffmpeg -S setsockopt -F success=1 -F key=wolfssl_ffmpeg_setsockopt

## Monitor I/O operations on sockets
-a always,exit -F arch=b32 -S sendto,sendmsg -F success=1 -F key=wolfssl_send
-a always,exit -F arch=b64 -S sendto,sendmsg -F success=1 -F key=wolfssl_send

-a always,exit -F arch=b32 -S recvfrom,recvmsg -F success=1 -F key=wolfssl_recv
-a always,exit -F arch=b64 -S recvfrom,recvmsg -F success=1 -F key=wolfssl_recv

-a always,exit -F arch=b64 -S read,write -F success=1 -F key=wolfssl_io

## Example with exe filter: Monitor I/O from WolfSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/lighttpd -S sendto,sendmsg -F success=1 -F key=wolfssl_lighttpd_send
-a always,exit -F arch=b64 -F exe=/usr/sbin/lighttpd -S sendto,sendmsg -F success=1 -F key=wolfssl_lighttpd_send

-a always,exit -F arch=b32 -F exe=/usr/bin/mariadb -S recvfrom,recvmsg -F success=1 -F key=wolfssl_mariadb_recv
-a always,exit -F arch=b64 -F exe=/usr/bin/mariadb -S recvfrom,recvmsg -F success=1 -F key=wolfssl_mariadb_recv

-a always,exit -F arch=b64 -F exe=/usr/bin/qt5-app -S read,write -F success=1 -F key=wolfssl_qt5_io

## Monitor poll/select operations (for async I/O)
-a always,exit -F arch=b32 -S poll,select -F success=1 -F key=wolfssl_poll
-a always,exit -F arch=b64 -S poll,ppoll,select,pselect6 -F success=1 -F key=wolfssl_poll

## Example with exe filter: Monitor async I/O from WolfSSL servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/lighttpd -S poll,select -F success=1 -F key=wolfssl_lighttpd_poll
-a always,exit -F arch=b64 -F exe=/usr/sbin/lighttpd -S poll,ppoll,select,pselect6 -F success=1 -F key=wolfssl_lighttpd_poll

-a always,exit -F arch=b32 -F exe=/usr/sbin/haproxy -S poll,select -F success=1 -F key=wolfssl_haproxy_poll
-a always,exit -F arch=b64 -F exe=/usr/sbin/haproxy -S poll,ppoll,select,pselect6 -F success=1 -F key=wolfssl_haproxy_poll

## Monitor epoll operations (for high-performance servers)
-a always,exit -F arch=b32 -S epoll_create -F success=1 -F key=wolfssl_epoll_create
-a always,exit -F arch=b64 -S epoll_create,epoll_create1 -F success=1 -F key=wolfssl_epoll_create

-a always,exit -F arch=b64 -S epoll_ctl -F success=1 -F key=wolfssl_epoll_ctl

-a always,exit -F arch=b64 -S epoll_wait,epoll_pwait -F success=1 -F key=wolfssl_epoll_wait

## Example with exe filter: Monitor epoll from WolfSSL-enabled servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S epoll_create -F success=1 -F key=wolfssl_nginx_epoll_create
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S epoll_create,epoll_create1 -F success=1 -F key=wolfssl_nginx_epoll_create

-a always,exit -F arch=b64 -F exe=/usr/sbin/haproxy -S epoll_ctl -F success=1 -F key=wolfssl_haproxy_epoll_ctl
-a always,exit -F arch=b64 -F exe=/usr/bin/asio-app -S epoll_wait,epoll_pwait -F success=1 -F key=wolfssl_asio_epoll_wait

## Monitor privilege changes
-a always,exit -F arch=b32 -S setuid,setreuid -F success=1 -F key=wolfssl_setuid
-a always,exit -F arch=b64 -S setuid,setreuid,setresuid -F success=1 -F key=wolfssl_setuid

-a always,exit -F arch=b32 -S setgid,setregid -F success=1 -F key=wolfssl_setgid
-a always,exit -F arch=b64 -S setgid,setregid,setresgid -F success=1 -F key=wolfssl_setgid

## Example with exe filter: Monitor privilege drops from WolfSSL services
-a always,exit -F arch=b32 -F exe=/usr/sbin/lighttpd -S setuid,setreuid -F success=1 -F key=wolfssl_lighttpd_setuid
-a always,exit -F arch=b64 -F exe=/usr/sbin/lighttpd -S setuid,setreuid,setresuid -F success=1 -F key=wolfssl_lighttpd_setuid

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S setgid,setregid -F success=1 -F key=wolfssl_nginx_setgid
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S setgid,setregid,setresgid -F success=1 -F key=wolfssl_nginx_setgid

-a always,exit -F arch=b64 -F exe=/usr/sbin/strongswan -S setuid,setreuid,setresuid -F success=1 -F key=wolfssl_strongswan_setuid

## Monitor capability changes
-a always,exit -F arch=b32 -S capset -F success=1 -F key=wolfssl_capabilities
-a always,exit -F arch=b64 -S capset -F success=1 -F key=wolfssl_capabilities

## Example with exe filter: Monitor capability changes from WolfSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/lighttpd -S capset -F success=1 -F key=wolfssl_lighttpd_capabilities
-a always,exit -F arch=b64 -F exe=/usr/sbin/lighttpd -S capset -F success=1 -F key=wolfssl_lighttpd_capabilities

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S capset -F success=1 -F key=wolfssl_nginx_capabilities
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S capset -F success=1 -F key=wolfssl_nginx_capabilities

## Monitor process creation and termination
-a always,exit -F arch=b32 -S clone,fork,vfork -F success=1 -F key=wolfssl_process_create
-a always,exit -F arch=b64 -S clone,fork,vfork -F success=1 -F key=wolfssl_process_create

-a always,exit -F arch=b64 -S exit,exit_group -F key=wolfssl_process_exit

## Example with exe filter: Monitor process operations from WolfSSL applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/lighttpd -S clone,fork,vfork -F success=1 -F key=wolfssl_lighttpd_fork
-a always,exit -F arch=b64 -F exe=/usr/sbin/lighttpd -S clone,fork,vfork -F success=1 -F key=wolfssl_lighttpd_fork

-a always,exit -F arch=b32 -F exe=/usr/bin/mariadb -S clone,fork,vfork -F success=1 -F key=wolfssl_mariadb_fork
-a always,exit -F arch=b64 -F exe=/usr/bin/mariadb -S clone,fork,vfork -F success=1 -F key=wolfssl_mariadb_fork

-a always,exit -F arch=b64 -F exe=/usr/bin/wolfssl-server -S exit,exit_group -F key=wolfssl_server_exit

## Monitor signal handling (for graceful shutdown)
-a always,exit -F arch=b32 -S kill,tkill,tgkill -F a1=15 -F key=wolfssl_sigterm
-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=15 -F key=wolfssl_sigterm

-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=2 -F key=wolfssl_sigint

## Example with exe filter: Monitor signals to/from WolfSSL applications
-a always,exit -F arch=b32 -F exe=/usr/bin/systemctl -S kill,tkill,tgkill -F a1=15 -F key=wolfssl_systemctl_sigterm
-a always,exit -F arch=b64 -F exe=/usr/bin/systemctl -S kill,tkill,tgkill -F a1=15 -F key=wolfssl_systemctl_sigterm

-a always,exit -F arch=b32 -F exe=/usr/sbin/service -S kill,tkill,tgkill -F a1=15 -F key=wolfssl_service_sigterm
-a always,exit -F arch=b64 -F exe=/usr/sbin/service -S kill,tkill,tgkill -F a1=15 -F key=wolfssl_service_sigterm

-a always,exit -F arch=b64 -F exe=/usr/bin/killall -S kill,tkill,tgkill -F a1=2 -F key=wolfssl_killall_sigint

## Monitor time operations (for certificate validity checking)
-a always,exit -F arch=b32 -S clock_gettime -F a0=0 -F key=wolfssl_clock_realtime
-a always,exit -F arch=b64 -S clock_gettime -F a0=0 -F key=wolfssl_clock_realtime

-a always,exit -F arch=b64 -S gettimeofday -F key=wolfssl_gettimeofday

## Example with exe filter: Monitor time operations from WolfSSL applications
-a always,exit -F arch=b32 -F exe=/usr/bin/curl -S clock_gettime -F a0=0 -F key=wolfssl_curl_time
-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S clock_gettime -F a0=0 -F key=wolfssl_curl_time

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S clock_gettime -F a0=0 -F key=wolfssl_nginx_time
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S clock_gettime -F a0=0 -F key=wolfssl_nginx_time

-a always,exit -F arch=b64 -F exe=/usr/bin/wolfssl-client -S gettimeofday -F key=wolfssl_client_time

## Monitor memory operations
-a always,exit -F arch=b32 -S mlock,mlockall -F success=1 -F key=wolfssl_mlock
-a always,exit -F arch=b64 -S mlock,mlock2,mlockall -F success=1 -F key=wolfssl_mlock

-a always,exit -F arch=b64 -S munlock,munlockall -F success=1 -F key=wolfssl_munlock

## Monitor namespace operations (for containerized deployments)
-a always,exit -F arch=b32 -S setns,unshare -F success=1 -F key=wolfssl_namespace
-a always,exit -F arch=b64 -S setns,unshare -F success=1 -F key=wolfssl_namespace

## Monitor chroot operations (for jailed environments)
-a always,exit -F arch=b32 -S chroot -F key=wolfssl_chroot
-a always,exit -F arch=b64 -S chroot -F key=wolfssl_chroot

## Monitor library loading
-a always,exit -F arch=b32 -F dir=/lib/ -F path=libwolfssl -S open,openat -F key=wolfssl_lib_load
-a always,exit -F arch=b32 -F dir=/usr/lib/ -F path=libwolfssl -S open,openat -F key=wolfssl_lib_load

-a always,exit -F arch=b64 -F dir=/lib64/ -F path=libwolfssl -S open,openat -F key=wolfssl_lib_load

-a always,exit -F arch=b64 -F dir=/usr/lib64/ -F path=libwolfssl -S open,openat -F key=wolfssl_lib_load

## Monitor embedded/IoT specific paths
-a always,exit -F arch=b32 -F dir=/opt/wolfssl/ -F perm=rwa -S open,openat -F key=wolfssl_opt
-a always,exit -F arch=b64 -F dir=/opt/wolfssl/ -F perm=rwa -S open,openat -F key=wolfssl_opt

-a always,exit -F arch=b32 -F dir=/var/lib/wolfssl/ -F perm=rwa -S open,openat -F key=wolfssl_var_lib
-a always,exit -F arch=b64 -F dir=/var/lib/wolfssl/ -F perm=rwa -S open,openat -F key=wolfssl_var_lib

## Monitor automotive/embedded paths
-a always,exit -F arch=b32 -F dir=/usr/share/autosar/ -F perm=r -S open,openat -F key=wolfssl_autosar
-a always,exit -F arch=b64 -F dir=/usr/share/autosar/ -F perm=r -S open,openat -F key=wolfssl_autosar

-a always,exit -F arch=b32 -F dir=/opt/qnx/ -F path=wolfssl -S open,openat -F key=wolfssl_qnx
-a always,exit -F arch=b64 -F dir=/opt/qnx/ -F path=wolfssl -S open,openat -F key=wolfssl_qnx

## Monitor RTOS paths (FreeRTOS, VxWorks)
-a always,exit -F arch=b32 -F dir=/opt/freertos/ -F path=wolfssl -S open,openat -F key=wolfssl_freertos
-a always,exit -F arch=b64 -F dir=/opt/freertos/ -F path=wolfssl -S open,openat -F key=wolfssl_freertos

-a always,exit -F arch=b32 -F dir=/opt/vxworks/ -F path=wolfssl -S open,openat -F key=wolfssl_vxworks
-a always,exit -F arch=b64 -F dir=/opt/vxworks/ -F path=wolfssl -S open,openat -F key=wolfssl_vxworks

## Monitor MySQL/MariaDB with WolfSSL
-a always,exit -F arch=b32 -F exe=/usr/sbin/mysqld -S open,openat -F path=wolfssl -F key=wolfssl_mysql_load
-a always,exit -F arch=b64 -F exe=/usr/sbin/mysqld -S open,openat -F path=wolfssl -F key=wolfssl_mysql_load

-a always,exit -F arch=b32 -F exe=/usr/sbin/mariadbd -S open,openat -F path=wolfssl -F key=wolfssl_mariadb_load
-a always,exit -F arch=b64 -F exe=/usr/sbin/mariadbd -S open,openat -F path=wolfssl -F key=wolfssl_mariadb_load

## Monitor Qt applications with WolfSSL
-a always,exit -F arch=b32 -F dir=/usr/lib/qt5/ -F path=wolfssl -S open,openat -F key=wolfssl_qt5_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/qt5/ -F path=wolfssl -S open,openat -F key=wolfssl_qt5_load

## Monitor strongSwan with WolfSSL
-a always,exit -F arch=b32 -F exe=/usr/sbin/strongswan -S open,openat -F path=wolfssl -F key=wolfssl_strongswan_load
-a always,exit -F arch=b64 -F exe=/usr/sbin/strongswan -S open,openat -F path=wolfssl -F key=wolfssl_strongswan_load

-a always,exit -F arch=b32 -F dir=/etc/strongswan/ -F perm=r -S open,openat -F key=wolfssl_strongswan_config
-a always,exit -F arch=b64 -F dir=/etc/strongswan/ -F perm=r -S open,openat -F key=wolfssl_strongswan_config

## Monitor cURL with WolfSSL
-a always,exit -F arch=b32 -F exe=/usr/bin/curl -S open,openat -F path=wolfssl -F key=wolfssl_curl_load
-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S open,openat -F path=wolfssl -F key=wolfssl_curl_load

## Monitor FIPS 140-2/3 module operations
-a always,exit -F arch=b32 -F path=/usr/lib/wolfssl/.fipsverified -F perm=r -S open,openat -F key=wolfssl_fips_verify
-a always,exit -F arch=b64 -F path=/usr/lib64/wolfssl/.fipsverified -F perm=r -S open,openat -F key=wolfssl_fips_verify

-a always,exit -F arch=b32 -F path=/proc/sys/crypto/fips_enabled -F perm=r -S open,openat -F key=wolfssl_fips_enabled
-a always,exit -F arch=b64 -F path=/proc/sys/crypto/fips_enabled -F perm=r -S open,openat -F key=wolfssl_fips_enabled

## GnuTLS (Syscall Rules Only)

## Monitor file operations on GnuTLS libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libgnutls.so -F perm=rwxa -S open,openat -F key=gnutls_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libgnutls.so -F perm=rwxa -S open,openat -F key=gnutls_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libgnutls.so.30 -F perm=rwxa -S open,openat -F key=gnutls_lib30_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libgnutls.so.30 -F perm=rwxa -S open,openat -F key=gnutls_lib30_access

-a always,exit -F arch=b32 -F path=/usr/lib/libgnutls-openssl.so -F perm=rwxa -S open,openat -F key=gnutls_openssl_compat
-a always,exit -F arch=b64 -F path=/usr/lib64/libgnutls-openssl.so -F perm=rwxa -S open,openat -F key=gnutls_openssl_compat

-a always,exit -F arch=b32 -F path=/usr/lib/libgnutlsxx.so -F perm=rwxa -S open,openat -F key=gnutls_cpp_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libgnutlsxx.so -F perm=rwxa -S open,openat -F key=gnutls_cpp_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libgnutls-dane.so -F perm=rwxa -S open,openat -F key=gnutls_dane_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libgnutls-dane.so -F perm=rwxa -S open,openat -F key=gnutls_dane_lib_access

-a always,exit -F arch=b32 -F path=/usr/local/lib/libgnutls.so -F perm=rwxa -S open,openat -F key=gnutls_lib_access
-a always,exit -F arch=b64 -F path=/usr/local/lib64/libgnutls.so -F perm=rwxa -S open,openat -F key=gnutls_lib_access

## Monitor GnuTLS dependencies
-a always,exit -F arch=b32 -F path=/usr/lib/libnettle.so -F perm=rwxa -S open,openat -F key=gnutls_nettle_lib
-a always,exit -F arch=b64 -F path=/usr/lib64/libnettle.so -F perm=rwxa -S open,openat -F key=gnutls_nettle_lib

-a always,exit -F arch=b32 -F path=/usr/lib/libhogweed.so -F perm=rwxa -S open,openat -F key=gnutls_hogweed_lib
-a always,exit -F arch=b64 -F path=/usr/lib64/libhogweed.so -F perm=rwxa -S open,openat -F key=gnutls_hogweed_lib

-a always,exit -F arch=b32 -F path=/usr/lib/libgmp.so -F perm=rwxa -S open,openat -F key=gnutls_gmp_lib
-a always,exit -F arch=b64 -F path=/usr/lib64/libgmp.so -F perm=rwxa -S open,openat -F key=gnutls_gmp_lib

-a always,exit -F arch=b32 -F path=/usr/lib/libtasn1.so -F perm=rwxa -S open,openat -F key=gnutls_tasn1_lib
-a always,exit -F arch=b64 -F path=/usr/lib64/libtasn1.so -F perm=rwxa -S open,openat -F key=gnutls_tasn1_lib

-a always,exit -F arch=b32 -F path=/usr/lib/libp11-kit.so -F perm=rwxa -S open,openat -F key=gnutls_p11kit_lib
-a always,exit -F arch=b64 -F path=/usr/lib64/libp11-kit.so -F perm=rwxa -S open,openat -F key=gnutls_p11kit_lib

## Monitor GnuTLS header files
-a always,exit -F arch=b32 -F dir=/usr/include/gnutls/ -F perm=r -S open,openat -F key=gnutls_headers
-a always,exit -F arch=b64 -F dir=/usr/include/gnutls/ -F perm=r -S open,openat -F key=gnutls_headers

-a always,exit -F arch=b32 -F dir=/usr/local/include/gnutls/ -F perm=r -S open,openat -F key=gnutls_headers
-a always,exit -F arch=b64 -F dir=/usr/local/include/gnutls/ -F perm=r -S open,openat -F key=gnutls_headers

## Monitor execve calls for GnuTLS utilities
-a always,exit -F arch=b32 -F path=/usr/bin/gnutls-cli -S execve -F key=gnutls_cli_exec
-a always,exit -F arch=b64 -F path=/usr/bin/gnutls-cli -S execve -F key=gnutls_cli_exec

-a always,exit -F arch=b32 -F path=/usr/bin/gnutls-serv -S execve -F key=gnutls_serv_exec
-a always,exit -F arch=b64 -F path=/usr/bin/gnutls-serv -S execve -F key=gnutls_serv_exec

-a always,exit -F arch=b32 -F path=/usr/bin/gnutls-cli-debug -S execve -F key=gnutls_cli_debug_exec
-a always,exit -F arch=b64 -F path=/usr/bin/gnutls-cli-debug -S execve -F key=gnutls_cli_debug_exec

-a always,exit -F arch=b32 -F path=/usr/bin/certtool -S execve -F key=gnutls_certtool_exec
-a always,exit -F arch=b64 -F path=/usr/bin/certtool -S execve -F key=gnutls_certtool_exec

-a always,exit -F arch=b32 -F path=/usr/bin/psktool -S execve -F key=gnutls_psktool_exec
-a always,exit -F arch=b64 -F path=/usr/bin/psktool -S execve -F key=gnutls_psktool_exec

-a always,exit -F arch=b32 -F path=/usr/bin/p11tool -S execve -F key=gnutls_p11tool_exec
-a always,exit -F arch=b64 -F path=/usr/bin/p11tool -S execve -F key=gnutls_p11tool_exec

-a always,exit -F arch=b32 -F path=/usr/bin/ocsptool -S execve -F key=gnutls_ocsptool_exec
-a always,exit -F arch=b64 -F path=/usr/bin/ocsptool -S execve -F key=gnutls_ocsptool_exec

-a always,exit -F arch=b32 -F path=/usr/bin/danetool -S execve -F key=gnutls_danetool_exec
-a always,exit -F arch=b64 -F path=/usr/bin/danetool -S execve -F key=gnutls_danetool_exec

-a always,exit -F arch=b32 -F path=/usr/bin/tpmtool -S execve -F key=gnutls_tpmtool_exec
-a always,exit -F arch=b64 -F path=/usr/bin/tpmtool -S execve -F key=gnutls_tpmtool_exec

## Monitor socket creation for SSL/TLS
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=1 -F success=1 -F key=gnutls_tcp_socket
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=1 -F success=1 -F key=gnutls_tcp_socket

-a always,exit -F arch=b32 -S socket -F a0=10 -F a1=1 -F success=1 -F key=gnutls_tcp6_socket
-a always,exit -F arch=b64 -S socket -F a0=10 -F a1=1 -F success=1 -F key=gnutls_tcp6_socket

-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=2 -F success=1 -F key=gnutls_udp_socket
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=2 -F success=1 -F key=gnutls_udp_socket

## Monitor bind calls on SSL/TLS and DTLS ports
-a always,exit -F arch=b32 -S bind -F exit=0 -F key=gnutls_bind_success
-a always,exit -F arch=b64 -S bind -F exit=0 -F key=gnutls_bind_success

## Monitor listen calls (for server applications)
-a always,exit -F arch=b32 -S listen -F success=1 -F key=gnutls_listen
-a always,exit -F arch=b64 -S listen -F success=1 -F key=gnutls_listen

## Monitor accept/accept4 calls (incoming connections)
-a always,exit -F arch=b32 -S accept,accept4 -F success=1 -F key=gnutls_accept
-a always,exit -F arch=b64 -S accept,accept4 -F success=1 -F key=gnutls_accept

## Monitor connect calls (outgoing connections)
-a always,exit -F arch=b32 -S connect -F success=1 -F key=gnutls_connect_success
-a always,exit -F arch=b64 -S connect -F success=1 -F key=gnutls_connect_success

-a always,exit -F arch=b32 -S connect -F exit=-ECONNREFUSED -F key=gnutls_connect_refused
-a always,exit -F arch=b64 -S connect -F exit=-ECONNREFUSED -F key=gnutls_connect_refused

-a always,exit -F arch=b64 -S connect -F exit=-ETIMEDOUT -F key=gnutls_connect_timeout

## Monitor certificate and key file operations
-a always,exit -F arch=b32 -F dir=/etc/gnutls/ -F perm=r -S open,openat -F key=gnutls_config_read
-a always,exit -F arch=b64 -F dir=/etc/gnutls/ -F perm=r -S open,openat -F key=gnutls_config_read

-a always,exit -F arch=b32 -F dir=/etc/ssl/certs/ -F perm=r -S open,openat -F key=gnutls_cert_read
-a always,exit -F arch=b64 -F dir=/etc/ssl/certs/ -F perm=r -S open,openat -F key=gnutls_cert_read

-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -F perm=r -S open,openat -F key=gnutls_key_read
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -F perm=r -S open,openat -F key=gnutls_key_read

-a always,exit -F arch=b32 -F dir=/etc/pki/ -F perm=r -S open,openat -F key=gnutls_pki_access
-a always,exit -F arch=b64 -F dir=/etc/pki/ -F perm=r -S open,openat -F key=gnutls_pki_access

-a always,exit -F arch=b64 -F dir=/etc/pki/ca-trust/ -F perm=r -S open,openat -F key=gnutls_ca_trust_access

## Monitor failed access to sensitive directories
-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EACCES -F key=gnutls_key_denied
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EACCES -F key=gnutls_key_denied

-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EPERM -F key=gnutls_key_denied
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EPERM -F key=gnutls_key_denied

## Monitor GnuTLS configuration files
-a always,exit -F arch=b32 -F path=/etc/gnutls/config -F perm=rwa -S open,openat -F key=gnutls_config_file
-a always,exit -F arch=b64 -F path=/etc/gnutls/config -F perm=rwa -S open,openat -F key=gnutls_config_file

-a always,exit -F arch=b32 -F dir=/usr/share/gnutls/ -F perm=r -S open,openat -F key=gnutls_share_dir
-a always,exit -F arch=b64 -F dir=/usr/share/gnutls/ -F perm=r -S open,openat -F key=gnutls_share_dir

## Monitor PKCS#11 module operations
-a always,exit -F arch=b32 -F dir=/usr/lib/pkcs11/ -F perm=r -S open,openat -F key=gnutls_pkcs11_modules
-a always,exit -F arch=b64 -F dir=/usr/lib64/pkcs11/ -F perm=r -S open,openat -F key=gnutls_pkcs11_modules

-a always,exit -F arch=b32 -F path=/etc/pkcs11/modules/ -F perm=r -S open,openat -F key=gnutls_pkcs11_config
-a always,exit -F arch=b64 -F path=/etc/pkcs11/modules/ -F perm=r -S open,openat -F key=gnutls_pkcs11_config

## Monitor memory mapping of crypto libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libgnutls.so -S mmap,mprotect -F key=gnutls_lib_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libgnutls.so -S mmap,mprotect -F key=gnutls_lib_mmap

-a always,exit -F arch=b32 -F path=/usr/lib/libnettle.so -S mmap,mprotect -F key=gnutls_nettle_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libnettle.so -S mmap,mprotect -F key=gnutls_nettle_mmap

-a always,exit -F arch=b32 -F path=/usr/lib/libhogweed.so -S mmap,mprotect -F key=gnutls_hogweed_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libhogweed.so -S mmap,mprotect -F key=gnutls_hogweed_mmap

## Monitor random number generation access
-a always,exit -F arch=b32 -F path=/dev/random -F perm=r -S open,openat -F key=gnutls_random
-a always,exit -F arch=b64 -F path=/dev/random -F perm=r -S open,openat -F key=gnutls_random

-a always,exit -F arch=b32 -F path=/dev/urandom -F perm=r -S open,openat -F key=gnutls_urandom
-a always,exit -F arch=b64 -F path=/dev/urandom -F perm=r -S open,openat -F key=gnutls_urandom

-a always,exit -F arch=b32 -S getrandom -F key=gnutls_getrandom
-a always,exit -F arch=b64 -S getrandom -F key=gnutls_getrandom

## Monitor shared memory operations (for session caching)
-a always,exit -F arch=b32 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -S shmctl -F key=T1559_Inter-Process_Communication

## Example with exe filter: Monitor shared memory from GnuTLS applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/exim -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/sbin/exim -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -F exe=/usr/sbin/proftpd -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/sbin/proftpd -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -F exe=/usr/bin/weechat -S shmctl -F key=T1559_Inter-Process_Communication

## Monitor semaphore operations (for thread synchronization)
-a always,exit -F arch=b32 -S semget,semop,semctl -F key=gnutls_semaphore
-a always,exit -F arch=b64 -S semget,semop,semctl -F key=gnutls_semaphore

## Example with exe filter: Monitor semaphore operations from GnuTLS servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/exim -S semget,semop,semctl -F key=gnutls_exim_semaphore
-a always,exit -F arch=b64 -F exe=/usr/sbin/exim -S semget,semop,semctl -F key=gnutls_exim_semaphore

-a always,exit -F arch=b32 -F exe=/usr/sbin/cups -S semget,semop,semctl -F key=gnutls_cups_semaphore
-a always,exit -F arch=b64 -F exe=/usr/sbin/cups -S semget,semop,semctl -F key=gnutls_cups_semaphore

## Monitor file descriptor operations
-a always,exit -F arch=b32 -S dup,dup2,dup3 -F success=1 -F key=gnutls_fd_dup
-a always,exit -F arch=b64 -S dup,dup2,dup3 -F success=1 -F key=gnutls_fd_dup

-a always,exit -F arch=b64 -S fcntl -F a1=1 -F key=gnutls_fcntl_dupfd
-a always,exit -F arch=b64 -S fcntl -F a1=2 -F key=gnutls_fcntl_setfd

## Example with exe filter: Monitor FD operations from GnuTLS applications
-a always,exit -F arch=b32 -F exe=/usr/bin/wget -S dup,dup2,dup3 -F success=1 -F key=gnutls_wget_fd_dup
-a always,exit -F arch=b64 -F exe=/usr/bin/wget -S dup,dup2,dup3 -F success=1 -F key=gnutls_wget_fd_dup

-a always,exit -F arch=b64 -F exe=/usr/bin/lftp -S fcntl -F a1=1 -F key=gnutls_lftp_fcntl_dupfd
-a always,exit -F arch=b64 -F exe=/usr/bin/git -S fcntl -F a1=2 -F key=gnutls_git_fcntl_setfd

## Monitor socket options
-a always,exit -F arch=b32 -S setsockopt -F success=1 -F key=gnutls_setsockopt
-a always,exit -F arch=b64 -S setsockopt -F success=1 -F key=gnutls_setsockopt

-a always,exit -F arch=b64 -S getsockopt -F success=1 -F key=gnutls_getsockopt

## Example with exe filter: Monitor socket options from GnuTLS clients
-a always,exit -F arch=b32 -F exe=/usr/bin/wget -S setsockopt -F success=1 -F key=gnutls_wget_setsockopt
-a always,exit -F arch=b64 -F exe=/usr/bin/wget -S setsockopt -F success=1 -F key=gnutls_wget_setsockopt

-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S getsockopt -F success=1 -F key=gnutls_curl_getsockopt
-a always,exit -F arch=b64 -F exe=/usr/bin/aria2c -S setsockopt -F success=1 -F key=gnutls_aria2c_setsockopt

## Monitor I/O operations on sockets
-a always,exit -F arch=b32 -S sendto,sendmsg -F success=1 -F key=gnutls_send
-a always,exit -F arch=b64 -S sendto,sendmsg -F success=1 -F key=gnutls_send

-a always,exit -F arch=b32 -S recvfrom,recvmsg -F success=1 -F key=gnutls_recv
-a always,exit -F arch=b64 -S recvfrom,recvmsg -F success=1 -F key=gnutls_recv

-a always,exit -F arch=b64 -S read,write -F success=1 -F key=gnutls_io

## Example with exe filter: Monitor I/O from GnuTLS applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/exim -S sendto,sendmsg -F success=1 -F key=gnutls_exim_send
-a always,exit -F arch=b64 -F exe=/usr/sbin/exim -S sendto,sendmsg -F success=1 -F key=gnutls_exim_send

-a always,exit -F arch=b32 -F exe=/usr/bin/weechat -S recvfrom,recvmsg -F success=1 -F key=gnutls_weechat_recv
-a always,exit -F arch=b64 -F exe=/usr/bin/weechat -S recvfrom,recvmsg -F success=1 -F key=gnutls_weechat_recv

-a always,exit -F arch=b64 -F exe=/usr/bin/emacs -S read,write -F success=1 -F key=gnutls_emacs_io

## Monitor poll/select operations (for async I/O)
-a always,exit -F arch=b32 -S poll,select -F success=1 -F key=gnutls_poll
-a always,exit -F arch=b64 -S poll,ppoll,select,pselect6 -F success=1 -F key=gnutls_poll

## Example with exe filter: Monitor async I/O from GnuTLS servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/proftpd -S poll,select -F success=1 -F key=gnutls_proftpd_poll
-a always,exit -F arch=b64 -F exe=/usr/sbin/proftpd -S poll,ppoll,select,pselect6 -F success=1 -F key=gnutls_proftpd_poll

-a always,exit -F arch=b32 -F exe=/usr/bin/vlc -S poll,select -F success=1 -F key=gnutls_vlc_poll
-a always,exit -F arch=b64 -F exe=/usr/bin/vlc -S poll,ppoll,select,pselect6 -F success=1 -F key=gnutls_vlc_poll

## Monitor epoll operations (for high-performance servers)
-a always,exit -F arch=b32 -S epoll_create -F success=1 -F key=gnutls_epoll_create
-a always,exit -F arch=b64 -S epoll_create,epoll_create1 -F success=1 -F key=gnutls_epoll_create

-a always,exit -F arch=b64 -S epoll_ctl -F success=1 -F key=gnutls_epoll_ctl
-a always,exit -F arch=b64 -S epoll_wait,epoll_pwait -F success=1 -F key=gnutls_epoll_wait

## Example with exe filter: Monitor epoll from GnuTLS-enabled servers
-a always,exit -F arch=b32 -F exe=/usr/bin/caddy -S epoll_create -F success=1 -F key=gnutls_caddy_epoll_create
-a always,exit -F arch=b64 -F exe=/usr/bin/caddy -S epoll_create,epoll_create1 -F success=1 -F key=gnutls_caddy_epoll_create

-a always,exit -F arch=b64 -F exe=/usr/sbin/exim -S epoll_ctl -F success=1 -F key=gnutls_exim_epoll_ctl
-a always,exit -F arch=b64 -F exe=/usr/bin/neomutt -S epoll_wait,epoll_pwait -F success=1 -F key=gnutls_neomutt_epoll_wait

## Monitor privilege changes
-a always,exit -F arch=b32 -S setuid,setreuid -F success=1 -F key=gnutls_setuid
-a always,exit -F arch=b64 -S setuid,setreuid,setresuid -F success=1 -F key=gnutls_setuid

-a always,exit -F arch=b32 -S setgid,setregid -F success=1 -F key=gnutls_setgid
-a always,exit -F arch=b64 -S setgid,setregid,setresgid -F success=1 -F key=gnutls_setgid

## Example with exe filter: Monitor privilege drops from GnuTLS services
-a always,exit -F arch=b32 -F exe=/usr/sbin/exim -S setuid,setreuid -F success=1 -F key=gnutls_exim_setuid
-a always,exit -F arch=b64 -F exe=/usr/sbin/exim -S setuid,setreuid,setresuid -F success=1 -F key=gnutls_exim_setuid

-a always,exit -F arch=b32 -F exe=/usr/sbin/proftpd -S setgid,setregid -F success=1 -F key=gnutls_proftpd_setgid
-a always,exit -F arch=b64 -F exe=/usr/sbin/proftpd -S setgid,setregid,setresgid -F success=1 -F key=gnutls_proftpd_setgid

-a always,exit -F arch=b64 -F exe=/usr/sbin/cups -S setuid,setreuid,setresuid -F success=1 -F key=gnutls_cups_setuid

## Monitor capability changes
-a always,exit -F arch=b32 -S capset -F success=1 -F key=gnutls_capabilities
-a always,exit -F arch=b64 -S capset -F success=1 -F key=gnutls_capabilities

## Example with exe filter: Monitor capability changes from GnuTLS applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/exim -S capset -F success=1 -F key=gnutls_exim_capabilities
-a always,exit -F arch=b64 -F exe=/usr/sbin/exim -S capset -F success=1 -F key=gnutls_exim_capabilities

-a always,exit -F arch=b32 -F exe=/usr/bin/wireshark -S capset -F success=1 -F key=gnutls_wireshark_capabilities
-a always,exit -F arch=b64 -F exe=/usr/bin/wireshark -S capset -F success=1 -F key=gnutls_wireshark_capabilities

## Monitor process creation and termination
-a always,exit -F arch=b32 -S clone,fork,vfork -F success=1 -F key=gnutls_process_create
-a always,exit -F arch=b64 -S clone,fork,vfork -F success=1 -F key=gnutls_process_create

-a always,exit -F arch=b64 -S exit,exit_group -F key=gnutls_process_exit

## Example with exe filter: Monitor process operations from GnuTLS applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/exim -S clone,fork,vfork -F success=1 -F key=gnutls_exim_fork
-a always,exit -F arch=b64 -F exe=/usr/sbin/exim -S clone,fork,vfork -F success=1 -F key=gnutls_exim_fork

-a always,exit -F arch=b32 -F exe=/usr/bin/git -S clone,fork,vfork -F success=1 -F key=gnutls_git_fork
-a always,exit -F arch=b64 -F exe=/usr/bin/git -S clone,fork,vfork -F success=1 -F key=gnutls_git_fork

-a always,exit -F arch=b64 -F exe=/usr/bin/certtool -S exit,exit_group -F key=gnutls_certtool_exit

## Monitor signal handling (for graceful shutdown)
-a always,exit -F arch=b32 -S kill,tkill,tgkill -F a1=15 -F key=gnutls_sigterm
-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=15 -F key=gnutls_sigterm

-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=2 -F key=gnutls_sigint

## Example with exe filter: Monitor signals to/from GnuTLS applications
-a always,exit -F arch=b32 -F exe=/usr/bin/systemctl -S kill,tkill,tgkill -F a1=15 -F key=gnutls_systemctl_sigterm
-a always,exit -F arch=b64 -F exe=/usr/bin/systemctl -S kill,tkill,tgkill -F a1=15 -F key=gnutls_systemctl_sigterm

-a always,exit -F arch=b32 -F exe=/usr/sbin/service -S kill,tkill,tgkill -F a1=15 -F key=gnutls_service_sigterm
-a always,exit -F arch=b64 -F exe=/usr/sbin/service -S kill,tkill,tgkill -F a1=15 -F key=gnutls_service_sigterm

-a always,exit -F arch=b64 -F exe=/usr/bin/killall -S kill,tkill,tgkill -F a1=2 -F key=gnutls_killall_sigint

## Monitor time operations (for certificate validity checking)
-a always,exit -F arch=b32 -S clock_gettime -F a0=0 -F key=gnutls_clock_realtime
-a always,exit -F arch=b64 -S clock_gettime -F a0=0 -F key=gnutls_clock_realtime

-a always,exit -F arch=b64 -S gettimeofday -F key=gnutls_gettimeofday

## Example with exe filter: Monitor time operations from GnuTLS applications
-a always,exit -F arch=b32 -F exe=/usr/bin/wget -S clock_gettime -F a0=0 -F key=gnutls_wget_time
-a always,exit -F arch=b64 -F exe=/usr/bin/wget -S clock_gettime -F a0=0 -F key=gnutls_wget_time

-a always,exit -F arch=b32 -F exe=/usr/bin/curl -S clock_gettime -F a0=0 -F key=gnutls_curl_time
-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S clock_gettime -F a0=0 -F key=gnutls_curl_time

-a always,exit -F arch=b64 -F exe=/usr/bin/certtool -S gettimeofday -F key=gnutls_certtool_time

## Monitor memory operations
-a always,exit -F arch=b32 -S mlock,mlockall -F success=1 -F key=gnutls_mlock
-a always,exit -F arch=b64 -S mlock,mlock2,mlockall -F success=1 -F key=gnutls_mlock

-a always,exit -F arch=b64 -S munlock,munlockall -F success=1 -F key=gnutls_munlock

## Monitor namespace operations (for containerized deployments)
-a always,exit -F arch=b32 -S setns,unshare -F success=1 -F key=gnutls_namespace
-a always,exit -F arch=b64 -S setns,unshare -F success=1 -F key=gnutls_namespace

## Monitor chroot operations (for jailed environments)
-a always,exit -F arch=b32 -S chroot -F key=gnutls_chroot
-a always,exit -F arch=b64 -S chroot -F key=gnutls_chroot

## Monitor library loading
-a always,exit -F arch=b32 -F dir=/lib/ -F path=libgnutls -S open,openat -F key=gnutls_lib_load
-a always,exit -F arch=b32 -F dir=/usr/lib/ -F path=libgnutls -S open,openat -F key=gnutls_lib_load

-a always,exit -F arch=b64 -F dir=/lib64/ -F path=libgnutls -S open,openat -F key=gnutls_lib_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/ -F path=libgnutls -S open,openat -F key=gnutls_lib_load

-a always,exit -F arch=b32 -F dir=/lib/ -F path=libnettle -S open,openat -F key=gnutls_nettle_load
-a always,exit -F arch=b32 -F dir=/usr/lib/ -F path=libnettle -S open,openat -F key=gnutls_nettle_load

-a always,exit -F arch=b64 -F dir=/lib64/ -F path=libnettle -S open,openat -F key=gnutls_nettle_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/ -F path=libnettle -S open,openat -F key=gnutls_nettle_load

## Monitor application-specific GnuTLS usage
-a always,exit -F arch=b32 -F dir=/var/lib/gnutls/ -F perm=rwa -S open,openat -F key=gnutls_var_lib
-a always,exit -F arch=b64 -F dir=/var/lib/gnutls/ -F perm=rwa -S open,openat -F key=gnutls_var_lib

-a always,exit -F arch=b32 -F dir=/opt/gnutls/ -F perm=rwa -S open,openat -F key=gnutls_opt
-a always,exit -F arch=b64 -F dir=/opt/gnutls/ -F perm=rwa -S open,openat -F key=gnutls_opt

## Monitor TPM operations (for hardware security)
-a always,exit -F arch=b32 -F path=/dev/tpm0 -F perm=rw -S open,openat -F key=gnutls_tpm_access
-a always,exit -F arch=b64 -F path=/dev/tpm0 -F perm=rw -S open,openat -F key=gnutls_tpm_access

-a always,exit -F arch=b32 -F path=/dev/tpmrm0 -F perm=rw -S open,openat -F key=gnutls_tpmrm_access
-a always,exit -F arch=b64 -F path=/dev/tpmrm0 -F perm=rw -S open,openat -F key=gnutls_tpmrm_access

## Monitor DANE/DNSSEC operations
-a always,exit -F arch=b32 -F path=/etc/unbound/root.key -F perm=r -S open,openat -F key=gnutls_dnssec_root_key
-a always,exit -F arch=b64 -F path=/etc/unbound/root.key -F perm=r -S open,openat -F key=gnutls_dnssec_root_key

## BoringSSL (Syscall Rules Only)

## Monitor file operations on BoringSSL libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libssl.so -F perm=rwxa -S open,openat -F key=boringssl_lib_access

-a always,exit -F arch=b64 -F path=/usr/lib64/libssl.so -F perm=rwxa -S open,openat -F key=boringssl_lib_access
-a always,exit -F arch=b32 -F path=/usr/lib/libcrypto.so -F perm=rwxa -S open,openat -F key=boringssl_crypto_lib_access

-a always,exit -F arch=b64 -F path=/usr/lib64/libcrypto.so -F perm=rwxa -S open,openat -F key=boringssl_crypto_lib_access
-a always,exit -F arch=b32 -F path=/usr/lib/libboringssl.so -F perm=rwxa -S open,openat -F key=boringssl_boring_lib_access

-a always,exit -F arch=b64 -F path=/usr/lib64/libboringssl.so -F perm=rwxa -S open,openat -F key=boringssl_boring_lib_access
-a always,exit -F arch=b32 -F path=/usr/local/lib/libssl.so -F perm=rwxa -S open,openat -F key=boringssl_lib_access

-a always,exit -F arch=b64 -F path=/usr/local/lib64/libssl.so -F perm=rwxa -S open,openat -F key=boringssl_lib_access
-a always,exit -F arch=b32 -F path=/usr/local/lib/libcrypto.so -F perm=rwxa -S open,openat -F key=boringssl_crypto_lib_access

-a always,exit -F arch=b64 -F path=/usr/local/lib64/libcrypto.so -F perm=rwxa -S open,openat -F key=boringssl_crypto_lib_access
-a always,exit -F arch=b32 -F path=/opt/boringssl/lib/libssl.so -F perm=rwxa -S open,openat -F key=boringssl_opt_lib_access

-a always,exit -F arch=b64 -F path=/opt/boringssl/lib64/libssl.so -F perm=rwxa -S open,openat -F key=boringssl_opt_lib_access
-a always,exit -F arch=b32 -F path=/opt/boringssl/lib/libcrypto.so -F perm=rwxa -S open,openat -F key=boringssl_opt_crypto_access

-a always,exit -F arch=b64 -F path=/opt/boringssl/lib64/libcrypto.so -F perm=rwxa -S open,openat -F key=boringssl_opt_crypto_access

## Monitor BoringSSL static libraries (commonly used in static builds)
-a always,exit -F arch=b32 -F path=/usr/lib/libssl.a -F perm=r -S open,openat -F key=boringssl_static_lib
-a always,exit -F arch=b64 -F path=/usr/lib64/libssl.a -F perm=r -S open,openat -F key=boringssl_static_lib

-a always,exit -F arch=b32 -F path=/usr/lib/libcrypto.a -F perm=r -S open,openat -F key=boringssl_static_crypto
-a always,exit -F arch=b64 -F path=/usr/lib64/libcrypto.a -F perm=r -S open,openat -F key=boringssl_static_crypto

## Monitor BoringSSL header files
-a always,exit -F arch=b32 -F dir=/usr/include/openssl/ -F perm=r -S open,openat -F key=boringssl_headers
-a always,exit -F arch=b64 -F dir=/usr/include/openssl/ -F perm=r -S open,openat -F key=boringssl_headers

-a always,exit -F arch=b32 -F dir=/usr/include/boringssl/ -F perm=r -S open,openat -F key=boringssl_headers
-a always,exit -F arch=b64 -F dir=/usr/include/boringssl/ -F perm=r -S open,openat -F key=boringssl_headers

-a always,exit -F arch=b32 -F dir=/usr/local/include/openssl/ -F perm=r -S open,openat -F key=boringssl_headers
-a always,exit -F arch=b64 -F dir=/usr/local/include/openssl/ -F perm=r -S open,openat -F key=boringssl_headers

-a always,exit -F arch=b32 -F dir=/opt/boringssl/include/ -F perm=r -S open,openat -F key=boringssl_opt_headers
-a always,exit -F arch=b64 -F dir=/opt/boringssl/include/ -F perm=r -S open,openat -F key=boringssl_opt_headers

## Monitor execve calls for BoringSSL utilities
-a always,exit -F arch=b32 -F path=/usr/bin/bssl -S execve -F key=boringssl_bssl_exec
-a always,exit -F arch=b64 -F path=/usr/bin/bssl -S execve -F key=boringssl_bssl_exec

-a always,exit -F arch=b32 -F path=/usr/local/bin/bssl -S execve -F key=boringssl_bssl_exec
-a always,exit -F arch=b64 -F path=/usr/local/bin/bssl -S execve -F key=boringssl_bssl_exec

-a always,exit -F arch=b32 -F path=/opt/boringssl/bin/bssl -S execve -F key=boringssl_bssl_exec
-a always,exit -F arch=b64 -F path=/opt/boringssl/bin/bssl -S execve -F key=boringssl_bssl_exec

## Monitor socket creation for SSL/TLS
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=1 -F success=1 -F key=boringssl_tcp_socket
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=1 -F success=1 -F key=boringssl_tcp_socket

-a always,exit -F arch=b32 -S socket -F a0=10 -F a1=1 -F success=1 -F key=boringssl_tcp6_socket
-a always,exit -F arch=b64 -S socket -F a0=10 -F a1=1 -F success=1 -F key=boringssl_tcp6_socket

-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=2 -F success=1 -F key=boringssl_udp_socket
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=2 -F success=1 -F key=boringssl_udp_socket

## Monitor bind calls on SSL/TLS and QUIC ports
-a always,exit -F arch=b32 -S bind -F exit=0 -F key=boringssl_bind_success
-a always,exit -F arch=b64 -S bind -F exit=0 -F key=boringssl_bind_success

## Monitor listen calls (for server applications)
-a always,exit -F arch=b32 -S listen -F success=1 -F key=boringssl_listen
-a always,exit -F arch=b64 -S listen -F success=1 -F key=boringssl_listen

## Monitor accept/accept4 calls (incoming connections)
-a always,exit -F arch=b32 -S accept,accept4 -F success=1 -F key=boringssl_accept
-a always,exit -F arch=b64 -S accept,accept4 -F success=1 -F key=boringssl_accept

## Monitor connect calls (outgoing connections)
-a always,exit -F arch=b32 -S connect -F success=1 -F key=boringssl_connect_success
-a always,exit -F arch=b64 -S connect -F success=1 -F key=boringssl_connect_success

-a always,exit -F arch=b32 -S connect -F exit=-ECONNREFUSED -F key=boringssl_connect_refused
-a always,exit -F arch=b64 -S connect -F exit=-ECONNREFUSED -F key=boringssl_connect_refused

-a always,exit -F arch=b64 -S connect -F exit=-ETIMEDOUT -F key=boringssl_connect_timeout

## Monitor certificate and key file operations
-a always,exit -F arch=b32 -F dir=/etc/boringssl/ -F perm=r -S open,openat -F key=boringssl_config_read
-a always,exit -F arch=b64 -F dir=/etc/boringssl/ -F perm=r -S open,openat -F key=boringssl_config_read

-a always,exit -F arch=b32 -F dir=/etc/ssl/certs/ -F perm=r -S open,openat -F key=boringssl_cert_read
-a always,exit -F arch=b64 -F dir=/etc/ssl/certs/ -F perm=r -S open,openat -F key=boringssl_cert_read

-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -F perm=r -S open,openat -F key=boringssl_key_read
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -F perm=r -S open,openat -F key=boringssl_key_read

-a always,exit -F arch=b32 -F dir=/etc/pki/ -F perm=r -S open,openat -F key=boringssl_pki_access
-a always,exit -F arch=b64 -F dir=/etc/pki/ -F perm=r -S open,openat -F key=boringssl_pki_access

-a always,exit -F arch=b64 -F dir=/etc/pki/ca-trust/ -F perm=r -S open,openat -F key=boringssl_ca_trust_access

## Monitor failed access to sensitive directories
-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EACCES -F key=boringssl_key_denied
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EACCES -F key=boringssl_key_denied

-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EPERM -F key=boringssl_key_denied
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -S open,openat -F exit=-EPERM -F key=boringssl_key_denied

## Monitor memory mapping of crypto libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libssl.so -S mmap,mprotect -F key=boringssl_lib_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libssl.so -S mmap,mprotect -F key=boringssl_lib_mmap

-a always,exit -F arch=b32 -F path=/usr/lib/libcrypto.so -S mmap,mprotect -F key=boringssl_crypto_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libcrypto.so -S mmap,mprotect -F key=boringssl_crypto_mmap

## Monitor random number generation access
-a always,exit -F arch=b32 -F path=/dev/random -F perm=r -S open,openat -F key=boringssl_random
-a always,exit -F arch=b64 -F path=/dev/random -F perm=r -S open,openat -F key=boringssl_random

-a always,exit -F arch=b32 -F path=/dev/urandom -F perm=r -S open,openat -F key=boringssl_urandom
-a always,exit -F arch=b64 -F path=/dev/urandom -F perm=r -S open,openat -F key=boringssl_urandom

-a always,exit -F arch=b32 -S getrandom -F key=boringssl_getrandom
-a always,exit -F arch=b64 -S getrandom -F key=boringssl_getrandom

## Monitor shared memory operations (for session caching)
-a always,exit -F arch=b32 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -S shmctl -F key=T1559_Inter-Process_Communication

## Example with exe filter: Monitor shared memory from BoringSSL applications
-a always,exit -F arch=b32 -F exe=/opt/google/chrome/chrome -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/opt/google/chrome/chrome -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -F exe=/usr/bin/chromium-browser -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/bin/chromium-browser -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S shmctl -F key=T1559_Inter-Process_Communication

## Monitor semaphore operations (for thread synchronization)
-a always,exit -F arch=b32 -S semget,semop,semctl -F key=boringssl_semaphore
-a always,exit -F arch=b64 -S semget,semop,semctl -F key=boringssl_semaphore

## Example with exe filter: Monitor semaphore operations from BoringSSL servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S semget,semop,semctl -F key=boringssl_nginx_semaphore
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S semget,semop,semctl -F key=boringssl_nginx_semaphore

-a always,exit -F arch=b32 -F exe=/usr/bin/envoy -S semget,semop,semctl -F key=boringssl_envoy_semaphore
-a always,exit -F arch=b64 -F exe=/usr/bin/envoy -S semget,semop,semctl -F key=boringssl_envoy_semaphore

## Monitor file descriptor operations
-a always,exit -F arch=b32 -S dup,dup2,dup3 -F success=1 -F key=boringssl_fd_dup
-a always,exit -F arch=b64 -S dup,dup2,dup3 -F success=1 -F key=boringssl_fd_dup

-a always,exit -F arch=b64 -S fcntl -F a1=1 -F key=boringssl_fcntl_dupfd

-a always,exit -F arch=b64 -S fcntl -F a1=2 -F key=boringssl_fcntl_setfd

## Example with exe filter: Monitor FD operations from BoringSSL applications
-a always,exit -F arch=b32 -F exe=/opt/google/chrome/chrome -S dup,dup2,dup3 -F success=1 -F key=boringssl_chrome_fd_dup
-a always,exit -F arch=b64 -F exe=/opt/google/chrome/chrome -S dup,dup2,dup3 -F success=1 -F key=boringssl_chrome_fd_dup

-a always,exit -F arch=b64 -F exe=/usr/bin/grpc_cli -S fcntl -F a1=1 -F key=boringssl_grpc_fcntl_dupfd
-a always,exit -F arch=b64 -F exe=/usr/bin/gsutil -S fcntl -F a1=2 -F key=boringssl_gsutil_fcntl_setfd

## Monitor socket options
-a always,exit -F arch=b32 -S setsockopt -F success=1 -F key=boringssl_setsockopt
-a always,exit -F arch=b64 -S setsockopt -F success=1 -F key=boringssl_setsockopt

-a always,exit -F arch=b64 -S getsockopt -F success=1 -F key=boringssl_getsockopt

## Example with exe filter: Monitor socket options from BoringSSL clients
-a always,exit -F arch=b32 -F exe=/opt/google/chrome/chrome -S setsockopt -F success=1 -F key=boringssl_chrome_setsockopt
-a always,exit -F arch=b64 -F exe=/opt/google/chrome/chrome -S setsockopt -F success=1 -F key=boringssl_chrome_setsockopt

-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S getsockopt -F success=1 -F key=boringssl_nginx_getsockopt
-a always,exit -F arch=b64 -F exe=/usr/bin/envoy -S setsockopt -F success=1 -F key=boringssl_envoy_setsockopt

## Monitor I/O operations on sockets
-a always,exit -F arch=b32 -S sendto,sendmsg -F success=1 -F key=boringssl_send
-a always,exit -F arch=b64 -S sendto,sendmsg -F success=1 -F key=boringssl_send

-a always,exit -F arch=b32 -S recvfrom,recvmsg -F success=1 -F key=boringssl_recv
-a always,exit -F arch=b64 -S recvfrom,recvmsg -F success=1 -F key=boringssl_recv

-a always,exit -F arch=b64 -S read,write -F success=1 -F key=boringssl_io

## Example with exe filter: Monitor I/O from BoringSSL applications
-a always,exit -F arch=b32 -F exe=/opt/google/chrome/chrome -S sendto,sendmsg -F success=1 -F key=boringssl_chrome_send
-a always,exit -F arch=b64 -F exe=/opt/google/chrome/chrome -S sendto,sendmsg -F success=1 -F key=boringssl_chrome_send

-a always,exit -F arch=b32 -F exe=/usr/bin/chromium-browser -S recvfrom,recvmsg -F success=1 -F key=boringssl_chromium_recv
-a always,exit -F arch=b64 -F exe=/usr/bin/chromium-browser -S recvfrom,recvmsg -F success=1 -F key=boringssl_chromium_recv

-a always,exit -F arch=b64 -F exe=/usr/bin/grpcurl -S read,write -F success=1 -F key=boringssl_grpcurl_io

## Monitor poll/select operations (for async I/O)
-a always,exit -F arch=b32 -S poll,select -F success=1 -F key=boringssl_poll
-a always,exit -F arch=b64 -S poll,ppoll,select,pselect6 -F success=1 -F key=boringssl_poll

## Example with exe filter: Monitor async I/O from BoringSSL servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S poll,select -F success=1 -F key=boringssl_nginx_poll
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S poll,ppoll,select,pselect6 -F success=1 -F key=boringssl_nginx_poll

-a always,exit -F arch=b32 -F exe=/usr/bin/envoy -S poll,select -F success=1 -F key=boringssl_envoy_poll
-a always,exit -F arch=b64 -F exe=/usr/bin/envoy -S poll,ppoll,select,pselect6 -F success=1 -F key=boringssl_envoy_poll

## Monitor epoll operations (for high-performance servers)
-a always,exit -F arch=b32 -S epoll_create -F success=1 -F key=boringssl_epoll_create
-a always,exit -F arch=b64 -S epoll_create,epoll_create1 -F success=1 -F key=boringssl_epoll_create

-a always,exit -F arch=b64 -S epoll_ctl -F success=1 -F key=boringssl_epoll_ctl

-a always,exit -F arch=b64 -S epoll_wait,epoll_pwait -F success=1 -F key=boringssl_epoll_wait

## Example with exe filter: Monitor epoll from BoringSSL-enabled servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S epoll_create -F success=1 -F key=boringssl_nginx_epoll_create
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S epoll_create,epoll_create1 -F success=1 -F key=boringssl_nginx_epoll_create

-a always,exit -F arch=b64 -F exe=/usr/bin/envoy -S epoll_ctl -F success=1 -F key=boringssl_envoy_epoll_ctl
-a always,exit -F arch=b64 -F exe=/usr/bin/istio-proxy -S epoll_wait,epoll_pwait -F success=1 -F key=boringssl_istio_epoll_wait

## Monitor privilege changes
-a always,exit -F arch=b32 -S setuid,setreuid -F success=1 -F key=boringssl_setuid
-a always,exit -F arch=b64 -S setuid,setreuid,setresuid -F success=1 -F key=boringssl_setuid

-a always,exit -F arch=b32 -S setgid,setregid -F success=1 -F key=boringssl_setgid
-a always,exit -F arch=b64 -S setgid,setregid,setresgid -F success=1 -F key=boringssl_setgid

## Example with exe filter: Monitor privilege drops from BoringSSL services
-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S setuid,setreuid -F success=1 -F key=boringssl_nginx_setuid
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S setuid,setreuid,setresuid -F success=1 -F key=boringssl_nginx_setuid

-a always,exit -F arch=b32 -F exe=/usr/bin/envoy -S setgid,setregid -F success=1 -F key=boringssl_envoy_setgid
-a always,exit -F arch=b64 -F exe=/usr/bin/envoy -S setgid,setregid,setresgid -F success=1 -F key=boringssl_envoy_setgid

-a always,exit -F arch=b64 -F exe=/opt/google/chrome/chrome-sandbox -S setuid,setreuid,setresuid -F success=1 -F key=boringssl_chrome_sandbox_setuid

## Monitor capability changes
-a always,exit -F arch=b32 -S capset -F success=1 -F key=boringssl_capabilities
-a always,exit -F arch=b64 -S capset -F success=1 -F key=boringssl_capabilities

## Example with exe filter: Monitor capability changes from BoringSSL applications
-a always,exit -F arch=b32 -F exe=/opt/google/chrome/chrome -S capset -F success=1 -F key=boringssl_chrome_capabilities
-a always,exit -F arch=b64 -F exe=/opt/google/chrome/chrome -S capset -F success=1 -F key=boringssl_chrome_capabilities

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S capset -F success=1 -F key=boringssl_nginx_capabilities
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S capset -F success=1 -F key=boringssl_nginx_capabilities

## Monitor process creation and termination
-a always,exit -F arch=b32 -S clone,fork,vfork -F success=1 -F key=boringssl_process_create
-a always,exit -F arch=b64 -S clone,fork,vfork -F success=1 -F key=boringssl_process_create

-a always,exit -F arch=b64 -S exit,exit_group -F key=boringssl_process_exit

## Example with exe filter: Monitor process operations from BoringSSL applications
-a always,exit -F arch=b32 -F exe=/opt/google/chrome/chrome -S clone,fork,vfork -F success=1 -F key=boringssl_chrome_fork
-a always,exit -F arch=b64 -F exe=/opt/google/chrome/chrome -S clone,fork,vfork -F success=1 -F key=boringssl_chrome_fork

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S clone,fork,vfork -F success=1 -F key=boringssl_nginx_fork
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S clone,fork,vfork -F success=1 -F key=boringssl_nginx_fork

-a always,exit -F arch=b64 -F exe=/usr/bin/bssl -S exit,exit_group -F key=boringssl_bssl_exit

## Monitor signal handling (for graceful shutdown)
-a always,exit -F arch=b32 -S kill,tkill,tgkill -F a1=15 -F key=boringssl_sigterm
-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=15 -F key=boringssl_sigterm

-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=2 -F key=boringssl_sigint

## Example with exe filter: Monitor signals to/from BoringSSL applications
-a always,exit -F arch=b32 -F exe=/usr/bin/systemctl -S kill,tkill,tgkill -F a1=15 -F key=boringssl_systemctl_sigterm
-a always,exit -F arch=b64 -F exe=/usr/bin/systemctl -S kill,tkill,tgkill -F a1=15 -F key=boringssl_systemctl_sigterm

-a always,exit -F arch=b32 -F exe=/usr/sbin/service -S kill,tkill,tgkill -F a1=15 -F key=boringssl_service_sigterm
-a always,exit -F arch=b64 -F exe=/usr/sbin/service -S kill,tkill,tgkill -F a1=15 -F key=boringssl_service_sigterm

-a always,exit -F arch=b64 -F exe=/usr/bin/killall -S kill,tkill,tgkill -F a1=2 -F key=boringssl_killall_sigint

## Monitor time operations (for certificate validity checking)
-a always,exit -F arch=b32 -S clock_gettime -F a0=0 -F key=boringssl_clock_realtime
-a always,exit -F arch=b64 -S clock_gettime -F a0=0 -F key=boringssl_clock_realtime

-a always,exit -F arch=b64 -S gettimeofday -F key=boringssl_gettimeofday

## Example with exe filter: Monitor time operations from BoringSSL applications
-a always,exit -F arch=b32 -F exe=/opt/google/chrome/chrome -S clock_gettime -F a0=0 -F key=boringssl_chrome_time
-a always,exit -F arch=b64 -F exe=/opt/google/chrome/chrome -S clock_gettime -F a0=0 -F key=boringssl_chrome_time

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S clock_gettime -F a0=0 -F key=boringssl_nginx_time
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S clock_gettime -F a0=0 -F key=boringssl_nginx_time

-a always,exit -F arch=b64 -F exe=/usr/bin/bssl -S gettimeofday -F key=boringssl_bssl_time

## Monitor memory operations
-a always,exit -F arch=b32 -S mlock,mlockall -F success=1 -F key=boringssl_mlock
-a always,exit -F arch=b64 -S mlock,mlock2,mlockall -F success=1 -F key=boringssl_mlock

-a always,exit -F arch=b64 -S munlock,munlockall -F success=1 -F key=boringssl_munlock

## Monitor namespace operations (for containerized deployments)
-a always,exit -F arch=b32 -S setns,unshare -F success=1 -F key=boringssl_namespace
-a always,exit -F arch=b64 -S setns,unshare -F success=1 -F key=boringssl_namespace

## Monitor chroot operations (for jailed environments)
-a always,exit -F arch=b32 -S chroot -F key=boringssl_chroot
-a always,exit -F arch=b64 -S chroot -F key=boringssl_chroot

## Monitor seccomp operations (Chrome sandboxing)
-a always,exit -F arch=b32 -S seccomp -F key=boringssl_seccomp
-a always,exit -F arch=b64 -S seccomp -F key=boringssl_seccomp

-a always,exit -F arch=b32 -S prctl -F a0=22 -F key=boringssl_prctl_seccomp
-a always,exit -F arch=b64 -S prctl -F a0=22 -F key=boringssl_prctl_seccomp

## Monitor library loading
-a always,exit -F arch=b32 -F dir=/lib/ -F path=libssl -S open,openat -F key=boringssl_lib_load
-a always,exit -F arch=b32 -F dir=/usr/lib/ -F path=libssl -S open,openat -F key=boringssl_lib_load

-a always,exit -F arch=b64 -F dir=/lib64/ -F path=libssl -S open,openat -F key=boringssl_lib_load

-a always,exit -F arch=b64 -F dir=/usr/lib64/ -F path=libssl -S open,openat -F key=boringssl_lib_load

-a always,exit -F arch=b32 -F dir=/lib/ -F path=libcrypto -S open,openat -F key=boringssl_crypto_load
-a always,exit -F arch=b64 -F dir=/lib64/ -F path=libcrypto -S open,openat -F key=boringssl_crypto_load

-a always,exit -F arch=b32 -F dir=/usr/lib/ -F path=libcrypto -S open,openat -F key=boringssl_crypto_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/ -F path=libcrypto -S open,openat -F key=boringssl_crypto_load

## Monitor Chrome/Chromium BoringSSL usage
-a always,exit -F arch=b32 -F dir=/opt/google/chrome/ -F path=libssl -S open,openat -F key=boringssl_chrome_load
-a always,exit -F arch=b64 -F dir=/opt/google/chrome/ -F path=libssl -S open,openat -F key=boringssl_chrome_load

-a always,exit -F arch=b32 -F dir=/usr/lib/chromium/ -F path=libssl -S open,openat -F key=boringssl_chromium_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/chromium/ -F path=libssl -S open,openat -F key=boringssl_chromium_load

-a always,exit -F arch=b32 -F dir=/usr/lib/chromium-browser/ -F path=libssl -S open,openat -F key=boringssl_chromium_browser_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/chromium-browser/ -F path=libssl -S open,openat -F key=boringssl_chromium_browser_load

## Monitor Android BoringSSL usage
-a always,exit -F arch=b32 -F dir=/system/lib/ -F path=libssl -S open,openat -F key=boringssl_android_load
-a always,exit -F arch=b64 -F dir=/system/lib64/ -F path=libssl -S open,openat -F key=boringssl_android_load

-a always,exit -F arch=b32 -F dir=/vendor/lib/ -F path=libssl -S open,openat -F key=boringssl_android_vendor_load
-a always,exit -F arch=b64 -F dir=/vendor/lib64/ -F path=libssl -S open,openat -F key=boringssl_android_vendor_load

## Monitor gRPC BoringSSL usage
-a always,exit -F arch=b32 -F dir=/usr/lib/grpc/ -F perm=r -S open,openat -F key=boringssl_grpc_lib
-a always,exit -F arch=b64 -F dir=/usr/lib64/grpc/ -F perm=r -S open,openat -F key=boringssl_grpc_lib

## Monitor QUIC protocol operations
-a always,exit -F arch=b32 -F dir=/var/lib/quic/ -F perm=rwa -S open,openat -F key=boringssl_quic_data
-a always,exit -F arch=b64 -F dir=/var/lib/quic/ -F perm=rwa -S open,openat -F key=boringssl_quic_data

## Monitor application-specific BoringSSL usage
-a always,exit -F arch=b32 -F dir=/var/lib/boringssl/ -F perm=rwa -S open,openat -F key=boringssl_var_lib
-a always,exit -F arch=b64 -F dir=/var/lib/boringssl/ -F perm=rwa -S open,openat -F key=boringssl_var_lib

-a always,exit -F arch=b32 -F dir=/opt/boringssl/ -F perm=rwa -S open,openat -F key=boringssl_opt
-a always,exit -F arch=b64 -F dir=/opt/boringssl/ -F perm=rwa -S open,openat -F key=boringssl_opt

# NSS (Network Security Services)(Syscall Rules Only)

## Monitor file operations on NSS libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libnss3.so -F perm=rwxa -S open,openat -F key=nss_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libnss3.so -F perm=rwxa -S open,openat -F key=nss_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libnssutil3.so -F perm=rwxa -S open,openat -F key=nss_util_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libnssutil3.so -F perm=rwxa -S open,openat -F key=nss_util_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libsmime3.so -F perm=rwxa -S open,openat -F key=nss_smime_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libsmime3.so -F perm=rwxa -S open,openat -F key=nss_smime_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libssl3.so -F perm=rwxa -S open,openat -F key=nss_ssl3_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libssl3.so -F perm=rwxa -S open,openat -F key=nss_ssl3_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libnspr4.so -F perm=rwxa -S open,openat -F key=nss_nspr_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libnspr4.so -F perm=rwxa -S open,openat -F key=nss_nspr_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libplc4.so -F perm=rwxa -S open,openat -F key=nss_plc_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libplc4.so -F perm=rwxa -S open,openat -F key=nss_plc_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libplds4.so -F perm=rwxa -S open,openat -F key=nss_plds_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libplds4.so -F perm=rwxa -S open,openat -F key=nss_plds_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libnssckbi.so -F perm=rwxa -S open,openat -F key=nss_ckbi_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libnssckbi.so -F perm=rwxa -S open,openat -F key=nss_ckbi_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libsoftokn3.so -F perm=rwxa -S open,openat -F key=nss_softokn_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libsoftokn3.so -F perm=rwxa -S open,openat -F key=nss_softokn_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libfreebl3.so -F perm=rwxa -S open,openat -F key=nss_freebl_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libfreebl3.so -F perm=rwxa -S open,openat -F key=nss_freebl_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libfreeblpriv3.so -F perm=rwxa -S open,openat -F key=nss_freeblpriv_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libfreeblpriv3.so -F perm=rwxa -S open,openat -F key=nss_freeblpriv_lib_access

## Monitor NSS header files
-a always,exit -F arch=b32 -F dir=/usr/include/nss3/ -F perm=r -S open,openat -F key=nss_headers
-a always,exit -F arch=b64 -F dir=/usr/include/nss3/ -F perm=r -S open,openat -F key=nss_headers

-a always,exit -F arch=b32 -F dir=/usr/include/nspr4/ -F perm=r -S open,openat -F key=nss_nspr_headers
-a always,exit -F arch=b64 -F dir=/usr/include/nspr4/ -F perm=r -S open,openat -F key=nss_nspr_headers

## Monitor execve calls for NSS tools
-a always,exit -F arch=b32 -F path=/usr/bin/certutil -S execve -F key=nss_certutil_exec
-a always,exit -F arch=b64 -F path=/usr/bin/certutil -S execve -F key=nss_certutil_exec

-a always,exit -F arch=b32 -F path=/usr/bin/pk12util -S execve -F key=nss_pk12util_exec
-a always,exit -F arch=b64 -F path=/usr/bin/pk12util -S execve -F key=nss_pk12util_exec

-a always,exit -F arch=b32 -F path=/usr/bin/modutil -S execve -F key=nss_modutil_exec
-a always,exit -F arch=b64 -F path=/usr/bin/modutil -S execve -F key=nss_modutil_exec

-a always,exit -F arch=b32 -F path=/usr/bin/shlibsign -S execve -F key=nss_shlibsign_exec
-a always,exit -F arch=b64 -F path=/usr/bin/shlibsign -S execve -F key=nss_shlibsign_exec

-a always,exit -F arch=b32 -F path=/usr/bin/signtool -S execve -F key=nss_signtool_exec
-a always,exit -F arch=b64 -F path=/usr/bin/signtool -S execve -F key=nss_signtool_exec

-a always,exit -F arch=b32 -F path=/usr/bin/ssltap -S execve -F key=nss_ssltap_exec
-a always,exit -F arch=b64 -F path=/usr/bin/ssltap -S execve -F key=nss_ssltap_exec

-a always,exit -F arch=b32 -F path=/usr/bin/vfychain -S execve -F key=nss_vfychain_exec
-a always,exit -F arch=b64 -F path=/usr/bin/vfychain -S execve -F key=nss_vfychain_exec

-a always,exit -F arch=b32 -F path=/usr/bin/vfyserv -S execve -F key=nss_vfyserv_exec
-a always,exit -F arch=b64 -F path=/usr/bin/vfyserv -S execve -F key=nss_vfyserv_exec

## Monitor NSS database operations
-a always,exit -F arch=b32 -F dir=/etc/pki/nssdb/ -F perm=rwa -S open,openat -F key=nss_system_db
-a always,exit -F arch=b64 -F dir=/etc/pki/nssdb/ -F perm=rwa -S open,openat -F key=nss_system_db

-a always,exit -F arch=b32 -F path=/etc/pki/nssdb/cert8.db -F perm=rwa -S open,openat -F key=nss_cert8_db
-a always,exit -F arch=b64 -F path=/etc/pki/nssdb/cert8.db -F perm=rwa -S open,openat -F key=nss_cert8_db

-a always,exit -F arch=b32 -F path=/etc/pki/nssdb/cert9.db -F perm=rwa -S open,openat -F key=nss_cert9_db
-a always,exit -F arch=b64 -F path=/etc/pki/nssdb/cert9.db -F perm=rwa -S open,openat -F key=nss_cert9_db

-a always,exit -F arch=b32 -F path=/etc/pki/nssdb/key3.db -F perm=rwa -S open,openat -F key=nss_key3_db
-a always,exit -F arch=b64 -F path=/etc/pki/nssdb/key3.db -F perm=rwa -S open,openat -F key=nss_key3_db

-a always,exit -F arch=b32 -F path=/etc/pki/nssdb/key4.db -F perm=rwa -S open,openat -F key=nss_key4_db
-a always,exit -F arch=b64 -F path=/etc/pki/nssdb/key4.db -F perm=rwa -S open,openat -F key=nss_key4_db

-a always,exit -F arch=b32 -F path=/etc/pki/nssdb/secmod.db -F perm=rwa -S open,openat -F key=nss_secmod_db
-a always,exit -F arch=b64 -F path=/etc/pki/nssdb/secmod.db -F perm=rwa -S open,openat -F key=nss_secmod_db

-a always,exit -F arch=b32 -F path=/etc/pki/nssdb/pkcs11.txt -F perm=rwa -S open,openat -F key=nss_pkcs11_txt
-a always,exit -F arch=b64 -F path=/etc/pki/nssdb/pkcs11.txt -F perm=rwa -S open,openat -F key=nss_pkcs11_txt

## Monitor user NSS databases
-a always,exit -F arch=b32 -F dir=/home/ -F perm=rwa -S open,openat -F key=nss_user_db
-a always,exit -F arch=b64 -F dir=/home/ -F perm=rwa -S open,openat -F key=nss_user_db

-a always,exit -F arch=b32 -F dir=/root/.pki/nssdb/ -F perm=rwa -S open,openat -F key=nss_root_db
-a always,exit -F arch=b64 -F dir=/root/.pki/nssdb/ -F perm=rwa -S open,openat -F key=nss_root_db

## Monitor socket creation for SSL/TLS
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=1 -F success=1 -F key=nss_tcp_socket
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=1 -F success=1 -F key=nss_tcp_socket

-a always,exit -F arch=b32 -S socket -F a0=10 -F a1=1 -F success=1 -F key=nss_tcp6_socket
-a always,exit -F arch=b64 -S socket -F a0=10 -F a1=1 -F success=1 -F key=nss_tcp6_socket

## Monitor bind calls on SSL/TLS ports
-a always,exit -F arch=b32 -S bind -F exit=0 -F key=nss_bind_success
-a always,exit -F arch=b64 -S bind -F exit=0 -F key=nss_bind_success

## Monitor listen calls (for server applications)
-a always,exit -F arch=b32 -S listen -F success=1 -F key=nss_listen
-a always,exit -F arch=b64 -S listen -F success=1 -F key=nss_listen

## Monitor accept/accept4 calls (incoming connections)
-a always,exit -F arch=b32 -S accept,accept4 -F success=1 -F key=nss_accept
-a always,exit -F arch=b64 -S accept,accept4 -F success=1 -F key=nss_accept

## Monitor connect calls (outgoing connections)
-a always,exit -F arch=b32 -S connect -F success=1 -F key=nss_connect_success
-a always,exit -F arch=b64 -S connect -F success=1 -F key=nss_connect_success

-a always,exit -F arch=b32 -S connect -F exit=-ECONNREFUSED -F key=nss_connect_refused
-a always,exit -F arch=b64 -S connect -F exit=-ECONNREFUSED -F key=nss_connect_refused

-a always,exit -F arch=b64 -S connect -F exit=-ETIMEDOUT -F key=nss_connect_timeout

## Monitor certificate and key file operations
-a always,exit -F arch=b32 -F dir=/etc/pki/tls/certs/ -F perm=r -S open,openat -F key=nss_cert_read
-a always,exit -F arch=b64 -F dir=/etc/pki/tls/certs/ -F perm=r -S open,openat -F key=nss_cert_read

-a always,exit -F arch=b32 -F dir=/etc/pki/tls/private/ -F perm=r -S open,openat -F key=nss_key_read
-a always,exit -F arch=b64 -F dir=/etc/pki/tls/private/ -F perm=r -S open,openat -F key=nss_key_read

-a always,exit -F arch=b32 -F dir=/etc/pki/ -F perm=r -S open,openat -F key=nss_pki_access
-a always,exit -F arch=b64 -F dir=/etc/pki/ -F perm=r -S open,openat -F key=nss_pki_access

-a always,exit -F arch=b64 -F dir=/etc/pki/ca-trust/ -F perm=r -S open,openat -F key=nss_ca_trust_access

## Monitor failed access to sensitive directories
-a always,exit -F arch=b32 -F dir=/etc/pki/tls/private/ -S open,openat -F exit=-EACCES -F key=nss_key_denied
-a always,exit -F arch=b64 -F dir=/etc/pki/tls/private/ -S open,openat -F exit=-EACCES -F key=nss_key_denied

-a always,exit -F arch=b32 -F dir=/etc/pki/tls/private/ -S open,openat -F exit=-EPERM -F key=nss_key_denied
-a always,exit -F arch=b64 -F dir=/etc/pki/tls/private/ -S open,openat -F exit=-EPERM -F key=nss_key_denied

-a always,exit -F arch=b32 -F dir=/etc/pki/nssdb/ -S open,openat -F exit=-EACCES -F key=nss_db_denied
-a always,exit -F arch=b64 -F dir=/etc/pki/nssdb/ -S open,openat -F exit=-EACCES -F key=nss_db_denied

## Monitor PKCS#11 module loading
-a always,exit -F arch=b32 -F dir=/usr/lib/pkcs11/ -F perm=r -S open,openat -F key=nss_pkcs11_modules
-a always,exit -F arch=b64 -F dir=/usr/lib64/pkcs11/ -F perm=r -S open,openat -F key=nss_pkcs11_modules

-a always,exit -F arch=b32 -F path=/usr/lib/libnssckbi.so -F perm=r -S open,openat -F key=nss_builtin_roots
-a always,exit -F arch=b64 -F path=/usr/lib64/libnssckbi.so -F perm=r -S open,openat -F key=nss_builtin_roots

## Monitor memory mapping of NSS libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libnss3.so -S mmap,mprotect -F key=nss_lib_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libnss3.so -S mmap,mprotect -F key=nss_lib_mmap

-a always,exit -F arch=b32 -F path=/usr/lib/libnspr4.so -S mmap,mprotect -F key=nss_nspr_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libnspr4.so -S mmap,mprotect -F key=nss_nspr_mmap

-a always,exit -F arch=b32 -F path=/usr/lib/libsoftokn3.so -S mmap,mprotect -F key=nss_softokn_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libsoftokn3.so -S mmap,mprotect -F key=nss_softokn_mmap

## Monitor random number generation access
-a always,exit -F arch=b32 -F path=/dev/random -F perm=r -S open,openat -F key=nss_random
-a always,exit -F arch=b64 -F path=/dev/random -F perm=r -S open,openat -F key=nss_random

-a always,exit -F arch=b32 -F path=/dev/urandom -F perm=r -S open,openat -F key=nss_urandom
-a always,exit -F arch=b64 -F path=/dev/urandom -F perm=r -S open,openat -F key=nss_urandom

-a always,exit -F arch=b32 -S getrandom -F key=nss_getrandom
-a always,exit -F arch=b64 -S getrandom -F key=nss_getrandom

## Monitor shared memory operations (for session caching)
-a always,exit -F arch=b32 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -S shmctl -F key=T1559_Inter-Process_Communication

## Example with exe filter: Monitor shared memory from browser applications
-a always,exit -F arch=b32 -F exe=/usr/lib/firefox/firefox -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/lib64/firefox/firefox -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -F exe=/usr/lib/thunderbird/thunderbird -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/lib64/thunderbird/thunderbird -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -F exe=/opt/google/chrome/chrome -S shmctl -F key=T1559_Inter-Process_Communication

## Monitor semaphore operations (for thread synchronization)
-a always,exit -F arch=b32 -S semget,semop,semctl -F key=nss_semaphore
-a always,exit -F arch=b64 -S semget,semop,semctl -F key=nss_semaphore

## Example with exe filter: Monitor semaphore operations from Mozilla applications
-a always,exit -F arch=b32 -F exe=/usr/lib/firefox/firefox -S semget,semop,semctl -F key=nss_firefox_semaphore
-a always,exit -F arch=b64 -F exe=/usr/lib64/firefox/firefox -S semget,semop,semctl -F key=nss_firefox_semaphore

-a always,exit -F arch=b32 -F exe=/usr/lib/seamonkey/seamonkey -S semget,semop,semctl -F key=nss_seamonkey_semaphore
-a always,exit -F arch=b64 -F exe=/usr/lib64/seamonkey/seamonkey -S semget,semop,semctl -F key=nss_seamonkey_semaphore

## Monitor file descriptor operations
-a always,exit -F arch=b32 -S dup,dup2,dup3 -F success=1 -F key=nss_fd_dup
-a always,exit -F arch=b64 -S dup,dup2,dup3 -F success=1 -F key=nss_fd_dup

-a always,exit -F arch=b64 -S fcntl -F a1=1 -F key=nss_fcntl_dupfd
-a always,exit -F arch=b64 -S fcntl -F a1=2 -F key=nss_fcntl_setfd

## Example with exe filter: Monitor FD operations from NSS-enabled applications
-a always,exit -F arch=b32 -F exe=/usr/bin/curl -S dup,dup2,dup3 -F success=1 -F key=nss_curl_fd_dup
-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S dup,dup2,dup3 -F success=1 -F key=nss_curl_fd_dup

-a always,exit -F arch=b64 -F exe=/usr/bin/wget -S fcntl -F a1=1 -F key=nss_wget_fcntl_dupfd
-a always,exit -F arch=b64 -F exe=/usr/lib64/firefox/firefox -S fcntl -F a1=2 -F key=nss_firefox_fcntl_setfd

## Monitor socket options
-a always,exit -F arch=b32 -S setsockopt -F success=1 -F key=nss_setsockopt
-a always,exit -F arch=b64 -S setsockopt -F success=1 -F key=nss_setsockopt

-a always,exit -F arch=b64 -S getsockopt -F success=1 -F key=nss_getsockopt

## Example with exe filter: Monitor socket options from browsers and tools
-a always,exit -F arch=b32 -F exe=/usr/lib/firefox/firefox -S setsockopt -F success=1 -F key=nss_firefox_setsockopt
-a always,exit -F arch=b64 -F exe=/usr/lib64/firefox/firefox -S setsockopt -F success=1 -F key=nss_firefox_setsockopt

-a always,exit -F arch=b64 -F exe=/opt/google/chrome/chrome -S getsockopt -F success=1 -F key=nss_chrome_getsockopt
-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S setsockopt -F success=1 -F key=nss_curl_setsockopt

## Monitor I/O operations on sockets
-a always,exit -F arch=b32 -S sendto,sendmsg -F success=1 -F key=nss_send
-a always,exit -F arch=b64 -S sendto,sendmsg -F success=1 -F key=nss_send

-a always,exit -F arch=b32 -S recvfrom,recvmsg -F success=1 -F key=nss_recv
-a always,exit -F arch=b64 -S recvfrom,recvmsg -F success=1 -F key=nss_recv

-a always,exit -F arch=b64 -S read,write -F success=1 -F key=nss_io

## Example with exe filter: Monitor I/O from NSS applications
-a always,exit -F arch=b32 -F exe=/usr/lib/firefox/firefox -S sendto,sendmsg -F success=1 -F key=nss_firefox_send
-a always,exit -F arch=b64 -F exe=/usr/lib64/firefox/firefox -S sendto,sendmsg -F success=1 -F key=nss_firefox_send

-a always,exit -F arch=b32 -F exe=/usr/lib/thunderbird/thunderbird -S recvfrom,recvmsg -F success=1 -F key=nss_thunderbird_recv
-a always,exit -F arch=b64 -F exe=/usr/lib64/thunderbird/thunderbird -S recvfrom,recvmsg -F success=1 -F key=nss_thunderbird_recv

-a always,exit -F arch=b64 -F exe=/usr/bin/evolution -S read,write -F success=1 -F key=nss_evolution_io

## Monitor poll/select operations (for async I/O)
-a always,exit -F arch=b32 -S poll,select -F success=1 -F key=nss_poll
-a always,exit -F arch=b64 -S poll,ppoll,select,pselect6 -F success=1 -F key=nss_poll

## Example with exe filter: Monitor async I/O from browsers
-a always,exit -F arch=b32 -F exe=/usr/lib/firefox/firefox -S poll,select -F success=1 -F key=nss_firefox_poll
-a always,exit -F arch=b64 -F exe=/usr/lib64/firefox/firefox -S poll,ppoll,select,pselect6 -F success=1 -F key=nss_firefox_poll

-a always,exit -F arch=b32 -F exe=/opt/google/chrome/chrome -S poll,select -F success=1 -F key=nss_chrome_poll
-a always,exit -F arch=b64 -F exe=/opt/google/chrome/chrome -S poll,ppoll,select,pselect6 -F success=1 -F key=nss_chrome_poll

## Monitor epoll operations (for high-performance servers)
-a always,exit -F arch=b32 -S epoll_create -F success=1 -F key=nss_epoll_create
-a always,exit -F arch=b64 -S epoll_create,epoll_create1 -F success=1 -F key=nss_epoll_create

-a always,exit -F arch=b64 -S epoll_ctl -F success=1 -F key=nss_epoll_ctl
-a always,exit -F arch=b64 -S epoll_wait,epoll_pwait -F success=1 -F key=nss_epoll_wait

## Example with exe filter: Monitor epoll from NSS-enabled servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/httpd -S epoll_create -F success=1 -F key=nss_httpd_epoll_create
-a always,exit -F arch=b64 -F exe=/usr/sbin/httpd -S epoll_create,epoll_create1 -F success=1 -F key=nss_httpd_epoll_create

-a always,exit -F arch=b64 -F exe=/usr/sbin/vsftpd -S epoll_ctl -F success=1 -F key=nss_vsftpd_epoll_ctl
-a always,exit -F arch=b64 -F exe=/usr/sbin/postfix -S epoll_wait,epoll_pwait -F success=1 -F key=nss_postfix_epoll_wait

## Monitor file locking (for database operations)
-a always,exit -F arch=b32 -S flock -F success=1 -F key=nss_flock
-a always,exit -F arch=b64 -S flock -F success=1 -F key=nss_flock

-a always,exit -F arch=b32 -S fcntl -F a1=6 -F key=nss_fcntl_setlk
-a always,exit -F arch=b64 -S fcntl -F a1=6 -F key=nss_fcntl_setlk

## Monitor privilege changes
-a always,exit -F arch=b32 -S setuid,setreuid -F success=1 -F key=nss_setuid
-a always,exit -F arch=b64 -S setuid,setreuid,setresuid -F success=1 -F key=nss_setuid

-a always,exit -F arch=b32 -S setgid,setregid -F success=1 -F key=nss_setgid
-a always,exit -F arch=b64 -S setgid,setregid,setresgid -F success=1 -F key=nss_setgid

## Example with exe filter: Monitor privilege drops from NSS applications
-a always,exit -F arch=b32 -F exe=/usr/lib/firefox/firefox -S setuid,setreuid -F success=1 -F key=nss_firefox_setuid
-a always,exit -F arch=b64 -F exe=/usr/lib64/firefox/firefox -S setuid,setreuid,setresuid -F success=1 -F key=nss_firefox_setuid

-a always,exit -F arch=b32 -F exe=/usr/sbin/httpd -S setgid,setregid -F success=1 -F key=nss_httpd_setgid
-a always,exit -F arch=b64 -F exe=/usr/sbin/httpd -S setgid,setregid,setresgid -F success=1 -F key=nss_httpd_setgid

## Monitor capability changes
-a always,exit -F arch=b32 -S capset -F success=1 -F key=nss_capabilities
-a always,exit -F arch=b64 -S capset -F success=1 -F key=nss_capabilities

## Example with exe filter: Monitor capability changes from browsers
-a always,exit -F arch=b32 -F exe=/usr/lib/firefox/firefox -S capset -F success=1 -F key=nss_firefox_capabilities
-a always,exit -F arch=b64 -F exe=/usr/lib64/firefox/firefox -S capset -F success=1 -F key=nss_firefox_capabilities

-a always,exit -F arch=b32 -F exe=/opt/google/chrome/chrome -S capset -F success=1 -F key=nss_chrome_capabilities
-a always,exit -F arch=b64 -F exe=/opt/google/chrome/chrome -S capset -F success=1 -F key=nss_chrome_capabilities

## Monitor process creation and termination
-a always,exit -F arch=b32 -S clone,fork,vfork -F success=1 -F key=nss_process_create
-a always,exit -F arch=b64 -S clone,fork,vfork -F success=1 -F key=nss_process_create

-a always,exit -F arch=b64 -S exit,exit_group -F key=nss_process_exit

## Example with exe filter: Monitor process operations from NSS applications
-a always,exit -F arch=b32 -F exe=/usr/lib/firefox/firefox -S clone,fork,vfork -F success=1 -F key=nss_firefox_fork
-a always,exit -F arch=b64 -F exe=/usr/lib64/firefox/firefox -S clone,fork,vfork -F success=1 -F key=nss_firefox_fork

-a always,exit -F arch=b32 -F exe=/usr/lib/thunderbird/thunderbird -S clone,fork,vfork -F success=1 -F key=nss_thunderbird_fork
-a always,exit -F arch=b64 -F exe=/usr/lib64/thunderbird/thunderbird -S clone,fork,vfork -F success=1 -F key=nss_thunderbird_fork

-a always,exit -F arch=b64 -F exe=/usr/bin/certutil -S exit,exit_group -F key=nss_certutil_exit

## Monitor signal handling (for graceful shutdown)
-a always,exit -F arch=b32 -S kill,tkill,tgkill -F a1=15 -F key=nss_sigterm
-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=15 -F key=nss_sigterm

-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=2 -F key=nss_sigint

## Example with exe filter: Monitor signals to/from NSS applications
-a always,exit -F arch=b32 -F exe=/usr/bin/killall -S kill,tkill,tgkill -F a1=15 -F key=nss_killall_sigterm
-a always,exit -F arch=b64 -F exe=/usr/bin/killall -S kill,tkill,tgkill -F a1=15 -F key=nss_killall_sigterm

-a always,exit -F arch=b32 -F exe=/usr/bin/pkill -S kill,tkill,tgkill -F a1=15 -F key=nss_pkill_sigterm
-a always,exit -F arch=b64 -F exe=/usr/bin/pkill -S kill,tkill,tgkill -F a1=15 -F key=nss_pkill_sigterm

## Monitor time operations (for certificate validity checking)
-a always,exit -F arch=b32 -S clock_gettime -F a0=0 -F key=nss_clock_realtime
-a always,exit -F arch=b64 -S clock_gettime -F a0=0 -F key=nss_clock_realtime

-a always,exit -F arch=b64 -S gettimeofday -F key=nss_gettimeofday

## Example with exe filter: Monitor time operations from NSS applications
-a always,exit -F arch=b32 -F exe=/usr/lib/firefox/firefox -S clock_gettime -F a0=0 -F key=nss_firefox_time
-a always,exit -F arch=b64 -F exe=/usr/lib64/firefox/firefox -S clock_gettime -F a0=0 -F key=nss_firefox_time

-a always,exit -F arch=b32 -F exe=/usr/bin/curl -S clock_gettime -F a0=0 -F key=nss_curl_time
-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S clock_gettime -F a0=0 -F key=nss_curl_time

-a always,exit -F arch=b64 -F exe=/usr/bin/certutil -S gettimeofday -F key=nss_certutil_time

## Monitor memory operations
-a always,exit -F arch=b32 -S mlock,mlockall -F success=1 -F key=nss_mlock
-a always,exit -F arch=b64 -S mlock,mlock2,mlockall -F success=1 -F key=nss_mlock

-a always,exit -F arch=b64 -S munlock,munlockall -F success=1 -F key=nss_munlock

## Monitor namespace operations (for containerized deployments)
-a always,exit -F arch=b32 -S setns,unshare -F success=1 -F key=nss_namespace
-a always,exit -F arch=b64 -S setns,unshare -F success=1 -F key=nss_namespace

## Monitor chroot operations (for jailed environments)
-a always,exit -F arch=b32 -S chroot -F key=nss_chroot
-a always,exit -F arch=b64 -S chroot -F key=nss_chroot

## Monitor library loading
-a always,exit -F arch=b32 -F dir=/lib/ -F path=libnss3 -S open,openat -F key=nss_lib_load
-a always,exit -F arch=b32 -F dir=/usr/lib/ -F path=libnss3 -S open,openat -F key=nss_lib_load

-a always,exit -F arch=b64 -F dir=/lib64/ -F path=libnss3 -S open,openat -F key=nss_lib_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/ -F path=libnss3 -S open,openat -F key=nss_lib_load

## Monitor Firefox/Mozilla application NSS usage
-a always,exit -F arch=b32 -F dir=/usr/lib/firefox/ -F path=libnss -S open,openat -F key=nss_firefox_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/firefox/ -F path=libnss -S open,openat -F key=nss_firefox_load

-a always,exit -F arch=b32 -F dir=/usr/lib/thunderbird/ -F path=libnss -S open,openat -F key=nss_thunderbird_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/thunderbird/ -F path=libnss -S open,openat -F key=nss_thunderbird_load

-a always,exit -F arch=b32 -F dir=/usr/lib/seamonkey/ -F path=libnss -S open,openat -F key=nss_seamonkey_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/seamonkey/ -F path=libnss -S open,openat -F key=nss_seamonkey_load

## Monitor Chrome/Chromium NSS usage
-a always,exit -F arch=b32 -F dir=/opt/google/chrome/ -F path=libnss -S open,openat -F key=nss_chrome_load
-a always,exit -F arch=b64 -F dir=/opt/google/chrome/ -F path=libnss -S open,openat -F key=nss_chrome_load

-a always,exit -F arch=b32 -F dir=/usr/lib/chromium/ -F path=libnss -S open,openat -F key=nss_chromium_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/chromium/ -F path=libnss -S open,openat -F key=nss_chromium_load

# certutil
-a always,exit -F arch=b32 -F path=/usr/bin/certutil -F perm=x -F key=T1140_Deobfuscate
-a always,exit -F arch=b64 -F path=/usr/bin/certutil -F perm=x -F key=T1140_Deobfuscate

-a always,exit -F arch=b32 -F path=/usr/sbin/certutil -F perm=x -F key=T1140_Deobfuscate
-a always,exit -F arch=b64 -F path=/usr/sbin/certutil -F perm=x -F key=T1140_Deobfuscate

## macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/certutil -F perm=x -F key=T1140_Deobfuscate
-a always,exit -F arch=b64 -F path=/usr/local/bin/certutil -F perm=x -F key=T1140_Deobfuscate

# mbedTLS (formerly PolarSSL) (Syscall Rules Only)

## Monitor file operations on mbedTLS libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libmbedtls.so -F perm=rwxa -S open,openat -F key=mbedtls_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libmbedtls.so -F perm=rwxa -S open,openat -F key=mbedtls_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libmbedcrypto.so -F perm=rwxa -S open,openat -F key=mbedtls_crypto_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libmbedcrypto.so -F perm=rwxa -S open,openat -F key=mbedtls_crypto_lib_access

-a always,exit -F arch=b32 -F path=/usr/lib/libmbedx509.so -F perm=rwxa -S open,openat -F key=mbedtls_x509_lib_access
-a always,exit -F arch=b64 -F path=/usr/lib64/libmbedx509.so -F perm=rwxa -S open,openat -F key=mbedtls_x509_lib_access

-a always,exit -F arch=b32 -F path=/usr/local/lib/libmbedtls.so -F perm=rwxa -S open,openat -F key=mbedtls_lib_access
-a always,exit -F arch=b64 -F path=/usr/local/lib64/libmbedtls.so -F perm=rwxa -S open,openat -F key=mbedtls_lib_access

-a always,exit -F arch=b32 -F path=/usr/local/lib/libmbedcrypto.so -F perm=rwxa -S open,openat -F key=mbedtls_crypto_lib_access
-a always,exit -F arch=b64 -F path=/usr/local/lib64/libmbedcrypto.so -F perm=rwxa -S open,openat -F key=mbedtls_crypto_lib_access

-a always,exit -F arch=b32 -F path=/usr/local/lib/libmbedx509.so -F perm=rwxa -S open,openat -F key=mbedtls_x509_lib_access
-a always,exit -F arch=b64 -F path=/usr/local/lib64/libmbedx509.so -F perm=rwxa -S open,openat -F key=mbedtls_x509_lib_access

## Monitor legacy PolarSSL libraries (if present)
-a always,exit -F arch=b32 -F path=/usr/lib/libpolarssl.so -F perm=rwxa -S open,openat -F key=mbedtls_polarssl_legacy
-a always,exit -F arch=b64 -F path=/usr/lib64/libpolarssl.so -F perm=rwxa -S open,openat -F key=mbedtls_polarssl_legacy

## Monitor mbedTLS header files
-a always,exit -F arch=b32 -F dir=/usr/include/mbedtls/ -F perm=r -S open,openat -F key=mbedtls_headers
-a always,exit -F arch=b64 -F dir=/usr/include/mbedtls/ -F perm=r -S open,openat -F key=mbedtls_headers

-a always,exit -F arch=b32 -F dir=/usr/include/psa/ -F perm=r -S open,openat -F key=mbedtls_psa_headers
-a always,exit -F arch=b64 -F dir=/usr/include/psa/ -F perm=r -S open,openat -F key=mbedtls_psa_headers

-a always,exit -F arch=b32 -F dir=/usr/local/include/mbedtls/ -F perm=r -S open,openat -F key=mbedtls_headers
-a always,exit -F arch=b64 -F dir=/usr/local/include/mbedtls/ -F perm=r -S open,openat -F key=mbedtls_headers

-a always,exit -F arch=b32 -F dir=/usr/local/include/psa/ -F perm=r -S open,openat -F key=mbedtls_psa_headers
-a always,exit -F arch=b64 -F dir=/usr/local/include/psa/ -F perm=r -S open,openat -F key=mbedtls_psa_headers

## Monitor execve calls for mbedTLS utilities
-a always,exit -F arch=b32 -F path=/usr/bin/mbedtls_ssl_client1 -S execve -F key=mbedtls_client1_exec
-a always,exit -F arch=b64 -F path=/usr/bin/mbedtls_ssl_client1 -S execve -F key=mbedtls_client1_exec

-a always,exit -F arch=b32 -F path=/usr/bin/mbedtls_ssl_client2 -S execve -F key=mbedtls_client2_exec
-a always,exit -F arch=b64 -F path=/usr/bin/mbedtls_ssl_client2 -S execve -F key=mbedtls_client2_exec

-a always,exit -F arch=b32 -F path=/usr/bin/mbedtls_ssl_server -S execve -F key=mbedtls_server_exec
-a always,exit -F arch=b64 -F path=/usr/bin/mbedtls_ssl_server -S execve -F key=mbedtls_server_exec

-a always,exit -F arch=b32 -F path=/usr/bin/mbedtls_ssl_server2 -S execve -F key=mbedtls_server2_exec
-a always,exit -F arch=b64 -F path=/usr/bin/mbedtls_ssl_server2 -S execve -F key=mbedtls_server2_exec

-a always,exit -F arch=b32 -F path=/usr/bin/mbedtls_benchmark -S execve -F key=mbedtls_benchmark_exec
-a always,exit -F arch=b64 -F path=/usr/bin/mbedtls_benchmark -S execve -F key=mbedtls_benchmark_exec

-a always,exit -F arch=b32 -F path=/usr/bin/mbedtls_selftest -S execve -F key=mbedtls_selftest_exec
-a always,exit -F arch=b64 -F path=/usr/bin/mbedtls_selftest -S execve -F key=mbedtls_selftest_exec

-a always,exit -F arch=b32 -F path=/usr/bin/mbedtls_cert_app -S execve -F key=mbedtls_cert_app_exec
-a always,exit -F arch=b64 -F path=/usr/bin/mbedtls_cert_app -S execve -F key=mbedtls_cert_app_exec

-a always,exit -F arch=b32 -F path=/usr/bin/mbedtls_cert_req -S execve -F key=mbedtls_cert_req_exec
-a always,exit -F arch=b64 -F path=/usr/bin/mbedtls_cert_req -S execve -F key=mbedtls_cert_req_exec

-a always,exit -F arch=b32 -F path=/usr/bin/mbedtls_cert_write -S execve -F key=mbedtls_cert_write_exec
-a always,exit -F arch=b64 -F path=/usr/bin/mbedtls_cert_write -S execve -F key=mbedtls_cert_write_exec

-a always,exit -F arch=b32 -F path=/usr/bin/gen_key -S execve -F key=mbedtls_gen_key_exec
-a always,exit -F arch=b64 -F path=/usr/bin/gen_key -S execve -F key=mbedtls_gen_key_exec

## Monitor socket creation for SSL/TLS
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=1 -F success=1 -F key=mbedtls_tcp_socket
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=1 -F success=1 -F key=mbedtls_tcp_socket

-a always,exit -F arch=b32 -S socket -F a0=10 -F a1=1 -F success=1 -F key=mbedtls_tcp6_socket
-a always,exit -F arch=b64 -S socket -F a0=10 -F a1=1 -F success=1 -F key=mbedtls_tcp6_socket

-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=2 -F success=1 -F key=mbedtls_udp_socket
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=2 -F success=1 -F key=mbedtls_udp_socket

## Monitor bind calls on SSL/TLS and DTLS ports
-a always,exit -F arch=b32 -S bind -F exit=0 -F key=mbedtls_bind_success
-a always,exit -F arch=b64 -S bind -F exit=0 -F key=mbedtls_bind_success

## Monitor listen calls (for server applications)
-a always,exit -F arch=b32 -S listen -F success=1 -F key=mbedtls_listen
-a always,exit -F arch=b64 -S listen -F success=1 -F key=mbedtls_listen

## Monitor accept/accept4 calls (incoming connections)
-a always,exit -F arch=b32 -S accept,accept4 -F success=1 -F key=mbedtls_accept
-a always,exit -F arch=b64 -S accept,accept4 -F success=1 -F key=mbedtls_accept

## Monitor connect calls (outgoing connections)
-a always,exit -F arch=b32 -S connect -F success=1 -F key=mbedtls_connect_success
-a always,exit -F arch=b64 -S connect -F success=1 -F key=mbedtls_connect_success

-a always,exit -F arch=b32 -S connect -F exit=-ECONNREFUSED -F key=mbedtls_connect_refused
-a always,exit -F arch=b64 -S connect -F exit=-ECONNREFUSED -F key=mbedtls_connect_refused

-a always,exit -F arch=b64 -S connect -F exit=-ETIMEDOUT -F key=mbedtls_connect_timeout

## Monitor certificate and key file operations
-a always,exit -F arch=b32 -F dir=/etc/mbedtls/certs/ -F perm=r -S open,openat -F key=mbedtls_cert_read
-a always,exit -F arch=b64 -F dir=/etc/mbedtls/certs/ -F perm=r -S open,openat -F key=mbedtls_cert_read

-a always,exit -F arch=b32 -F dir=/etc/mbedtls/keys/ -F perm=r -S open,openat -F key=mbedtls_key_read
-a always,exit -F arch=b64 -F dir=/etc/mbedtls/keys/ -F perm=r -S open,openat -F key=mbedtls_key_read

-a always,exit -F arch=b32 -F dir=/etc/ssl/certs/ -F perm=r -S open,openat -F key=mbedtls_ssl_cert_read
-a always,exit -F arch=b64 -F dir=/etc/ssl/certs/ -F perm=r -S open,openat -F key=mbedtls_ssl_cert_read

-a always,exit -F arch=b32 -F dir=/etc/ssl/private/ -F perm=r -S open,openat -F key=mbedtls_ssl_key_read
-a always,exit -F arch=b64 -F dir=/etc/ssl/private/ -F perm=r -S open,openat -F key=mbedtls_ssl_key_read

## Monitor failed access to sensitive directories
-a always,exit -F arch=b32 -F dir=/etc/mbedtls/keys/ -S open,openat -F exit=-EACCES -F key=mbedtls_key_denied
-a always,exit -F arch=b64 -F dir=/etc/mbedtls/keys/ -S open,openat -F exit=-EACCES -F key=mbedtls_key_denied

-a always,exit -F arch=b32 -F dir=/etc/mbedtls/keys/ -S open,openat -F exit=-EPERM -F key=mbedtls_key_denied
-a always,exit -F arch=b64 -F dir=/etc/mbedtls/keys/ -S open,openat -F exit=-EPERM -F key=mbedtls_key_denied

## Monitor mbedTLS configuration directories
-a always,exit -F arch=b32 -F path=/etc/mbedtls/mbedtls.conf -F perm=rwa -S open,openat -F key=mbedtls_config_file
-a always,exit -F arch=b64 -F path=/etc/mbedtls/mbedtls.conf -F perm=rwa -S open,openat -F key=mbedtls_config_file

-a always,exit -F arch=b32 -F dir=/etc/mbedtls/ -F perm=rwa -S open,openat -F key=mbedtls_config
-a always,exit -F arch=b64 -F dir=/etc/mbedtls/ -F perm=rwa -S open,openat -F key=mbedtls_config

-a always,exit -F arch=b32 -F dir=/usr/local/etc/mbedtls/ -F perm=rwa -S open,openat -F key=mbedtls_config
-a always,exit -F arch=b64 -F dir=/usr/local/etc/mbedtls/ -F perm=rwa -S open,openat -F key=mbedtls_config

## Monitor memory mapping of crypto libraries
-a always,exit -F arch=b32 -F path=/usr/lib/libmbedtls.so -S mmap,mprotect -F key=mbedtls_lib_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libmbedtls.so -S mmap,mprotect -F key=mbedtls_lib_mmap

-a always,exit -F arch=b32 -F path=/usr/lib/libmbedcrypto.so -S mmap,mprotect -F key=mbedtls_crypto_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libmbedcrypto.so -S mmap,mprotect -F key=mbedtls_crypto_mmap

-a always,exit -F arch=b32 -F path=/usr/lib/libmbedx509.so -S mmap,mprotect -F key=mbedtls_x509_mmap
-a always,exit -F arch=b64 -F path=/usr/lib64/libmbedx509.so -S mmap,mprotect -F key=mbedtls_x509_mmap

## Monitor random number generation access
-a always,exit -F arch=b32 -F path=/dev/random -F perm=r -S open,openat -F key=mbedtls_random
-a always,exit -F arch=b64 -F path=/dev/random -F perm=r -S open,openat -F key=mbedtls_random

-a always,exit -F arch=b32 -F path=/dev/urandom -F perm=r -S open,openat -F key=mbedtls_urandom
-a always,exit -F arch=b64 -F path=/dev/urandom -F perm=r -S open,openat -F key=mbedtls_urandom

-a always,exit -F arch=b32 -S getrandom -F key=mbedtls_getrandom
-a always,exit -F arch=b64 -S getrandom -F key=mbedtls_getrandom

## Monitor hardware RNG access (for embedded systems)
-a always,exit -F arch=b32 -F path=/dev/hwrng -F perm=r -S open,openat -F key=mbedtls_hwrng
-a always,exit -F arch=b64 -F path=/dev/hwrng -F perm=r -S open,openat -F key=mbedtls_hwrng

## Monitor shared memory operations (for session caching)
-a always,exit -F arch=b32 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -S shmctl -F key=T1559_Inter-Process_Communication

## Example with exe filter: Monitor shared memory from specific applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/haproxy -S shmget -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/sbin/haproxy -S shmget -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -F exe=/usr/sbin/varnish -S shmat -F success=1 -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/sbin/varnish -S shmat -F success=1 -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b64 -F exe=/usr/bin/redis-server -S shmctl -F key=T1559_Inter-Process_Communication

## Monitor semaphore operations (for thread synchronization)
-a always,exit -F arch=b32 -S semget,semop,semctl -F key=mbedtls_semaphore
-a always,exit -F arch=b64 -S semget,semop,semctl -F key=mbedtls_semaphore

## Example with exe filter: Monitor semaphore operations from multi-threaded servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/apache2 -S semget,semop,semctl -F key=mbedtls_apache_semaphore
-a always,exit -F arch=b64 -F exe=/usr/sbin/apache2 -S semget,semop,semctl -F key=mbedtls_apache_semaphore

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S semget,semop,semctl -F key=mbedtls_nginx_semaphore
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S semget,semop,semctl -F key=mbedtls_nginx_semaphore

## Monitor file descriptor operations
-a always,exit -F arch=b32 -S dup,dup2,dup3 -F success=1 -F key=mbedtls_fd_dup
-a always,exit -F arch=b64 -S dup,dup2,dup3 -F success=1 -F key=mbedtls_fd_dup

-a always,exit -F arch=b64 -S fcntl -F a1=1 -F key=mbedtls_fcntl_dupfd

-a always,exit -F arch=b64 -S fcntl -F a1=2 -F key=mbedtls_fcntl_setfd

## Example with exe filter: Monitor FD operations from specific services
-a always,exit -F arch=b32 -F exe=/usr/bin/stunnel -S dup,dup2,dup3 -F success=1 -F key=mbedtls_stunnel_fd_dup
-a always,exit -F arch=b64 -F exe=/usr/bin/stunnel -S dup,dup2,dup3 -F success=1 -F key=mbedtls_stunnel_fd_dup

-a always,exit -F arch=b64 -F exe=/usr/sbin/sshd -S fcntl -F a1=1 -F key=mbedtls_sshd_fcntl_dupfd
-a always,exit -F arch=b64 -F exe=/usr/bin/socat -S fcntl -F a1=2 -F key=mbedtls_socat_fcntl_setfd

## Monitor socket options
-a always,exit -F arch=b32 -S setsockopt -F success=1 -F key=mbedtls_setsockopt
-a always,exit -F arch=b64 -S setsockopt -F success=1 -F key=mbedtls_setsockopt

-a always,exit -F arch=b64 -S getsockopt -F success=1 -F key=mbedtls_getsockopt

## Example with exe filter: Monitor socket options from network services
-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S setsockopt -F success=1 -F key=mbedtls_nginx_setsockopt
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S setsockopt -F success=1 -F key=mbedtls_nginx_setsockopt

-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S getsockopt -F success=1 -F key=mbedtls_curl_getsockopt
-a always,exit -F arch=b64 -F exe=/usr/bin/wget -S setsockopt -F success=1 -F key=mbedtls_wget_setsockopt

## Monitor I/O operations on sockets
-a always,exit -F arch=b32 -S sendto,sendmsg -F success=1 -F key=mbedtls_send
-a always,exit -F arch=b64 -S sendto,sendmsg -F success=1 -F key=mbedtls_send

-a always,exit -F arch=b32 -S recvfrom,recvmsg -F success=1 -F key=mbedtls_recv
-a always,exit -F arch=b64 -S recvfrom,recvmsg -F success=1 -F key=mbedtls_recv

-a always,exit -F arch=b64 -S read,write -F success=1 -F key=mbedtls_io
## Example with exe filter: Monitor I/O from specific TLS applications

-a always,exit -F arch=b32 -F exe=/usr/bin/mosquitto -S sendto,sendmsg -F success=1 -F key=mbedtls_mosquitto_send
-a always,exit -F arch=b64 -F exe=/usr/bin/mosquitto -S sendto,sendmsg -F success=1 -F key=mbedtls_mosquitto_send

-a always,exit -F arch=b32 -F exe=/usr/sbin/openvpn -S recvfrom,recvmsg -F success=1 -F key=mbedtls_openvpn_recv
-a always,exit -F arch=b64 -F exe=/usr/sbin/openvpn -S recvfrom,recvmsg -F success=1 -F key=mbedtls_openvpn_recv

-a always,exit -F arch=b64 -F exe=/usr/local/bin/iot-gateway -S read,write -F success=1 -F key=mbedtls_iot_io

## Monitor poll/select operations (for async I/O)
-a always,exit -F arch=b32 -S poll,select -F success=1 -F key=mbedtls_poll
-a always,exit -F arch=b64 -S poll,ppoll,select,pselect6 -F success=1 -F key=mbedtls_poll

## Example with exe filter: Monitor async I/O from event-driven servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/lighttpd -S poll,select -F success=1 -F key=mbedtls_lighttpd_poll
-a always,exit -F arch=b64 -F exe=/usr/sbin/lighttpd -S poll,ppoll,select,pselect6 -F success=1 -F key=mbedtls_lighttpd_poll

-a always,exit -F arch=b32 -F exe=/usr/bin/node -S poll,select -F success=1 -F key=mbedtls_node_poll
-a always,exit -F arch=b64 -F exe=/usr/bin/node -S poll,ppoll,select,pselect6 -F success=1 -F key=mbedtls_node_poll

## Monitor epoll operations (for high-performance servers)
-a always,exit -F arch=b32 -S epoll_create -F success=1 -F key=mbedtls_epoll_create
-a always,exit -F arch=b64 -S epoll_create,epoll_create1 -F success=1 -F key=mbedtls_epoll_create

-a always,exit -F arch=b64 -S epoll_ctl -F success=1 -F key=mbedtls_epoll_ctl

-a always,exit -F arch=b64 -S epoll_wait,epoll_pwait -F success=1 -F key=mbedtls_epoll_wait

## Example with exe filter: Monitor epoll from high-performance servers
-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S epoll_create -F success=1 -F key=mbedtls_nginx_epoll_create
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S epoll_create,epoll_create1 -F success=1 -F key=mbedtls_nginx_epoll_create

-a always,exit -F arch=b64 -F exe=/usr/sbin/haproxy -S epoll_ctl -F success=1 -F key=mbedtls_haproxy_epoll_ctl

-a always,exit -F arch=b64 -F exe=/usr/bin/envoy -S epoll_wait,epoll_pwait -F success=1 -F key=mbedtls_envoy_epoll_wait

## Monitor privilege changes
-a always,exit -F arch=b32 -S setuid,setreuid -F success=1 -F key=mbedtls_setuid
-a always,exit -F arch=b64 -S setuid,setreuid,setresuid -F success=1 -F key=mbedtls_setuid

-a always,exit -F arch=b32 -S setgid,setregid -F success=1 -F key=mbedtls_setgid
-a always,exit -F arch=b64 -S setgid,setregid,setresgid -F success=1 -F key=mbedtls_setgid

## Example with exe filter: Monitor privilege drops from specific services
-a always,exit -F arch=b32 -F exe=/usr/sbin/apache2 -S setuid,setreuid -F success=1 -F key=mbedtls_apache_setuid
-a always,exit -F arch=b64 -F exe=/usr/sbin/apache2 -S setuid,setreuid,setresuid -F success=1 -F key=mbedtls_apache_setuid

-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S setgid,setregid -F success=1 -F key=mbedtls_nginx_setgid
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S setgid,setregid,setresgid -F success=1 -F key=mbedtls_nginx_setgid

-a always,exit -F arch=b64 -F exe=/usr/sbin/openvpn -S setuid,setreuid,setresuid -F success=1 -F key=mbedtls_openvpn_setuid

## Monitor capability changes
-a always,exit -F arch=b32 -S capset -F success=1 -F key=mbedtls_capabilities
-a always,exit -F arch=b64 -S capset -F success=1 -F key=mbedtls_capabilities

## Example with exe filter: Monitor capability changes from specific applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S capset -F success=1 -F key=mbedtls_nginx_capabilities
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S capset -F success=1 -F key=mbedtls_nginx_capabilities

-a always,exit -F arch=b32 -F exe=/usr/sbin/apache2 -S capset -F success=1 -F key=mbedtls_apache_capabilities
-a always,exit -F arch=b64 -F exe=/usr/sbin/apache2 -S capset -F success=1 -F key=mbedtls_apache_capabilities

## Monitor process creation and termination
-a always,exit -F arch=b32 -S clone,fork,vfork -F success=1 -F key=mbedtls_process_create
-a always,exit -F arch=b64 -S clone,fork,vfork -F success=1 -F key=mbedtls_process_create

-a always,exit -F arch=b64 -S exit,exit_group -F key=mbedtls_process_exit

## Example with exe filter: Monitor process operations from mbedTLS-enabled services
-a always,exit -F arch=b32 -F exe=/usr/sbin/openvpn -S clone,fork,vfork -F success=1 -F key=mbedtls_openvpn_fork
-a always,exit -F arch=b64 -F exe=/usr/sbin/openvpn -S clone,fork,vfork -F success=1 -F key=mbedtls_openvpn_fork

-a always,exit -F arch=b32 -F exe=/usr/bin/stunnel -S clone,fork,vfork -F success=1 -F key=mbedtls_stunnel_fork
-a always,exit -F arch=b64 -F exe=/usr/bin/stunnel -S clone,fork,vfork -F success=1 -F key=mbedtls_stunnel_fork

-a always,exit -F arch=b64 -F exe=/usr/local/bin/myapp -S exit,exit_group -F key=mbedtls_myapp_exit

## Monitor signal handling (for graceful shutdown)
-a always,exit -F arch=b32 -S kill,tkill,tgkill -F a1=15 -F key=mbedtls_sigterm
-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=15 -F key=mbedtls_sigterm

-a always,exit -F arch=b64 -S kill,tkill,tgkill -F a1=2 -F key=mbedtls_sigint

## Example with exe filter: Monitor signals from specific management tools
-a always,exit -F arch=b32 -F exe=/usr/bin/systemctl -S kill,tkill,tgkill -F a1=15 -F key=mbedtls_systemctl_sigterm
-a always,exit -F arch=b64 -F exe=/usr/bin/systemctl -S kill,tkill,tgkill -F a1=15 -F key=mbedtls_systemctl_sigterm

-a always,exit -F arch=b32 -F exe=/usr/sbin/service -S kill,tkill,tgkill -F a1=15 -F key=mbedtls_service_sigterm
-a always,exit -F arch=b64 -F exe=/usr/sbin/service -S kill,tkill,tgkill -F a1=15 -F key=mbedtls_service_sigterm

-a always,exit -F arch=b64 -F exe=/usr/bin/killall -S kill,tkill,tgkill -F a1=2 -F key=mbedtls_killall_sigint

## Monitor time operations (for certificate validity checking)
-a always,exit -F arch=b32 -S clock_gettime -F a0=0 -F key=mbedtls_clock_realtime
-a always,exit -F arch=b64 -S clock_gettime -F a0=0 -F key=mbedtls_clock_realtime

-a always,exit -F arch=b64 -S gettimeofday -F key=mbedtls_gettimeofday
## Example with exe filter: Monitor time operations from TLS-enabled applications
-a always,exit -F arch=b32 -F exe=/usr/sbin/nginx -S clock_gettime -F a0=0 -F key=mbedtls_nginx_time
-a always,exit -F arch=b64 -F exe=/usr/sbin/nginx -S clock_gettime -F a0=0 -F key=mbedtls_nginx_time

-a always,exit -F arch=b32 -F exe=/usr/bin/curl -S clock_gettime -F a0=0 -F key=mbedtls_curl_time
-a always,exit -F arch=b64 -F exe=/usr/bin/curl -S clock_gettime -F a0=0 -F key=mbedtls_curl_time

-a always,exit -F arch=b64 -F exe=/usr/bin/wget -S gettimeofday -F key=mbedtls_wget_time

## Monitor memory operations
-a always,exit -F arch=b32 -S mlock,mlockall -F success=1 -F key=mbedtls_mlock
-a always,exit -F arch=b64 -S mlock,mlock2,mlockall -F success=1 -F key=mbedtls_mlock

-a always,exit -F arch=b64 -S munlock,munlockall -F success=1 -F key=mbedtls_munlock

## Monitor namespace operations (for containerized deployments)
-a always,exit -F arch=b32 -S setns,unshare -F success=1 -F key=mbedtls_namespace
-a always,exit -F arch=b64 -S setns,unshare -F success=1 -F key=mbedtls_namespace

## Monitor chroot operations (for jailed environments)
-a always,exit -F arch=b32 -S chroot -F key=mbedtls_chroot
-a always,exit -F arch=b64 -S chroot -F key=mbedtls_chroot

## Monitor library loading
-a always,exit -F arch=b32 -F dir=/lib/ -F path=libmbedtls -S open,openat -F key=mbedtls_lib_load
-a always,exit -F arch=b32 -F dir=/usr/lib/ -F path=libmbedtls -S open,openat -F key=mbedtls_lib_load

-a always,exit -F arch=b64 -F dir=/lib64/ -F path=libmbedtls -S open,openat -F key=mbedtls_lib_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/ -F path=libmbedtls -S open,openat -F key=mbedtls_lib_load

-a always,exit -F arch=b32 -F dir=/lib/ -F path=libmbedcrypto -S open,openat -F key=mbedtls_crypto_load
-a always,exit -F arch=b32 -F dir=/usr/lib/ -F path=libmbedcrypto -S open,openat -F key=mbedtls_crypto_load

-a always,exit -F arch=b64 -F dir=/lib64/ -F path=libmbedcrypto -S open,openat -F key=mbedtls_crypto_load
-a always,exit -F arch=b64 -F dir=/usr/lib64/ -F path=libmbedcrypto -S open,openat -F key=mbedtls_crypto_load

## Monitor embedded/IoT specific paths
-a always,exit -F arch=b32 -F dir=/opt/mbedtls/ -F perm=rwa -S open,openat -F key=mbedtls_opt
-a always,exit -F arch=b64 -F dir=/opt/mbedtls/ -F perm=rwa -S open,openat -F key=mbedtls_opt

-a always,exit -F arch=b32 -F dir=/var/lib/mbedtls/ -F perm=rwa -S open,openat -F key=mbedtls_var_lib
-a always,exit -F arch=b64 -F dir=/var/lib/mbedtls/ -F perm=rwa -S open,openat -F key=mbedtls_var_lib

## Monitor OpenVPN with mbedTLS
-a always,exit -F arch=b32 -F dir=/etc/openvpn/ -F path=mbedtls -S open,openat -F key=mbedtls_openvpn
-a always,exit -F arch=b64 -F dir=/etc/openvpn/ -F path=mbedtls -S open,openat -F key=mbedtls_openvpn

-a always,exit -F arch=b32 -F path=/usr/sbin/openvpn -S execve -F key=mbedtls_openvpn_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/openvpn -S execve -F key=mbedtls_openvpn_exec

## Monitor PSA Crypto API operations (Platform Security Architecture)
-a always,exit -F arch=b32 -F dir=/var/lib/psa/ -F perm=rwa -S open,openat -F key=mbedtls_psa_storage
-a always,exit -F arch=b64 -F dir=/var/lib/psa/ -F perm=rwa -S open,openat -F key=mbedtls_psa_storage

-a always,exit -F arch=b32 -F path=/etc/psa/crypto.json -F perm=r -S open,openat -F key=mbedtls_psa_config
-a always,exit -F arch=b64 -F path=/etc/psa/crypto.json -F perm=r -S open,openat -F key=mbedtls_psa_config

## Monitor ARM TrustZone operations (for embedded security)
-a always,exit -F arch=b32 -S ioctl -F a1=0x5401 -F key=mbedtls_trustzone
-a always,exit -F arch=b64 -S ioctl -F a1=0x5401 -F key=mbedtls_trustzone

# High Volume Events

## Remove them if they cause to much volume in your environment
### Root command executions
### https://sudoedit.com/log-sudo-with-auditd/

#-a always,exit -F arch=b32 -F euid=0 -S execve -F key=rootcmd
#-a always,exit -F arch=b64 -F euid=0 -S execve -F key=rootcmd
#-a always,exit -F arch=b32 -F euid=0 -F "auid>=500" -F "auid!=-1" -S execve -F key=T1169_Sudo
#-a always,exit -F arch=b64 -F euid=0 -F "auid>=500" -F "auid!=Memory_Process_creation-1" -S execve -F key=T1169_Sudo

-a always,exit -F arch=b32 -F euid=0 -S execve -F key=T1169_Sudo
-a always,exit -F arch=b64 -F euid=0 -S execve -F key=T1169_Sudo

## Monitoring changes to system and network configurations
-a always,exit -F arch=b64 -S setsockopt,socket -F key=network_changes
-a always,exit -F arch=b32 -S setsockopt,socket -F key=network_changes

## in memory file execution
-a always,exit -F arch=b32 -F "auid>=500" -F "auid!=-1" -S execveat -F key=Memory_Process_creation
-a always,exit -F arch=b64 -F "auid>=500" -F "auid!=-1" -S execveat -F key=Memory_Process_creation

## File Deletion Events by User
## T1070 Indicator Removal
## credits to Mitre https://attack.mitre.org/techniques/T1070/
##
## Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses.
## Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions.
## Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders.
## Location, format, and type of artifact (such as command or login history) are often specific to each platform.
##
## Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity.
## This may compromise the integrity of security solutions by causing notable events to go unreported.
## This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.

### T1070.004_Indicator_Removal_File_Deletion
### -a always,exit -F arch=b32 -S rmdir -S unlink -S unlinkat -S rename -S renameat -F "auid>=500" -F "auid!=-1" -F key=delete
### -a always,exit -F arch=b64 -S rmdir -S unlink -S unlinkat -S rename -S renameat -F "auid>=500" -F "auid!=-1" -F key=delete
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_rename
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_unlinkat
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_renameat
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_unlink
-a always,exit -F arch=b32 -S rmdir -S unlink -S unlinkat -S rename -S renameat -F "auid>=500" -F "auid!=-1" -F key=T1107_File_Deletion
-a always,exit -F arch=b64 -S rmdir -S unlink -S unlinkat -S rename -S renameat -F "auid>=500" -F "auid!=-1" -F key=T1107_File_Deletion

-a always,exit -F arch=b32 -S rmdir -S unlink -S unlinkat -S rename -S renameat -F "auid=0" -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -S rmdir -S unlink -S unlinkat -S rename -S renameat -F "auid=0" -F key=T1070.004_Indicator_Removal_File_Deletion

## shred
-a always,exit -F arch=b32 -F path=/bin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/bin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/sbin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/sbin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/bin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/bin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/sbin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/sbin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/local/bin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/local/bin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/local/sbin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/local/sbin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/snap/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/snap/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/snap/bin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/snap/bin/shred -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

## wipe
-a always,exit -F arch=b32 -F path=/bin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/bin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/sbin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/sbin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/bin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/bin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/sbin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/sbin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/local/bin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/local/bin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/local/sbin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/local/sbin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/snap/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/snap/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/snap/bin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/snap/bin/wipe -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

## scrub
-a always,exit -F arch=b32 -F path=/bin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/bin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/sbin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/sbin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/bin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/bin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/sbin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/sbin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/local/bin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/local/bin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/local/sbin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/local/sbin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/snap/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/snap/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/snap/bin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/snap/bin/scrub -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

## dd
-a always,exit -F arch=b32 -F path=/bin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/bin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/sbin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/sbin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/bin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/bin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/sbin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/sbin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/local/bin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/local/bin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/local/sbin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/local/sbin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/snap/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/snap/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/snap/bin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/snap/bin/dd -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

## logsave
-a always,exit -F arch=b32 -F path=/bin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/bin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/sbin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/sbin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/bin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/bin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/sbin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/sbin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/local/bin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/local/bin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/local/sbin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/local/sbin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/snap/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/snap/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/snap/bin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/snap/bin/logsave -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

### rm
-a always,exit -F arch=b32 -F path=/bin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/bin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/sbin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/sbin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/bin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/bin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/sbin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/sbin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/local/bin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/local/bin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/snap/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/snap/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

-a always,exit -F arch=b32 -F path=/snap/bin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion
-a always,exit -F arch=b64 -F path=/snap/bin/rm -F perm=x -F key=T1070.004_Indicator_Removal_File_Deletion

## File Access
### Unauthorized Access (unsuccessful)
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open_by_handle_at
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_truncate
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_ftruncate
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_openat
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open
-a always,exit -F arch=b32 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EACCES -F "auid>=500" -F "auid!=-1" -F key=file_access
-a always,exit -F arch=b64 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EACCES -F "auid>=500" -F "auid!=-1" -F key=file_access

-a always,exit -F arch=b32 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EPERM -F "auid>=500" -F "auid!=-1" -F key=file_access
-a always,exit -F arch=b64 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EPERM -F "auid>=500" -F "auid!=-1" -F key=file_access

### Unsuccessful Creation
#### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_creat
-a always,exit -F arch=b32 -S creat,link,mknod,mkdir,symlink,mknodat,linkat,symlinkat -F exit=-EACCES -F key=file_creation
-a always,exit -F arch=b64 -S mkdir,creat,link,symlink,mknod,mknodat,linkat,symlinkat -F exit=-EACCES -F key=file_creation

-a always,exit -F arch=b32 -S link,mkdir,symlink,mkdirat -F exit=-EPERM -F key=file_creation
-a always,exit -F arch=b64 -S mkdir,link,symlink,mkdirat -F exit=-EPERM -F key=file_creation

### Unsuccessful Modification

-a always,exit -F arch=b32 -S rename -S renameat -S truncate -S chmod -S setxattr -S lsetxattr -S removexattr -S lremovexattr -F exit=-EACCES -F key=file_modification
-a always,exit -F arch=b64 -S rename -S renameat -S truncate -S chmod -S setxattr -S lsetxattr -S removexattr -S lremovexattr -F exit=-EACCES -F key=file_modification

-a always,exit -F arch=b32 -S rename -S renameat -S truncate -S chmod -S setxattr -S lsetxattr -S removexattr -S lremovexattr -F exit=-EPERM -F key=file_modification
-a always,exit -F arch=b64 -S rename -S renameat -S truncate -S chmod -S setxattr -S lsetxattr -S removexattr -S lremovexattr -F exit=-EPERM -F key=file_modification

### This rule suppresses events that originate on the below file systems.
### Typically you would use this in conjunction with rules to monitor
### kernel modules. The filesystem listed are known to cause hundreds of
### dir records during kernel module load. As an aside, if you do see the
### tracefs or debugfs module load and this is a production system, you really
### should look into why its getting loaded and prevent it if possible.
### https://github.com/linux-audit/audit-userspace/blob/master/rules/23-ignore-filesystems.rules

-a never,filesystem -F fstype=tracefs
-a never,filesystem -F fstype=debugfs

## 32bit ABI Exploitation
### If you are on a 64 bit platform, everything _should_ be running
### in 64 bit mode. This rule will detect any use of the 32 bit syscalls
### because this might be a sign of someone exploiting a hole in the 32
### bit ABI.

-a always,exit -F arch=b32 -S all -F key=32bit_abi

## This is to check if the system is making or receiving connections
## externally
### https://github.com/linux-audit/audit-userspace/blob/master/rules/71-networking.rules

## -a always,exit -F arch=b64 -S accept,connect -F key=external-access

## TT1057 Process Discovery
## credits to Mitre https://attack.mitre.org/techniques/T1057/
##
## Adversaries may attempt to get information about running processes on a system.
## Information obtained could be used to gain an understanding of common software/applications running on systems within the network.
## Administrator or otherwise elevated access may provide better process details.
## Adversaries may use the information from Process Discovery during automated discovery to shape follow-on behaviors,
## including whether or not the adversary fully infects the target and/or attempts specific actions.
##
## In Windows environments, adversaries could obtain details on running processes using the Tasklist utility via cmd or Get-Process via PowerShell.
## Information about processes can also be extracted from the output of Native API calls such as CreateToolhelp32Snapshot.
## In Mac and Linux, this is accomplished with the ps command. Adversaries may also opt to enumerate processes via /proc.
## ESXi also supports use of the ps command, as well as esxcli system process list.[1][2]
##
## On network devices, Network Device CLI commands such as show processes can be used to display current running processes

### ps
-a always,exit -F arch=b32 -F path=/usr/bin/ps -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ps -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ps -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ps -F perm=x -F key=T1057_Process_Discovery

### top
-a always,exit -F arch=b32 -F path=/usr/bin/top -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/top -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/top -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/top -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/top -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/top -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/top -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/top -F perm=x -F key=T1057_Process_Discovery

### atop
#### https://www.atoptool.nl
#### https://github.com/Atoptool/atop
-a always,exit -F arch=b32 -F path=/usr/bin/atop -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/atop -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/atop -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/atop -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/atop -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/atop -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/atop -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/atop -F perm=x -F key=T1057_Process_Discovery

### htop
#### https://htop.dev
#### https://github.com/htop-dev/htop/
-a always,exit -F arch=b32 -F path=/usr/bin/htop -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/htop -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/htop -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/htop -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/htop -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/htop -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/htop -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/htop -F perm=x -F key=T1057_Process_Discovery

### iftop
#### https://github.com/soarpenguin/iftop
-a always,exit -F arch=b32 -F path=/usr/bin/iftop -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/iftop -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/iftop -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/iftop -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/iftop -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/iftop -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/iftop -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/iftop -F perm=x -F key=T1057_Process_Discovery

### lsof
#### https://github.com/lsof-org/lsof
-a always,exit -F arch=b32 -F path=/usr/bin/lsof -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/lsof -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/lsof -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/lsof -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/lsof -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/lsof -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lsof -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lsof -F perm=x -F key=T1057_Process_Discovery

### pgrep
-a always,exit -F arch=b32 -F path=/usr/bin/pgrep -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/pgrep -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/pgrep -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/pgrep -F perm=x -F key=T1057_Process_Discovery

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/pgrep -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/pgrep -F perm=x -F key=T1057_Process_Discovery

### pidof
-a always,exit -F arch=b32 -F path=/usr/bin/pidof -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/pidof -F perm=x -F key=T1057_Process_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/pidof -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/pidof -F perm=x -F key=T1057_Process_Discovery

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/pidof -F perm=x -F key=T1057_Process_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/pidof -F perm=x -F key=T1057_Process_Discovery


## T1016 System Network Configuration Discovery
## credits to Mitre https://attack.mitre.org/techniques/T1016/
##
## Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems.
## Several operating system administration utilities exist that can be used to gather this information. Examples include Arp, ipconfig/ifconfig, nbtstat, and route.
##
## Adversaries may also leverage a Network Device CLI on network devices to gather information about configurations and settings, such as IP addresses of configured interfaces and static/dynamic routes (e.g. show ip route, show ip interface).[1][2]
## On ESXi, adversaries may leverage esxcli to gather network configuration information. For example, the command esxcli network nic list will retrieve the MAC address, while esxcli network ip interface ipv4 get will retrieve the local IPv4 address.[3]
##
## Adversaries may use the information from System Network Configuration Discovery during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next.

### route
-a always,exit -F arch=b32 -F path=/usr/bin/route -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/route -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/route -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/route -F perm=x -F key=T1016_System_Network_Configuration_Discovery

### ifconfig
-a always,exit -F arch=b32 -F path=/usr/bin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ifconfig -F perm=x -F key=T1016_System_Network_Configuration_Discovery

### resolv.conf
-a always,exit -F arch=b32 -F path=/etc/resolv.conf -F perm=wa -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/etc/resolv.conf -F perm=wa -F key=T1016_System_Network_Configuration_Discovery

### /etc/hosts
### The network environment should not be modified by anything other than administrator action.
### Any change to network parameters should be audited.
### https://static.open-scap.org/ssg-guides/ssg-rhel7-guide-C2S.html#xccdf_org.ssgproject.content_rule_audit_rules_networkconfig_modification
# -w /etc/hosts.allow -F perm=wa -F key=T1016_System_Network_Configuration_Discovery
# -w /etc/hosts.deny -F perm=wa -F key=T1016_System_Network_Configuration_Discovery
# -w /etc/hosts -F perm=wa -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/etc/hosts -F perm=wa -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/etc/hosts -F perm=wa -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/etc/hosts.allow -F perm=wa -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/etc/hosts.allow -F perm=wa -F key=T1016_System_Network_Configuration_Discovery

-a always,exit -F arch=b32 -F path=/etc/hosts.deny -F perm=wa -F key=T1016_System_Network_Configuration_Discovery
-a always,exit -F arch=b64 -F path=/etc/hosts.deny -F perm=wa -F key=T1016_System_Network_Configuration_Discovery

## T1049_System_Network_Connections_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/netstat -F perm=x -F key=T1049_System_Network_Connections_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/netstat -F perm=x -F key=T1049_System_Network_Connections_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/netstat -F perm=x -F key=T1049_System_Network_Connections_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/netstat -F perm=x -F key=T1049_System_Network_Connections_Discovery

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/sbin/netstat -F perm=x -F key=T1049_System_Network_Connections_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/netstat -F perm=x -F key=T1049_System_Network_Connections_Discovery

## T1018_Remote_System_Discovery
### arp
-a always,exit -F arch=b32 -F path=/usr/bin/arp -F perm=x -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/arp -F perm=x -F key=T1018_Remote_System_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/arp -F perm=x -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/arp -F perm=x -F key=T1018_Remote_System_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/local/arp -F perm=x -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/local/arp -F perm=x -F key=T1018_Remote_System_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/local/arp -F perm=x -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/local/arp -F perm=x -F key=T1018_Remote_System_Discovery

### nslookup
-a always,exit -F arch=b32 -F path=/usr/bin/nslookup -F perm=x -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/nslookup -F perm=x -F key=T1018_Remote_System_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/nslookup -F perm=x -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/nslookup -F perm=x -F key=T1018_Remote_System_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/local/nslookup -F perm=x -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/local/anslookup -F perm=x -F key=T1018_Remote_System_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/local/nslookup -F perm=x -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/local/nslookup -F perm=x -F key=T1018_Remote_System_Discovery

## dig
### T1018_Remote_System_Discovery
### https://github.com/polarityio/dig
-a always,exit -F arch=b32 -F path=/usr/bin/dig -F perm=x -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/dig -F perm=x -F key=T1018_Remote_System_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/dig -F perm=x -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/dig -F perm=x -F key=T1018_Remote_System_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/dig -F perm=x -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/dig -F perm=x -F key=T1018_Remote_System_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/dig -F perm=x -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/dig -F perm=x -F key=T1018_Remote_System_Discovery

-a always,exit -F arch=b32 -F path=/proc/net/tcp -S open -S openat -F "auid>=500" -F "auid!=-1" -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/proc/net/tcp -S open -S openat -F "auid>=500" -F "auid!=-1" -F key=T1018_Remote_System_Discovery

-a always,exit -F arch=b32 -F path=/proc/net/arp -S open -S openat -F "auid>=500" -F "auid!=-1" -F key=T1018_Remote_System_Discovery
-a always,exit -F arch=b64 -F path=/proc/net/arp -S open -S openat -F "auid>=500" -F "auid!=-1" -F key=T1018_Remote_System_Discovery

# T1083_File_and_Directory_Discovery

## grep
-a always,exit -F arch=b32 -F path=/usr/bin/grep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/grep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/grep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/grep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/grep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/grep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/grep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/grep -F perm=x -F key=T1083_File_and_Directory_Discovery

## egrep
-a always,exit -F arch=b32 -F path=/usr/bin/egrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/egrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/egrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/egrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/egrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/egrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/egrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/egrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## ugrep
### https://github.com/Genivia/ugrep
-a always,exit -F arch=b32 -F path=/usr/bin/ugrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ugrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ugrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ugrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ugrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ugrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ugrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ugrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## bgrep
### https://github.com/tmbinc/bgrep
-a always,exit -F arch=b32 -F path=/usr/bin/bgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/bgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/bgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/bgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/bgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/bgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/bgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/bgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## ripgrep
### https://github.com/BurntSushi/ripgrep
-a always,exit -F arch=b32 -F path=/usr/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/ripgrep/current/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/ripgrep/current/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/home/linuxbrew/.linuxbrew/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/home/linuxbrew/.linuxbrew/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/opt/homebrew/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/opt/homebrew/bin/rg -F perm=x -F key=T1083_File_and_Directory_Discovery

## ripgrep-all
### https://github.com/phiresky/ripgrep-all
-a always,exit -F arch=b32 -F path=/usr/bin/rga -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/rga -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/rga -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/rga -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/rga -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/rga -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rga -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rga -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/bin/rga -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/rga -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/bin/rga -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/bin/rga -F perm=x -F key=T1083_File_and_Directory_Discovery

## nowgrep
### https://github.com/asbott/nowgrep
-a always,exit -F arch=b32 -F path=/usr/bin/nowgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/nowgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/nowgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/nowgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/nowgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/nowgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/nowgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/nowgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/bin/nowgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/nowgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/bin/nowgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/bin/nowgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## zgrep
-a always,exit -F arch=b32 -F path=/usr/bin/zgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/zgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/zgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/zgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/zgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/zgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zgrep -F perm=x -F key=T1083_File_and_Directory_Discovery


## cgrep
### https://github.com/awgn/cgrep
-a always,exit -F arch=b32 -F path=/usr/bin/cgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/cgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/cgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/cgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/cgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/cgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/cgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/cgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## ngrep
### https://github.com/jpr5/ngrep
-a always,exit -F arch=b32 -F path=/usr/bin/ngrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ngrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ngrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ngrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ngrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ngrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ngrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ngrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## vgrep
### https://github.com/vrothberg/vgrep
-a always,exit -F arch=b32 -F path=/usr/bin/vgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/vgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/vgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/vgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/vgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/vgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/vgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/vgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## hypergrep
### https://github.com/p-ranav/hypergrep
-a always,exit -F arch=b32 -F path=/usr/bin/hypergrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/hypergrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/hypergrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/hypergrep -F perm=x -F key=T1083_File_and_Directory_Discovery

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/hypergrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/hypergrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## https://github.com/gvansickle/ucg
-a always,exit -F arch=b32 -F path=/usr/bin/ucg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ucg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ucg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ucg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ucg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ucg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ucg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ucg -F perm=x -F key=T1083_File_and_Directory_Discovery

## https://github.com/monochromegane/the_platinum_searcher
-a always,exit -F arch=b32 -F path=/usr/bin/pt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/pt -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/pt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/pt -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/pt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/pt -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/pt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/pt -F perm=x -F key=T1083_File_and_Directory_Discovery

## https://github.com/ggreer/the_silver_searcher
-a always,exit -F arch=b32 -F path=/usr/bin/ag -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ag -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ag -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ag -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ag -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ag -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ag -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ag -F perm=x -F key=T1083_File_and_Directory_Discovery

## https://github.com/svent/sift
-a always,exit -F arch=b32 -F path=/usr/bin/sift -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/sift -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/sift -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/sift -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/sift -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/sift -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/sift -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/sift -F perm=x -F key=T1083_File_and_Directory_Discovery

### https://github.com/beyondgrep/ack3
### https://beyondgrep.com
-a always,exit -F arch=b32 -F path=/usr/bin/ack -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ack -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ack -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ack -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ack -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ack -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ack -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ack -F perm=x -F key=T1083_File_and_Directory_Discovery

## semgrep
### https://github.com/returntocorp/semgrep
-a always,exit -F arch=b32 -F path=/usr/bin/semgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/semgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/semgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/semgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/semgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/semgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/semgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/semgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## rzgrep
### https://github.com/MoserMichael/rzgrep
-a always,exit -F arch=b32 -F path=/usr/bin/rzgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/rzgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/rzgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/rzgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/rzgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/rzgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rzgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rzgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## xlsxgrep
### https://github.com/zazuum/xlsxgrep
-a always,exit -F arch=b32 -F path=/usr/bin/xlsxgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/xlsxgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/xlsxgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/xlsxgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/xlsxgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/xlsxgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xlsxgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xlsxgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## mp4grep
### https://github.com/o-oconnell/mp4grep
-a always,exit -F arch=b32 -F path=/usr/bin/mp4grep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/mp4grep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/mp4grep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/mp4grep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/mp4grep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/mp4grep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/mp4grep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/mp4grep -F perm=x -F key=T1083_File_and_Directory_Discovery

## hackers-grep
### https://github.com/codypierce/hackers-grep
-a always,exit -F arch=b32 -F path=/usr/bin/hackers-grep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/hackers-grep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/hackers-grep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/hackers-grep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/hackers-grep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/hackers-grep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/hackers-grep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/hackers-grep -F perm=x -F key=T1083_File_and_Directory_Discovery

## jvgrep
### https://github.com/mattn/jvgrep
-a always,exit -F arch=b32 -F path=/usr/bin/jvgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/jvgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/jvgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/jvgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/jvgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/jvgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/jvgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/jvgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## livegrep
### https://livegrep.com/search/linux
-a always,exit -F arch=b32 -F path=/usr/bin/livegrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/livegrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/livegrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/livegrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/livegrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/livegrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/livegrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/livegrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## pru
### https://github.com/grosser/pru
-a always,exit -F arch=b32 -F path=/usr/bin/pru -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/pru -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/pru -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/pru -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/pru -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/pru -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/pru -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/pru -F perm=x -F key=T1083_File_and_Directory_Discovery

## ytgrep
### https://pypi.org/project/ytgrep/
-a always,exit -F arch=b32 -F path=/usr/bin/ytgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ytgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ytgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ytgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ytgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ytgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ytgrep -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ytgrep -F perm=x -F key=T1083_File_and_Directory_Discovery

## vi
-a always,exit -F arch=b32 -F path=/usr/bin/vi -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/vi -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/vi -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/vi -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/vi -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/vi -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/vi -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/vi -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/bin/vi -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/vi -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/vi -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/vi -F perm=x -F key=T1083_File_and_Directory_Discovery

## vim
-a always,exit -F arch=b32 -F path=/usr/bin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/bin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/bin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/bin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/vim/current/bin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/vim/current/bin/vim -F perm=x -F key=T1083_File_and_Directory_Discovery

## rview
-a always,exit -F arch=b32 -F path=/bin/rview -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/rview -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/rview -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/rview -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/rview -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/rview -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/rview -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/rview -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/rview -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/rview -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rview -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rview -F perm=x -F key=T1083_File_and_Directory_Discovery

## rvim
-a always,exit -F arch=b32 -F path=/bin/rvim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/rvim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/rvim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/rvim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/rvim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/rvim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/rvim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/rvim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/rvim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/rvim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rvim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rvim -F perm=x -F key=T1083_File_and_Directory_Discovery

# nano
-a always,exit -F arch=b32 -F path=/usr/bin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/bin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/bin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/bin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/nano/current/bin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/nano/current/bin/nano -F perm=x -F key=T1083_File_and_Directory_Discovery

# emacs
-a always,exit -F arch=b32 -F path=/usr/bin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/bin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/bin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/bin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/emacs/current/bin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/emacs/current/bin/emacs -F perm=x -F key=T1083_File_and_Directory_Discovery

### ls
-a always,exit -F arch=b32 -F path=/usr/bin/ls -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ls -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ls -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ls -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ls -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ls -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ls -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ls -F perm=x -F key=T1083_File_and_Directory_Discovery

### ll
-a always,exit -F arch=b32 -F path=/usr/bin/ll -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ll -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ll -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ll -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ll -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ll -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ll -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ll -F perm=x -F key=T1083_File_and_Directory_Discovery

### dir
-a always,exit -F arch=b32 -F path=/usr/bin/dir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/dir -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/dir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/dir -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/dir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/dir -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/dir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/dir -F perm=x -F key=T1083_File_and_Directory_Discovery

### vdir
-a always,exit -F arch=b32 -F path=/usr/bin/vdir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/vdir -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/vdir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/vdir -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/vdir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/vdir -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/vdir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/vdir -F perm=x -F key=T1083_File_and_Directory_Discovery

### tree
-a always,exit -F arch=b32 -F path=/usr/bin/tree -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/tree -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/tree -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/tree -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/vdir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/vdir -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/vdir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/vdir -F perm=x -F key=T1083_File_and_Directory_Discovery

### find
-a always,exit -F arch=b32 -F path=/usr/bin/find -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/find -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/find -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/find -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/find-F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/find -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/find -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/find -F perm=x -F key=T1083_File_and_Directory_Discovery

### locate
-a always,exit -F arch=b32 -F path=/usr/bin/locate -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/locate -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/locate -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/locate -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/locate -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/locate -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/locate -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/locate -F perm=x -F key=T1083_File_and_Directory_Discovery

### whereis
-a always,exit -F arch=b32 -F path=/usr/bin/whereis -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/whereis -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/whereis -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/whereis -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/whereis -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/whereis -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/whereis -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/whereis -F perm=x -F key=T1083_File_and_Directory_Discovery

### which
-a always,exit -F arch=b32 -F path=/usr/bin/which -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/which -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/which -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/which -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/which -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/which -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/which -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/which -F perm=x -F key=T1083_File_and_Directory_Discovery

### type
-a always,exit -F arch=b32 -F path=/usr/bin/type -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/type -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/type -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/type -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/type -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/type -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/type -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/type -F perm=x -F key=T1083_File_and_Directory_Discovery

### updatedb
-a always,exit -F arch=b32 -F path=/usr/bin/updatedb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/updatedb -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/updatedb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/updatedb -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/updatedb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/updatedb -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/updatedb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/updatedb -F perm=x -F key=T1083_File_and_Directory_Discovery

### mlocate
-a always,exit -F arch=b32 -F path=/usr/bin/mlocate -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/mlocate -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/mlocate -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/mlocate -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/mlocate -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/mlocate -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/mlocate -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/mlocate -F perm=x -F key=T1083_File_and_Directory_Discovery

### du
-a always,exit -F arch=b32 -F path=/usr/bin/du -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/du -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/du -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/du -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/du -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/du -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/du -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/du -F perm=x -F key=T1083_File_and_Directory_Discovery

### ncdu
-a always,exit -F arch=b32 -F path=/usr/bin/ncdu -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ncdu -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ncdu -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ncdu -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ncdu -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ncdu -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ncdu -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ncdu -F perm=x -F key=T1083_File_and_Directory_Discovery

### stat
-a always,exit -F arch=b32 -F path=/usr/bin/stat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/stat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/stat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/stat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/stat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/stat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/stat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/stat -F perm=x -F key=T1083_File_and_Directory_Discovery

### file
-a always,exit -F arch=b32 -F path=/usr/bin/file -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/file -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/file -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/file -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/file -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/file -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/file -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/file -F perm=x -F key=T1083_File_and_Directory_Discovery

### realpath
-a always,exit -F arch=b32 -F path=/usr/bin/realpath -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/realpath -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/realpath -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/realpath -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/realpath -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/realpath -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/realpath -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/realpath -F perm=x -F key=T1083_File_and_Directory_Discovery

### readlink
-a always,exit -F arch=b32 -F path=/usr/bin/readlink -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/readlink -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/readlink -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/readlink -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/readlink -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/readlink -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/readlink -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/readlink -F perm=x -F key=T1083_File_and_Directory_Discovery

### namei
-a always,exit -F arch=b32 -F path=/usr/bin/namei -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/namei -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/namei -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/namei -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/namei -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/namei -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/namei -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/namei -F perm=x -F key=T1083_File_and_Directory_Discovery

### cat
-a always,exit -F arch=b32 -F path=/usr/bin/cat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/cat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/cat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/cat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/cat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/cat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/cat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/cat -F perm=x -F key=T1083_File_and_Directory_Discovery

### batcat
-a always,exit -F arch=b32 -F path=/usr/bin/batcat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/batcat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/batcat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/batcat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/batcat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/batcat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/batcat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/batcat -F perm=x -F key=T1083_File_and_Directory_Discovery

### tail
-a always,exit -F arch=b32 -F path=/usr/bin/tail -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/tail -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/tail -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/tail -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/tail -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/tail -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/tail -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/tail -F perm=x -F key=T1083_File_and_Directory_Discovery

### head
-a always,exit -F arch=b32 -F path=/usr/bin/head -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/head -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/head -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/head -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/head -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/head -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/head -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/head -F perm=x -F key=T1083_File_and_Directory_Discovery

### sed
-a always,exit -F arch=b32 -F path=/usr/bin/sed -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/sed -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/sed -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/sed -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/sed -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/sed -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/sed -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/sed -F perm=x -F key=T1083_File_and_Directory_Discovery

### awk
-a always,exit -F arch=b32 -F path=/usr/bin/awk -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/awk -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/awk -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/awk -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/awk -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/awk -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/awk -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/awk -F perm=x -F key=T1083_File_and_Directory_Discovery

### fdfind
-a always,exit -F arch=b32 -F path=/usr/bin/fdfind -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/fdfind -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/fdfind -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/fdfind -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/fdfind -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/fdfind -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/fdfind -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/fdfind -F perm=x -F key=T1083_File_and_Directory_Discovery

### fd
-a always,exit -F arch=b32 -F path=/usr/bin/fd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/fd -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/fd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/fd -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/fd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/fd -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/fd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/fd -F perm=x -F key=T1083_File_and_Directory_Discovery

### fzf
-a always,exit -F arch=b32 -F path=/usr/bin/fzf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/fzf -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/fzf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/fzf -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/fzf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/fzf -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/fzf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/fzf -F perm=x -F key=T1083_File_and_Directory_Discovery

### mount
-a always,exit -F arch=b32 -F path=/usr/bin/mount -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/mount -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/mount -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/mount -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/mount -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/mount -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/mount -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/mount -F perm=x -F key=T1083_File_and_Directory_Discovery

### findmnt
-a always,exit -F arch=b32 -F path=/usr/bin/findmnt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/findmnt -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/findmnt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/findmnt -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/findmnt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/findmnt -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/findmnt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/findmnt -F perm=x -F key=T1083_File_and_Directory_Discovery

### df
-a always,exit -F arch=b32 -F path=/usr/bin/df -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/df -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/df -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/df -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/df -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/df -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/df -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/df -F perm=x -F key=T1083_File_and_Directory_Discovery

### env
-a always,exit -F arch=b32 -F path=/usr/bin/env -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/env -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/env -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/env -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/env -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/env -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/env -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/env -F perm=x -F key=T1083_File_and_Directory_Discovery

### printenv
-a always,exit -F arch=b32 -F path=/usr/bin/printenv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/printenv -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/printenv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/printenv -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/printenv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/printenv -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/printenv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/printenv -F perm=x -F key=T1083_File_and_Directory_Discovery

### pwd
-a always,exit -F arch=b32 -F path=/usr/bin/pwd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/pwd -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/pwd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/pwd -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/pwd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/pwd -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/pwd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/pwd -F perm=x -F key=T1083_File_and_Directory_Discovery

## alpine
-a always,exit -F arch=b32 -F path=/bin/alpine -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/alpine -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/alpine -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/alpine -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/alpine -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/alpine -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/alpine -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/alpine -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/alpine -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/alpine -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/alpine -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/alpine -F perm=x -F key=T1083_File_and_Directory_Discovery

## apache2ctl
-a always,exit -F arch=b32 -F path=/bin/apache2ctl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/apache2ctl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/apache2ctl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/apache2ctl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/apache2ctl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/apache2ctl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/apache2ctl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/apache2ctl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/apache2ctl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/apache2ctl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/apache2ctl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/apache2ctl -F perm=x -F key=T1083_File_and_Directory_Discovery

## as
-a always,exit -F arch=b32 -F path=/bin/as -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/as -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/as -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/as -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/as -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/as -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/as -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/as -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/as -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/as -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/as -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/as -F perm=x -F key=T1083_File_and_Directory_Discovery

## ascii-xfr
-a always,exit -F arch=b32 -F path=/bin/ascii-xfr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/ascii-xfr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/ascii-xfr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/ascii-xfr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/ascii-xfr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ascii-xfr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ascii-xfr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ascii-xfr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ascii-xfr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ascii-xfr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ascii-xfr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ascii-xfr -F perm=x -F key=T1083_File_and_Directory_Discovery

## ascii85
-a always,exit -F arch=b32 -F path=/bin/ascii85 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/ascii85 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/ascii85 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/ascii85 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/ascii85 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ascii85 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ascii85 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ascii85 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ascii85 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ascii85 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ascii85 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ascii85 -F perm=x -F key=T1083_File_and_Directory_Discovery

## aspell
-a always,exit -F arch=b32 -F path=/bin/aspell -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/aspell -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/aspell -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/aspell -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/aspell -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/aspell -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/aspell -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/aspell -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/aspell -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/aspell -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/aspell -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/aspell -F perm=x -F key=T1083_File_and_Directory_Discovery

## atobm
-a always,exit -F arch=b32 -F path=/bin/atobm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/atobm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/atobm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/atobm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/atobm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/atobm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/atobm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/atobm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/atobm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/atobm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/atobm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/atobm -F perm=x -F key=T1083_File_and_Directory_Discovery

## base32
-a always,exit -F arch=b32 -F path=/bin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/bin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/bin/base32 -F perm=x -F key=T1083_File_and_Directory_Discovery

## base58
-a always,exit -F arch=b32 -F path=/bin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/bin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/bin/base58 -F perm=x -F key=T1083_File_and_Directory_Discovery

## base64
-a always,exit -F arch=b32 -F path=/bin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/bin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/bin/base64 -F perm=x -F key=T1083_File_and_Directory_Discovery

## basenc
-a always,exit -F arch=b32 -F path=/bin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/bin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/bin/basenc -F perm=x -F key=T1083_File_and_Directory_Discovery

## basez
-a always,exit -F arch=b32 -F path=/bin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/basez -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/basez -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/snap/bin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/snap/bin/basez -F perm=x -F key=T1083_File_and_Directory_Discovery

## bc
-a always,exit -F arch=b32 -F path=/bin/bc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/bc -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/bc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/bc -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/bc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/bc -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/bc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/bc -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/bc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/bc -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/bc -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/bc -F perm=x -F key=T1083_File_and_Directory_Discovery

## bconsole
-a always,exit -F arch=b32 -F path=/bin/bconsole -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/bconsole -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/bconsole -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/bconsole -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/bconsole -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/bconsole -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/bconsole -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/bconsole -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/bconsole -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/bconsole -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/bconsole -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/bconsole -F perm=x -F key=T1083_File_and_Directory_Discovery

## bridge
-a always,exit -F arch=b32 -F path=/bin/bridge -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/bridge -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/bridge -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/bridge -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/bridge -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/bridge -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/bridge -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/bridge -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/bridge -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/bridge -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/bridge -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/bridge -F perm=x -F key=T1083_File_and_Directory_Discovery

## c89
-a always,exit -F arch=b32 -F path=/bin/c89 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/c89 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/c89 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/c89 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/c89 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/c89 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/c89 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/c89 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/c89 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/c89 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/c89 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/c89 -F perm=x -F key=T1083_File_and_Directory_Discovery

## c99
-a always,exit -F arch=b32 -F path=/bin/c99 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/c99 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/c99 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/c99 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/c99 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/c99 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/c99 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/c99 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/c99 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/c99 -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/c99 -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/c99 -F perm=x -F key=T1083_File_and_Directory_Discovery

## check_cups
-a always,exit -F arch=b32 -F path=/bin/check_cups -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/check_cups -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/check_cups -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/check_cups -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/check_cups -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/check_cups -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/check_cups -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/check_cups -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/check_cups -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/check_cups -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/check_cups -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/check_cups -F perm=x -F key=T1083_File_and_Directory_Discovery

## check_log
-a always,exit -F arch=b32 -F path=/bin/check_log -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/check_log -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/check_log -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/check_log -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/check_log -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/check_log -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/check_log -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/check_log -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/check_log -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/check_log -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/check_log -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/check_log -F perm=x -F key=T1083_File_and_Directory_Discovery

## check_memory
-a always,exit -F arch=b32 -F path=/bin/check_memory -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/check_memory -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/check_memory -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/check_memory -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/check_memory -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/check_memory -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/check_memory -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/check_memory -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/check_memory -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/check_memory -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/check_memory -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/check_memory -F perm=x -F key=T1083_File_and_Directory_Discovery

## check_raid
-a always,exit -F arch=b32 -F path=/bin/check_raid -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/check_raid -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/check_raid -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/check_raid -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/check_raid -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/check_raid -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/check_raid -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/check_raid -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/check_raid -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/check_raid -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/check_raid -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/check_raid -F perm=x -F key=T1083_File_and_Directory_Discovery

## check_statusfile
-a always,exit -F arch=b32 -F path=/bin/check_statusfile -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/check_statusfile -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/check_statusfile -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/check_statusfile -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/check_statusfile -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/check_statusfile -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/check_statusfile -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/check_statusfile -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/check_statusfile -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/check_statusfile -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/check_statusfile -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/check_statusfile -F perm=x -F key=T1083_File_and_Directory_Discovery

## cmp
-a always,exit -F arch=b32 -F path=/bin/cmp -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/cmp -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/cmp -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/cmp -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/cmp -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/cmp -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/cmp -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/cmp -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/cmp -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/cmp -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/cmp -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/cmp -F perm=x -F key=T1083_File_and_Directory_Discovery

## column
-a always,exit -F arch=b32 -F path=/bin/column -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/column -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/column -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/column -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/column -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/column -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/column -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/column -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/column -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/column -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/column -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/column -F perm=x -F key=T1083_File_and_Directory_Discovery

## comm
-a always,exit -F arch=b32 -F path=/bin/comm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/comm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/comm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/comm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/comm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/comm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/comm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/comm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/comm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/comm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/comm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/comm -F perm=x -F key=T1083_File_and_Directory_Discovery

## csplit
-a always,exit -F arch=b32 -F path=/bin/csplit -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/csplit -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/csplit -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/csplit -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/csplit -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/csplit -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/csplit -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/csplit -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/csplit -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/csplit -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/csplit -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/csplit -F perm=x -F key=T1083_File_and_Directory_Discovery

## csvtool
-a always,exit -F arch=b32 -F path=/bin/csvtool -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/csvtool -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/csvtool -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/csvtool -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/csvtool -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/csvtool -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/csvtool -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/csvtool -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/csvtool -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/csvtool -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/csvtool -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/csvtool -F perm=x -F key=T1083_File_and_Directory_Discovery

## cupsfilter
-a always,exit -F arch=b32 -F path=/bin/cupsfilter -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/cupsfilter -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/cupsfilter -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/cupsfilter -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/cupsfilter -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/cupsfilter -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/cupsfilter -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/cupsfilter -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/cupsfilter -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/cupsfilter -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/cupsfilter -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/cupsfilter -F perm=x -F key=T1083_File_and_Directory_Discovery

## cut
-a always,exit -F arch=b32 -F path=/bin/cut -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/cut -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/cut -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/cut -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/cut -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/cut -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/cut -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/cut -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/cut -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/cut -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/cut -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/cut -F perm=x -F key=T1083_File_and_Directory_Discovery

## date
-a always,exit -F arch=b32 -F path=/bin/date -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/date -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/date -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/date -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/date -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/date -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/date -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/date -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/date -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/date -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/date -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/date -F perm=x -F key=T1083_File_and_Directory_Discovery

## dialog
-a always,exit -F arch=b32 -F path=/bin/dialog -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/dialog -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/dialog -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/dialog -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/dialog -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/dialog -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/dialog -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/dialog -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/dialog -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/dialog -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/dialog -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/dialog -F perm=x -F key=T1083_File_and_Directory_Discovery

## diff
-a always,exit -F arch=b32 -F path=/bin/diff -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/diff -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/diff -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/diff -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/diff -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/diff -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/diff -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/diff -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/diff -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/diff -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/diff -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/diff -F perm=x -F key=T1083_File_and_Directory_Discovery

## ed
-a always,exit -F arch=b32 -F path=/bin/ed -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/ed -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/ed -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/ed -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/ed -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ed -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ed -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ed -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ed -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ed -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ed -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ed -F perm=x -F key=T1083_File_and_Directory_Discovery

## elvish
-a always,exit -F arch=b32 -F path=/bin/elvish -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/elvish -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/elvish -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/elvish -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/elvish -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/elvish -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/elvish -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/elvish -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/elvish -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/elvish -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/elvish -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/elvish -F perm=x -F key=T1083_File_and_Directory_Discovery

## eqn
-a always,exit -F arch=b32 -F path=/bin/eqn -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/eqn -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/eqn -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/eqn -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/eqn -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/eqn -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/eqn -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/eqn -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/eqn -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/eqn -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/eqn -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/eqn -F perm=x -F key=T1083_File_and_Directory_Discovery

## espeak
-a always,exit -F arch=b32 -F path=/bin/espeak -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/espeak -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/espeak -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/espeak -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/espeak -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/espeak -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/espeak -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/espeak -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/espeak -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/espeak -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/espeak -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/espeak -F perm=x -F key=T1083_File_and_Directory_Discovery

## ex
-a always,exit -F arch=b32 -F path=/bin/ex -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/ex -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/ex -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/ex -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/ex -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ex -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ex -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ex -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ex -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ex -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ex -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ex -F perm=x -F key=T1083_File_and_Directory_Discovery

## exiftool
-a always,exit -F arch=b32 -F path=/bin/exiftool -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/exiftool -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/exiftool -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/exiftool -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/exiftool -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/exiftool -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/exiftool -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/exiftool -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/exiftool -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/exiftool -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/exiftool -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/exiftool -F perm=x -F key=T1083_File_and_Directory_Discovery

## expand
-a always,exit -F arch=b32 -F path=/bin/expand -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/expand -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/expand -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/expand -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/expand -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/expand -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/expand -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/expand -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/expand -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/expand -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/expand -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/expand -F perm=x -F key=T1083_File_and_Directory_Discovery

## expect
-a always,exit -F arch=b32 -F path=/bin/expect -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/expect -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/expect -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/expect -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/expect -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/expect -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/expect -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/expect -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/expect -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/expect -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/expect -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/expect -F perm=x -F key=T1083_File_and_Directory_Discovery

## fmt
-a always,exit -F arch=b32 -F path=/bin/fmt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/fmt -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/fmt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/fmt -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/fmt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/fmt -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/fmt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/fmt -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/fmt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/fmt -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/fmt -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/fmt -F perm=x -F key=T1083_File_and_Directory_Discovery

## fold
-a always,exit -F arch=b32 -F path=/bin/fold -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/fold -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/fold -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/fold -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/fold -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/fold -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/fold -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/fold -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/fold -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/fold -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/fold -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/fold -F perm=x -F key=T1083_File_and_Directory_Discovery

## gcore
-a always,exit -F arch=b32 -F path=/bin/gcore -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/gcore -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/gcore -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/gcore -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/gcore -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/gcore -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/gcore -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/gcore -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/gcore -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/gcore -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/gcore -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/gcore -F perm=x -F key=T1083_File_and_Directory_Discovery

## gdb
-a always,exit -F arch=b32 -F path=/bin/gdb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/gdb -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/gdb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/gdb -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/gdb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/gdb -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/gdb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/gdb -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/gdb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/gdb -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/gdb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/gdb -F perm=x -F key=T1083_File_and_Directory_Discovery

## genisoimage
-a always,exit -F arch=b32 -F path=/bin/genisoimage -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/genisoimage -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/genisoimage -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/genisoimage -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/genisoimage -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/genisoimage -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/genisoimage -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/genisoimage -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/genisoimage -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/genisoimage -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/genisoimage -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/genisoimage -F perm=x -F key=T1083_File_and_Directory_Discovery

## gimp
-a always,exit -F arch=b32 -F path=/bin/gimp -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/gimp -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/gimp -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/gimp -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/gimp -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/gimp -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/gimp -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/gimp -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/gimp -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/gimp -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/gimp -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/gimp -F perm=x -F key=T1083_File_and_Directory_Discovery

## hd
-a always,exit -F arch=b32 -F path=/bin/hd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/hd -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/hd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/hd -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/hd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/hd -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/hd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/hd -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/hd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/hd -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/hd -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/hd -F perm=x -F key=T1083_File_and_Directory_Discovery

## hexdump
-a always,exit -F arch=b32 -F path=/bin/hexdump -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/hexdump -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/hexdump -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/hexdump -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/hexdump -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/hexdump -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/hexdump -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/hexdump -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/hexdump -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/hexdump -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/hexdump -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/hexdump -F perm=x -F key=T1083_File_and_Directory_Discovery

## highlight
-a always,exit -F arch=b32 -F path=/bin/highlight -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/highlight -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/highlight -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/highlight -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/highlight -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/highlight -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/highlight -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/highlight -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/highlight -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/highlight -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/highlight -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/highlight -F perm=x -F key=T1083_File_and_Directory_Discovery

## iconv
-a always,exit -F arch=b32 -F path=/bin/iconv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/iconv -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/iconv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/iconv -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/iconv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/iconv -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/iconv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/iconv -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/iconv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/iconv -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/iconv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/iconv -F perm=x -F key=T1083_File_and_Directory_Discovery

## irb
-a always,exit -F arch=b32 -F path=/bin/irb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/irb -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/irb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/irb -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/irb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/irb -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/irb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/irb -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/irb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/irb -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/irb -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/irb -F perm=x -F key=T1083_File_and_Directory_Discovery

## jjs
-a always,exit -F arch=b32 -F path=/bin/jjs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/jjs -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/jjs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/jjs -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/jjs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/jjs -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/jjs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/jjs -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/jjs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/jjs -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/jjs -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/jjs -F perm=x -F key=T1083_File_and_Directory_Discovery

## join
-a always,exit -F arch=b32 -F path=/bin/join -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/join -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/join -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/join -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/join -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/join -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/join -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/join -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/join -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/join -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/join -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/join -F perm=x -F key=T1083_File_and_Directory_Discovery

## jq
-a always,exit -F arch=b32 -F path=/bin/jq -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/jq -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/jq -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/jq -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/jq -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/jq -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/jq -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/jq -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/jq -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/jq -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/jq -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/jq -F perm=x -F key=T1083_File_and_Directory_Discovery

## less
-a always,exit -F arch=b32 -F path=/bin/less -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/less -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/less -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/less -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/less -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/less -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/less -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/less -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/less -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/less -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/less -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/less -F perm=x -F key=T1083_File_and_Directory_Discovery

## links
-a always,exit -F arch=b32 -F path=/bin/links -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/links -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/links -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/links -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/links -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/links -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/links -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/links -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/links -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/links -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/links -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/links -F perm=x -F key=T1083_File_and_Directory_Discovery

## look
-a always,exit -F arch=b32 -F path=/bin/look -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/look -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/look -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/look -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/look -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/look -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/look -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/look -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/look -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/look -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/look -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/look -F perm=x -F key=T1083_File_and_Directory_Discovery

## ltrace
-a always,exit -F arch=b32 -F path=/bin/ltrace -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/ltrace -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/ltrace -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/ltrace -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/ltrace -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ltrace -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ltrace -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ltrace -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ltrace -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ltrace -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ltrace -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ltrace -F perm=x -F key=T1083_File_and_Directory_Discovery

## lwp-download
-a always,exit -F arch=b32 -F path=/bin/lwp-download -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/lwp-download -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/lwp-download -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/lwp-download -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/lwp-download -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/lwp-download -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/lwp-download -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/lwp-download -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/lwp-download -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/lwp-download -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lwp-download -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lwp-download -F perm=x -F key=T1083_File_and_Directory_Discovery

## lwp-request
-a always,exit -F arch=b32 -F path=/bin/lwp-request -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/lwp-request -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/lwp-request -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/lwp-request -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/lwp-request -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/lwp-request -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/lwp-request -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/lwp-request -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/lwp-request -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/lwp-request -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lwp-request -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lwp-request -F perm=x -F key=T1083_File_and_Directory_Discovery

## man
-a always,exit -F arch=b32 -F path=/bin/man -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/man -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/man -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/man -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/man -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/man -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/man -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/man -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/man -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/man -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/man -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/man -F perm=x -F key=T1083_File_and_Directory_Discovery

## mkdir
-a always,exit -F arch=b32 -F path=/bin/mkdir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/mkdir -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/mkdir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/mkdir -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/mkdir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/mkdir -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/mkdir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/mkdir -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/mkdir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/mkdir -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/mkdir -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/mkdir -F perm=x -F key=T1083_File_and_Directory_Discovery

## more
-a always,exit -F arch=b32 -F path=/bin/more -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/more -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/more -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/more -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/more -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/more -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/more -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/more -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/more -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/more -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/more -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/more -F perm=x -F key=T1083_File_and_Directory_Discovery

## mosquitto
-a always,exit -F arch=b32 -F path=/bin/mosquitto -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/mosquitto -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/mosquitto -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/mosquitto -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/mosquitto -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/mosquitto -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/mosquitto -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/mosquitto -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/mosquitto -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/mosquitto -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/mosquitto -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/mosquitto -F perm=x -F key=T1083_File_and_Directory_Discovery

## msgattrib
-a always,exit -F arch=b32 -F path=/bin/msgattrib -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/msgattrib -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/msgattrib -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/msgattrib -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/msgattrib -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/msgattrib -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/msgattrib -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/msgattrib -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/msgattrib -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/msgattrib -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/msgattrib -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/msgattrib -F perm=x -F key=T1083_File_and_Directory_Discovery

## msgcat
-a always,exit -F arch=b32 -F path=/bin/msgcat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/msgcat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/msgcat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/msgcat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/msgcat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/msgcat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/msgcat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/msgcat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/msgcat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/msgcat -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/msgcat -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/msgcat -F perm=x -F key=T1083_File_and_Directory_Discovery

## msgconv
-a always,exit -F arch=b32 -F path=/bin/msgconv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/msgconv -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/msgconv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/msgconv -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/msgconv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/msgconv -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/msgconv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/msgconv -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/msgconv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/msgconv -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/msgconv -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/msgconv -F perm=x -F key=T1083_File_and_Directory_Discovery

## msgfilter
-a always,exit -F arch=b32 -F path=/bin/msgfilter -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/msgfilter -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/msgfilter -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/msgfilter -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/msgfilter -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/msgfilter -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/msgfilter -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/msgfilter -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/msgfilter -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/msgfilter -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/msgfilter -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/msgfilter -F perm=x -F key=T1083_File_and_Directory_Discovery

## msgmerge
-a always,exit -F arch=b32 -F path=/bin/msgmerge -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/msgmerge -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/msgmerge -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/msgmerge -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/msgmerge -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/msgmerge -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/msgmerge -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/msgmerge -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/msgmerge -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/msgmerge -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/msgmerge -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/msgmerge -F perm=x -F key=T1083_File_and_Directory_Discovery

## msguniq
-a always,exit -F arch=b32 -F path=/bin/msguniq -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/msguniq -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/msguniq -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/msguniq -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/msguniq -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/msguniq -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/msguniq -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/msguniq -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/msguniq -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/msguniq -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/msguniq -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/msguniq -F perm=x -F key=T1083_File_and_Directory_Discovery

## mtr
-a always,exit -F arch=b32 -F path=/bin/mtr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/mtr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/mtr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/mtr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/mtr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/mtr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/mtr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/mtr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/mtr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/mtr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/mtr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/mtr -F perm=x -F key=T1083_File_and_Directory_Discovery

## nasm
-a always,exit -F arch=b32 -F path=/bin/nasm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/nasm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/nasm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/nasm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/nasm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/nasm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/nasm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/nasm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/nasm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/nasm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/nasm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/nasm -F perm=x -F key=T1083_File_and_Directory_Discovery

## nl
-a always,exit -F arch=b32 -F path=/bin/nl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/nl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/nl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/nl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/nl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/nl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/nl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/nl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/nl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/nl -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/nl -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/nl -F perm=x -F key=T1083_File_and_Directory_Discovery

## nm
-a always,exit -F arch=b32 -F path=/bin/nm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/nm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/nm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/nm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/nm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/nm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/nm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/nm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/nm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/nm -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/nm -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/nm -F perm=x -F key=T1083_File_and_Directory_Discovery

## nroff
-a always,exit -F arch=b32 -F path=/bin/nroff -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/nroff -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/nroff -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/nroff -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/nroff -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/nroff -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/nroff -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/nroff -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/nroff -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/nroff -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/nroff -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/nroff -F perm=x -F key=T1083_File_and_Directory_Discovery

## octave
-a always,exit -F arch=b32 -F path=/bin/octave -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/octave -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/octave -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/octave -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/octave -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/octave -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/octave -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/octave -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/octave -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/octave -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/octave -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/octave -F perm=x -F key=T1083_File_and_Directory_Discovery

## od
-a always,exit -F arch=b32 -F path=/bin/od -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/od -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/od -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/od -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/od -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/od -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/od -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/od -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/od -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/od -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/od -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/od -F perm=x -F key=T1083_File_and_Directory_Discovery

## paste
-a always,exit -F arch=b32 -F path=/bin/paste -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/paste -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/paste -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/paste -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/paste -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/paste -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/paste -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/paste -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/paste -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/paste -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/paste -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/paste -F perm=x -F key=T1083_File_and_Directory_Discovery

## pg
-a always,exit -F arch=b32 -F path=/bin/pg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/pg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/pg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/pg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/pg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/pg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/pg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/pg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/pg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/pg -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/pg -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/pg -F perm=x -F key=T1083_File_and_Directory_Discovery

## pic
-a always,exit -F arch=b32 -F path=/bin/pic -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/pic -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/pic -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/pic -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/pic -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/pic -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/pic -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/pic -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/pic -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/pic -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/pic -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/pic -F perm=x -F key=T1083_File_and_Directory_Discovery

## pr
-a always,exit -F arch=b32 -F path=/bin/pr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/pr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/pr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/pr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/pr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/pr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/pr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/pr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/pr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/pr -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/pr -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/pr -F perm=x -F key=T1083_File_and_Directory_Discovery

## ptx
-a always,exit -F arch=b32 -F path=/bin/ptx -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/ptx -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/ptx -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/ptx -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/ptx -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/ptx -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/ptx -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/ptx -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/ptx -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/ptx -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ptx -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ptx -F perm=x -F key=T1083_File_and_Directory_Discovery

## rake
-a always,exit -F arch=b32 -F path=/bin/rake -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/rake -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/rake -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/rake -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/rake -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/rake -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/rake -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/rake -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/rake -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/rake -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rake -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rake -F perm=x -F key=T1083_File_and_Directory_Discovery

## readelf
-a always,exit -F arch=b32 -F path=/bin/readelf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/readelf -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/readelf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/readelf -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/readelf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/readelf -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/readelf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/readelf -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/readelf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/readelf -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/readelf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/readelf -F perm=x -F key=T1083_File_and_Directory_Discovery

## red
-a always,exit -F arch=b32 -F path=/bin/red -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/red -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/red -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/red -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/red -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/red -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/red -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/red -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/red -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/red -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/red -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/red -F perm=x -F key=T1083_File_and_Directory_Discovery

## redcarpet
-a always,exit -F arch=b32 -F path=/bin/redcarpet -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/redcarpet -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/redcarpet -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/redcarpet -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/redcarpet -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/redcarpet -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/redcarpet -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/redcarpet -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/redcarpet -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/redcarpet -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/redcarpet -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/redcarpet -F perm=x -F key=T1083_File_and_Directory_Discovery

## rev
-a always,exit -F arch=b32 -F path=/bin/rev -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/rev -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/rev -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/rev -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/rev -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/rev -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/rev -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/rev -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/rev -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/rev -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rev -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rev -F perm=x -F key=T1083_File_and_Directory_Discovery

## run-mailcap
-a always,exit -F arch=b32 -F path=/bin/run-mailcap -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/run-mailcap -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/run-mailcap -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/run-mailcap -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/run-mailcap -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/run-mailcap -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/run-mailcap -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/run-mailcap -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/run-mailcap -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/run-mailcap -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/run-mailcap -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/run-mailcap -F perm=x -F key=T1083_File_and_Directory_Discovery

## shuf
-a always,exit -F arch=b32 -F path=/bin/shuf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/shuf -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/shuf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/shuf -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/shuf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/shuf -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/shuf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/shuf -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/shuf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/shuf -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/shuf -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/shuf -F perm=x -F key=T1083_File_and_Directory_Discovery

## soelim
-a always,exit -F arch=b32 -F path=/bin/soelim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/soelim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/soelim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/soelim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/soelim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/soelim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/soelim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/soelim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/soelim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/soelim -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/soelim -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/soelim -F perm=x -F key=T1083_File_and_Directory_Discovery

## sort
-a always,exit -F arch=b32 -F path=/bin/sort -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/sort -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/sort -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/sort -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/sort -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/sort -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/sort -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/sort -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/sort -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/sort -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/sort -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/sort -F perm=x -F key=T1083_File_and_Directory_Discovery

## split
-a always,exit -F arch=b32 -F path=/bin/split -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/split -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/split -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/split -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/split -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/split -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/split -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/split -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/split -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/split -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/split -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/split -F perm=x -F key=T1083_File_and_Directory_Discovery

## strings
-a always,exit -F arch=b32 -F path=/bin/strings -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/strings -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/strings -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/strings -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/strings -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/strings -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/strings -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/strings -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/strings -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/strings -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/strings -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/strings -F perm=x -F key=T1083_File_and_Directory_Discovery

## tac
-a always,exit -F arch=b32 -F path=/bin/tac -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/bin/tac -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/sbin/tac -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/sbin/tac -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/bin/tac -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/tac -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/tac -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/tac -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/tac -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/tac -F perm=x -F key=T1083_File_and_Directory_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/tac -F perm=x -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/tac -F perm=x -F key=T1083_File_and_Directory_Discovery

## T1135 Network Share Discovery

### showmount
-a always,exit -F arch=b32 -F path=/usr/bin/showmount -F perm=x -F key=T1135_Network_Share_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/showmount -F perm=x -F key=T1135_Network_Share_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/showmount -F perm=x -F key=T1135_Network_Share_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/showmount -F perm=x -F key=T1135_Network_Share_Discovery

### exportfs
-a always,exit -F arch=b32 -F path=/usr/bin/exportfs -F perm=x -F key=T1135_Network_Share_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/exportfs -F perm=x -F key=T1135_Network_Share_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/exportfs -F perm=x -F key=T1135_Network_Share_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/exportfs -F perm=x -F key=T1135_Network_Share_Discovery

### nmblookup
-a always,exit -F arch=b32 -F path=/usr/bin/nmblookup -F perm=x -F key=T1135_Network_Share_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/nmblookup -F perm=x -F key=T1135_Network_Share_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/nmblookup -F perm=x -F key=T1135_Network_Share_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/nmblookup -F perm=x -F key=T1135_Network_Share_Discovery

### exports
-a always,exit -F arch=b32 -F path=/etc/exports -F perm=wa -F key=T1135_Network_Share_Discovery
-a always,exit -F arch=b64 -F path=/etc/exports -F perm=wa -F key=T1135_Network_Share_Discovery

### A configuration file that defines and configures static
### file system mounts, including options for each mount point.
-a always,exit -F arch=b32 -F path=/etc/fstab -F perm=wa -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/etc/fstab -F perm=wa -F key=T1083_File_and_Directory_Discovery

### A file that lists currently mounted file systems, the information
### about the device, mount point, and file system type.
-a always,exit -F arch=b32 -F path=/etc/mtab -F perm=wa -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/etc/mtab -F perm=wa -F key=T1083_File_and_Directory_Discovery
### The configuration file for the mtools package, used for accessing
### and managing MS-DOS (FAT) file systems, specifying settings
### for tools like mcopy and mdir.
-a always,exit -F arch=b32 -F path=/etc/mtools.conf -F perm=wa -F key=T1083_File_and_Directory_Discovery
-a always,exit -F arch=b64 -F path=/etc/mtools.conf -F perm=wa -F key=T1083_File_and_Directory_Discovery

## T1497_Virtualization_Sandbox_Evasion
### dmidecode
-a always,exit -F arch=b32 -F path=/usr/bin/dmidecode -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/dmidecode -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/dmidecode -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/dmidecode -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

### facter
-a always,exit -F arch=b32 -F path=/usr/bin/facter -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/facter -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/facter -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/facter -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

### lshw
-a always,exit -F arch=b32 -F path=/usr/bin/lshw -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/lshw -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/lshw -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/lshw -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

### dmesg
-a always,exit -F arch=b32 -F path=/usr/bin/dmesg -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/dmesg -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/dmesg -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/dmesg -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/bin/dmesg -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/bin/dmesg -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/local/sbin/dmesg -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/local/sbin/dmesg -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

### hostnamectl
-a always,exit -F arch=b32 -F path=/usr/bin/hostnamectl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/hostnamectl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/hostnamectl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/hostnamectl -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

### systemd-detect-virt
-a always,exit -F arch=b32 -F path=/usr/bin/systemd-detect-virt -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/systemd-detect-virt -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/systemd-detect-virt -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/systemd-detect-virt -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

### imvirt
-a always,exit -F arch=b32 -F path=/usr/bin/imvirt -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/bin/imvirt -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

-a always,exit -F arch=b32 -F path=/usr/sbin/imvirt -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion
-a always,exit -F arch=b64 -F path=/usr/sbin/imvirt -F perm=x -F key=T1497_Virtualization_Sandbox_Evasion

## T1082 System Information Discovery
### uname
-a always,exit -F arch=b32 -F path=/usr/bin/uname -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/uname -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/uname -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/uname -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/uname -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/uname -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/uname -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/uname -F perm=x -F key=T1082_System_Information_Discovery

### lscpu
-a always,exit -F arch=b32 -F path=/usr/bin/lscpu -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/lscpu -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/lscpu -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/lscpu -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/lscpu -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/lscpu -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lscpu -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lscpu -F perm=x -F key=T1082_System_Information_Discovery

### lsblk
-a always,exit -F arch=b32 -F path=/usr/bin/lsblk -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/lsblk -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/lsblk -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/lsblk -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/lsblk -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/lsblk -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lsblk -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lsblk -F perm=x -F key=T1082_System_Information_Discovery

### blkid
-a always,exit -F arch=b32 -F path=/usr/bin/blkid -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/blkid -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/blkid -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/blkid -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/blkid -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/blkid -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/blkid -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/blkid -F perm=x -F key=T1082_System_Information_Discovery

### lsscsi
-a always,exit -F arch=b32 -F path=/usr/bin/lsscsi -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/lsscsi -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/lsscsi -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/lsscsi -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/lsscsi -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/lsscsi -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lsscsi -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lsscsi -F perm=x -F key=T1082_System_Information_Discovery

### lsusb
-a always,exit -F arch=b32 -F path=/usr/bin/lsusb -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/lsusb -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/lsusb -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/lsusb -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/lsusb -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/lsusb -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lsusb -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lsusb -F perm=x -F key=T1082_System_Information_Discovery

### lspci
-a always,exit -F arch=b32 -F path=/usr/bin/lspci -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/lspci -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/lspci -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/lspci -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/bin/lspci -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/bin/lspci -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lspci -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lspci -F perm=x -F key=T1082_System_Information_Discovery

### fdisk
-a always,exit -F arch=b32 -F path=/usr/bin/fdisk -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/fdisk -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/fdisk -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/fdisk -F perm=x -F key=T1082_System_Information_Discovery

### lsb_release
-a always,exit -F arch=b32 -F path=/usr/bin/lsb_release -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/bin/lsb_release -F perm=x -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/usr/sbin/lsb_release -F perm=x -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/usr/sbin/lsb_release -F perm=x -F key=T1082_System_Information_Discovery

### os-release
-a always,exit -F arch=b32 -F path=/etc/os-release -F perm=r -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/etc/os-release -F perm=r -F key=T1082_System_Information_Discovery

-a always,exit -F arch=b32 -F path=/etc/hostname -S open -S openat -F "auid>=500" -F "auid!=-1" -F key=T1082_System_Information_Discovery
-a always,exit -F arch=b64 -F path=/etc/hostname -S open -S openat -F "auid>=500" -F "auid!=-1" -F key=T1082_System_Information_Discovery

## T1040 Network Sniffing
### bettercap
-a always,exit -F arch=b32 -F path=/usr/bin/bettercap -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/bettercap -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/bettercap -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/bettercap -F perm=x -F key=T1040_Network_Sniffing

### dsniff
-a always,exit -F arch=b32 -F path=/usr/bin/dsniff -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/dsniff -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/dsniff -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/dsniff -F perm=x -F key=T1040_Network_Sniffing

### eigrp-tools
-a always,exit -F arch=b32 -F path=/usr/bin/eigrp-tools -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/eigrp-tools -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/eigrp-tools -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/eigrp-tools -F perm=x -F key=T1040_Network_Sniffing

### ettercap
-a always,exit -F arch=b32 -F path=/usr/bin/ettercap -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/ettercap -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/ettercap -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/ettercap -F perm=x -F key=T1040_Network_Sniffing

### httpsniff
-a always,exit -F arch=b32 -F path=/usr/bin/httpsniff -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/httpsniff -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/httpsniff -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/httpsniff -F perm=x -F key=T1040_Network_Sniffing

### netsniff-ng
-a always,exit -F arch=b32 -F path=/usr/bin/netsniff-ng -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/netsniff-ng -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/netsniff-ng -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/netsniff-ng -F perm=x -F key=T1040_Network_Sniffing

### sslsniff
-a always,exit -F arch=b32 -F path=/usr/bin/sslsniff -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/sslsniff -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/sslsniff -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/sslsniff -F perm=x -F key=T1040_Network_Sniffing

### ssldump
-a always,exit -F arch=b32 -F path=/usr/bin/ssldump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/ssldump -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/ssldump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/ssldump -F perm=x -F key=T1040_Network_Sniffing

### tcpick
-a always,exit -F arch=b32 -F path=/usr/bin/tcpick -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/tcpick -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/tcpick -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/tcpick -F perm=x -F key=T1040_Network_Sniffing

### wireshark
-a always,exit -F arch=b32 -F path=/usr/bin/wireshark-cli -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/wireshark-cli -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/wireshark-cli -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/wireshark-cli -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/bin/wireshark-qt -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/wireshark-qt -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/wireshark-qt -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/wireshark-qt -F perm=x -F key=T1040_Network_Sniffing

#### macOS
-a always,exit -F arch=b32 -F path=/usr/local/Cellar/wireshark/ -F perm=wa -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/local/Cellar/wireshark/ -F perm=wa -F key=T1040_Network_Sniffing

### udpdump
-a always,exit -F arch=b32 -F path=/usr/bin/udpdump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/udpdump -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/udpdump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/udpdump -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/local/bin/udpdump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/local/bin/udpdump -F perm=x -F key=T1040_Network_Sniffing

### sshdump
-a always,exit -F arch=b32 -F path=/usr/bin/sshdump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/sshdump -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/sshdump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/sshdump -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/local/bin/sshdump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/local/bin/sshdump -F perm=x -F key=T1040_Network_Sniffing

### randpktdump
-a always,exit -F arch=b32 -F path=/usr/bin/randpktdump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/randpktdump -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/randpktdump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/randpktdump -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/local/bin/randpktdump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/local/bin/randpktdump -F perm=x -F key=T1040_Network_Sniffing

### ciscodump
-a always,exit -F arch=b32 -F path=/usr/bin/ciscodump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/ciscodump -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/ciscodump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/ciscodump -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/local/bin/ciscodump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/local/bin/ciscodump -F perm=x -F key=T1040_Network_Sniffing

### androiddump
-a always,exit -F arch=b32 -F path=/usr/bin/androiddump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/androiddump -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/androiddump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/androiddump -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/local/bin/androiddump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/local/bin/androiddump -F perm=x -F key=T1040_Network_Sniffing

### wifi-monitor
-a always,exit -F arch=b32 -F path=/usr/bin/wifi-monitor -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/wifi-monitor -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/wifi-monitor -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/wifi-monitor -F perm=x -F key=T1040_Network_Sniffing

### tcpdump
-a always,exit -F arch=b32 -F path=/usr/bin/tcpdump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/bin/tcpdump -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/sbin/tcpdump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/sbin/tcpdump -F perm=x -F key=T1040_Network_Sniffing

#### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/tcpdump -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/local/bin/tcpdump -F perm=x -F key=T1040_Network_Sniffing

## T1005_Data_From_Local_System
### cp
-a always,exit -F arch=b32 -F path=/bin/cp -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/bin/cp -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/sbin/cp -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/sbin/cp -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/usr/bin/cp -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/bin/cp -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/usr/sbin/cp -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/sbin/cp -F perm=x -F key=T1005_Data_From_Local_System

#### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/cp -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/local/bin/cp -F perm=x -F key=T1040_Network_Sniffing

-a always,exit -F arch=b32 -F path=/usr/local/sbin/cp -F perm=x -F key=T1040_Network_Sniffing
-a always,exit -F arch=b64 -F path=/usr/local/sbin/cp -F perm=x -F key=T1040_Network_Sniffing

### dd
-a always,exit -F arch=b32 -F path=/usr/bin/dd -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/bin/dd -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/usr/sbin/dd -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/sbin/dd -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/usr/local/bin/dd -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/local/bin/dd -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/usr/local/sbin/dd -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/local/sbin/dd -F perm=x -F key=T1005_Data_From_Local_System

### mv
-a always,exit -F arch=b32 -F path=/bin/mv -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/bin/mv -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/bin/mv -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/bin/mv -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/usr/bin/mv -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/bin/mv -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/usr/sbin/mv -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/sbin/mv -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/usr/local/bin/mv -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/local/bin/mv -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/usr/local/sbin/mv -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/local/sbin/mv -F perm=x -F key=T1005_Data_From_Local_System

### touch
-a always,exit -F arch=b32 -F path=/bin/touch -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/bin/touch -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/bin/touch -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/bin/touch -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/usr/bin/touch -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/bin/touch -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/usr/sbin/touch -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/sbin/touch -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/usr/local/bin/touch -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/local/bin/touch -F perm=x -F key=T1005_Data_From_Local_System

-a always,exit -F arch=b32 -F path=/usr/local/sbin/touch -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/local/sbin/touch -F perm=x -F key=T1005_Data_From_Local_System

## T1105_Remote_File_Copy

### ftp
-a always,exit -F arch=b32 -F path=/usr/bin/ftp -F perm=x -F key=T1105_Remote_File_Copy
-a always,exit -F arch=b64 -F path=/usr/bin/ftp -F perm=x -F key=T1105_Remote_File_Copy

-a always,exit -F arch=b32 -F path=/usr/sbin/ftp -F perm=x -F key=T1105_Remote_File_Copy
-a always,exit -F arch=b64 -F path=/usr/sbin/ftp -F perm=x -F key=T1105_Remote_File_Copy

#### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/ftp -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/local/bin/ftp -F perm=x -F key=T1005_Data_From_Local_System

### sftp
-a always,exit -F arch=b32 -F path=/usr/bin/sftp -F perm=x -F key=T1105_Remote_File_Copy
-a always,exit -F arch=b64 -F path=/usr/bin/sftp -F perm=x -F key=T1105_Remote_File_Copy

-a always,exit -F arch=b32 -F path=/usr/sbin/sftp -F perm=x -F key=T1105_Remote_File_Copy
-a always,exit -F arch=b64 -F path=/usr/sbin/sftp -F perm=x -F key=T1105_Remote_File_Copy

#### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/sftp -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/local/bin/sftp -F perm=x -F key=T1005_Data_From_Local_System

### scp
-a always,exit -F arch=b32 -F path=/usr/bin/scp -F perm=x -F key=T1105_Remote_File_Copy
-a always,exit -F arch=b64 -F path=/usr/bin/scp -F perm=x -F key=T1105_Remote_File_Copy

-a always,exit -F arch=b32 -F path=/usr/sbin/scp -F perm=x -F key=T1105_Remote_File_Copy
-a always,exit -F arch=b64 -F path=/usr/sbin/scp -F perm=x -F key=T1105_Remote_File_Copy

#### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/scp -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/local/bin/scp -F perm=x -F key=T1005_Data_From_Local_System

### rsync
-a always,exit -F arch=b32 -F path=/usr/bin/rsync -F perm=x -F key=T1105_Remote_File_Copy
-a always,exit -F arch=b64 -F path=/usr/bin/rsync -F perm=x -F key=T1105_Remote_File_Copy

-a always,exit -F arch=b32 -F path=/usr/sbin/rsync -F perm=x -F key=T1105_Remote_File_Copy
-a always,exit -F arch=b64 -F path=/usr/sbin/rsync -F perm=x -F key=T1105_Remote_File_Copy

#### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/rsync -F perm=x -F key=T1005_Data_From_Local_System
-a always,exit -F arch=b64 -F path=/usr/local/bin/rsync -F perm=x -F key=T1005_Data_From_Local_System

## T1133_External_Remote_Services
-a always,exit -F arch=b32 -F path=/usr/sbin/sshd -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/sshd -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ftpd -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ftpd -F perm=x -F key=T1133_External_Remote_Services

### vsftpd
-a always,exit -F arch=b32 -F path=/etc/vsftpd.conf -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/etc/vsftpd.conf -F perm=wa -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/etc/vsftpd.ftpusers -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/etc/vsftpd.ftpusers -F perm=wa -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/vsftpd -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/vsftpd -F perm=x -F key=T1133_External_Remote_Services

## T1059_Command_and_Scripting_Interpreter
### echo
-a always,exit -F arch=b32 -F path=/bin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/bin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/sbin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/sbin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/usr/bin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/usr/bin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/usr/sbin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/usr/sbin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/usr/local/bin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/usr/local/bin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/usr/local/sbin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/usr/local/sbin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/snap/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/snap/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/snap/bin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/snap/bin/echo -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

### printf
-a always,exit -F arch=b32 -F path=/bin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/bin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/sbin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/sbin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/usr/bin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/usr/bin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/usr/sbin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/usr/sbin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/usr/local/bin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/usr/local/bin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/usr/local/sbin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/usr/local/sbin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/snap/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/snap/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

-a always,exit -F arch=b32 -F path=/snap/bin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F path=/snap/bin/printf -F perm=x -F key=T1059_Command_and_Scripting_Interpreter

## T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### agetty
-a always,exit -F arch=b32 -F path=/bin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/agetty -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

## chmod
-a always,exit -F arch=b32 -F path=/bin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/chmod -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

## chown
-a always,exit -F arch=b32 -F path=/bin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/chown -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

## chroot
-a always,exit -F arch=b32 -F path=/bin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/chroot -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

## make
-a always,exit -F arch=b32 -F path=/bin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/make -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

## gcc
-a always,exit -F arch=b32 -F path=/bin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/gcc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

## as
-a always,exit -F arch=b32 -F path=/bin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/as -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

## nasm
-a always,exit -F arch=b32 -F path=/bin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/nasm -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

## bc
-a always,exit -F arch=b32 -F path=/bin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/bin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/sbin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/sbin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/bin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/bin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/sbin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/sbin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/bin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/bin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/usr/local/sbin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/usr/local/sbin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

-a always,exit -F arch=b32 -F path=/snap/bin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell
-a always,exit -F arch=b64 -F path=/snap/bin/bc -F perm=x -F key=T1059.004_Command_and_Scripting_Interpreter_Unix_Shell

### proftpd
#### T1133_External_Remote_Services
-a always,exit -F arch=b32 -F path=/etc/proftpd.conf -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/etc/proftpd.conf -F perm=wa -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/local/etc/proftpd.conf -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/local/etc/proftpd.conf -F perm=wa -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F dir=/etc/proftpd/ -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F dir=/etc/proftpd/ -F perm=wa -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F dir=/usr/local/etc/proftpd/ -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F dir=/usr/local/etc/proftpd/ -F perm=wa -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/proftpd -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/proftpd -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/proftpd -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/proftpd -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/ftpcount -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/ftpcount -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ftpcount -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ftpcount -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/ftpdctl -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/ftpdctl -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ftpdctl -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ftpdctl -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/ftptop -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/ftptop -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ftptop -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ftptop -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/ftpwho -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/ftpwho -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ftpwho -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ftpwho -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/auth-otp -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/auth-otp -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/auth-otp -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/auth-otp -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/ftpasswd -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/ftpasswd -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ftpasswd -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ftpasswd -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/ftpmail -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/ftpmail -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ftpmail -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ftpmail -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/proftpd-gencert -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/proftpd-gencert -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/proftpd-gencert -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/proftpd-gencert -F perm=x -F key=T1133_External_Remote_Services

# Monitoring GNU Parallel Command Execution

# Monitor direct execution of parallel command from common locations
-a always,exit -F arch=b32 -F path=/bin/parallel -F perm=x -F key=parallel_execution
-a always,exit -F arch=b64 -F path=/bin/parallel -F perm=x -F key=parallel_execution

-a always,exit -F arch=b32 -F path=/sbin/parallel -F perm=x -F key=parallel_execution
-a always,exit -F arch=b64 -F path=/xbin/parallel -F perm=x -F key=parallel_execution

-a always,exit -F arch=b32 -F path=/usr/bin/parallel -F perm=x -F key=parallel_execution
-a always,exit -F arch=b64 -F path=/usr/bin/parallel -F perm=x -F key=parallel_execution

-a always,exit -F arch=b32 -F path=/usr/sbin/parallel -F perm=x -F key=parallel_execution
-a always,exit -F arch=b64 -F path=/usr/sbin/parallel -F perm=x -F key=parallel_execution

-a always,exit -F arch=b32 -F path=/usr/local/bin/parallel -F perm=x -F key=parallel_execution
-a always,exit -F arch=b64 -F path=/usr/local/bin/parallel -F perm=x -F key=parallel_execution

-a always,exit -F arch=b32 -F path=/usr/local/sbin/parallel -F perm=x -F key=parallel_execution
-a always,exit -F arch=b64 -F path=/usr/local/sbin/parallel -F perm=x -F key=parallel_execution

## Monitor execution via execve system call for 'parallel' command
-a always,exit -F arch=b32 -F exe=/bin/parallel -S execve -F key=parallel_exec_syscall
-a always,exit -F arch=b64 -F exe=/bin/parallel -S execve -F key=parallel_exec_syscall

-a always,exit -F arch=b32 -F exe=/sbin/parallel -S execve -F key=parallel_exec_syscall
-a always,exit -F arch=b64 -F exe=/sbin/parallel -S execve -F key=parallel_exec_syscall

-a always,exit -F arch=b32 -F exe=/usr/bin/parallel -S execveat -F key=parallel_execat_syscall
-a always,exit -F arch=b64 -F exe=/usr/bin/parallel -S execveat -F key=parallel_execat_syscall

-a always,exit -F arch=b32 -F exe=/usr/sbin/parallel -S execveat -F key=parallel_execat_syscall
-a always,exit -F arch=b64 -F exe=/usr/sbin/parallel -S execveat -F key=parallel_execat_syscall

-a always,exit -F arch=b32 -F exe=/usr/local/bin/parallel -S execve -F key=parallel_exec_syscall
-a always,exit -F arch=b64 -F exe=/usr/local/bin/parallel -S execve -F key=parallel_exec_syscall

-a always,exit -F arch=b32 -F exe=/usr/local/sbin/parallel -S execve -F key=parallel_exec_syscall
-a always,exit -F arch=b64 -F exe=/usr/local/sbin/parallel -S execve -F key=parallel_exec_syscall

## Track which users are running parallel command
-a always,exit -F arch=b32 -F path=/bin/parallel -F perm=x -F "auid>=500" -F "auid!=-1" -F key=parallel_user_exec
-a always,exit -F arch=b64 -F path=/bin/parallel -F perm=x -F "auid>=500" -F "auid!=-1" -F key=parallel_user_exec

-a always,exit -F arch=b32 -F path=/sbin/parallel -F perm=x -F "auid>=500" -F "auid!=-1" -F key=parallel_user_exec
-a always,exit -F arch=b64 -F path=/sbin/parallel -F perm=x -F "auid>=500" -F "auid!=-1" -F key=parallel_user_exec

-a always,exit -F arch=b32 -F path=/usr/bin/parallel -F perm=x -F "auid>=500" -F "auid!=-1" -F key=parallel_user_exec
-a always,exit -F arch=b64 -F path=/usr/bin/parallel -F perm=x -F "auid>=500" -F "auid!=-1" -F key=parallel_user_exec

-a always,exit -F arch=b32 -F path=/usr/sbin/parallel -F perm=x -F "auid>=500" -F "auid!=-1" -F key=parallel_user_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/parallel -F perm=x -F "auid>=500" -F "auid!=-1" -F key=parallel_user_exec

-a always,exit -F arch=b32 -F path=/usr/local/bin/parallel -F perm=x -F "auid>=500" -F "auid!=-1" -F key=parallel_user_exec
-a always,exit -F arch=b64 -F path=/usr/local/bin/parallel -F perm=x -F "auid>=500" -F "auid!=-1" -F key=parallel_user_exec

-a always,exit -F arch=b32 -F path=/usr/local/sbin/parallel -F perm=x -F "auid>=500" -F "auid!=-1" -F key=parallel_user_exec
-a always,exit -F arch=b64 -F path=/usr/local/sbin/parallel -F perm=x -F "auid>=500" -F "auid!=-1" -F key=parallel_user_exec

## Track root/sudo execution of parallel
-a always,exit -F arch=b32 -F path=/bin/parallel -F perm=x -F euid=0 -F key=parallel_root_exec
-a always,exit -F arch=b64 -F path=/bin/parallel -F perm=x -F euid=0 -F key=parallel_root_exec

-a always,exit -F arch=b32 -F path=/sbin/parallel -F perm=x -F euid=0 -F key=parallel_root_exec
-a always,exit -F arch=b64 -F path=/sbin/parallel -F perm=x -F euid=0 -F key=parallel_root_exec

-a always,exit -F arch=b32 -F path=/usr/bin/parallel -F perm=x -F euid=0 -F key=parallel_root_exec
-a always,exit -F arch=b64 -F path=/usr/bin/parallel -F perm=x -F euid=0 -F key=parallel_root_exec

-a always,exit -F arch=b32 -F path=/usr/sbin/parallel -F perm=x -F euid=0 -F key=parallel_root_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/parallel -F perm=x -F euid=0 -F key=parallel_root_exec

-a always,exit -F arch=b32 -F path=/usr/local/bin/parallel -F perm=x -F euid=0 -F key=parallel_root_exec
-a always,exit -F arch=b64 -F path=/usr/local/bin/parallel -F perm=x -F euid=0 -F key=parallel_root_exec

-a always,exit -F arch=b32 -F path=/usr/local/sbin/parallel -F perm=x -F euid=0 -F key=parallel_root_exec
-a always,exit -F arch=b64 -F path=/usr/local/sbin/parallel -F perm=x -F euid=0 -F key=parallel_root_exec

## Monitor when parallel is run with elevated privileges
-a always,exit -F arch=b32 -F path=/bin/parallel -F perm=x -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=parallel_sudo_exec
-a always,exit -F arch=b64 -F path=/bin/parallel -F perm=x -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=parallel_sudo_exec

-a always,exit -F arch=b32 -F path=/sbin/parallel -F perm=x -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=parallel_sudo_exec
-a always,exit -F arch=b64 -F path=/sbin/parallel -F perm=x -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=parallel_sudo_exec

-a always,exit -F arch=b32 -F path=/usr/bin/parallel -F perm=x -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=parallel_sudo_exec
-a always,exit -F arch=b64 -F path=/usr/bin/parallel -F perm=x -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=parallel_sudo_exec

-a always,exit -F arch=b32 -F path=/usr/sbin/parallel -F perm=x -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=parallel_sudo_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/parallel -F perm=x -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=parallel_sudo_exec

-a always,exit -F arch=b32 -F path=/usr/local/bin/parallel -F perm=x -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=parallel_sudo_exec
-a always,exit -F arch=b64 -F path=/usr/local/bin/parallel -F perm=x -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=parallel_sudo_exec

-a always,exit -F arch=b32 -F path=/usr/local/bin/parallel -F perm=x -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=parallel_sudo_exec
-a always,exit -F arch=b64 -F path=/usr/local/bin/parallel -F perm=x -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=parallel_sudo_exec

## Monitor parallel configuration directory
-a always,exit -F arch=b32 -F dir=/etc/parallel/ -F perm=wa -F key=parallel_config_change
-a always,exit -F arch=b64 -F dir=/etc/parallel/ -F perm=wa -F key=parallel_config_change

## Monitor parallel rc files
-a always,exit -F arch=b32 -F path=/etc/parallel/config -F perm=wa -F key=parallel_system_config
-a always,exit -F arch=b64 -F path=/etc/parallel/config -F perm=wa -F key=parallel_system_config

# Monitor GNU Parallel invocations with execve on all standard locations
-a always,exit -F arch=b32 -F exe=/bin/parallel -S execve  -F key=parallel_exec
-a always,exit -F arch=b64 -F exe=/bin/parallel -S execve  -F key=parallel_exec

-a always,exit -F arch=b32 -F exe=/usr/bin/parallel -S execve  -F key=parallel_exec
-a always,exit -F arch=b64 -F exe=/usr/bin/parallel -S execve  -F key=parallel_exec

-a always,exit -F arch=b32 -F exe=/usr/local/bin/parallel -S execve  -F key=parallel_exec
-a always,exit -F arch=b64 -F exe=/usr/local/bin/parallel -S execve  -F key=parallel_exec

# Track bash or sh calling parallel (argument filtering requires special kernel support)
-a always,exit -F arch=b32 -F exe=/bin/bash -S execve  -F key=parallel_via_shell
-a always,exit -F arch=b64 -F exe=/bin/bash -S execve  -F key=parallel_via_shell

-a always,exit -F arch=b32 -F exe=/bin/sh -S execve  -F key=parallel_via_shell
-a always,exit -F arch=b64 -F exe=/bin/sh -S execve  -F key=parallel_via_shell

# If your system supports Arg Filtering (kernel >= 4.1), you may further refine:
# Example (for auditctl only, NOT supported on all distributions, check your kernel/auditd):
# -a always,exit -F arch=b64 -F exe=/usr/bin/parallel -C argv1=--ssh -S execve  -F key=parallel_ssh_exec

# Alternate: filter for remote execution (-S flag)
# -a always,exit -F arch=b64 -F exe=/usr/bin/parallel -C argv1=-S -S execve  -F key=parallel_remote_exec

## Monitor when parallel spawns child processes (it typically spawns many)
-a always,exit -F arch=b32 -F ppid_exe=/usr/bin/parallel -S clone -S fork -S vfork -F key=parallel_spawn_process
-a always,exit -F arch=b64 -F ppid_exe=/usr/bin/parallel -S clone -S fork -S vfork -F key=parallel_spawn_process

## Monitor parallel's pipe operations (it uses pipes for job distribution)
-a always,exit -F arch=b32 -F exe=/usr/bin/parallel -S pipe -S pipe2 -F key=parallel_pipe_ops
-a always,exit -F arch=b64 -F exe=/usr/bin/parallel -S pipe -S pipe2 -F key=parallel_pipe_ops

## Parallel often creates temp files in /tmp
-a always,exit -F arch=b32 -F dir=/tmp/ -F exe=/usr/bin/parallel -F perm=wac -F key=parallel_tmp_files
-a always,exit -F arch=b64 -F dir=/tmp/ -F exe=/usr/bin/parallel -F perm=wac -F key=parallel_tmp_files

-a always,exit -F arch=b32 -F dir=/var/tmp/ -F exe=/usr/bin/parallel -F perm=wac -F key=parallel_vartmp_files
-a always,exit -F arch=b64 -F dir=/var/tmp/ -F exe=/usr/bin/parallel -F perm=wac -F key=parallel_vartmp_files

### atftpd
#### https://sourceforge.net/projects/atftp/
#### https://github.com/madmartin/atftp
#### atftp is a client/server implementation of the TFTP protocol that implements RFCs 1350, 2090, 2347, 2348, 2349 and 7440.
#### The server is multi-threaded and the client presents a friendly interface using libreadline.
#### T1133_External_Remote_Services
-a always,exit -F arch=b32 -F path=/usr/bin/atftpd -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/atftpd -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/atftpd -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/atftpd -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/in.tftpd -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/in.tftpd -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/in.tftpd -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/in.tftpd -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/lib/systemd/system/atftpd.service -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/lib/systemd/system/atftpd.service -F perm=wa -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/atftpd.service -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/atftpd.service -F perm=wa -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/lib/systemd/system/atftpd.socket -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/lib/systemd/system/atftpd.socket -F perm=wa -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/atftpd.socket -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/atftpd.socket -F perm=wa -F key=T1133_External_Remote_Services

### uftp
#### #### T1133_External_Remote_Services
#### https://sourceforge.net/projects/uftp-multicast/
#### UFTP is an encrypted multicast file transfer program, designed to securely, reliably,
#### and efficiently transfer files to multiple receivers simultaneously.
#### FTP also has the capability to communicate over disjoint networks separated by one or
#### more firewalls (NAT traversal) and without full end-to-end multicast capability
#### (multicast tunneling) through the use of a UFTP proxy server.
-a always,exit -F arch=b32 -F path=/usr/bin/uftp -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/uftp -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/uftp -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/uftp -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/local/bin/uftp -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/local/bin/uftp -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/local/sbin/uftp -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/local/sbin/uftp -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/lib/systemd/system/uftp.service -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/lib/systemd/system/uftp.service -F perm=wa -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/uftp.service -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/uftp.service -F perm=wa -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/lib/systemd/system/uftp.socket -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/lib/systemd/system/uftp.socket -F perm=wa -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/uftp.socket -F perm=wa -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/uftp.socket -F perm=wa -F key=T1133_External_Remote_Services

### ncftp
#### T1133_External_Remote_Services
#### https://www.ncftp.com
-a always,exit -F arch=b32 -F path=/usr/bin/ncftp3 -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/ncftp3 -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ncftp3 -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ncftp3 -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/ncftpbatch -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/ncftpbatch -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ncftpbatch -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ncftpbatch -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/ncftpbookmarks -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/ncftpbookmarks -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ncftpbookmarks -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ncftpbookmarks -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/ncftpget -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/ncftpget -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ncftpget -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ncftpget -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/ncftpls -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/ncftpls -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ncftpls -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ncftpls -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/ncftpput -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/ncftpput -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ncftpput -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ncftpput -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/bin/ncftpspooler -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/bin/ncftpspooler -F perm=x -F key=T1133_External_Remote_Services

-a always,exit -F arch=b32 -F path=/usr/sbin/ncftpspooler -F perm=x -F key=T1133_External_Remote_Services
-a always,exit -F arch=b64 -F path=/usr/sbin/ncftpspooler -F perm=x -F key=T1133_External_Remote_Services

## T1219_Remote_Access_Tools
## nc
## duplicates for historical reasons
#-a always,exit -F arch=b32 -F path=/bin/nc -F perm=x -F key=T1219_Remote_Access_Tools
#-a always,exit -F arch=b64 -F path=/bin/nc -F perm=x -F key=T1219_Remote_Access_Tools

#-a always,exit -F arch=b32 -F path=/sbin/nc -F perm=x -F key=T1219_Remote_Access_Tools
#-a always,exit -F arch=b64 -F path=/sbin/nc -F perm=x -F key=T1219_Remote_Access_Tools

## ssh
-a always,exit -F arch=b32 -F path=/bin/ssh -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/ssh -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/bin/ssh -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/ssh -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/ssh -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ssh -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/ssh -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/ssh -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/ssh -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/ssh -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ssh -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ssh -F perm=x -F key=T1219_Remote_Access_Tools

## ssh-keyscan
-a always,exit -F arch=b32 -F path=/bin/ssh-keyscan -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/ssh-keyscan -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/sbin/ssh-keyscan -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/sbin/ssh-keyscan -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/ssh-keyscan -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/ssh-keyscan -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/ssh-keyscan -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/ssh-keyscan -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/ssh-keyscan -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/ssh-keyscan -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ssh-keyscan -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ssh-keyscan -F perm=x -F key=T1219_Remote_Access_Tools

## cluster ssh
-a always,exit -F arch=b32 -F path=/bin/cssh -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/cssh -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/bin/cssh -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/bin/cssh -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/cssh -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/cssh -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/cssh -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/cssh -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/cssh -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/cssh -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/cssh -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/cssh -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/etc/clusters -F perm=wa -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/etc/clusters -F perm=wa -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/etc/csshrc -F perm=wa -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/etc/csshrc -F perm=wa -F key=T1219_Remote_Access_Tools

### socat
-a always,exit -F arch=b32 -F path=/usr/bin/socat -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/socat -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/socat -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/socat -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/socat -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/socat -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/socat -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/socat -F perm=x -F key=T1219_Remote_Access_Tools

## rdesktop
-a always,exit -F arch=b32 -F path=/usr/bin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rdesktop -F perm=x -F key=T1219_Remote_Access_Tools

## xfreerdp
-a always,exit -F arch=b32 -F path=/usr/bin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xfreerdp -F perm=x -F key=T1219_Remote_Access_Tools

## teamviewer
-a always,exit -F arch=b32 -F path=/usr/bin/teamviewer -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/teamviewer -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/teamviewer -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/teamviewer -F perm=x -F key=T1219_Remote_Access_Tools

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/teamviewer -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/teamviewer -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/teamviewer -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/teamviewer -F perm=x -F key=T1219_Remote_Access_Tools

## LogMein
-a always,exit -F arch=b32 -F path=/usr/bin/LogMein -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/LogMein -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/LogMein -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/LogMein -F perm=x -F key=T1219_Remote_Access_Tools

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/LogMein -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/LogMein -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/LogMein -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/LogMein -F perm=x -F key=T1219_Remote_Access_Tools

## vnc
-a always,exit -F arch=b32 -F dir=/etc/vnc/policy.d/ -F perm=wa -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F dir=/etc/vnc/policy.d/ -F perm=wa -F key=T1219_Remote_Access_Tools

## vncviewer
-a always,exit -F arch=b32 -F path=/usr/bin/vncviewer -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/vncviewer -F perm=x -F key=T1219_Remote_Access_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/vncviewer -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/vncviewer -F perm=x -F key=T1219_Remote_Access_Tools

### macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/vncviewer -F perm=x -F key=T1219_Remote_Access_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/vncviewer -F perm=x -F key=T1219_Remote_Access_Tools


## T1560_Archive_Collected_Data
### https://infozip.sourceforge.net/Zip.html
## zip
-a always,exit -F arch=b32 -F path=/bin/zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zip -F perm=x -F key=T1560_Archive_Collected_Data

## zipcloak
-a always,exit -F arch=b32 -F path=/bin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zipcloak -F perm=x -F key=T1560_Archive_Collected_Data

## zipnote
-a always,exit -F arch=b32 -F path=/bin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zipnote -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zipnote -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zipnote -F perm=x -F key=T1560_Archive_Collected_Data

## zipsplit
-a always,exit -F arch=b32 -F path=/bin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zipsplit -F perm=x -F key=T1560_Archive_Collected_Data

## unzip
-a always,exit -F arch=b32 -F path=/bin/unzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/unzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/unzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/unzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/unzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/unzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/unzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/unzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/unzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/unzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/unzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/unzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/unzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/unzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/unzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/unzip -F perm=x -F key=T1560_Archive_Collected_Data

## https://www.gnu.org/software/gzip/
### gzip
-a always,exit -F arch=b32 -F path=/bin/gzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/gzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/gzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/gzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/gzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/gzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/gzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/gzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/gzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/gzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/gzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/gzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/gzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/gzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/gzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/gzip -F perm=x -F key=T1560_Archive_Collected_Data

### gunzip
-a always,exit -F arch=b32 -F path=/bin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/gunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/gunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/gunzip -F perm=x -F key=T1560_Archive_Collected_Data

### gzexe
-a always,exit -F arch=b32 -F path=/bin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/gzexe -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/gzexe -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/gzexe -F perm=x -F key=T1560_Archive_Collected_Data

### uncompress
-a always,exit -F arch=b32 -F path=/bin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/uncompress -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/uncompress -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/uncompress -F perm=x -F key=T1560_Archive_Collected_Data

### zcat
-a always,exit -F arch=b32 -F path=/bin/zcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zcat -F perm=x -F key=T1560_Archive_Collected_Data

### zcmp
-a always,exit -F arch=b32 -F path=/bin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zcmp -F perm=x -F key=T1560_Archive_Collected_Data

### zdiff
-a always,exit -F arch=b32 -F path=/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

### zegrep
-a always,exit -F arch=b32 -F path=/bin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zegrep -F perm=x -F key=T1560_Archive_Collected_Data

### zfgrep
-a always,exit -F arch=b32 -F path=/bin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zfgrep -F perm=x -F key=T1560_Archive_Collected_Data

### zforce
-a always,exit -F arch=b32 -F path=/bin/zforce -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zforce -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zforce -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zforce -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zforce -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zforce -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zforce -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zforce -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zforce -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zforce -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zforce -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zforce -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zforce -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zforce -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zforce -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zforce -F perm=x -F key=T1560_Archive_Collected_Data

### zgrep
-a always,exit -F arch=b32 -F path=/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

### zless
-a always,exit -F arch=b32 -F path=/bin/zless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zless -F perm=x -F key=T1560_Archive_Collected_Data

### zmore
-a always,exit -F arch=b32 -F path=/bin/zmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zmore -F perm=x -F key=T1560_Archive_Collected_Data

### znew
-a always,exit -F arch=b32 -F path=/bin/znew -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/znew -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/znew -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/znew -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/znew -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/znew -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/znew -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/znew -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/znew -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/znew -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/znew -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/znew -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/znew -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/znew -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/znew -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/znew -F perm=x -F key=T1560_Archive_Collected_Data

## https://www.gnu.org/software/tar/
### tar
-a always,exit -F arch=b32 -F path=/bin/tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/tar -F perm=x -F key=T1560_Archive_Collected_Data

### rmt-tar
-a always,exit -F arch=b32 -F path=/bin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/rmt-tar -F perm=x -F key=T1560_Archive_Collected_Data

## tarcat
-a always,exit -F arch=b32 -F path=/bin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/tarcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/tarcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/tarcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/etc/rmt -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/etc/rmt -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/lib/mime/packages/tar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/lib/mime/packages/tar -F perm=x -F key=T1560_Archive_Collected_Data

## https://sourceware.org/bzip2/
### bzip2
-a always,exit -F arch=b32 -F path=/bin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/bzip2 -F perm=x -F key=T1560_Archive_Collected_Data

### bunzip2
-a always,exit -F arch=b32 -F path=/bin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/bunzip2 -F perm=x -F key=T1560_Archive_Collected_Data

### bzcat
-a always,exit -F arch=b32 -F path=/bin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/bzcat -F perm=x -F key=T1560_Archive_Collected_Data

### bzip2recover
-a always,exit -F arch=b32 -F path=/bin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/bzip2recover -F perm=x -F key=T1560_Archive_Collected_Data

## https://p7zip.sourceforge.net/
### p7zip
-a always,exit -F arch=b32 -F path=/bin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/p7zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/p7zip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/p7zip -F perm=x -F key=T1560_Archive_Collected_Data

### 7zr
-a always,exit -F arch=b32 -F path=/bin/7zr -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/7zr -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/7zr -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/7zr -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/7zr -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/7zr -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/7zr -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/7zr -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/7zr -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/7zr -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/7zr -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/7zr -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/7zr -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/7zr -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/7zr -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/7zr -F perm=x -F key=T1560_Archive_Collected_Data

## https://www.rkeene.org/oss/dact
## dact
-a always,exit -F arch=b32 -F path=/bin/dact -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/dact -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/dact -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/dact -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/dact -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/dact -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/dact -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/dact -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/dact -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/dact -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/dact -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/dact -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/dact -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/dact -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/dact -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/dact -F perm=x -F key=T1560_Archive_Collected_Data

## https://upx.github.io/
## upx-ucl
-a always,exit -F arch=b32 -F path=/bin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/upx-ucl -F perm=x -F key=T1560_Archive_Collected_Data

## https://github.com/ib/xarchiver
## xarchiver
-a always,exit -F arch=b32 -F path=/bin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/xarchiver -F perm=x -F key=T1560_Archive_Collected_Data

## https://www.gnu.org/software/cpio/
### cpio
-a always,exit -F arch=b32 -F path=/bin/cpio -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/cpio -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/cpio -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/cpio -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/cpio -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/cpio -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/cpio -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/cpio -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/cpio -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/cpio -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/cpio -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/cpio -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/cpio -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/cpio -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/cpio -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/cpio -F perm=x -F key=T1560_Archive_Collected_Data

### mt-gnu
-a always,exit -F arch=b32 -F path=/bin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/mt-gnu -F perm=x -F key=T1560_Archive_Collected_Data

### 7z
-a always,exit -F arch=b32 -F path=/bin/7z -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/7z -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/7z -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/7z -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/7z -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/7z -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/7z -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/7z -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/7z -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/7z -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/7z -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/7z -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/7z -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/7z -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/7z -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/7z -F perm=x -F key=T1560_Archive_Collected_Data

### 7za
-a always,exit -F arch=b32 -F path=/bin/7za -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/7za -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/7za -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/7za -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/7za -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/7za -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/7za -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/7za -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/7za -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/7za -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/7za -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/7za -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/7za -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/7za -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/7za -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/7za -F perm=x -F key=T1560_Archive_Collected_Data

### 7zz
-a always,exit -F arch=b32 -F path=/bin/7zz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/7zz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/7zz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/7zz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/7zz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/7zz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/7zz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/7zz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/7zz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/7zz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/7zz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/7zz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/7zz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/7zz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/7zz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/7zz -F perm=x -F key=T1560_Archive_Collected_Data

### lha
-a always,exit -F arch=b32 -F path=/bin/lha -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/lha -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/lha -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/lha -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/lha -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/lha -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/lha -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/lha -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/lha -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/lha -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lha -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lha -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/lha -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/lha -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/lha -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/lha -F perm=x -F key=T1560_Archive_Collected_Data

### zpaq
-a always,exit -F arch=b32 -F path=/bin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zpaq -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zpaq -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zpaq -F perm=x -F key=T1560_Archive_Collected_Data

### zoo
-a always,exit -F arch=b32 -F path=/bin/zoo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zoo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zoo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zoo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zoo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zoo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zoo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zoo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zoo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zoo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zoo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zoo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zoo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zoo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zoo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zoo -F perm=x -F key=T1560_Archive_Collected_Data

### squashfs
-a always,exit -F arch=b32 -F path=/bin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/squashfs -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/squashfs -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/squashfs -F perm=x -F key=T1560_Archive_Collected_Data

### https://www.nongnu.org/lzip/lzip.html
-a always,exit -F arch=b32 -F path=/bin/lzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/lzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/lzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/lzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/lzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/lzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/lzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/lzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/lzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/lzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/lzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/lzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/lzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/lzip -F perm=x -F key=T1560_Archive_Collected_Data

### https://github.com/ckolivas/lrzip
#### lrzip
-a always,exit -F arch=b32 -F path=/bin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/lrzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/lrzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/lrzip -F perm=x -F key=T1560_Archive_Collected_Data

#### lrunzip
-a always,exit -F arch=b32 -F path=/bin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/lrunzip -F perm=x -F key=T1560_Archive_Collected_Data

#### lrzcat
-a always,exit -F arch=b32 -F path=/bin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/lrzcat -F perm=x -F key=T1560_Archive_Collected_Data

#### lrztar
-a always,exit -F arch=b32 -F path=/bin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/lrztar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/lrztar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/lrztar -F perm=x -F key=T1560_Archive_Collected_Data

#### lrzuntar
-a always,exit -F arch=b32 -F path=/bin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/lrzuntar -F perm=x -F key=T1560_Archive_Collected_Data

#### lrz
-a always,exit -F arch=b32 -F path=/bin/lrz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/lrz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/lrz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/lrz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/lrz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/lrz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/lrz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/lrz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/lrz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/lrz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lrz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lrz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/lrz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/lrz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/lrz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/lrz -F perm=x -F key=T1560_Archive_Collected_Data

### lz4
-a always,exit -F arch=b32 -F path=/bin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/lz4 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/lz4 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/lz4 -F perm=x -F key=T1560_Archive_Collected_Data

### https://www.lzop.org/
-a always,exit -F arch=b32 -F path=/bin/lzop -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/lzop -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/lzop -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/lzop -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/lzop -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/lzop -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/lzop -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/lzop -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/lzop -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/lzop -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lzop -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lzop -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/lzop -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/lzop -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/lzop -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/lzop -F perm=x -F key=T1560_Archive_Collected_Data

### https://rzip.samba.org/
#### rzip
-a always,exit -F arch=b32 -F path=/bin/rzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/rzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/rzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/rzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/rzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/rzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/rzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/rzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/rzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/rzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/rzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/rzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/rzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/rzip -F perm=x -F key=T1560_Archive_Collected_Data

#### runzip
-a always,exit -F arch=b32 -F path=/bin/runzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/runzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/runzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/runzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/runzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/runzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/runzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/runzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/runzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/runzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/runzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/runzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/runzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/runzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/runzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/runzip -F perm=x -F key=T1560_Archive_Collected_Data

### https://tukaani.org/xz/
#### xz
-a always,exit -F arch=b32 -F path=/bin/xz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/xz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/xz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/xz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/xz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/xz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/xz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/xz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/xz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/xz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/xz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/xz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/xz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/xz -F perm=x -F key=T1560_Archive_Collected_Data

#### unxz
-a always,exit -F arch=b32 -F path=/bin/unxz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/unxz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/unxz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/unxz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/unxz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/unxz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/unxz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/unxz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/unxz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/unxz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/unxz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/unxz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/unxz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/unxz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/unxz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/unxz -F perm=x -F key=T1560_Archive_Collected_Data

#### lzmainfo
-a always,exit -F arch=b32 -F path=/bin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/lzmainfo -F perm=x -F key=T1560_Archive_Collected_Data

#### xzcat
-a always,exit -F arch=b32 -F path=/bin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/xzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/xzcat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/xzcat -F perm=x -F key=T1560_Archive_Collected_Data

#### xzcmp
-a always,exit -F arch=b32 -F path=/bin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/xzcmp -F perm=x -F key=T1560_Archive_Collected_Data

#### zdiff
-a always,exit -F arch=b32 -F path=/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zdiff -F perm=x -F key=T1560_Archive_Collected_Data

#### xzegrep
-a always,exit -F arch=b32 -F path=/bin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/xzegrep -F perm=x -F key=T1560_Archive_Collected_Data

#### xzfgrep
-a always,exit -F arch=b32 -F path=/bin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/xzfgrep -F perm=x -F key=T1560_Archive_Collected_Data

#### zgrep
-a always,exit -F arch=b32 -F path=/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/zgrep -F perm=x -F key=T1560_Archive_Collected_Data

#### xzless
-a always,exit -F arch=b32 -F path=/bin/xzless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/xzless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/xzless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/xzless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/xzless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/xzless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/xzless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/xzless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/xzless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/xzless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xzless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xzless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/xzless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/xzless -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/xzless -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/xzless -F perm=x -F key=T1560_Archive_Collected_Data

#### xzmore
-a always,exit -F arch=b32 -F path=/bin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/xzmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/xzmore -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/xzmore -F perm=x -F key=T1560_Archive_Collected_Data

### https://www.nongnu.org/lzip/plzip.html
-a always,exit -F arch=b32 -F path=/usr/bin/plzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/plzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/plzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/plzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/plzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/plzip -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/plzip -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/plzip -F perm=x -F key=T1560_Archive_Collected_Data

### http://compression.ca/
-a always,exit -F arch=b32 -F path=/usr/bin/pbzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/pbzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/pbzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/pbzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/pbzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/pbzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/pbzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/pbzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/lbzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/lbzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/lbzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/lbzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/lbzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/lbzip2 -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/lbzip2 -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/lbzip2 -F perm=x -F key=T1560_Archive_Collected_Data

### https://github.com/vasi/pixz/
-a always,exit -F arch=b32 -F path=/usr/bin/pixz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/pixz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/pixz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/pixz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/pixz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/pixz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/pixz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/pixz -F perm=x -F key=T1560_Archive_Collected_Data

### https://github.com/madler/pigz
-a always,exit -F arch=b32 -F path=/usr/bin/pigz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/pigz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/pigz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/pigz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/pigz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/pigz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/pigz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/pigz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/unpigz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/unpigz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/unpigz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/unpigz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/unpigz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/unpigz -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/unpigz -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/unpigz -F perm=x -F key=T1560_Archive_Collected_Data

### zstd
-a always,exit -F arch=b32 -F path=/usr/bin/zstd -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zstd -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zstd -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zstd -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zstd -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zstd -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zstd -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/s^bin/zstd -F perm=x -F key=T1560_Archive_Collected_Data

### https://unarchiver.c3.cx/commandline
-a always,exit -F arch=b32 -F path=/usr/bin/unar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/unar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/unar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/unar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/unar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/unar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/unar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/unar -F perm=x -F key=T1560_Archive_Collected_Data

### https://www.cabextract.org.uk/
-a always,exit -F arch=b32 -F path=/usr/bin/cabextract -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/cabextract -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/cabextract -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/cabextract -F perm=x -F key=T1560_Archive_Collected_Data

### https://github.com/google/brotli
-a always,exit -F arch=b32 -F path=/usr/bin/brotli -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/brotli -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/brotli -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/brotli -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/brotli -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/brotli -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/brotli -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/brotli -F perm=x -F key=T1560_Archive_Collected_Data

### https://github.com/google/zopfli
-a always,exit -F arch=b32 -F path=/usr/bin/zopfli -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/zopfli -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/zopfli -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/zopfli -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/zopfli -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/zopfli -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/zopfli -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/zopfli -F perm=x -F key=T1560_Archive_Collected_Data

### https://www.rarlab.com/
-a always,exit -F arch=b32 -F path=/usr/bin/rar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/rar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/unrar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/unrar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/rar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/rar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/unrar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/unrar -F perm=x -F key=T1560_Archive_Collected_Data

### https://www.nongnu.org/atool/
-a always,exit -F arch=b32 -F path=/usr/bin/atool -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/atool -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/atool -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/atool -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/atool -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/atool -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/apack -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/apack -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/apack -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/apack -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/apack -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/apack -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/aunpack -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/aunpack -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/aunpack -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/aunpack -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/aunpack -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/aunpack -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/acat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/acat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/acat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/acat -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/acat -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/acat -F perm=x -F key=T1560_Archive_Collected_Data

### https://github.com/dtrx-py/dtrx
-a always,exit -F arch=b32 -F path=/usr/bin/dtrx -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/dtrx -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/dtrx -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/dtrx -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/dtrx -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/dtrx -F perm=x -F key=T1560_Archive_Collected_Data

### https://github.com/ani6al/arc
-a always,exit -F arch=b32 -F path=/usr/bin/arc -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/arc -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/arc -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/arc -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/arc -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/arc -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/arc -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/arc -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/marc -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/marc -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/marc -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/marc -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/marc -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/marc -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/marc -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/marc -F perm=x -F key=T1560_Archive_Collected_Data

# ar
-a always,exit -F arch=b32 -F path=/bin/ar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/bin/ar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/sbin/ar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/sbin/ar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/ar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/ar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/ar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/ar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/ar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/ar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/ar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/ar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/ar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/ar -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/snap/bin/ar -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/snap/bin/ar -F perm=x -F key=T1560_Archive_Collected_Data

# https://sourceforge.net/projects/arj/
-a always,exit -F arch=b32 -F path=/usr/bin/arj -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/arj -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/arj -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/arj -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/arj -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/arj -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/arj -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/arj -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/arj-register -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/arj-register -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/arj-register -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/arj-register -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/arj-register -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/arj-register -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/arj-register -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/arj-register -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/arjdisp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/arjdisp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/arjdisp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/arjdisp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/arjdisp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/arjdisp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/arjdisp -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/arjdisp -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/bin/rearj -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/rearj -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/rearj -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/rearj -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/rearj -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/rearj -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/sbin/rearj -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/sbin/rearj -F perm=x -F key=T1560_Archive_Collected_Data

# https://www.cabextract.org.uk/
-a always,exit -F arch=b32 -F path=/usr/bin/cabextract -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/bin/cabextract -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/sbin/cabextract -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/sbin/cabextract -F perm=x -F key=T1560_Archive_Collected_Data

-a always,exit -F arch=b32 -F path=/usr/local/bin/cabextract -F perm=x -F key=T1560_Archive_Collected_Data
-a always,exit -F arch=b64 -F path=/usr/local/bin/cabextract -F perm=x -F key=T1560_Archive_Collected_Data

# T1140_Deobfuscate_Decode_Files_or_Information
## b2sum
-a always,exit -F arch=b32 -F path=/bin/b2sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/bin/b2sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/sbin/b2sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/sbin/b2sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/bin/b2sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/bin/b2sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/sbin/b2sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/sbin/b2sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/bin/b2sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/bin/b2sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/sbin/b2sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/sbin/b2sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

## b3sum
-a always,exit -F arch=b32 -F path=/bin/b3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/bin/b3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/sbin/b3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/sbin/b3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/bin/b3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/bin/b3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/sbin/b3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/sbin/b3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/bin/b3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/bin/b3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/sbin/b3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/sbin/b3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

## md5sum
-a always,exit -F arch=b32 -F path=/bin/md5sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/bin/md5sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/sbin/md5sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/sbin/md5sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/bin/md5sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/bin/md5sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/sbin/md5sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/sbin/md5sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/bin/md5sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/bin/md5sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/sbin/md5sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/sbin/md5sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

## csum
-a always,exit -F arch=b32 -F path=/bin/csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/bin/csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/sbin/csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/sbin/csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/bin/csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/bin/csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/sbin/csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/sbin/csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/bin/csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/bin/csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/sbin/csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/sbin/csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

## k12sum
-a always,exit -F arch=b32 -F path=/bin/k12sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/bin/k12sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/sbin/k12sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/sbin/k12sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/bin/k12sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/bin/k12sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/sbin/k12sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/sbin/k12sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/bin/k12sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/bin/k12sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/sbin/k12sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/sbin/k12sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

## sha1sum
-a always,exit -F arch=b32 -F path=/bin/sha1sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/bin/sha1sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/sbin/sha1sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/sbin/sha1sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/bin/sha1sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/bin/sha1sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/sbin/sha1sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/sbin/sha1sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/bin/sha1sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/bin/sha1sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/sbin/sha1sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/sbin/sha1sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

## sha256sum
-a always,exit -F arch=b32 -F path=/bin/sha256sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/bin/sha256sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/sbin/sha256sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/sbin/sha256sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/bin/sha256sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/bin/sha256sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/sbin/sha256sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/sbin/sha256sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/bin/sha256sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/bin/sha256sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/sbin/sha256sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/sbin/sha256sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

## sha512sum
-a always,exit -F arch=b32 -F path=/bin/sha512sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/bin/sha512sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/sbin/sha512sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/sbin/sha512sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/bin/sha512sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/bin/sha512sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/sbin/sha512sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/sbin/sha512sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/bin/sha512sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/bin/sha512sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/sbin/sha512sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/sbin/sha512sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

## sha3sum
-a always,exit -F arch=b32 -F path=/bin/sha3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/bin/sha3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/sbin/sha3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/sbin/sha3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/bin/sha3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/bin/sha3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/sbin/sha3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/sbin/sha3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/bin/sha3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/bin/sha3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/sbin/sha3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/sbin/sha3sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

## twoxhash
-a always,exit -F arch=b32 -F path=/bin/twoxhash -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/bin/twoxhash -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/sbin/twoxhash -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/sbin/twoxhash -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/bin/twoxhash -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/bin/twoxhash -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/sbin/twoxhash -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/sbin/twoxhash -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/bin/twoxhash -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/bin/twoxhash -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/sbin/twoxhash -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/sbin/twoxhash -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

## crc32csum
-a always,exit -F arch=b32 -F path=/bin/crc32csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/bin/crc32csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/sbin/crc32csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/sbin/crc32csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/bin/crc32csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/bin/crc32csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/sbin/crc32csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/sbin/crc32csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/bin/crc32csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/bin/crc32csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/sbin/crc32csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/sbin/crc32csum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

## crc32sum
-a always,exit -F arch=b32 -F path=/bin/crc32sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/bin/crc32sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/sbin/crc32sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/sbin/crc32sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/bin/crc32sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/bin/crc32sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/sbin/crc32sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/sbin/crc32sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/bin/crc32sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/bin/crc32sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

-a always,exit -F arch=b32 -F path=/usr/local/sbin/crc32sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information
-a always,exit -F arch=b64 -F path=/usr/local/sbin/crc32sum -F perm=x -F key=T1140_Deobfuscate_Decode_Files_or_Information

## Anonymous File Creation
### These rules watch the use of memfd_create
### "memfd_create" creates anonymous file and returns a file descriptor to access it
### When combined with "fexecve" can be used to stealthily run binaries in memory without touching disk
### https://magisterquis.github.io/2018/03/31/in-memory-only-elf-execution.html

-a always,exit -F arch=b32 -S memfd_create -F key=anon_file_create
-a always,exit -F arch=b64 -S memfd_create -F key=anon_file_create

### https://github.com/CheraghiMilad/bypass-Neo23x0-auditd-config
### Bypassing the Neo23x0 (Florian Roth) auditd Configuration Using the fexecve Systemcall
-a always,exit -F arch=b32 -S fexecve -F key=fexecve_detect
-a always,exit -F arch=b64 -S fexecve -F key=fexecve_detect

# Modify logging configuration
## https://github.com/quantum-sec/auditd-config/blob/master/config/quantum_auditd.rules

## rsyslog
-a always,exit -F arch=b32 -F path=/etc/rsyslog.conf -F perm=wa -F key=rsyslog_config_change
-a always,exit -F arch=b64 -F path=/etc/rsyslog.conf -F perm=wa -F key=rsyslog_config_change

-a always,exit -F arch=b32 -F dir=/etc/rsyslog.d/ -F perm=wa -F key=rsyslog_dir_change
-a always,exit -F arch=b64 -F dir=/etc/rsyslog.d/ -F perm=wa -F key=rsyslog_dir_change

## syslog-ng
-a always,exit -F arch=b32 -F path=/etc/syslog-ng.conf -F perm=wa -F key=syslog-ng_config_change
-a always,exit -F arch=b64 -F path=/etc/syslog-ng.conf -F perm=wa -F key=syslog-ng_config_change

-a always,exit -F arch=b32 -F dir=/etc/syslog-ng/ -F perm=wa -F key=syslog-ng_dir_change
-a always,exit -F arch=b64 -F dir=/etc/syslog-ng/ -F perm=wa -F key=syslog-ng_dir_change

## syslog
-a always,exit -F arch=b32 -F path=/etc/syslog.conf -F perm=wa -F key=syslog_config_change
-a always,exit -F arch=b64 -F path=/etc/syslog.conf -F perm=wa -F key=syslog_config_change

-a always,exit -F arch=b32 -F dir=/etc/syslog/ -F perm=wa -F key=syslog_dir_change
-a always,exit -F arch=b64 -F dir=/etc/syslog/ -F perm=wa -F key=syslog_dir_change

## fluentd
-a always,exit -F arch=b32 -F path=/etc/fluent/fluent.conf -F perm=wa -F key=fluentd_config_change
-a always,exit -F arch=b64 -F path=/etc/fluent/fluent.conf -F perm=wa -F key=fluentd_config_change

-a always,exit -F arch=b32 -F dir=/etc/fluent/ -F perm=wa -F key=fluentd_dir_change
-a always,exit -F arch=b64 -F dir=/etc/fluent/ -F perm=wa -F key=fluentd_dir_change

### td-agent
-a always,exit -F arch=b32 -F path=/etc/td-agent/td-agent.conf -F perm=wa -F key=fluentd_config_change
-a always,exit -F arch=b64 -F path=/etc/td-agent/td-agent.conf -F perm=wa -F key=fluentd_config_change

-a always,exit -F arch=b32 -F dir=/etc/td-agent/ -F perm=wa -F key=fluentd_dir_change
-a always,exit -F arch=b64 -F dir=/etc/td-agent/ -F perm=wa -F key=fluentd_dir_change

### fluent-bit
-a always,exit -F arch=b32 -F path=/etc/td-agent-bit/td-agent-bit.conf -F perm=wa -F key=fluentbit_dir_change
-a always,exit -F arch=b64 -F path=/etc/td-agent-bit/td-agent-bit.conf -F perm=wa -F key=fluentbit_dir_change

-a always,exit -F arch=b32 -F dir=/etc/td-agent-bit/ -F perm=wa -F key=fluentbit_dir_change
-a always,exit -F arch=b64 -F dir=/etc/td-agent-bit/ -F perm=wa -F key=fluentbit_dir_change

## Filebeat
-a always,exit -F arch=b32 -F dir=/etc/filebeat/ -F perm=wa -F key=filebeat_dir_change
-a always,exit -F arch=b64 -F dir=/etc/filebeat/ -F perm=wa -F key=filebeat_dir_change

-a always,exit -F arch=b32 -F dir=/usr/share/filebeat/bin/ -F perm=wa -F key=filebeat_dir_change
-a always,exit -F arch=b64 -F dir=/usr/share/filebeat/bin/ -F perm=wa -F key=filebeat_dir_change

-a always,exit -F arch=b32 -F dir=/usr/share/filebeat/ -F perm=wa -F key=filebeat_dir_change
-a always,exit -F arch=b64 -F dir=/usr/share/filebeat/ -F perm=wa -F key=filebeat_dir_change

## oms-agent
-a always,exit -F arch=b32 -F dir=/etc/opt/microsoft/omsagent/ -F perm=wa -F key=oms-agent_dir_change
-a always,exit -F arch=b64 -F dir=/etc/opt/microsoft/omsagent/ -F perm=wa -F key=oms-agent_dir_change

-a always,exit -F arch=b32 -F path=/etc/opt/microsoft/omsagent/bin -F perm=wa -F key=oms-agent_bin_change
-a always,exit -F arch=b64 -F path=/etc/opt/microsoft/omsagent/bin -F perm=wa -F key=oms-agent_bin_change

-a always,exit -F arch=b32 -F dir=/etc/opt/microsoft/omsagent/ -F perm=
-a always,exit -F arch=b64 -F dir=/etc/opt/microsoft/omsagent/ -F perm=

-a always,exit -F arch=b32 -F path=/opt/microsoft/omsagent/bin/omsadmin.sh -F perm=x -F key=oms_admin_execution
-a always,exit -F arch=b64 -F path=/opt/microsoft/omsagent/bin/omsadmin.sh -F perm=x -F key=oms_admin_execution

### Uncomment below after configuring the workspace id for the oms-agent config
### Uncomment the syslog rule associated with the oms-agent configuration
-a always,exit -F arch=b32 -F path=/etc/opt/microsoft/omsagent/<workspace -F perm=wa -F key=oms-agent_config_change
-a always,exit -F arch=b64 -F path=/etc/opt/microsoft/omsagent/<workspace -F perm=wa -F key=oms-agent_config_change

-a always,exit -F arch=b32 -F path=/etc/syslog-ng/security-config-omsagent.conf -F perm=wa -F key=oms-agent_bin_change
-a always,exit -F arch=b64 -F path=/etc/syslog-ng/security-config-omsagent.conf -F perm=wa -F key=oms-agent_bin_change

-a always,exit -F arch=b32 -F path=/etc/rsyslog.d/security-config-omsagent.conf -F perm=wa -F key=oms-agent_bin_change
-a always,exit -F arch=b64 -F path=/etc/rsyslog.d/security-config-omsagent.conf -F perm=wa -F key=oms-agent_bin_change

# cfg2html
## https://github.com/cfg2html/cfg2html
-a always,exit -F arch=b32 -F path=/etc/cfg2html/default.conf -F perm=wa -F key=cfg2html
-a always,exit -F arch=b64 -F path=/etc/cfg2html/default.conf -F perm=wa -F key=cfg2html

-a always,exit -F arch=b32 -F path=/etc/cfg2html/local.conf -F perm=wa -F key=cfg2html
-a always,exit -F arch=b64 -F path=/etc/cfg2html/local.conf -F perm=wa -F key=cfg2html

-a always,exit -F arch=b32 -F path=/etc/cfg2html/files -F perm=wa -F key=cfg2html
-a always,exit -F arch=b64 -F path=/etc/cfg2html/files -F perm=wa -F key=cfg2html

-a always,exit -F arch=b32 -F path=/etc/cfg2html/systeminfo -F perm=wa -F key=cfg2html
-a always,exit -F arch=b64 -F path=/etc/cfg2html/systeminfo -F perm=wa -F key=cfg2html

-a always,exit -F arch=b32 -F path=/etc/cfg2html/plugins -F perm=wa -F key=cfg2html
-a always,exit -F arch=b64 -F path=/etc/cfg2html/plugins -F perm=wa -F key=cfg2html

-a always,exit -F arch=b32 -F dir=/etc/cfg2html/ -F perm=wa -F key=cfg2html
-a always,exit -F arch=b64 -F dir=/etc/cfg2html/ -F perm=wa -F key=cfg2html

-a always,exit -F arch=b32 -F path=/usr/bin/cfg2html-linux -F perm=x -F key=cfg2html
-a always,exit -F arch=b64 -F path=/usr/bin/cfg2html-linux -F perm=x -F key=cfg2html

# inxi
## https://github.com/smxi/inxi
## https://smxi.org/docs/inxi-installation.htm
-a always,exit -F arch=b32 -F path=/etc/inxi.conf -F perm=x -F key=inxi
-a always,exit -F arch=b64 -F path=/etc/inxi.conf -F perm=x -F key=inxi

-a always,exit -F arch=b32 -F path=/usr/bin/inxi -F perm=x -F key=inxi
-a always,exit -F arch=b64 -F path=/usr/bin/inxi -F perm=x -F key=inxi

-a always,exit -F arch=b32 -F path=/usr/sbin/inxi -F perm=x -F key=inxi
-a always,exit -F arch=b64 -F path=/usr/sbin/inxi -F perm=x -F key=inxi

## macOS
-a always,exit -F arch=b32 -F path=/usr/local/bin/inxi -F perm=x -F key=inxi
-a always,exit -F arch=b64 -F path=/usr/local/bin/inxi -F perm=x -F key=inxi

# cramfs
-a always,exit -F arch=b32 -F path=/etc/modprobe.d/cramfs.conf -F perm=wa -F key=cramfs
-a always,exit -F arch=b64 -F path=/etc/modprobe.d/cramfs.conf -F perm=wa -F key=cramfs

# freevxfs
-a always,exit -F arch=b32 -F path=/etc/modprobe.d/freevxfs.conf -F perm=wa -F key=freevxfs
-a always,exit -F arch=b64 -F path=/etc/modprobe.d/freevxfs.conf -F perm=wa -F key=freevxfs

# hfs
-a always,exit -F arch=b32 -F path=/etc/modprobe.d/hfs.conf -F perm=wa -F key=hfs
-a always,exit -F arch=b64 -F path=/etc/modprobe.d/hfs.conf -F perm=wa -F key=hfs

# hfsplus
-a always,exit -F arch=b32 -F path=/etc/modprobe.d/hfsplus.conf -F perm=wa -F key=hfs
-a always,exit -F arch=b64 -F path=/etc/modprobe.d/hfsplus.conf -F perm=wa -F key=hfs

# jffs2
-a always,exit -F arch=b32 -F path=/etc/modprobe.d/jffs2.conf -F perm=wa -F key=jffs2
-a always,exit -F arch=b64 -F path=/etc/modprobe.d/jffs2.conf -F perm=wa -F key=jffs2

# squashfs
-a always,exit -F arch=b32 -F path=/etc/modprobe.d/squashfs.conf -F perm=wa -F key=squashfs
-a always,exit -F arch=b64 -F path=/etc/modprobe.d/squashfs.conf -F perm=wa -F key=squashfs

# udf
-a always,exit -F arch=b32 -F path=/etc/modprobe.d/udf.conf -F perm=wa -F key=udf
-a always,exit -F arch=b64 -F path=/etc/modprobe.d/udf.conf -F perm=wa -F key=udf

# IBM TSM - IBM Spectrum Protect
## https://technote101.com/ibm-spectrum-protect-tsm/how-to-install-tsm-server-ibm-spectrum-protect-on-linux/
## https://technote101.com/blog/how-to-create-tsm-server-instance-ibm-spectrum-protect-version-8/
## https://www.ibm.com/docs/en/spectrum-protect/8.1.9?topic=steps-linux-configuring-server-client-communications-unix-systems
## https://www.ibm.com/support/pages/troubleshoot-issues-ibm-spectrum-protect-environment-using-servermon-component
-a always,exit -F arch=b32 -F dir=/opt/tivoli/ -F perm=wa -F key=IBM_Spectrum_Protect
-a always,exit -F arch=b64 -F dir=/opt/tivoli/ -F perm=wa -F key=IBM_Spectrum_Protect

# osquery
## https://github.com/osquery/osquery
-a always,exit -F arch=b32 -F dir=/etc/init.d/osqueryd/ -F perm=wa -F key=osquery
-a always,exit -F arch=b64 -F dir=/etc/init.d/osqueryd/ -F perm=wa -F key=osquery

-a always,exit -F arch=b32 -F dir=/etc/osquery/ -F perm=wa -F key=osquery
-a always,exit -F arch=b64 -F dir=/etc/osquery/ -F perm=wa -F key=osquery

-a always,exit -F arch=b32 -F path=/etc/sysconfig/osqueryd -F perm=wa -F key=osquery
-a always,exit -F arch=b64 -F path=/etc/sysconfig/osqueryd -F perm=wa -F key=osquery

-a always,exit -F arch=b32 -F path=/opt/osquery/bin/osqueryctl -F perm=x -F key=osquery
-a always,exit -F arch=b64 -F path=/opt/osquery/bin/osqueryctl -F perm=x -F key=osquery

-a always,exit -F arch=b32 -F path=/opt/osquery/bin/osqueryd -F perm=x -F key=osquery
-a always,exit -F arch=b64 -F path=/opt/osquery/bin/osqueryd -F perm=x -F key=osquery

-a always,exit -F arch=b32 -F path=/usr/local/bin/osqueryi -F perm=x -F key=osquery
-a always,exit -F arch=b64 -F path=/usr/local/bin/osqueryi -F perm=x -F key=osquery

-a always,exit -F arch=b32 -F path=/opt/osquery/bin/osqueryctl -F perm=x -F key=osquery
-a always,exit -F arch=b64 -F path=/opt/osquery/bin/osqueryctl -F perm=x -F key=osquery

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/osqueryd.service -F perm=wa -F key=osquery
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/osqueryd.service -F perm=wa -F key=osquery

-a always,exit -F arch=b32 -F path=/opt/osquery/share/osquery/certs/certs.pem -F perm=wa -F key=osquery
-a always,exit -F arch=b64 -F path=/opt/osquery/share/osquery/certs/certs.pem -F perm=wa -F key=osquery

-a always,exit -F arch=b32 -F dir=/opt/osquery/share/osquery/lenses/ -F perm=wa -F key=osquery
-a always,exit -F arch=b64 -F dir=/opt/osquery/share/osquery/lenses/ -F perm=wa -F key=osquery

-a always,exit -F arch=b32 -F dir=/opt/osquery/share/osquery/packs/ -F perm=wa -F key=osquery
-a always,exit -F arch=b64 -F dir=/opt/osquery/share/osquery/packs/ -F perm=wa -F key=osquery

-a always,exit -F arch=b32 -F path=/opt/osquery/share/osquery/osquery.example.conf -F perm=wa -F key=osquery
-a always,exit -F arch=b64 -F path=/opt/osquery/share/osquery/osquery.example.conf -F perm=wa -F key=osquery

# Qualys Cloud Agent
## Monitor execution of the main agent binary
-a always,exit -F arch=b32 -S execve -F path=/usr/local/qualys/cloud-agent/bin/qualys-cloud-agent.sh -F "auid>=500" -F "auid!=-1" -F key=qualys_cloudagent
-a always,exit -F arch=b64 -S execve -F path=/usr/local/qualys/cloud-agent/bin/qualys-cloud-agent.sh -F "auid>=500" -F "auid!=-1" -F key=qualys_cloudagent

## Monitor configuration file operations in /etc/qualys
-a always,exit -F arch=b32 -S open,openat,creat,unlink,rename,write -F dir=/etc/qualys/ -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=qualys_cloudagent
-a always,exit -F arch=b64 -S open,openat,creat,unlink,rename,write -F dir=/etc/qualys/ -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=qualys_cloudagent

## Monitor log file operations in /var/log/qualys
-a always,exit -F arch=b32 -S open,openat,creat,unlink,rename,write -F dir=/var/log/qualys/ -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=qualys_cloudagent
-a always,exit -F arch=b64 -S open,openat,creat,unlink,rename,write -F dir=/var/log/qualys/ -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=qualys_cloudagent

## Monitor changes to the systemd service file
-a always,exit -F arch=b32 -S open,openat,creat,unlink,rename,write -F path=/etc/systemd/system/qualys-cloud-agent.service -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=qualys_cloudagent
-a always,exit -F arch=b64 -S open,openat,creat,unlink,rename,write -F path=/etc/systemd/system/qualys-cloud-agent.service -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=qualys_cloudagent

# git
-a always,exit -F arch=b32 -F path=/usr/bin/git -F perm=x -F key=git
-a always,exit -F arch=b64 -F path=/usr/bin/git -F perm=x -F key=git

-a always,exit -F arch=b32 -F path=/usr/sbin/git -F perm=x -F key=git
-a always,exit -F arch=b64 -F path=/usr/sbin/git -F perm=x -F key=git

-a always,exit -F arch=b32 -F path=/usr/local/bin/git -F perm=x -F key=git
-a always,exit -F arch=b64 -F path=/usr/local/bin/git -F perm=x -F key=git

-a always,exit -F arch=b32 -F path=/usr/local/sbin/git -F perm=x -F key=git
-a always,exit -F arch=b64 -F path=/usr/local/sbin/git -F perm=x -F key=git

-a always,exit -F arch=b32 -F path=/usr/bin/git-lfs -F perm=x -F key=git
-a always,exit -F arch=b64 -F path=/usr/bin/git-lfs -F perm=x -F key=git

-a always,exit -F arch=b32 -F path=/usr/sbin/git-lfs -F perm=x -F key=git
-a always,exit -F arch=b64 -F path=/usr/sbin/git-lfs -F perm=x -F key=git

-a always,exit -F arch=b32 -F path=/usr/local/bin/git-lfs -F perm=x -F key=git
-a always,exit -F arch=b64 -F path=/usr/local/bin/git-lfs -F perm=x -F key=git

-a always,exit -F arch=b32 -F path=/usr/local/sbin/git-lfs -F perm=x -F key=git
-a always,exit -F arch=b64 -F path=/usr/local/sbin/git-lfs -F perm=x -F key=git

## Splunk - Enhanced Rules
#### https://www.splunk.com/

# --- Splunk Binaries ---
## Monitor execution (x), write (w), and attribute changes (a) on Splunk binaries to detect tampering.

# Primary installation path (most important)
-a always,exit -F arch=b32 -F path=/opt/splunk/bin/splunk -F perm=xwa -F key=splunk
-a always,exit -F arch=b64 -F path=/opt/splunk/bin/splunk -F perm=xwa -F key=splunk

# Common symlink locations (monitor execution only)
-a always,exit -F arch=b32 -F path=/usr/bin/splunk -F perm=x -F key=splunk
-a always,exit -F arch=b64 -F path=/usr/bin/splunk -F perm=x -F key=splunk
-a always,exit -F arch=b32 -F path=/usr/sbin/splunk -F perm=x -F key=splunk
-a always,exit -F arch=b64 -F path=/usr/sbin/splunk -F perm=x -F key=splunk

# --- Splunk Configuration & Data ---
## Monitor for write and attribute changes (wa) to critical Splunk directories.
## The 'dir' directive is recursive, covering subdirectories like apps and users.

# Main configuration directory (includes apps, users, system settings)
-a always,exit -F arch=b32 -F dir=/opt/splunk/etc/ -F perm=wa -F key=splunk
-a always,exit -F arch=b64 -F dir=/opt/splunk/etc/ -F perm=wa -F key=splunk

# Log files directory (detect tampering with logs)
-a always,exit -F arch=b32 -F dir=/opt/splunk/var/log/splunk/ -F perm=wa -F key=splunk
-a always,exit -F arch=b64 -F dir=/opt/splunk/var/log/splunk/ -F perm=wa -F key=splunk

# Runtime and process information
-a always,exit -F arch=b32 -F dir=/opt/splunk/var/run/splunk/ -F perm=wa -F key=splunk
-a always,exit -F arch=b64 -F dir=/opt/splunk/var/run/splunk/ -F perm=wa -F key=splunk

## Auditing Elasticsearch 🔍
## This section includes rules for monitoring Elasticsearch clusters
## to detect unauthorized changes, data access, and security events.

# --- Core Elasticsearch Binaries ---
## Monitor for execution (x), write (w), and attribute changes (a) to detect tampering.
-a always,exit -F arch=b32 -F path=/usr/share/elasticsearch/bin/elasticsearch -F perm=xwa -F key=elasticsearch-binary
-a always,exit -F arch=b64 -F path=/usr/share/elasticsearch/bin/elasticsearch -F perm=xwa -F key=elasticsearch-binary

-a always,exit -F arch=b32 -F path=/usr/share/elasticsearch/bin/elasticsearch-cli -F perm=xwa -F key=elasticsearch-binary
-a always,exit -F arch=b64 -F path=/usr/share/elasticsearch/bin/elasticsearch-cli -F perm=xwa -F key=elasticsearch-binary

-a always,exit -F arch=b32 -F path=/usr/share/elasticsearch/bin/elasticsearch-env -F perm=xwa -F key=elasticsearch-binary
-a always,exit -F arch=b64 -F path=/usr/share/elasticsearch/bin/elasticsearch-env -F perm=xwa -F key=elasticsearch-binary

## Monitor Elasticsearch management tools for tampering and execution
-a always,exit -F arch=b32 -F path=/usr/share/elasticsearch/bin/elasticsearch-node -F perm=xwa -F key=elasticsearch-tools
-a always,exit -F arch=b64 -F path=/usr/share/elasticsearch/bin/elasticsearch-node -F perm=xwa -F key=elasticsearch-tools

-a always,exit -F arch=b32 -F path=/usr/share/elasticsearch/bin/elasticsearch-shard -F perm=xwa -F key=elasticsearch-tools
-a always,exit -F arch=b64 -F path=/usr/share/elasticsearch/bin/elasticsearch-shard -F perm=xwa -F key=elasticsearch-tools

-a always,exit -F arch=b32 -F path=/usr/share/elasticsearch/bin/elasticsearch-keystore -F perm=xwa -F key=elasticsearch-keystore
-a always,exit -F arch=b64 -F path=/usr/share/elasticsearch/bin/elasticsearch-keystore -F perm=xwa -F key=elasticsearch-keystore

-a always,exit -F arch=b32 -F path=/usr/share/elasticsearch/bin/elasticsearch-users -F perm=xwa -F key=elasticsearch-users
-a always,exit -F arch=b64 -F path=/usr/share/elasticsearch/bin/elasticsearch-users -F perm=xwa -F key=elasticsearch-users

-a always,exit -F arch=b32 -F path=/usr/share/elasticsearch/bin/elasticsearch-setup-passwords -F perm=xwa -F key=elasticsearch-passwords
-a always,exit -F arch=b64 -F path=/usr/share/elasticsearch/bin/elasticsearch-setup-passwords -F perm=xwa -F key=elasticsearch-passwords

# --- Configuration Files ---
## Monitor main configuration directory
-a always,exit -F arch=b32 -F dir=/etc/elasticsearch/ -F perm=wa -F key=elasticsearch-config
-a always,exit -F arch=b64 -F dir=/etc/elasticsearch/ -F perm=wa -F key=elasticsearch-config

## Monitor specific critical configuration files
-a always,exit -F arch=b32 -F path=/etc/elasticsearch/elasticsearch.yml -F perm=wa -F key=elasticsearch-main-config
-a always,exit -F arch=b64 -F path=/etc/elasticsearch/elasticsearch.yml -F perm=wa -F key=elasticsearch-main-config

-a always,exit -F arch=b32 -F path=/etc/elasticsearch/jvm.options -F perm=wa -F key=elasticsearch-jvm-config
-a always,exit -F arch=b64 -F path=/etc/elasticsearch/jvm.options -F perm=wa -F key=elasticsearch-jvm-config

-a always,exit -F arch=b32 -F path=/etc/elasticsearch/log4j2.properties -F perm=wa -F key=elasticsearch-logging-config
-a always,exit -F arch=b64 -F path=/etc/elasticsearch/log4j2.properties -F perm=wa -F key=elasticsearch-logging-config

## Monitor security configuration
-a always,exit -F arch=b32 -F path=/etc/elasticsearch/users -F perm=wa -F key=elasticsearch-users-file
-a always,exit -F arch=b64 -F path=/etc/elasticsearch/users -F perm=wa -F key=elasticsearch-users-file

-a always,exit -F arch=b32 -F path=/etc/elasticsearch/users_roles -F perm=wa -F key=elasticsearch-users-roles
-a always,exit -F arch=b64 -F path=/etc/elasticsearch/users_roles -F perm=wa -F key=elasticsearch-users-roles

-a always,exit -F arch=b32 -F path=/etc/elasticsearch/roles.yml -F perm=wa -F key=elasticsearch-roles
-a always,exit -F arch=b64 -F path=/etc/elasticsearch/roles.yml -F perm=wa -F key=elasticsearch-roles

-a always,exit -F arch=b32 -F path=/etc/elasticsearch/role_mapping.yml -F perm=wa -F key=elasticsearch-role-mapping
-a always,exit -F arch=b64 -F path=/etc/elasticsearch/role_mapping.yml -F perm=wa -F key=elasticsearch-role-mapping

## Monitor keystore (critical for secrets)
-a always,exit -F arch=b32 -F path=/etc/elasticsearch/elasticsearch.keystore -F perm=wa -F key=elasticsearch-keystore-file
-a always,exit -F arch=b64 -F path=/etc/elasticsearch/elasticsearch.keystore -F perm=wa -F key=elasticsearch-keystore-file

# --- SSL/TLS Certificates and Keys ---
## Monitor certificate directories (adjust paths based on your setup)
-a always,exit -F arch=b32 -F dir=/etc/elasticsearch/certs/ -F perm=wa -F key=elasticsearch-certificates
-a always,exit -F arch=b64 -F dir=/etc/elasticsearch/certs/ -F perm=wa -F key=elasticsearch-certificates

-a always,exit -F arch=b32 -F dir=/etc/elasticsearch/x-pack/ -F perm=wa -F key=elasticsearch-xpack-config
-a always,exit -F arch=b64 -F dir=/etc/elasticsearch/x-pack/ -F perm=wa -F key=elasticsearch-xpack-config

# --- Data Directories ---
## WARNING: Monitoring the data directory is high-volume and can impact performance.
## Enable this rule with caution, preferably in low-traffic environments or for targeted investigations.
# -a always,exit -F arch=b32 -F dir=/var/lib/elasticsearch/ -F perm=wa -F key=elasticsearch-data
-a always,exit -F arch=b64 -F dir=/var/lib/elasticsearch/ -F perm=wa -F key=elasticsearch-data

## Monitor index metadata changes
-a always,exit -F arch=b32 -F dir=/var/lib/elasticsearch/nodes/ -F perm=wa -F key=elasticsearch-nodes
-a always,exit -F arch=b64 -F dir=/var/lib/elasticsearch/nodes/ -F perm=wa -F key=elasticsearch-nodes

# --- Log Files ---
## Monitor log directory for tampering
-a always,exit -F arch=b32 -F dir=/var/log/elasticsearch/ -F perm=wa -F key=elasticsearch-logs
-a always,exit -F arch=b64 -F dir=/var/log/elasticsearch/ -F perm=wa -F key=elasticsearch-logs

# --- Plugins Directory ---
## Monitor plugin installations and changes
-a always,exit -F arch=b32 -F dir=/usr/share/elasticsearch/plugins/ -F perm=wa -F key=elasticsearch-plugins
-a always,exit -F arch=b64 -F dir=/usr/share/elasticsearch/plugins/ -F perm=wa -F key=elasticsearch-plugins

-a always,exit -F arch=b32 -F dir=/usr/share/elasticsearch/modules/ -F perm=wa -F key=elasticsearch-modules
-a always,exit -F arch=b64 -F dir=/usr/share/elasticsearch/modules/ -F perm=wa -F key=elasticsearch-modules

# --- Systemd Service Files ---
## Monitor service configuration changes
-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/elasticsearch.service -F perm=wa -F key=elasticsearch-service
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/elasticsearch.service -F perm=wa -F key=elasticsearch-service

-a always,exit -F arch=b32 -F dir=/etc/systemd/system/elasticsearch.service.d/ -F perm=wa -F key=elasticsearch-service-override
-a always,exit -F arch=b64 -F dir=/etc/systemd/system/elasticsearch.service.d/ -F perm=wa -F key=elasticsearch-service-override

# --- Default/Sysconfig Files ---
## Monitor environment variable configurations
-a always,exit -F arch=b32 -F path=/etc/default/elasticsearch -F perm=wa -F key=elasticsearch-defaults
-a always,exit -F arch=b64 -F path=/etc/default/elasticsearch -F perm=wa -F key=elasticsearch-defaults

-a always,exit -F arch=b32 -F path=/etc/sysconfig/elasticsearch -F perm=wa -F key=elasticsearch-sysconfig
-a always,exit -F arch=b64 -F path=/etc/sysconfig/elasticsearch -F perm=wa -F key=elasticsearch-sysconfig

# --- PID and Runtime Files ---
## Monitor runtime files
-a always,exit -F arch=b32 -F dir=/var/run/elasticsearch/ -F perm=wa -F key=elasticsearch-runtime
-a always,exit -F arch=b64 -F dir=/var/run/elasticsearch/ -F perm=wa -F key=elasticsearch-runtime

-a always,exit -F arch=b32 -F path=/var/run/elasticsearch.pid -F perm=wa -F key=elasticsearch-pid
-a always,exit -F arch=b64 -F path=/var/run/elasticsearch.pid -F perm=wa -F key=elasticsearch-pid

# --- Backup/Snapshot Directories ---
## Monitor snapshot repositories (adjust path based on your repo.path setting)
-a always,exit -F arch=b32 -F dir=/mount/backups/elasticsearch/ -F perm=wa -F key=elasticsearch-snapshots
-a always,exit -F arch=b64 -F dir=/mount/backups/elasticsearch/ -F perm=wa -F key=elasticsearch-snapshots

-a always,exit -F arch=b32 -F dir=/var/lib/elasticsearch-snapshots/ -F perm=wa -F key=elasticsearch-snapshots
-a always,exit -F arch=b64 -F dir=/var/lib/elasticsearch-snapshots/ -F perm=wa -F key=elasticsearch-snapshots

# --- Network Connections ---
## Monitor network binding changes (for detecting port changes)
-a always,exit -F arch=b32 -S bind -F a0=2 -F exit=-EACCES -F key=elasticsearch-bind-fail
-a always,exit -F arch=b64 -S bind -F a0=2 -F exit=-EACCES -F key=elasticsearch-bind-fail

-a always,exit -F arch=b32 -S bind -F success=1 -F key=elasticsearch-bind-success
-a always,exit -F arch=b64 -S bind -F success=1 -F key=elasticsearch-bind-success

# --- Process and Memory Operations ---
## Monitor for memory mapping operations (Elasticsearch uses memory-mapped files)
-a always,exit -F arch=b32 -S mmap -F a2&0x4 -F key=elasticsearch-mmap-write
-a always,exit -F arch=b64 -S mmap -F a2&0x4 -F key=elasticsearch-mmap-write

# --- File Deletion Monitoring ---
## Monitor deletion of critical Elasticsearch files
-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F dir=/etc/elasticsearch/ -F key=elasticsearch-config-deletion
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F dir=/etc/elasticsearch/ -F key=elasticsearch-config-deletion

-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F dir=/var/lib/elasticsearch/ -F key=elasticsearch-data-deletion
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F dir=/var/lib/elasticsearch/ -F key=elasticsearch-data-deletion

# --- ILM (Index Lifecycle Management) Policies ---
## Monitor ILM policy directory if using file-based policies
-a always,exit -F arch=b32 -F dir=/etc/elasticsearch/ilm-policies/ -F perm=wa -F key=elasticsearch-ilm-policies
-a always,exit -F arch=b64 -F dir=/etc/elasticsearch/ilm-policies/ -F perm=wa -F key=elasticsearch-ilm-policies

# --- Watcher Configuration ---
## Monitor Watcher scripts and configurations
-a always,exit -F arch=b32 -F dir=/etc/elasticsearch/scripts/ -F perm=wa -F key=elasticsearch-watcher-scripts
-a always,exit -F arch=b64 -F dir=/etc/elasticsearch/scripts/ -F perm=wa -F key=elasticsearch-watcher-scripts

# --- Optional: ECE (Elastic Cloud Enterprise) Specific ---
## Uncomment if using ECE
# -a always,exit -F arch=b32 -F path=/usr/share/enterprise-search/ -F perm=wa -F key=elasticsearch-enterprise-search
# -a always,exit -F arch=b64 -F path=/usr/share/enterprise-search/ -F perm=wa -F key=elasticsearch-enterprise-search

# --- Optional: Audit Elasticsearch User ---
## Monitor specific elasticsearch user activities (UID 1000 is example - adjust to your ES user UID)
# -a always,exit -F arch=b32 -F uid=1000 -S execve -F key=elasticsearch-user-commands
# -a always,exit -F arch=b64 -F uid=1000 -S execve -F key=elasticsearch-user-commands

## Auditing JFrog Artifactory 📦
## This section includes rules for monitoring Artifactory repositories and services
## to detect unauthorized access, configuration changes, and security events.

# --- Core Artifactory Binaries ---
## Monitor main Artifactory executables for tampering and execution
-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/bin/artifactory.sh -F perm=xwa -F key=artifactory-binary
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/bin/artifactory.sh -F perm=xwa -F key=artifactory-binary

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/bin/artifactoryctl -F perm=xwa -F key=artifactory-control
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/bin/artifactoryctl -F perm=xwa -F key=artifactory-control

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/bin/artifactory.default -F perm=wa -F key=artifactory-defaults
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/bin/artifactory.default -F perm=wa -F key=artifactory-defaults

## Monitor Artifactory management scripts for tampering and execution
-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/bin/migrate.sh -F perm=xwa -F key=artifactory-migrate
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/bin/migrate.sh -F perm=xwa -F key=artifactory-migrate

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/bin/installService.sh -F perm=xwa -F key=artifactory-install
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/bin/installService.sh -F perm=xwa -F key=artifactory-install

# --- Application Directory ---
## Monitor application directory for tampering
-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/app/ -F perm=wa -F key=artifactory-app
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/app/ -F perm=wa -F key=artifactory-app

# --- Main Configuration Directories ---
## Monitor primary configuration directory
-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/etc/ -F perm=wa -F key=artifactory-config
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/etc/ -F perm=wa -F key=artifactory-config

-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/etc/artifactory/ -F perm=wa -F key=artifactory-main-config
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/etc/artifactory/ -F perm=wa -F key=artifactory-main-config

## Monitor system configuration files
-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/etc/system.yaml -F perm=wa -F key=artifactory-system-yaml
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/etc/system.yaml -F perm=wa -F key=artifactory-system-yaml

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/etc/artifactory/artifactory.system.properties -F perm=wa -F key=artifactory-system-props
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/etc/artifactory/artifactory.system.properties -F perm=wa -F key=artifactory-system-props

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/etc/artifactory/artifactory.config.xml -F perm=wa -F key=artifactory-config-xml
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/etc/artifactory/artifactory.config.xml -F perm=wa -F key=artifactory-config-xml

# --- Security Configuration ---
## Monitor security directory and access credentials
-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/etc/security/ -F perm=wa -F key=artifactory-security
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/etc/security/ -F perm=wa -F key=artifactory-security

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/etc/security/master.key -F perm=rwa -F key=artifactory-master-key
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/etc/security/master.key -F perm=rwa -F key=artifactory-master-key

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/etc/security/join.key -F perm=rwa -F key=artifactory-join-key
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/etc/security/join.key -F perm=rwa -F key=artifactory-join-key

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/etc/security/artifactory.key -F perm=rwa -F key=artifactory-encryption-key
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/etc/security/artifactory.key -F perm=rwa -F key=artifactory-encryption-key

## Monitor access tokens and credentials
-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/etc/access/ -F perm=wa -F key=artifactory-access
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/etc/access/ -F perm=wa -F key=artifactory-access

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/etc/access/access.config.yml -F perm=wa -F key=artifactory-access-config
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/etc/access/access.config.yml -F perm=wa -F key=artifactory-access-config

-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/etc/access/keys/ -F perm=wa -F key=artifactory-access-keys
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/etc/access/keys/ -F perm=wa -F key=artifactory-access-keys

# --- Database Configuration ---
## Monitor database configuration and connection settings
-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/etc/system.yaml -F perm=wa -F key=artifactory-db-config
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/etc/system.yaml -F perm=wa -F key=artifactory-db-config

-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/data/derby/ -F perm=wa -F key=artifactory-derby-db
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/data/derby/ -F perm=wa -F key=artifactory-derby-db

# --- Repository Storage ---
## Monitor repository data (HIGH VOLUME - use with caution)
-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/data/artifactory/data/ -F perm=wa -F key=artifactory-repo-data
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/data/artifactory/data/ -F perm=wa -F key=artifactory-repo-data

-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/data/artifactory/filestore/ -F perm=wa -F key=artifactory-filestore
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/data/artifactory/filestore/ -F perm=wa -F key=artifactory-filestore

## Monitor backup directories
-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/backup/ -F perm=wa -F key=artifactory-backup
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/backup/ -F perm=wa -F key=artifactory-backup

-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/backup/daily/ -F perm=wa -F key=artifactory-backup-daily
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/backup/daily/ -F perm=wa -F key=artifactory-backup-daily

-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/backup/weekly/ -F perm=wa -F key=artifactory-backup-weekly
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/backup/weekly/ -F perm=wa -F key=artifactory-backup-weekly

# --- Log Files ---
## Monitor log directories for tampering
-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/log/ -F perm=wa -F key=artifactory-logs
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/log/ -F perm=wa -F key=artifactory-logs

-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/log/archived/ -F perm=wa -F key=artifactory-logs-archived
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/log/archived/ -F perm=wa -F key=artifactory-logs-archived

## Monitor audit logs specifically
-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/log/artifactory-audit.log -F perm=wa -F key=artifactory-audit-log
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/log/artifactory-audit.log -F perm=wa -F key=artifactory-audit-log

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/log/artifactory-access-audit.log -F perm=wa -F key=artifactory-access-audit-log
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/log/artifactory-access-audit.log -F perm=wa -F key=artifactory-access-audit-log

# --- Plugins and Extensions ---
## Monitor plugin directories
-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/etc/plugins/ -F perm=wa -F key=artifactory-plugins
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/etc/plugins/ -F perm=wa -F key=artifactory-plugins

-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/etc/artifactory/plugins/ -F perm=wa -F key=artifactory-user-plugins
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/etc/artifactory/plugins/ -F perm=wa -F key=artifactory-user-plugins

# --- License Files ---
## Monitor license changes
-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/etc/artifactory/artifactory.lic -F perm=wa -F key=artifactory-license
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/etc/artifactory/artifactory.lic -F perm=wa -F key=artifactory-license

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/etc/artifactory/artifactory.cluster.license -F perm=wa -F key=artifactory-cluster-license
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/etc/artifactory/artifactory.cluster.license -F perm=wa -F key=artifactory-cluster-license

# --- HA/Cluster Configuration ---
## Monitor High Availability configuration
-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/etc/artifactory/ha-node.properties -F perm=wa -F key=artifactory-ha-config
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/etc/artifactory/ha-node.properties -F perm=wa -F key=artifactory-ha-config

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/etc/artifactory/storage.properties -F perm=wa -F key=artifactory-storage-config
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/etc/artifactory/storage.properties -F perm=wa -F key=artifactory-storage-config

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/var/etc/artifactory/binarystore.xml -F perm=wa -F key=artifactory-binarystore-config
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/var/etc/artifactory/binarystore.xml -F perm=wa -F key=artifactory-binarystore-config

# --- Systemd Service Files ---
## Monitor service configuration
-a always,exit -F arch=b32 -F path=/lib/systemd/system/artifactory.service -F perm=wa -F key=artifactory-service
-a always,exit -F arch=b64 -F path=/lib/systemd/system/artifactory.service -F perm=wa -F key=artifactory-service

-a always,exit -F arch=b32 -F dir=/etc/systemd/system/artifactory.service.d/ -F perm=wa -F key=artifactory-service-override
-a always,exit -F arch=b64 -F dir=/etc/systemd/system/artifactory.service.d/ -F perm=wa -F key=artifactory-service-override

# --- Tomcat Configuration (if using embedded Tomcat) ---
-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/app/artifactory/tomcat/conf/ -F perm=wa -F key=artifactory-tomcat-config
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/app/artifactory/tomcat/conf/ -F perm=wa -F key=artifactory-tomcat-config

-a always,exit -F arch=b32 -F path=/opt/jfrog/artifactory/app/artifactory/tomcat/conf/server.xml -F perm=wa -F key=artifactory-tomcat-server
-a always,exit -F arch=b64 -F path=/opt/jfrog/artifactory/app/artifactory/tomcat/conf/server.xml -F perm=wa -F key=artifactory-tomcat-server

# --- SSL/TLS Certificates ---
## Monitor certificate stores
-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/etc/security/keys/ -F perm=wa -F key=artifactory-ssl-keys
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/etc/security/keys/ -F perm=wa -F key=artifactory-ssl-keys

-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/etc/security/certificates/ -F perm=wa -F key=artifactory-certificates
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/etc/security/certificates/ -F perm=wa -F key=artifactory-certificates

# --- PID and Lock Files ---
## Monitor runtime files
-a always,exit -F arch=b32 -F path=/var/run/artifactory.pid -F perm=wa -F key=artifactory-pid
-a always,exit -F arch=b64 -F path=/var/run/artifactory.pid -F perm=wa -F key=artifactory-pid

-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/run/ -F perm=wa -F key=artifactory-runtime
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/run/ -F perm=wa -F key=artifactory-runtime

# --- Import/Export Directories ---
## Monitor import/export operations
-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/data/artifactory/export/ -F perm=wa -F key=artifactory-export
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/data/artifactory/export/ -F perm=wa -F key=artifactory-export

-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/data/artifactory/import/ -F perm=wa -F key=artifactory-import
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/data/artifactory/import/ -F perm=wa -F key=artifactory-import

# --- UI Configuration ---
## Monitor UI customization
-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/app/frontend/ -F perm=wa -F key=artifactory-ui
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/app/frontend/ -F perm=wa -F key=artifactory-ui

-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/etc/artifactory/ui/ -F perm=wa -F key=artifactory-ui-config
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/etc/artifactory/ui/ -F perm=wa -F key=artifactory-ui-config

# --- Replication Configuration ---
## Monitor replication settings
-a always,exit -F arch=b32 -F dir=/opt/jfrog/artifactory/var/etc/artifactory/replication/ -F perm=wa -F key=artifactory-replication
-a always,exit -F arch=b64 -F dir=/opt/jfrog/artifactory/var/etc/artifactory/replication/ -F perm=wa -F key=artifactory-replication

# --- Optional: Monitor specific user operations ---
## Replace UID with your artifactory user's UID
# -a always,exit -F arch=b32 -F uid=1030 -S execve -F key=artifactory-user-commands
# -a always,exit -F arch=b64 -F uid=1030 -S execve -F key=artifactory-user-commands

# --- File Deletion Monitoring ---
## Monitor deletion of critical Artifactory files within specified directories
-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F dir=/opt/jfrog/artifactory/var/etc/ -F key=artifactory-config-deletion
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F dir=/opt/jfrog/artifactory/var/etc/ -F key=artifactory-config-deletion

-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F dir=/opt/jfrog/artifactory/var/data/ -F key=artifactory-data-deletion
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F dir=/opt/jfrog/artifactory/var/data/ -F key=artifactory-data-deletion

# Jenkins
## https://www.jenkins.io/
## https://www.jenkins.io/blog/2022/03/25/systemd-migration/
-a always,exit -F arch=b32 -F path=/etc/default/jenkins -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F path=/etc/default/jenkins -F perm=wa -F key=jenkins

-a always,exit -F arch=b32 -F path=/etc/systemd/system/jenkins.service.d/override.conf -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F path=/etc/systemd/system/jenkins.service.d/override.conf -F perm=wa -F key=jenkins

-a always,exit -F arch=b32 -F path=/lib/systemd/system/jenkins.service -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F path=/lib/systemd/system/jenkins.service -F perm=wa -F key=jenkins

-a always,exit -F arch=b32 -F path=/usr/bin/java -F perm=x -F key=jenkins
-a always,exit -F arch=b64 -F path=/usr/bin/java -F perm=x -F key=jenkins

-a always,exit -F arch=b32 -F path=/usr/sbin/java -F perm=x -F key=jenkins
-a always,exit -F arch=b64 -F path=/usr/sbin/java -F perm=x -F key=jenkins

### Red Hat, openSUSE specific
-a always,exit -F arch=b32 -F path=/etc/sysconfig/jenkins -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F path=/etc/sysconfig/jenkins -F perm=wa -F key=jenkins

-a always,exit -F arch=b32 -F path=/usr/lib/systemd/system/jenkins.service -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F path=/usr/lib/systemd/system/jenkins.service -F perm=wa -F key=jenkins

-a always,exit -F arch=b32 -F path=/opt/jenkins/config/jenkins.yaml -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F path=/opt/jenkins/config/jenkins.yaml -F perm=wa -F key=jenkins

-a always,exit -F arch=b32 -F path=/opt/jenkins/home/secrets/hudson.util.Secret -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F path=/opt/jenkins/home/secrets/hudson.util.Secret -F perm=wa -F key=jenkins

-a always,exit -F arch=b32 -F path=/opt/jenkins/home/secrets/master.key -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F path=/opt/jenkins/home/secrets/master.key -F perm=wa -F key=jenkins

## --- Jenkins Home Directory (adjust path if needed) ---
## Debian/Ubuntu default
-a always,exit -F arch=b32 -F dir=/var/lib/jenkins/ -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F dir=/var/lib/jenkins/ -F perm=wa -F key=jenkins

## Red Hat/openSUSE/generic default
-a always,exit -F arch=b32 -F dir=/opt/jenkins/home/ -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F dir=/opt/jenkins/home/ -F perm=wa -F key=jenkins

## --- Critical Jenkins Files and Directories ---
## Main configuration file
-a always,exit -F arch=b32 -F path=/var/lib/jenkins/config.xml -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F path=/var/lib/jenkins/config.xml -F perm=wa -F key=jenkins

-a always,exit -F arch=b32 -F path=/opt/jenkins/home/config.xml -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F path=/opt/jenkins/home/config.xml -F perm=wa -F key=jenkins

## Plugins directory
-a always,exit -F arch=b32 -F dir=/var/lib/jenkins/plugins/ -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F dir=/var/lib/jenkins/plugins/ -F perm=wa -F key=jenkins

-a always,exit -F arch=b32 -F dir=/opt/jenkins/home/plugins/ -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F dir=/opt/jenkins/home/plugins/ -F perm=wa -F key=jenkins

## Users and secrets
-a always,exit -F arch=b32 -F dir=/var/lib/jenkins/users/ -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F dir=/var/lib/jenkins/users/ -F perm=wa -F key=jenkins

-a always,exit -F arch=b32 -F dir=/var/lib/jenkins/secrets/ -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F dir=/var/lib/jenkins/secrets/ -F perm=wa -F key=jenkins

## Agent/Node configurations
-a always,exit -F arch=b32 -F dir=/var/lib/jenkins/nodes/ -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F dir=/var/lib/jenkins/nodes/ -F perm=wa -F key=jenkins

-a always,exit -F arch=b32 -F dir=/opt/jenkins/home/nodes/ -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F dir=/opt/jenkins/home/nodes/ -F perm=wa -F key=jenkins

## Job configurations and builds
-a always,exit -F arch=b32 -F dir=/var/lib/jenkins/jobs/ -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F dir=/var/lib/jenkins/jobs/ -F perm=wa -F key=jenkins

-a always,exit -F arch=b32 -F dir=/opt/jenkins/home/jobs/ -F perm=wa -F key=jenkins
-a always,exit -F arch=b64 -F dir=/opt/jenkins/home/jobs/ -F perm=wa -F key=jenkins

## --- Jenkins File Deletion Monitoring ---
-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F dir=/var/lib/jenkins/ -F key=jenkins
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F dir=/var/lib/jenkins/ -F key=jenkins

-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F dir=/opt/jenkins/home/ -F key=jenkins
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F dir=/opt/jenkins/home/ -F key=jenkins

# initramfs-tools
-a always,exit -F arch=b32 -F path=/etc/initramfs-tools/initramfs.conf -F perm=wa -F key=initramfs-tools
-a always,exit -F arch=b64 -F path=/etc/initramfs-tools/initramfs.conf -F perm=wa -F key=initramfs-tools

-a always,exit -F arch=b32 -F path=/etc/initramfs-tools/update-initramfs.conf -F perm=wa -F key=initramfs-tools
-a always,exit -F arch=b64 -F path=/etc/initramfs-tools/update-initramfs.conf -F perm=wa -F key=initramfs-tools

-a always,exit -F arch=b32 -F dir=/etc/initramfs-tools/ -F perm=wa -F key=initramfs-tools
-a always,exit -F arch=b64 -F dir=/etc/initramfs-tools/ -F perm=wa -F key=initramfs-tools

# lighttpd
-a always,exit -F arch=b32 -F path=/etc/lighttpd/lighttpd.conf -F perm=wa -F key=lighttpd
-a always,exit -F arch=b64 -F path=/etc/lighttpd/lighttpd.conf -F perm=wa -F key=lighttpd

-a always,exit -F arch=b32 -F dir=/etc/lighttpd/ -F perm=wa -F key=lighttpd
-a always,exit -F arch=b64 -F dir=/etc/lighttpd/ -F perm=wa -F key=lighttpd

# nagios
## https://assets.nagios.com/downloads/nagioscore/docs/nagioscore/3/en/configmain.html
-a always,exit -F arch=b32 -F dir=/usr/local/nagios/etc/ -F perm=wa -F key=nagios
-a always,exit -F arch=b64 -F dir=/usr/local/nagios/etc/ -F perm=wa -F key=nagios

## Monitor Nagios binaries and CGIs for tampering
-a always,exit -F arch=b32 -F path=/usr/local/nagios/bin/nagios -F perm=xwa -F key=nagios
-a always,exit -F arch=b64 -F path=/usr/local/nagios/bin/nagios -F perm=xwa -F key=nagios

-a always,exit -F arch=b32 -F dir=/usr/local/nagios/sbin/ -F perm=xwa -F key=nagios
-a always,exit -F arch=b64 -F dir=/usr/local/nagios/sbin/ -F perm=xwa -F key=nagios

## Monitor Nagios plugins for tampering
-a always,exit -F arch=b32 -F dir=/usr/local/nagios/libexec/ -F perm=wa -F key=nagios
-a always,exit -F arch=b64 -F dir=/usr/local/nagios/libexec/ -F perm=wa -F key=nagios

## Monitor Nagios var directory for changes (logs, cache, command pipe)
-a always,exit -F arch=b32 -F dir=/usr/local/nagios/var/ -F perm=wa -F key=nagios
-a always,exit -F arch=b64 -F dir=/usr/local/nagios/var/ -F perm=wa -F key=nagios

## --- Nagios File Deletion Monitoring ---
-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F dir=/usr/local/nagios/etc/ -F key=nagios
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F dir=/usr/local/nagios/etc/ -F key=nagios

-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F dir=/usr/local/nagios/bin/ -F key=nagios
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F dir=/usr/local/nagios/bin/ -F key=nagios

-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F dir=/usr/local/nagios/sbin/ -F key=nagios
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F dir=/usr/local/nagios/sbin/ -F key=nagios

-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F dir=/usr/local/nagios/libexec/ -F key=nagios
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F dir=/usr/local/nagios/libexec/ -F key=nagios

-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F dir=/usr/local/nagios/var/ -F key=nagios
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F dir=/usr/local/nagios/var/ -F key=nagios

# checkmk
## https://docs.checkmk.com/latest/en/cmc_files.html
-a always,exit -F arch=b32 -F dir=/var/check_mk/core/config/ -F perm=wa -F key=checkmk
-a always,exit -F arch=b64 -F dir=/var/check_mk/core/config/ -F perm=wa -F key=checkmk

-a always,exit -F arch=b32 -F dir=/omd/sites/ -S open,openat,creat -F perm=w -F key=checkmk
-a always,exit -F arch=b64 -F dir=/omd/sites/ -S open,openat,creat -F perm=w -F key=checkmk

-a always,exit -F arch=b32 -F dir=/omd/sites/ -S open,openat -F perm=rw -F key=checkmk-logs
-a always,exit -F arch=b64 -F dir=/omd/sites/ -S open,openat -F perm=rw -F key=checkmk-logs

# SAP
## Monitor SAP configuration files:
-a always,exit -F arch=b32 -F dir=/usr/sap/SID/SYS/profile/ -F perm=wa -F key=sap_config
-a always,exit -F arch=b64 -F dir=/usr/sap/SID/SYS/profile/ -F perm=wa -F key=sap_config

## Monitor SAP executable files:
-a always,exit -F arch=b32 -F dir=/usr/sap/SID/DVEBMGS00/exe/ -F perm=x -F key=sap_executables
-a always,exit -F arch=b64 -F dir=/usr/sap/SID/DVEBMGS00/exe/ -F perm=x -F key=sap_executables

## Monitor SAP log files:
-a always,exit -F arch=b32 -F dir=/usr/sap/SID/DVEBMGS00/work/ -F perm=wa -F key=sap_logs
-a always,exit -F arch=b64 -F dir=/usr/sap/SID/DVEBMGS00/work/ -F perm=wa -F key=sap_logs

## Monitor SAP installation directory:
-a always,exit -F arch=b32 -F dir=/usr/sap/ -F perm=wa -F key=sap_installation
-a always,exit -F arch=b64 -F dir=/usr/sap/ -F perm=wa -F key=sap_installation

## Monitor SAP database files:
-a always,exit -F arch=b32 -F dir=/sapmnt/SID/global/db/ -F perm=wa -F key=sap_database
-a always,exit -F arch=b64 -F dir=/sapmnt/SID/global/db/ -F perm=wa -F key=sap_database

## Monitor SAP user activities:
-a always,exit -F arch=b32 -S execve -F "auid>=500" -F "auid!=-1" -F key=sap_user_activity
-a always,exit -F arch=b64 -S execve -F "auid>=500" -F "auid!=-1" -F key=sap_user_activity

# samba
-a always,exit -F arch=b32 -F path=/etc/samba/smb.conf -F perm=wa -F key=samba
-a always,exit -F arch=b64 -F path=/etc/samba/smb.conf -F perm=wa -F key=samba

-a always,exit -F arch=b32 -F dir=/etc/samba/ -F perm=wa -F key=samba
-a always,exit -F arch=b64 -F dir=/etc/samba/ -F perm=wa -F key=samba

# apache2
## https://httpd.apache.org/docs/current/en/configuring.html
-a always,exit -F arch=b32 -F path=/etc/apache2/apache2.conf -F perm=wa -F key=apache2
-a always,exit -F arch=b64 -F path=/etc/apache2/apache2.conf -F perm=wa -F key=apache2

-a always,exit -F arch=b32 -F path=/etc/apache2/ports.conf -F perm=wa -F key=apache2
-a always,exit -F arch=b64 -F path=/etc/apache2/ports.conf -F perm=wa -F key=apache2

-a always,exit -F arch=b32 -F dir=/etc/apache2/ -F perm=wa -F key=apache2
-a always,exit -F arch=b64 -F dir=/etc/apache2/ -F perm=wa -F key=apache2

-a always,exit -F arch=b32 -F path=/usr/sbin/a2disconf -F perm=x -F key=apache2
-a always,exit -F arch=b64 -F path=/usr/sbin/a2disconf -F perm=x -F key=apache2

-a always,exit -F arch=b32 -F path=/usr/sbin/a2dismod -F perm=x -F key=apache2
-a always,exit -F arch=b64 -F path=/usr/sbin/a2dismod -F perm=x -F key=apache2

-a always,exit -F arch=b32 -F path=/usr/sbin/a2dissite -F perm=x -F key=apache2
-a always,exit -F arch=b64 -F path=/usr/sbin/a2dissite -F perm=x -F key=apache2

-a always,exit -F arch=b32 -F path=/usr/sbin/a2enconf -F perm=x -F key=apache2
-a always,exit -F arch=b64 -F path=/usr/sbin/a2enconf -F perm=x -F key=apache2

-a always,exit -F arch=b32 -F path=/usr/sbin/a2enmod -F perm=x -F key=apache2
-a always,exit -F arch=b64 -F path=/usr/sbin/a2enmod -F perm=x -F key=apache2

-a always,exit -F arch=b32 -F path=/usr/sbin/a2ensite -F perm=x -F key=apache2
-a always,exit -F arch=b64 -F path=/usr/sbin/a2ensite -F perm=x -F key=apache2

-a always,exit -F arch=b32 -F path=/usr/sbin/a2query -F perm=x -F key=apache2
-a always,exit -F arch=b64 -F path=/usr/sbin/a2query -F perm=x -F key=apache2

-a always,exit -F arch=b32 -F path=/usr/sbin/apache2ctl -F perm=x -F key=apache2
-a always,exit -F arch=b64 -F path=/usr/sbin/apache2ctl -F perm=x -F key=apache2

-a always,exit -F arch=b32 -F path=/usr/sbin/apachectl -F perm=x -F key=apache2
-a always,exit -F arch=b64 -F path=/usr/sbin/apachectl -F perm=x -F key=apache2

# Java
-a always,exit -F arch=b32 -F dir=/etc/.java/ -F perm=wa -F key=java
-a always,exit -F arch=b64 -F dir=/etc/.java/ -F perm=wa -F key=java

-a always,exit -F arch=b32 -F dir=/usr/jdk/ -F perm=x -F key=java
-a always,exit -F arch=b64 -F dir=/usr/jdk/ -F perm=x -F key=java

-a always,exit -F arch=b32 -F dir=/usr/lib/jvm/ -F perm=x -F key=java
-a always,exit -F arch=b64 -F dir=/usr/lib/jvm/ -F perm=x -F key=java

## macOS
-a always,exit -F arch=b32 -F dir=/Library/Java/JavaVirtualMachines/ -F perm=wa -F key=java
-a always,exit -F arch=b64 -F dir=/Library/Java/JavaVirtualMachines/ -F perm=wa -F key=java

## Monitor Java binary execution
-a always,exit -F arch=b32 -F path=/usr/bin/java -S execve -F key=java_exec
-a always,exit -F arch=b64 -F path=/usr/bin/java -S execve -F key=java_exec

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-11-openjdk-amd64/bin/java -S execve -F key=java11_exec
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-11-openjdk-amd64/bin/java -S execve -F key=java11_exec

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-17-openjdk-amd64/bin/java -S execve -F key=java17_exec
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-17-openjdk-amd64/bin/java -S execve -F key=java17_exec

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-21-openjdk-amd64/bin/java -S execve -F key=java21_exec
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-21-openjdk-amd64/bin/java -S execve -F key=java21_exec

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-23-openjdk-amd64/bin/java -S execve -F key=java23_exec
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-23-openjdk-amd64/bin/java -S execve -F key=java23_exec

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-24-openjdk-amd64/bin/java -S execve -F key=java24_exec
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-24-openjdk-amd64/bin/java -S execve -F key=java24_exec

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-25-openjdk-amd64/bin/java -S execve -F key=java24_exec
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-25-openjdk-amd64/bin/java -S execve -F key=java24_exec

## Monitor javac compilation
-a always,exit -F arch=b32 -F path=/usr/bin/javac -S execve -F key=javac_compile
-a always,exit -F arch=b64 -F path=/usr/bin/javac -S execve -F key=javac_compile

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-11-openjdk-amd64/bin/javac -S execve -F key=javac11_compile
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-11-openjdk-amd64/bin/javac -S execve -F key=javac11_compile

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-17-openjdk-amd64/bin/javac -S execve -F key=javac17_compile
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-17-openjdk-amd64/bin/javac -S execve -F key=javac17_compile

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-21-openjdk-amd64/bin/javac -S execve -F key=javac21_compile
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-21-openjdk-amd64/bin/javac -S execve -F key=javac21_compile

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-23-openjdk-amd64/bin/javac -S execve -F key=javac23_compile
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-23-openjdk-amd64/bin/javac -S execve -F key=javac23_compile

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-24-openjdk-amd64/bin/javac -S execve -F key=javac24_compile
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-24-openjdk-amd64/bin/javac -S execve -F key=javac24_compile

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-25-openjdk-amd64/bin/javac -S execve -F key=javac24_compile
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-25-openjdk-amd64/bin/javac -S execve -F key=javac24_compile

## Monitor other Java tools
-a always,exit -F arch=b32 -F path=/usr/bin/jar -S execve -F key=jar_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jar -S execve -F key=jar_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jstack -S execve -F key=jstack_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jstack -S execve -F key=jstack_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jmap -S execve -F key=jmap_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jmap -S execve -F key=jmap_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jcmd -S execve -F key=jcmd_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jcmd -S execve -F key=jcmd_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jconsole -S execve -F key=jconsole_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jconsole -S execve -F key=jconsole_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jdb -S execve -F key=jdb_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jdb -S execve -F key=jdb_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jps -S execve -F key=jps_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jps -S execve -F key=jps_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jstat -S execve -F key=jstat_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jstat -S execve -F key=jstat_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jstatd -S execve -F key=jstatd_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jstatd -S execve -F key=jstatd_exec

-a always,exit -F arch=b32 -F path=/usr/bin/keytool -S execve -F key=keytool_exec
-a always,exit -F arch=b64 -F path=/usr/bin/keytool -S execve -F key=keytool_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jarsigner -S execve -F key=jarsigner_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jarsigner -S execve -F key=jarsigner_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jinfo -S execve -F key=jinfo_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jinfo -S execve -F key=jinfo_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jhat -S execve -F key=jhat_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jhat -S execve -F key=jhat_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jvisualvm -S execve -F key=jvisualvm_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jvisualvm -S execve -F key=jvisualvm_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jshell -S execve -F key=jshell_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jshell -S execve -F key=jshell_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jlink -S execve -F key=jlink_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jlink -S execve -F key=jlink_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jmod -S execve -F key=jmod_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jmod -S execve -F key=jmod_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jdeps -S execve -F key=jdeps_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jdeps -S execve -F key=jdeps_exec

-a always,exit -F arch=b32 -F path=/usr/bin/javap -S execve -F key=javap_exec
-a always,exit -F arch=b64 -F path=/usr/bin/javap -S execve -F key=javap_exec

-a always,exit -F arch=b32 -F path=/usr/bin/jrunscript -S execve -F key=jrunscript_exec
-a always,exit -F arch=b64 -F path=/usr/bin/jrunscript -S execve -F key=jrunscript_exec

## Monitor JVM directories - execution
-a always,exit -F arch=b32 -F dir=/usr/lib/jvm/ -S execve -F key=jvm_dir_exec
-a always,exit -F arch=b64 -F dir=/usr/lib/jvm/ -S execve -F key=jvm_dir_exec

## Monitor JVM directories - write/modify
-a always,exit -F arch=b32 -F dir=/usr/lib/jvm/ -F perm=wa -S open,openat,creat -F key=jvm_dir_write
-a always,exit -F arch=b64 -F dir=/usr/lib/jvm/ -F perm=wa -S open,openat,creat -F key=jvm_dir_write

-a always,exit -F arch=b32 -F dir=/usr/lib/jvm/ -S unlink,unlinkat,rename,renameat,rmdir -F key=jvm_dir_delete
-a always,exit -F arch=b64 -F dir=/usr/lib/jvm/ -S unlink,unlinkat,rename,renameat,rmdir -F key=jvm_dir_delete

-a always,exit -F arch=b32 -F dir=/usr/lib/jvm/ -S chmod,fchmod,fchmodat -F key=jvm_dir_chmod
-a always,exit -F arch=b64 -F dir=/usr/lib/jvm/ -S chmod,fchmod,fchmodat -F key=jvm_dir_chmod

-a always,exit -F arch=b32 -F dir=/usr/lib/jvm/ -S chown,fchown,fchownat,lchown -F key=jvm_dir_chown
-a always,exit -F arch=b64 -F dir=/usr/lib/jvm/ -S chown,fchown,fchownat,lchown -F key=jvm_dir_chown

-a always,exit -F arch=b32 -F dir=/usr/lib/jvm/ -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F key=jvm_dir_xattr
-a always,exit -F arch=b64 -F dir=/usr/lib/jvm/ -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F key=jvm_dir_xattr

## Monitor Java security directories
-a always,exit -F arch=b32 -F dir=/etc/java/ -F perm=wa -S open,openat,creat -F key=java_security_write
-a always,exit -F arch=b64 -F dir=/etc/java/ -F perm=wa -S open,openat,creat -F key=java_security_write

-a always,exit -F arch=b32 -F dir=/etc/java-11-openjdk/ -F perm=wa -S open,openat,creat -F key=java11_security_write
-a always,exit -F arch=b64 -F dir=/etc/java-11-openjdk/ -F perm=wa -S open,openat,creat -F key=java11_security_write

-a always,exit -F arch=b32 -F dir=/etc/java-17-openjdk/ -F perm=wa -S open,openat,creat -F key=java17_security_write
-a always,exit -F arch=b64 -F dir=/etc/java-17-openjdk/ -F perm=wa -S open,openat,creat -F key=java17_security_write

-a always,exit -F arch=b32 -F dir=/etc/java-21-openjdk/ -F perm=wa -S open,openat,creat -F key=java21_security_write
-a always,exit -F arch=b64 -F dir=/etc/java-21-openjdk/ -F perm=wa -S open,openat,creat -F key=java21_security_write

-a always,exit -F arch=b32 -F dir=/etc/java-23-openjdk/ -F perm=wa -S open,openat,creat -F key=java23_security_write
-a always,exit -F arch=b64 -F dir=/etc/java-23-openjdk/ -F perm=wa -S open,openat,creat -F key=java23_security_write

-a always,exit -F arch=b32 -F dir=/etc/java-24-openjdk/ -F perm=wa -S open,openat,creat -F key=java24_security_write
-a always,exit -F arch=b64 -F dir=/etc/java-24-openjdk/ -F perm=wa -S open,openat,creat -F key=java24_security_write

## Monitor Java security directory deletions
-a always,exit -F arch=b32 -F dir=/etc/java/ -S unlink,unlinkat,rename,renameat -F key=java_security_delete
-a always,exit -F arch=b64 -F dir=/etc/java/ -S unlink,unlinkat,rename,renameat -F key=java_security_delete

-a always,exit -F arch=b32 -F dir=/etc/java-11-openjdk/ -S unlink,unlinkat,rename,renameat -F key=java11_security_delete
-a always,exit -F arch=b64 -F dir=/etc/java-11-openjdk/ -S unlink,unlinkat,rename,renameat -F key=java11_security_delete

-a always,exit -F arch=b32 -F dir=/etc/java-17-openjdk/ -S unlink,unlinkat,rename,renameat -F key=java17_security_delete
-a always,exit -F arch=b64 -F dir=/etc/java-17-openjdk/ -S unlink,unlinkat,rename,renameat -F key=java17_security_delete

-a always,exit -F arch=b32 -F dir=/etc/java-21-openjdk/ -S unlink,unlinkat,rename,renameat -F key=java21_security_delete
-a always,exit -F arch=b64 -F dir=/etc/java-21-openjdk/ -S unlink,unlinkat,rename,renameat -F key=java21_security_delete

-a always,exit -F arch=b32 -F dir=/etc/java-23-openjdk/ -S unlink,unlinkat,rename,renameat -F key=java23_security_delete
-a always,exit -F arch=b64 -F dir=/etc/java-23-openjdk/ -S unlink,unlinkat,rename,renameat -F key=java23_security_delete

-a always,exit -F arch=b32 -F dir=/etc/java-24-openjdk/ -S unlink,unlinkat,rename,renameat -F key=java24_security_delete
-a always,exit -F arch=b64 -F dir=/etc/java-24-openjdk/ -S unlink,unlinkat,rename,renameat -F key=java24_security_delete

-a always,exit -F arch=b32 -F dir=/etc/java-25-openjdk/ -S unlink,unlinkat,rename,renameat -F key=java24_security_delete
-a always,exit -F arch=b64 -F dir=/etc/java-25-openjdk/ -S unlink,unlinkat,rename,renameat -F key=java24_security_delete

## Monitor application directories
-a always,exit -F arch=b32 -F dir=/opt/java/ -F perm=wa -S open,openat,creat -F key=java_app_write
-a always,exit -F arch=b64 -F dir=/opt/java/ -F perm=wa -S open,openat,creat -F key=java_app_write

-a always,exit -F arch=b32 -F dir=/opt/java/ -S execve -F key=java_app_exec
-a always,exit -F arch=b64 -F dir=/opt/java/ -S execve -F key=java_app_exec

-a always,exit -F arch=b32 -F dir=/opt/java/ -S unlink,unlinkat,rename,renameat -F key=java_app_delete
-a always,exit -F arch=b64 -F dir=/opt/java/ -S unlink,unlinkat,rename,renameat -F key=java_app_delete

## Monitor Tomcat directories
-a always,exit -F arch=b32 -F dir=/var/lib/tomcat/ -F perm=wa -S open,openat,creat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/lib/tomcat/ -F perm=wa -S open,openat,creat -F key=tomcat

-a always,exit -F arch=b32 -F dir=/var/lib/tomcat9/ -F perm=wa -S open,openat,creat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/lib/tomcat9/ -F perm=wa -S open,openat,creat -F key=tomcat

-a always,exit -F arch=b32 -F dir=/var/lib/tomcat10/ -F perm=wa -S open,openat,creat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/lib/tomcat10/ -F perm=wa -S open,openat,creat -F key=tomcat

-a always,exit -F arch=b32 -F dir=/usr/share/tomcat/ -F perm=wa -S open,openat,creat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/usr/share/tomcat/ -F perm=wa -S open,openat,creat -F key=tomcat

-a always,exit -F arch=b32 -F dir=/usr/share/tomcat9/ -F perm=wa -S open,openat,creat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/usr/share/tomcat9/ -F perm=wa -S open,openat,creat -F key=tomcat

-a always,exit -F arch=b32 -F dir=/usr/share/tomcat10/ -F perm=wa -S open,openat,creat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/usr/share/tomcat10/ -F perm=wa -S open,openat,creat -F key=tomcat

-a always,exit -F arch=b32 -F dir=/var/lib/tomcat/ -S unlink,unlinkat,rename,renameat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/lib/tomcat/ -S unlink,unlinkat,rename,renameat -F key=tomcat

-a always,exit -F arch=b32 -F dir=/var/lib/tomcat/ -S execve -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/lib/tomcat/ -S execve -F key=tomcat

## Monitor webapps directories
-a always,exit -F arch=b32 -F dir=/var/lib/tomcat/webapps/ -F perm=wa -S open,openat,creat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/lib/tomcat/webapps/ -F perm=wa -S open,openat,creat -F key=tomcat

-a always,exit -F arch=b32 -F dir=/var/lib/tomcat/webapps/ -S unlink,unlinkat,rename,renameat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/lib/tomcat/webapps/ -S unlink,unlinkat,rename,renameat -F key=tomcat

-a always,exit -F arch=b32 -F dir=/var/lib/tomcat/webapps/ -S execve -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/lib/tomcat/webapps/ -S execve -F key=tomcat

## Monitor security policy files
-a always,exit -F arch=b32 -F path=/etc/java/security/java.policy -F perm=wa -S open,openat -F key=java_policy_mod
-a always,exit -F arch=b64 -F path=/etc/java/security/java.policy -F perm=wa -S open,openat -F key=java_policy_mod

-a always,exit -F arch=b32 -F path=/etc/java/security/java.security -F perm=wa -S open,openat -F key=java_security_mod
-a always,exit -F arch=b64 -F path=/etc/java/security/java.security -F perm=wa -S open,openat -F key=java_security_mod

-a always,exit -F arch=b32 -F path=/etc/java/security/java.policy -S unlink,unlinkat -F key=java_policy_delete
-a always,exit -F arch=b64 -F path=/etc/java/security/java.policy -S unlink,unlinkat -F key=java_policy_delete

-a always,exit -F arch=b32 -F path=/etc/java/security/java.security -S unlink,unlinkat -F key=java_security_delete
-a always,exit -F arch=b64 -F path=/etc/java/security/java.security -S unlink,unlinkat -F key=java_security_delete

## Monitor keystore operations
-a always,exit -F arch=b32 -F path=/etc/ssl/certs/java/cacerts -F perm=wa -S open,openat -F key=java_cacerts_mod
-a always,exit -F arch=b64 -F path=/etc/ssl/certs/java/cacerts -F perm=wa -S open,openat -F key=java_cacerts_mod

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-11-openjdk-amd64/lib/security/cacerts -F perm=wa -S open,openat -F key=java11_cacerts_mod
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-11-openjdk-amd64/lib/security/cacerts -F perm=wa -S open,openat -F key=java11_cacerts_mod

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-17-openjdk-amd64/lib/security/cacerts -F perm=wa -S open,openat -F key=java17_cacerts_mod
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-17-openjdk-amd64/lib/security/cacerts -F perm=wa -S open,openat -F key=java17_cacerts_mod

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-21-openjdk-amd64/lib/security/cacerts -F perm=wa -S open,openat -F key=java21_cacerts_mod
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-21-openjdk-amd64/lib/security/cacerts -F perm=wa -S open,openat -F key=java21_cacerts_mod

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-23-openjdk-amd64/lib/security/cacerts -F perm=wa -S open,openat -F key=java21_cacerts_mod
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-23-openjdk-amd64/lib/security/cacerts -F perm=wa -S open,openat -F key=java21_cacerts_mod

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-24-openjdk-amd64/lib/security/cacerts -F perm=wa -S open,openat -F key=java21_cacerts_mod
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-24-openjdk-amd64/lib/security/cacerts -F perm=wa -S open,openat -F key=java21_cacerts_mod

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-25-openjdk-amd64/lib/security/cacerts -F perm=wa -S open,openat -F key=java21_cacerts_mod
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-25-openjdk-amd64/lib/security/cacerts -F perm=wa -S open,openat -F key=java21_cacerts_mod

## Monitor blacklist/blocked certs files
-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-11-openjdk-amd64/lib/security/blacklist -F perm=wa -S open,openat -F key=java11_blacklist_mod
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-11-openjdk-amd64/lib/security/blacklist -F perm=wa -S open,openat -F key=java11_blacklist_mod

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-17-openjdk-amd64/lib/security/blacklist -F perm=wa -S open,openat -F key=java17_blacklist_mod
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-17-openjdk-amd64/lib/security/blacklist -F perm=wa -S open,openat -F key=java17_blacklist_mod

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-21-openjdk-amd64/lib/security/blocked.certs -F perm=wa -S open,openat -F key=java21_blockedcerts_mod
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-21-openjdk-amd64/lib/security/blocked.certs -F perm=wa -S open,openat -F key=java21_blockedcerts_mod

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-23-openjdk-amd64/lib/security/blocked.certs -F perm=wa -S open,openat -F key=java21_blockedcerts_mod
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-23-openjdk-amd64/lib/security/blocked.certs -F perm=wa -S open,openat -F key=java21_blockedcerts_mod

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-24-openjdk-amd64/lib/security/blocked.certs -F perm=wa -S open,openat -F key=java21_blockedcerts_mod
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-24-openjdk-amd64/lib/security/blocked.certs -F perm=wa -S open,openat -F key=java21_blockedcerts_mod

-a always,exit -F arch=b32 -F path=/usr/lib/jvm/java-25-openjdk-amd64/lib/security/blocked.certs -F perm=wa -S open,openat -F key=java21_blockedcerts_mod
-a always,exit -F arch=b64 -F path=/usr/lib/jvm/java-25-openjdk-amd64/lib/security/blocked.certs -F perm=wa -S open,openat -F key=java21_blockedcerts_mod

## Monitor process creation/termination by Java
-a always,exit -F arch=b32 -F exe=/usr/bin/java -S clone,fork,vfork -F success=1 -F key=java_process_create
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S clone,fork,vfork -F success=1 -F key=java_process_create

-a always,exit -F arch=b32 -F exe=/usr/bin/java -S kill,tkill,tgkill -F key=java_process_kill
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S kill,tkill,tgkill -F key=java_process_kill

## Monitor socket operations by Java
-a always,exit -F arch=b32 -F exe=/usr/bin/java -S socket,connect,accept,accept4,bind,listen -F key=java_network
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S socket,connect,accept,accept4,bind,listen -F key=java_network

-a always,exit -F arch=b32 -F exe=/usr/bin/java -S sendto,recvfrom,sendmsg,recvmsg -F key=java_network_data
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S sendto,recvfrom,sendmsg,recvmsg -F key=java_network_data

## Monitor JAR file access
-a always,exit -F arch=b32 -F dir=/usr/share/java/ -F perm=wa -S open,openat,creat -F key=jar_write
-a always,exit -F arch=b64 -F dir=/usr/share/java/ -F perm=wa -S open,openat,creat -F key=jar_write

-a always,exit -F arch=b32 -F dir=/usr/local/share/java/ -F perm=wa -S open,openat,creat -F key=local_jar_write
-a always,exit -F arch=b64 -F dir=/usr/local/share/java/ -F perm=wa -S open,openat,creat -F key=local_jar_write

-a always,exit -F arch=b32 -F dir=/usr/share/java/ -S unlink,unlinkat,rename,renameat -F key=jar_delete
-a always,exit -F arch=b64 -F dir=/usr/share/java/ -S unlink,unlinkat,rename,renameat -F key=jar_delete

-a always,exit -F arch=b32 -F dir=/usr/local/share/java/ -S unlink,unlinkat,rename,renameat -F key=local_jar_delete
-a always,exit -F arch=b64 -F dir=/usr/local/share/java/ -S unlink,unlinkat,rename,renameat -F key=local_jar_delete

## Monitor WAR file operations
-a always,exit -F arch=b32 -F dir=/var/lib/tomcat/webapps/ -F perm=wa -S open,openat,creat -F key=war_write
-a always,exit -F arch=b64 -F dir=/var/lib/tomcat/webapps/ -F perm=wa -S open,openat,creat -F key=war_write

-a always,exit -F arch=b32 -F dir=/var/lib/tomcat/webapps/ -S unlink,unlinkat,rename,renameat -F key=war_delete
-a always,exit -F arch=b64 -F dir=/var/lib/tomcat/webapps/ -S unlink,unlinkat,rename,renameat -F key=war_delete

## Monitor EAR file operations
-a always,exit -F arch=b32 -F dir=/opt/jboss/standalone/deployments/ -F perm=wa -S open,openat,creat -F key=ear_write
-a always,exit -F arch=b64 -F dir=/opt/jboss/standalone/deployments/ -F perm=wa -S open,openat,creat -F key=ear_write

-a always,exit -F arch=b32 -F dir=/opt/jboss/standalone/deployments/ -S unlink,unlinkat,rename,renameat -F key=ear_delete
-a always,exit -F arch=b64 -F dir=/opt/jboss/standalone/deployments/ -S unlink,unlinkat,rename,renameat -F key=ear_delete

## Monitor memory mapping by Java
-a always,exit -F arch=b32 -F exe=/usr/bin/java -S mmap,mprotect,munmap -F key=java_memory_map
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S mmap,mprotect,munmap -F key=java_memory_map

## Monitor file descriptor operations
-a always,exit -F arch=b32 -F exe=/usr/bin/java -S dup,dup2,dup3 -F key=java_fd_dup
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S dup,dup2,dup3 -F key=java_fd_dup

## Monitor shared memory operations
-a always,exit -F arch=b32 -F exe=/usr/bin/java -S shmget,shmat,shmdt,shmctl -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S shmget,shmat,shmdt,shmctl -F key=T1559_Inter-Process_Communication

## Monitor IPC operations
-a always,exit -F arch=b32 -F exe=/usr/bin/java -S msgget,msgctl,msgsnd,msgrcv -F key=java_msg
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S msgget,msgctl,msgsnd,msgrcv -F key=java_msg

-a always,exit -F arch=b32 -F exe=/usr/bin/java -S semget,semctl,semop,semtimedop -F key=java_sem
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S semget,semctl,semop,semtimedop -F key=java_sem

## Monitor privilege escalation attempts
-a always,exit -F arch=b32 -F exe=/usr/bin/java -S setuid,setgid,setreuid,setregid -F key=java_priv_escalation
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S setuid,setgid,setreuid,setregid -F key=java_priv_escalation

-a always,exit -F arch=b32 -F exe=/usr/bin/java -S setresuid,setresgid,setfsuid,setfsgid -F key=java_priv_escalation
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S setresuid,setresgid,setfsuid,setfsgid -F key=java_priv_escalation

## Monitor capability operations
-a always,exit -F arch=b32 -F exe=/usr/bin/java -S capset -F key=java_capabilities
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S capset -F key=java_capabilities

## Monitor Java application logs
-a always,exit -F arch=b32 -F dir=/var/log/java/ -F perm=wa -S open,openat,creat -F key=java_log_write
-a always,exit -F arch=b64 -F dir=/var/log/java/ -F perm=wa -S open,openat,creat -F key=java_log_write

-a always,exit -F arch=b32 -F dir=/var/log/java/ -S unlink,unlinkat,rename,renameat -F key=java_log_delete
-a always,exit -F arch=b64 -F dir=/var/log/java/ -S unlink,unlinkat,rename,renameat -F key=java_log_delete

## Monitor Tomcat logs
-a always,exit -F arch=b32 -F dir=/var/log/tomcat/ -F perm=wa -S open,openat,creat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/log/tomcat/ -F perm=wa -S open,openat,creat -F key=tomcat

-a always,exit -F arch=b32 -F dir=/var/log/tomcat9/ -F perm=wa -S open,openat,creat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/log/tomcat9/ -F perm=wa -S open,openat,creat -F key=tomcat

-a always,exit -F arch=b32 -F dir=/var/log/tomcat10/ -F perm=wa -S open,openat,creat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/log/tomcat10/ -F perm=wa -S open,openat,creat -F key=tomcattomcat

-a always,exit -F arch=b32 -F dir=/var/log/tomcat/ -S unlink,unlinkat,rename,renameat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/log/tomcat/ -S unlink,unlinkat,rename,renameat -F key=tomcat

-a always,exit -F arch=b32 -F dir=/var/log/tomcat9/ -S unlink,unlinkat,rename,renameat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/log/tomcat9/ -S unlink,unlinkat,rename,renameat -F key=tomcat

-a always,exit -F arch=b32 -F dir=/var/log/tomcat10/ -S unlink,unlinkat,rename,renameat -F key=tomcat
-a always,exit -F arch=b64 -F dir=/var/log/tomcat10/ -S unlink,unlinkat,rename,renameat -F key=tomcat

## Monitor Java temp file operations
-a always,exit -F arch=b32 -F dir=/tmp/ -F exe=/usr/bin/java -F perm=wac -S open,openat,creat -F key=java_tmp_create
-a always,exit -F arch=b64 -F dir=/tmp/ -F exe=/usr/bin/java -F perm=wac -S open,openat,creat -F key=java_tmp_create

-a always,exit -F arch=b32 -F dir=/tmp/ -F exe=/usr/bin/java -S unlink,unlinkat -F key=java_tmp_delete
-a always,exit -F arch=b64 -F dir=/tmp/ -F exe=/usr/bin/java -S unlink,unlinkat -F key=java_tmp_delete

-a always,exit -F arch=b32 -F dir=/var/tmp/ -F exe=/usr/bin/java -F perm=wac -S open,openat,creat -F key=java_vartmp_create
-a always,exit -F arch=b64 -F dir=/var/tmp/ -F exe=/usr/bin/java -F perm=wac -S open,openat,creat -F key=java_vartmp_create

-a always,exit -F arch=b32 -F dir=/var/tmp/ -F exe=/usr/bin/java -S unlink,unlinkat -F key=java_vartmp_delete
-a always,exit -F arch=b64 -F dir=/var/tmp/ -F exe=/usr/bin/java -S unlink,unlinkat -F key=java_vartmp_delete

## Monitor native library loading
-a always,exit -F arch=b32 -F dir=/usr/lib/ -F exe=/usr/bin/java -F perm=rx -S open,openat -F key=java_lib_load
-a always,exit -F arch=b64 -F dir=/usr/lib/ -F exe=/usr/bin/java -F perm=rx -S open,openat -F key=java_lib_load

-a always,exit -F arch=b32 -F dir=/usr/lib/jni/ -F exe=/usr/bin/java -F perm=rx -S open,openat -F key=java_jni_load
-a always,exit -F arch=b64 -F dir=/usr/lib/jni/ -F exe=/usr/bin/java -F perm=rx -S open,openat -F key=java_jni_load

-a always,exit -F arch=b32 -F dir=/usr/lib/i386-linux-gnu/jni/ -F exe=/usr/bin/java -F perm=rx -S open,openat -F key=java_jni_i386_load
-a always,exit -F arch=b64 -F dir=/usr/lib/x86_64-linux-gnu/jni/ -F exe=/usr/bin/java -F perm=rx -S open,openat -F key=java_jni_x64_load

## Monitor ptrace operations (debugging)
-a always,exit -F arch=b32 -F exe=/usr/bin/java -S ptrace -F key=java_debug
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S ptrace -F key=java_debug

-a always,exit -F arch=b32 -S ptrace -F a0=0x10 -F key=java_attach
-a always,exit -F arch=b64 -S ptrace -F a0=0x10 -F key=java_attach

-a always,exit -F arch=b32 -F exe=/usr/bin/java -S process_vm_readv,process_vm_writev -F key=java_vm_access
-a always,exit -F arch=b64 -F exe=/usr/bin/java -S process_vm_readv,process_vm_writev -F key=java_vm_access

## Monitor class file operations
-a always,exit -F arch=b32 -F dir=/usr/share/classes/ -F perm=wa -S open,openat,creat -F key=class_file_write
-a always,exit -F arch=b64 -F dir=/usr/share/classes/ -F perm=wa -S open,openat,creat -F key=class_file_write

-a always,exit -F arch=b32 -F dir=/usr/share/classes/ -S unlink,unlinkat,rename,renameat -F key=class_file_delete
-a always,exit -F arch=b64 -F dir=/usr/share/classes/ -S unlink,unlinkat,rename,renameat -F key=class_file_delete

## Monitor Maven directories
-a always,exit -F arch=b32 -F dir=/usr/share/maven/ -F perm=wa -S open,openat,creat -F key=maven_write
-a always,exit -F arch=b64 -F dir=/usr/share/maven/ -F perm=wa -S open,openat,creat -F key=maven_write

-a always,exit -F arch=b32 -F dir=/opt/maven/ -F perm=wa -S open,openat,creat -F key=maven_opt_write
-a always,exit -F arch=b64 -F dir=/opt/maven/ -F perm=wa -S open,openat,creat -F key=maven_opt_write

-a always,exit -F arch=b32 -F path=/usr/bin/mvn -S execve -F key=maven_exec
-a always,exit -F arch=b64 -F path=/usr/bin/mvn -S execve -F key=maven_exec

-a always,exit -F arch=b32 -F path=/opt/maven/bin/mvn -S execve -F key=maven_opt_exec
-a always,exit -F arch=b64 -F path=/opt/maven/bin/mvn -S execve -F key=maven_opt_exec

## Monitor Gradle directories
-a always,exit -F arch=b32 -F dir=/usr/share/gradle/ -F perm=wa -S open,openat,creat -F key=gradle_write
-a always,exit -F arch=b64 -F dir=/usr/share/gradle/ -F perm=wa -S open,openat,creat -F key=gradle_write

-a always,exit -F arch=b32 -F dir=/opt/gradle/ -F perm=wa -S open,openat,creat -F key=gradle_opt_write
-a always,exit -F arch=b64 -F dir=/opt/gradle/ -F perm=wa -S open,openat,creat -F key=gradle_opt_write

-a always,exit -F arch=b32 -F path=/usr/bin/gradle -S execve -F key=gradle_exec
-a always,exit -F arch=b64 -F path=/usr/bin/gradle -S execve -F key=gradle_exec

-a always,exit -F arch=b32 -F path=/opt/gradle/bin/gradle -S execve -F key=gradle_opt_exec
-a always,exit -F arch=b64 -F path=/opt/gradle/bin/gradle -S execve -F key=gradle_opt_exec

# Monitor Ant directories
-a always,exit -F arch=b32 -F dir=/usr/share/ant/ -F perm=wa -S open,openat,creat -F key=ant_write
-a always,exit -F arch=b64 -F dir=/usr/share/ant/ -F perm=wa -S open,openat,creat -F key=ant_write

-a always,exit -F arch=b32 -F path=/usr/bin/ant -S execve -F key=ant_exec
-a always,exit -F arch=b64 -F path=/usr/bin/ant -S execve -F key=ant_exec

## Monitor Spring Boot directories
-a always,exit -F arch=b32 -F dir=/opt/springboot/ -F perm=wa -S open,openat,creat -F key=springboot_write
-a always,exit -F arch=b64 -F dir=/opt/springboot/ -F perm=wa -S open,openat,creat -F key=springboot_write

-a always,exit -F arch=b32 -F dir=/opt/springboot/ -S execve -F key=springboot_exec
-a always,exit -F arch=b64 -F dir=/opt/springboot/ -S execve -F key=springboot_exec

-a always,exit -F arch=b32 -F dir=/opt/springboot/ -S unlink,unlinkat,rename,renameat -F key=springboot_delete
-a always,exit -F arch=b64 -F dir=/opt/springboot/ -S unlink,unlinkat,rename,renameat -F key=springboot_delete

## Monitor microservices directories
-a always,exit -F arch=b32 -F dir=/opt/microservices/ -F perm=wa -S open,openat,creat -F key=microservices_write
-a always,exit -F arch=b64 -F dir=/opt/microservices/ -F perm=wa -S open,openat,creat -F key=microservices_write

-a always,exit -F arch=b32 -F dir=/opt/microservices/ -S execve -F key=microservices_exec
-a always,exit -F arch=b64 -F dir=/opt/microservices/ -S execve -F key=microservices_exec

-a always,exit -F arch=b32 -F dir=/opt/microservices/ -S unlink,unlinkat,rename,renameat -F key=microservices_delete
-a always,exit -F arch=b64 -F dir=/opt/microservices/ -S unlink,unlinkat,rename,renameat -F key=microservices_delete

## Monitor JBoss/WildFly directories
-a always,exit -F arch=b32 -F dir=/opt/jboss/ -F perm=wa -S open,openat,creat -F key=jboss_write
-a always,exit -F arch=b64 -F dir=/opt/jboss/ -F perm=wa -S open,openat,creat -F key=jboss_write

-a always,exit -F arch=b32 -F dir=/opt/wildfly/ -F perm=wa -S open,openat,creat -F key=wildfly_write
-a always,exit -F arch=b64 -F dir=/opt/wildfly/ -F perm=wa -S open,openat,creat -F key=wildfly_write

-a always,exit -F arch=b32 -F dir=/opt/jboss/ -S execve -F key=jboss_exec
-a always,exit -F arch=b64 -F dir=/opt/jboss/ -S execve -F key=jboss_exec

-a always,exit -F arch=b32 -F dir=/opt/wildfly/ -S execve -F key=wildfly_exec
-a always,exit -F arch=b64 -F dir=/opt/wildfly/ -S execve -F key=wildfly_exec

-a always,exit -F arch=b32 -F dir=/opt/jboss/ -S unlink,unlinkat,rename,renameat -F key=jboss_delete
-a always,exit -F arch=b64 -F dir=/opt/jboss/ -S unlink,unlinkat,rename,renameat -F key=jboss_delete

-a always,exit -F arch=b32 -F dir=/opt/wildfly/ -S unlink,unlinkat,rename,renameat -F key=wildfly_delete
-a always,exit -F arch=b64 -F dir=/opt/wildfly/ -S unlink,unlinkat,rename,renameat -F key=wildfly_delete

## Monitor Jetty directories
-a always,exit -F arch=b32 -F dir=/opt/jetty/ -F perm=wa -S open,openat,creat -F key=jetty_write
-a always,exit -F arch=b64 -F dir=/opt/jetty/ -F perm=wa -S open,openat,creat -F key=jetty_write

-a always,exit -F arch=b32 -F dir=/usr/share/jetty/ -F perm=wa -S open,openat,creat -F key=jetty_share_write
-a always,exit -F arch=b64 -F dir=/usr/share/jetty/ -F perm=wa -S open,openat,creat -F key=jetty_share_write

-a always,exit -F arch=b32 -F dir=/opt/jetty/ -S execve -F key=jetty_exec
-a always,exit -F arch=b64 -F dir=/opt/jetty/ -S execve -F key=jetty_exec

-a always,exit -F arch=b32 -F dir=/opt/jetty/ -S unlink,unlinkat,rename,renameat -F key=jetty_delete
-a always,exit -F arch=b64 -F dir=/opt/jetty/ -S unlink,unlinkat,rename,renameat -F key=jetty_delete

## Monitor GlassFish/Payara directories
-a always,exit -F arch=b32 -F dir=/opt/glassfish/ -F perm=wa -S open,openat,creat -F key=glassfish_write
-a always,exit -F arch=b64 -F dir=/opt/glassfish/ -F perm=wa -S open,openat,creat -F key=glassfish_write

-a always,exit -F arch=b32 -F dir=/opt/payara/ -F perm=wa -S open,openat,creat -F key=payara_write
-a always,exit -F arch=b64 -F dir=/opt/payara/ -F perm=wa -S open,openat,creat -F key=payara_write

-a always,exit -F arch=b32 -F dir=/opt/glassfish/ -S execve -F key=glassfish_exec
-a always,exit -F arch=b64 -F dir=/opt/glassfish/ -S execve -F key=glassfish_exec

-a always,exit -F arch=b32 -F dir=/opt/payara/ -S execve -F key=payara_exec
-a always,exit -F arch=b64 -F dir=/opt/payara/ -S execve -F key=payara_exec

# tomcat
-a always,exit -F arch=b32 -F dir=/usr/local/tomcat/conf/ -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F dir=/usr/local/tomcat/conf/ -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F path=/opt/tomcat/latest/conf/tomcat-users.xml -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/opt/tomcat/latest/conf/tomcat-users.xml -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F dir=/opt/tomcat/latest/conf/ -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F dir=/opt/tomcat/latest/conf/ -F perm=wa -F key=tomcat

## tomcat 8
-a always,exit -F arch=b32 -F path=/opt/tomcat8/conf/server.xml -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/opt/tomcat8/conf/server.xml -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F dir=/opt/tomcat8/conf/ -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F dir=/opt/tomcat8/conf/ -F perm=wa -F key=tomcat

## tomcat 9
-a always,exit -F arch=b32 -F path=/etc/tomcat9/web.xml -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/etc/tomcat9/web.xml -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F dir=/etc/tomcat9/ -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F dir=/etc/tomcat9/ -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F dir=/usr/share/tomcat9/etc/ -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F dir=/usr/share/tomcat9/etc/ -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F path=/usr/lib/sysusers.d/tomcat9.conf -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/usr/lib/sysusers.d/tomcat9.conf -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F path=/usr/lib/tmpfiles.d/tomcat9.conf -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/usr/lib/tmpfiles.d/tomcat9.conf -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F path=/usr/libexec/tomcat9/tomcat-start.sh -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/usr/libexec/tomcat9/tomcat-start.sh -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F path=/usr/libexec/tomcat9/tomcat-update-policy.sh -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/usr/libexec/tomcat9/tomcat-update-policy.sh -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F path=/var/lib/tomcat9/conf -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/var/lib/tomcat9/conf -F perm=wa -F key=tomcat

## tomcat 10
-a always,exit -F arch=b32 -F path=/etc/tomcat10/web.xml -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/etc/tomcat10/web.xml -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F dir=/etc/tomcat10/ -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F dir=/etc/tomcat10/ -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F dir=/usr/share/tomcat10/etc/ -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F dir=/usr/share/tomcat10/etc/ -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F path=/usr/lib/sysusers.d/tomcat10.conf -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/usr/lib/sysusers.d/tomcat10.conf -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F path=/usr/lib/tmpfiles.d/tomcat10.conf -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/usr/lib/tmpfiles.d/tomcat10.conf -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F path=/usr/libexec/tomcat10/tomcat-start.sh -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/usr/libexec/tomcat10/tomcat-start.sh -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F path=/usr/libexec/tomcat10/tomcat-update-policy.sh -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/usr/libexec/tomcat10/tomcat-update-policy.sh -F perm=wa -F key=tomcat

-a always,exit -F arch=b32 -F path=/var/lib/tomcat10/conf -F perm=wa -F key=tomcat
-a always,exit -F arch=b64 -F path=/var/lib/tomcat10/conf -F perm=wa -F key=tomcat

# openvpn
-a always,exit -F arch=b32 -F dir=/etc/openvpn/ -F perm=wa -F key=openvpn
-a always,exit -F arch=b64 -F dir=/etc/openvpn/ -F perm=wa -F key=openvpn

-a always,exit -F arch=b32 -F path=/bin/openvpn -F perm=x -F key=openvpn
-a always,exit -F arch=b64 -F path=/bin/openvpn -F perm=x -F key=openvpn

-a always,exit -F arch=b32 -F path=/sbin/openvpn -F perm=x -F key=openvpn
-a always,exit -F arch=b64 -F path=/sbin/openvpn -F perm=x -F key=openvpn

-a always,exit -F arch=b32 -F path=/usr/bin/openvpn -F perm=x -F key=openvpn
-a always,exit -F arch=b64 -F path=/usr/bin/openvpn -F perm=x -F key=openvpn

-a always,exit -F arch=b32 -F path=/usr/sbin/openvpn -F perm=x -F key=openvpn
-a always,exit -F arch=b64 -F path=/usr/sbin/openvpn -F perm=x -F key=openvpn

-a always,exit -F arch=b32 -F path=/usr/local/bin/openvpn -F perm=x -F key=openvpn
-a always,exit -F arch=b64 -F path=/usr/local/bin/openvpn -F perm=x -F key=openvpn

-a always,exit -F arch=b32 -F path=/usr/local/sbin/openvpn -F perm=x -F key=openvpn
-a always,exit -F arch=b64 -F path=/usr/local/sbin/openvpn -F perm=x -F key=openvpn

# wireguard
-a always,exit -F arch=b32 -F path=/etc/wireguard/wg0.conf -F perm=wa -F key=wireguard
-a always,exit -F arch=b64 -F path=/etc/wireguard/wg0.conf -F perm=wa -F key=wireguard

-a always,exit -F arch=b32 -F path=/etc/wireguard/wg-client.conf -F perm=wa -F key=wireguard
-a always,exit -F arch=b64 -F path=/etc/wireguard/wg-client.conf -F perm=wa -F key=wireguard

-a always,exit -F arch=b32 -F dir=/etc/wireguard/ -F perm=wa -F key=wireguard
-a always,exit -F arch=b64 -F dir=/etc/wireguard/ -F perm=wa -F key=wireguard

# ipsec
-a always,exit -F arch=b32 -F path=/etc/ipsec.conf -F perm=wa -F key=ipsec
-a always,exit -F arch=b64 -F path=/etc/ipsec.conf -F perm=wa -F key=ipsec

-a always,exit -F arch=b32 -F path=/etc/ipsec.d/certs -F perm=wa -F key=ipsec
-a always,exit -F arch=b64 -F path=/etc/ipsec.d/certs -F perm=wa -F key=ipsec

-a always,exit -F arch=b32 -F dir=/etc/ipsec.d/ -F perm=wa -F key=ipsec
-a always,exit -F arch=b64 -F dir=/etc/ipsec.d/ -F perm=wa -F key=ipsec

# nginx
## https://docs.nginx.com/nginx/admin-guide/basic-functionality/managing-configuration-files/
-a always,exit -F arch=b32 -F path=/etc/nginx/nginx.conf -F perm=wa -F key=nginx
-a always,exit -F arch=b64 -F path=/etc/nginx/nginx.conf -F perm=wa -F key=nginx

-a always,exit -F arch=b32 -F path=/usr/local/nginx/conf/nginx.conf -F perm=wa -F key=nginx
-a always,exit -F arch=b64 -F path=/usr/local/nginx/conf/nginx.conf -F perm=wa -F key=nginx

-a always,exit -F arch=b32 -F path=/usr/local/etc/nginx/nginx.conf -F perm=wa -F key=nginx
-a always,exit -F arch=b64 -F path=/usr/local/etc/nginx/nginx.conf -F perm=wa -F key=nginx

-a always,exit -F arch=b32 -F dir=/etc/nginx/ -F perm=wa -F key=nginx
-a always,exit -F arch=b64 -F dir=/etc/nginx/ -F perm=wa -F key=nginx

-a always,exit -F arch=b32 -F dir=/etc/nginx/conf.d/ -F perm=wa -F key=nginx
-a always,exit -F arch=b64 -F dir=/etc/nginx/conf.d/ -F perm=wa -F key=nginx

# OpenVAS (Open Vulnerability Assessment System)

## Monitor OpenVAS scanner configuration file
-a always,exit -F arch=b32 -F path=/etc/openvas/openvas.conf -F perm=wa -F key=openvas
-a always,exit -F arch=b64 -F path=/etc/openvas/openvas.conf -F perm=wa -F key=openvas

## Monitor OpenVAS configuration directory (non-recursive watch)
-a always,exit -F arch=b32 -F dir=/etc/openvas/ -F perm=wa -F key=openvas
-a always,exit -F arch=b64 -F dir=/etc/openvas/ -F perm=wa -F key=openvas

## Monitor specific OpenVAS SSL certificate files
-a always,exit -F arch=b32 -F path=/etc/openvas/ssl/cert.pem -F perm=wa -F key=openvas
-a always,exit -F arch=b64 -F path=/etc/openvas/ssl/cert.pem -F perm=wa -F key=openvas

-a always,exit -F arch=b32 -F path=/etc/openvas/ssl/key.pem -F perm=wa -F key=openvas
-a always,exit -F arch=b64 -F path=/etc/openvas/ssl/key.pem -F perm=wa -F key=openvas

-a always,exit -F arch=b32 -F path=/etc/openvas/ssl/dhparam.pem -F perm=wa -F key=openvas
-a always,exit -F arch=b64 -F path=/etc/openvas/ssl/dhparam.pem -F perm=wa -F key=openvas

## Monitor OpenVAS SSL directory
-a always,exit -F arch=b32 -F dir=/etc/openvas/ssl/ -F perm=wa -F key=openvas
-a always,exit -F arch=b64 -F dir=/etc/openvas/ssl/ -F perm=wa -F key=openvas

## Monitor OpenVAS data directory (non-recursive watch)
-a always,exit -F arch=b32 -F dir=/var/lib/openvas/ -F perm=wa -F key=openvas
-a always,exit -F arch=b64 -F dir=/var/lib/openvas/ -F perm=wa -F key=openvas

## Monitor OpenVAS executables for execution
-a always,exit -F arch=b32 -S execve -F path=/usr/bin/openvas -F perm=x -F key=openvas
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/openvas -F perm=x -F key=openvas

## Monitor OpenVAS scanner executable
-a always,exit -F arch=b32 -S execve -F path=/usr/sbin/openvassd -F perm=x -F key=openvas
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/openvassd -F perm=x -F key=openvas

## Monitor OpenVAS manager executable
-a always,exit -F arch=b32 -S execve -F path=/usr/sbin/openvasmd -F perm=x -F key=openvas
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/openvasmd -F perm=x -F key=openvas

## Monitor OpenVAS CLI executable
-a always,exit -F arch=b32 -S execve -F path=/usr/bin/omp -F perm=x -F key=openvas
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/omp -F perm=x -F key=openvas

## Monitor OpenVAS certificates directory
-a always,exit -F arch=b32 -F dir=/var/lib/openvas/CA/ -F perm=wa -F key=openvas
-a always,exit -F arch=b64 -F dir=/var/lib/openvas/CA/ -F perm=wa -F key=openvas

## Monitor OpenVAS private keys directory
-a always,exit -F arch=b32 -F dir=/var/lib/openvas/private/CA/ -F perm=wa -F key=openvas
-a always,exit -F arch=b64 -F dir=/var/lib/openvas/private/CA/ -F perm=wa -F key=openvas

## Monitor OpenVAS NVT feed plugins directory
-a always,exit -F arch=b32 -F dir=/var/lib/openvas/plugins/ -F perm=wa -F key=openvas
-a always,exit -F arch=b64 -F dir=/var/lib/openvas/plugins/ -F perm=wa -F key=openvas

## Monitor OpenVAS logs directory
-a always,exit -F arch=b32 -F dir=/var/log/openvas/ -F perm=wa -F key=openvas
-a always,exit -F arch=b64 -F dir=/var/log/openvas/ -F perm=wa -F key=openvas

# NGINX

## Monitor NGINX config directories
-a always,exit -F arch=b32 -F dir=/etc/nginx/ -F perm=wa -F key=nginx
-a always,exit -F arch=b64 -F dir=/etc/nginx/ -F perm=wa -F key=nginx

-a always,exit -F arch=b32 -F dir=/usr/local/nginx/conf/ -F perm=wa -F key=nginx
-a always,exit -F arch=b64 -F dir=/usr/local/nginx/conf/ -F perm=wa -F key=nginx

-a always,exit -F arch=b32 -F dir=/usr/local/etc/nginx/ -F perm=wa -F key=nginx
-a always,exit -F arch=b64 -F dir=/usr/local/etc/nginx/ -F perm=wa -F key=nginx


# zookeeper
## https://zookeeper.apache.org/
-a always,exit -F arch=b32 -F path=/opt/zookeeper/conf/zoo.cfg -F perm=wa -F key=zookeeper
-a always,exit -F arch=b64 -F path=/opt/zookeeper/conf/zoo.cfg -F perm=wa -F key=zookeeper

-a always,exit -F arch=b32 -F path=/opt/zookeeper/conf/java.env -F perm=wa -F key=zookeeper
-a always,exit -F arch=b64 -F path=/opt/zookeeper/conf/java.env -F perm=wa -F key=zookeeper

-a always,exit -F arch=b32 -F dir=/opt/zookeeper/conf/ -F perm=wa -F key=zookeeper
-a always,exit -F arch=b64 -F dir=/opt/zookeeper/conf/ -F perm=wa -F key=zookeeper

-a always,exit -F arch=b32 -F path=/opt/zookeeper/bin/zkServer.sh -F perm=x -F key=zookeeper
-a always,exit -F arch=b64 -F path=/opt/zookeeper/bin/zkServer.sh -F perm=x -F key=zookeeper

# Solr
-a always,exit -F arch=b32 -F path=/etc/default/solr.in.sh -F perm=wa -F key=solr
-a always,exit -F arch=b64 -F path=/etc/default/solr.in.sh -F perm=wa -F key=solr

-a always,exit -F arch=b32 -F path=/opt/solr/server/solr/solr.xml -F perm=wa -F key=solr
-a always,exit -F arch=b64 -F path=/opt/solr/server/solr/solr.xml -F perm=wa -F key=solr

-a always,exit -F arch=b32 -F dir=/opt/solrSSL/ -F perm=wa -F key=solr
-a always,exit -F arch=b64 -F dir=/opt/solrSSL/ -F perm=wa -F key=solr

# fail2ban
-a always,exit -F arch=b32 -F path=/etc/fail2ban/fail2ban.conf -F perm=wa -F key=fail2ban
-a always,exit -F arch=b64 -F path=/etc/fail2ban/fail2ban.conf -F perm=wa -F key=fail2ban

-a always,exit -F arch=b32 -F path=/etc/fail2ban/jail.conf -F perm=wa -F key=fail2ban
-a always,exit -F arch=b64 -F path=/etc/fail2ban/jail.conf -F perm=wa -F key=fail2ban

-a always,exit -F arch=b32 -F dir=/etc/fail2ban/ -F perm=wa -F key=fail2ban
-a always,exit -F arch=b64 -F dir=/etc/fail2ban/ -F perm=wa -F key=fail2ban

-a always,exit -F arch=b32 -F dir=/etc/fail2ban/filter.d/ -F perm=wa -F key=fail2ban
-a always,exit -F arch=b64 -F dir=/etc/fail2ban/filter.d/ -F perm=wa -F key=fail2ban

# sshguard
-a always,exit -F arch=b32 -F path=/etc/sshguard/sshguard.conf -F perm=x -F key=sshguard
-a always,exit -F arch=b64 -F path=/etc/sshguard/sshguard.conf -F perm=x -F key=sshguard

-a always,exit -F arch=b32 -F dir=/etc/sshguard/ -F perm=x -F key=sshguard
-a always,exit -F arch=b64 -F dir=/etc/sshguard/ -F perm=x -F key=sshguard

-a always,exit -F arch=b32 -F path=/usr/sbin/sshguard -F perm=x -F key=sshguard
-a always,exit -F arch=b64 -F path=/usr/sbin/sshguard -F perm=x -F key=sshguard

# usbguard
-a always,exit -F arch=b32 -F path=/etc/usbguard/usbguard-daemon.conf -F perm=wa -F key=usbguard
-a always,exit -F arch=b64 -F path=/etc/usbguard/usbguard-daemon.conf -F perm=wa -F key=usbguard

-a always,exit -F arch=b32 -F path=/etc/logrotate.d/usbguard -F perm=wa -F key=usbguard
-a always,exit -F arch=b64 -F path=/etc/logrotate.d/usbguard -F perm=wa -F key=usbguard

-a always,exit -F arch=b32 -F dir=/etc/usbguard/ -F perm=wa -F key=usbguard
-a always,exit -F arch=b64 -F dir=/etc/usbguard/ -F perm=wa -F key=usbguard

-a always,exit -F arch=b32 -F path=/etc/init.d/usbguard -F perm=wa -F key=usbguard
-a always,exit -F arch=b64 -F path=/etc/init.d/usbguard -F perm=wa -F key=usbguard

-a always,exit -F arch=b32 -F path=/etc/init.d/usbguard-dbus -F perm=wa -F key=usbguard
-a always,exit -F arch=b64 -F path=/etc/init.d/usbguard-dbus -F perm=wa -F key=usbguard

-a always,exit -F arch=b32 -F path=/usr/bin/usbguard -F perm=x -F key=usbguard
-a always,exit -F arch=b64 -F path=/usr/bin/usbguard -F perm=x -F key=usbguard

-a always,exit -F arch=b32 -F path=/usr/sbin/usbguard -F perm=x -F key=usbguard
-a always,exit -F arch=b64 -F path=/usr/sbin/usbguard -F perm=x -F key=usbguard

-a always,exit -F arch=b32 -F path=/usr/bin/usbguard-daemon -F perm=x -F key=usbguard
-a always,exit -F arch=b64 -F path=/usr/bin/usbguard-daemon -F perm=x -F key=usbguard

-a always,exit -F arch=b32 -F path=/usr/sbin/usbguard-daemon -F perm=x -F key=usbguard
-a always,exit -F arch=b64 -F path=/usr/sbin/usbguard-daemon -F perm=x -F key=usbguard

-a always,exit -F arch=b32 -F path=/usr/bin/usbguard-dbus -F perm=x -F key=usbguard
-a always,exit -F arch=b64 -F path=/usr/bin/usbguard-dbus -F perm=x -F key=usbguard

# ppp
## https://linux.die.net/man/5/pppoe.conf
-a always,exit -F arch=b32 -F path=/etc/ppp/resolv.conf -F perm=wa -F key=ppp
-a always,exit -F arch=b64 -F path=/etc/ppp/resolv.conf -F perm=wa -F key=ppp

-a always,exit -F arch=b32 -F dir=/etc/ppp/ -F perm=wa -F key=ppp
-a always,exit -F arch=b64 -F dir=/etc/ppp/ -F perm=wa -F key=ppp

# haproxy
-a always,exit -F arch=b32 -F path=/etc/haproxy/haproxy.cfg -F perm=wa -F key=haproxy
-a always,exit -F arch=b64 -F path=/etc/haproxy/haproxy.cfg -F perm=wa -F key=haproxy

-a always,exit -F arch=b32 -F path=/etc/firewalld/services/haproxy-http.xml -F perm=wa -F key=haproxy
-a always,exit -F arch=b64 -F path=/etc/firewalld/services/haproxy-http.xml -F perm=wa -F key=haproxy

-a always,exit -F arch=b32 -F path=/etc/keepalived/keepalived.conf -F perm=wa -F key=haproxy
-a always,exit -F arch=b64 -F path=/etc/keepalived/keepalived.conf -F perm=wa -F key=haproxy

-a always,exit -F arch=b32 -F dir=/etc/keepalived/ -F perm=wa -F key=haproxy
-a always,exit -F arch=b64 -F dir=/etc/keepalived/ -F perm=wa -F key=haproxy

-a always,exit -F arch=b32 -F dir=/etc/default/haproxy/ -F perm=wa -F key=haproxy
-a always,exit -F arch=b64 -F dir=/etc/default/haproxy/ -F perm=wa -F key=haproxy

-a always,exit -F arch=b32 -F dir=/etc/haproxy/ -F perm=wa -F key=haproxy
-a always,exit -F arch=b64 -F dir=/etc/haproxy/ -F perm=wa -F key=haproxy

-a always,exit -F arch=b32 -F path=/etc/rsyslog.d/49-haproxy.conf -F perm=wa -F key=haproxy
-a always,exit -F arch=b64 -F path=/etc/rsyslog.d/49-haproxy.conf -F perm=wa -F key=haproxy

-a always,exit -F arch=b32 -F path=/lib/systemd/system/haproxy.service -F perm=wa -F key=haproxy
-a always,exit -F arch=b64 -F path=/lib/systemd/system/haproxy.service -F perm=wa -F key=haproxy

-a always,exit -F arch=b32 -F path=/usr/bin/halog -F perm=x -F key=haproxy
-a always,exit -F arch=b64 -F path=/usr/bin/halog -F perm=x -F key=haproxy

-a always,exit -F arch=b32 -F path=/usr/sbin/halog -F perm=x -F key=haproxy
-a always,exit -F arch=b64 -F path=/usr/sbin/halog -F perm=x -F key=haproxy

-a always,exit -F arch=b32 -F path=/usr/sbin/haproxy -F perm=x -F key=haproxy
-a always,exit -F arch=b64 -F path=/usr/sbin/haproxy -F perm=x -F key=haproxy

# pacemaker
## pacemaker-common
-a always,exit -F arch=b32 -F path=/etc/sysconfig/pacemaker -F perm=wa -F key=pacemaker
-a always,exit -F arch=b64 -F path=/etc/sysconfig/pacemaker -F perm=wa -F key=pacemaker

-a always,exit -F arch=b32 -F path=/etc/default/pacemaker -F perm=wa -F key=pacemaker
-a always,exit -F arch=b64 -F path=/etc/default/pacemaker -F perm=wa -F key=pacemaker

## pacemaker corosync
-a always,exit -F arch=b32 -F path=/etc/corosync/corosync.conf -F perm=wa -F key=pacemaker
-a always,exit -F arch=b64 -F path=/etc/corosync/corosync.conf -F perm=wa -F key=pacemaker

-a always,exit -F arch=b32 -F path=/etc/default/corosync -F perm=wa -F key=pacemaker
-a always,exit -F arch=b64 -F path=/etc/default/corosync -F perm=wa -F key=pacemaker

## pacemaker cluster manager
-a always,exit -F arch=b32 -F path=/etc/crm/crm.conf -F perm=wa -F key=pacemaker
-a always,exit -F arch=b64 -F path=/etc/crm/crm.conf -F perm=wa -F key=pacemaker

-a always,exit -F arch=b32 -F path=/etc/crm/profiles.yml -F perm=wa -F key=pacemaker
-a always,exit -F arch=b64 -F path=/etc/crm/profiles.yml -F perm=wa -F key=pacemaker

-a always,exit -F arch=b32 -F dir=/etc/crm/ -F perm=wa -F key=pacemaker
-a always,exit -F arch=b64 -F dir=/etc/crm/ -F perm=wa -F key=pacemaker

-a always,exit -F arch=b32 -F dir=/usr/sbin/crm/ -F perm=x -F key=pacemaker
-a always,exit -F arch=b64 -F dir=/usr/sbin/crm/ -F perm=x -F key=pacemaker

-a always,exit -F arch=b32 -F dir=/usr/share/crmsh/scripts/ -F perm=x -F key=pacemaker
-a always,exit -F arch=b64 -F dir=/usr/share/crmsh/scripts/ -F perm=x -F key=pacemaker

## pacemaker pcs
-a always,exit -F arch=b32 -F path=/etc/default/pcsd -F perm=wa -F key=pacemaker
-a always,exit -F arch=b64 -F path=/etc/default/pcsd -F perm=wa -F key=pacemaker

-a always,exit -F arch=b32 -F path=/etc/pam.d/pcsd -F perm=wa -F key=pacemaker
-a always,exit -F arch=b64 -F path=/etc/pam.d/pcsd -F perm=wa -F key=pacemaker

-a always,exit -F arch=b32 -F dir=/usr/sbin/pcs/ -F perm=x -F key=pacemaker
-a always,exit -F arch=b64 -F dir=/usr/sbin/pcs/ -F perm=x -F key=pacemaker

-a always,exit -F arch=b32 -F dir=/usr/sbin/pcsd/ -F perm=x -F key=pacemaker
-a always,exit -F arch=b64 -F dir=/usr/sbin/pcsd/ -F perm=x -F key=pacemaker

# mysql
-a always,exit -F arch=b32 -F path=/etc/my.cnf -F perm=wa -F key=mysql
-a always,exit -F arch=b64 -F path=/etc/my.cnf -F perm=wa -F key=mysql

-a always,exit -F arch=b32 -F path=/etc/mysql/my.cnf -F perm=wa -F key=mysql
-a always,exit -F arch=b64 -F path=/etc/mysql/my.cnf -F perm=wa -F key=mysql

-a always,exit -F arch=b32 -F dir=/etc/mysql/ -F perm=wa -F key=mysql
-a always,exit -F arch=b64 -F dir=/etc/mysql/ -F perm=wa -F key=mysql

# PostgreSQL
-a always,exit -F arch=b32 -F path=/etc/postgresql/18/main/postgresql.conf -F perm=wa -F key=postgresql
-a always,exit -F arch=b64 -F path=/etc/postgresql/18/main/postgresql.conf -F perm=wa -F key=postgresql

-a always,exit -F arch=b32 -F path=/etc/postgresql/17/main/postgresql.conf -F perm=wa -F key=postgresql
-a always,exit -F arch=b64 -F path=/etc/postgresql/17/main/postgresql.conf -F perm=wa -F key=postgresql

-a always,exit -F arch=b32 -F path=/etc/postgresql/16/main/postgresql.conf -F perm=wa -F key=postgresql
-a always,exit -F arch=b64 -F path=/etc/postgresql/16/main/postgresql.conf -F perm=wa -F key=postgresql

-a always,exit -F arch=b32 -F path=/etc/postgresql/15/main/postgresql.conf -F perm=wa -F key=postgresql
-a always,exit -F arch=b64 -F path=/etc/postgresql/15/main/postgresql.conf -F perm=wa -F key=postgresql

-a always,exit -F arch=b32 -F path=/etc/postgresql/14/main/postgresql.conf -F perm=wa -F key=postgresql
-a always,exit -F arch=b64 -F path=/etc/postgresql/14/main/postgresql.conf -F perm=wa -F key=postgresql

-a always,exit -F arch=b32 -F path=/etc/postgresql/13/main/postgresql.conf -F perm=wa -F key=postgresql
-a always,exit -F arch=b64 -F path=/etc/postgresql/13/main/postgresql.conf -F perm=wa -F key=postgresql

-a always,exit -F arch=b32 -F path=/etc/postgresql/12/main/postgresql.conf -F perm=wa -F key=postgresql
-a always,exit -F arch=b64 -F path=/etc/postgresql/12/main/postgresql.conf -F perm=wa -F key=postgresql

-a always,exit -F arch=b32 -F path=/etc/postgresql/11/main/postgresql.conf -F perm=wa -F key=postgresql
-a always,exit -F arch=b64 -F path=/etc/postgresql/11/main/postgresql.conf -F perm=wa -F key=postgresql

-a always,exit -F arch=b32 -F dir=/etc/postgresql/ -F perm=wa -F key=postgresql
-a always,exit -F arch=b64 -F dir=/etc/postgresql/ -F perm=wa -F key=postgresql

-a always,exit -F arch=b32 -F path=/var/lib/pgsql/data/postgresql.conf -F perm=wa -F key=postgresql
-a always,exit -F arch=b64 -F path=/var/lib/pgsql/data/postgresql.conf -F perm=wa -F key=postgresql

-a always,exit -F arch=b32 -F path=/var/lib/postgresql/18/data/postgresql.conf -F perm=wa -F key=postgresql
-a always,exit -F arch=b32 -F path=/var/lib/postgresql/18/data/postgresql.conf -F perm=wa -F key=postgresql

-a always,exit -F arch=b32 -F path=/var/lib/postgresql/17/data/postgresql.conf -F perm=wa -F key=postgresql
-a always,exit -F arch=b32 -F path=/var/lib/postgresql/17/data/postgresql.conf -F perm=wa -F key=postgresql

-a always,exit -F arch=b32 -F path=/var/lib/postgresql/16/data/postgresql.conf -F perm=wa -F key=postgresql
-a always,exit -F arch=b32 -F path=/var/lib/postgresql/16/data/postgresql.conf -F perm=wa -F key=postgresql

-a always,exit -F arch=b32 -F path=/var/lib/postgresql/15/data/postgresql.conf -F perm=wa -F key=postgresql
-a always,exit -F arch=b32 -F path=/var/lib/postgresql/15/data/postgresql.conf -F perm=wa -F key=postgresql

# GitLab
## creat syscall exists on 32-bit x86 systems and is still supported there.
## On 64-bit x86_64, creat syscall is typically not present as a separate syscall, and its functionality is handled by open.

## fullchain.crt
-a always,exit -F arch=b32 -F path=/etc/letsencrypt/live/gitlab/fullchain.crt -F perm=wa -F key=gitlab
-a always,exit -F arch=b32 -F path=/etc/letsencrypt/live/gitlab/fullchain.crt -F perm=wa -F key=gitlab

-a always,exit -F arch=b32 -S open,openat,creat -F path=/etc/letsencrypt/live/gitlab/fullchain.crt -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=gitlab
-a always,exit -F arch=b64 -S open,openat -F path=/etc/letsencrypt/live/gitlab/fullchain.crt -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=gitlab

## privkey.pem
-a always,exit -F arch=b32 -F path=/etc/letsencrypt/live/gitlab/privkey.pem -F perm=wa -F key=gitlab
-a always,exit -F arch=b32 -F path=/etc/letsencrypt/live/gitlab/privkey.pem -F perm=wa -F key=gitlab

-a always,exit -F arch=b32 -S open,openat,creat -F path=/etc/letsencrypt/live/gitlab/privkey.pem -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=gitlab
-a always,exit -F arch=b64 -S open,openat -F path=/etc/letsencrypt/live/gitlab/privkey.pem -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=gitlab

## GitLab Project Auth Config
-a always,exit -F arch=b32 -F path=/etc/apt/auth.conf.d/gitlab_project.conf -F perm=wa -F key=gitlab
-a always,exit -F arch=b32 -F path=/etc/apt/auth.conf.d/gitlab_project.conf -F perm=wa -F key=gitlab

-a always,exit -F arch=b32 -S open,openat,creat -F path=/etc/apt/auth.conf.d/gitlab_project.conf -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=gitlab
-a always,exit -F arch=b64 -S open,openat -F path=/etc/apt/auth.conf.d/gitlab_project.conf -F perm=wa -F "auid>=500" -F "auid!=-1" -F key=gitlab

## GitLab Secrets
-a always,exit -F arch=b32 -F path=/etc/letsencrypt/live/gitlab/privkey.pem -F perm=wa -F key=gitlab
-a always,exit -F arch=b32 -F path=/etc/letsencrypt/live/gitlab/privkey.pem -F perm=wa -F key=gitlab

-a always,exit -F arch=b32 -F path=/etc/gitlab/gitlab-secrets.json -F perm=wa -F key=gitlab
-a always,exit -F arch=b32 -F path=/etc/gitlab/gitlab-secrets.json -F perm=wa -F key=gitlab

## GitLab Sensitive Directories
-a always,exit -F arch=b32 -F dir=/etc/gitlab/ssl/ -F perm=wa -F key=gitlab
-a always,exit -F arch=b64 -F dir=/etc/gitlab/ssl/ -F perm=wa -F key=gitlab

-a always,exit -F arch=b32 -F dir=/etc/gitlab/ -F perm=wa -F key=gitlab
-a always,exit -F arch=b64 -F dir=/etc/gitlab/ -F perm=wa -F key=gitlab

-a always,exit -F arch=b32 -F dir=/var/opt/gitlab/ -F perm=wa -F key=gitlab
-a always,exit -F arch=b64 -F dir=/var/opt/gitlab/ -F perm=wa -F key=gitlab

-a always,exit -F arch=b32 -F dir=/etc/letsencrypt/live/gitlab/ -F perm=wa -F key=gitlab
-a always,exit -F arch=b64 -F dir=/etc/letsencrypt/live/gitlab/ -F perm=wa -F key=gitlab

-a always,exit -F arch=b32 -F dir=/usr/local/share/ca-certificates/ -F perm=wa -F key=gitlab
-a always,exit -F arch=b64 -F dir=/usr/local/share/ca-certificates/ -F perm=wa -F key=gitlab

-a always,exit -F arch=b32 -F dir=/usr/local/share/keyrings/ -F perm=wa -F key=gitlab
-a always,exit -F arch=b64 -F dir=/usr/local/share/keyrings/ -F perm=wa -F key=gitlab

-a always,exit -F arch=b32 -F dir=/var/opt/gitlab/ -F perm=x -F key=gitlab
-a always,exit -F arch=b64 -F dir=/var/opt/gitlab/ -F perm=x -F key=gitlab

# Redis
## Debian
-a always,exit -F arch=b32 -F path=/etc/redis/redis.conf -F perm=wa -F key=redis
-a always,exit -F arch=b64 -F path=/etc/redis/redis.conf -F perm=wa -F key=redis

## RHEL
-a always,exit -F arch=b32 -F path=/etc/redis.conf -F perm=wa -F key=redis
-a always,exit -F arch=b64 -F path=/etc/redis.conf -F perm=wa -F key=redis

-a always,exit -F arch=b32 -F dir=/etc/redis/ -F perm=wa -F key=redis
-a always,exit -F arch=b64 -F dir=/etc/redis/ -F perm=wa -F key=redis

-a always,exit -F arch=b32 -F dir=/var/lib/redis/ -F perm=wa -F key=redis
-a always,exit -F arch=b64 -F dir=/var/lib/redis/ -F perm=wa -F key=redis

# Redict (fork of Redis)
## Debian
-a always,exit -F arch=b32 -F path=/etc/redict/redict.conf -F perm=wa -F key=redict
-a always,exit -F arch=b64 -F path=/etc/redict/redict.conf -F perm=wa -F key=redict

## RHEL
-a always,exit -F arch=b32 -F path=/etc/redict.conf -F perm=wa -F key=redict
-a always,exit -F arch=b64 -F path=/etc/redict.conf -F perm=wa -F key=redict

-a always,exit -F arch=b32 -F dir=/etc/redict/ -F perm=wa -F key=redict
-a always,exit -F arch=b64 -F dir=/etc/redict/ -F perm=wa -F key=redict

-a always,exit -F arch=b32 -F dir=/var/lib/redict/ -F perm=wa -F key=redict
-a always,exit -F arch=b64 -F dir=/var/lib/redict/ -F perm=wa -F key=redict

# coredns
-a always,exit -F arch=b32 -F path=/etc/coredns/Corefile -F perm=wa -F key=coredns
-a always,exit -F arch=b64 -F path=/etc/coredns/Corefile -F perm=wa -F key=coredns

-a always,exit -F arch=b32 -F path=/etc/coredns/ca.pem -F perm=wa -F key=coredns
-a always,exit -F arch=b64 -F path=/etc/coredns/ca.pem -F perm=wa -F key=coredns

-a always,exit -F arch=b32 -F dir=/etc/coredns/ -F perm=wa -F key=coredns
-a always,exit -F arch=b64 -F dir=/etc/coredns/ -F perm=wa -F key=coredns

-a always,exit -F arch=b32 -F path=/etc/systemd/system/coredns.service -F perm=wa -F key=coredns
-a always,exit -F arch=b64 -F path=/etc/systemd/system/coredns.service -F perm=wa -F key=coredns

-a always,exit -F arch=b32 -F path=/etc/resolved.conf -F perm=wa -F key=dns
-a always,exit -F arch=b64 -F path=/etc/resolved.conf -F perm=wa -F key=dns

-a always,exit -F arch=b32 -F path=/etc/systemd/resolved.conf -F perm=wa -F key=dns
-a always,exit -F arch=b64 -F path=/etc/systemd/resolved.conf -F perm=wa -F key=dns

# OpenXPKI
## https://github.com/openxpki/openxpki-config/tree/community
-a always,exit -F arch=b32 -F path=/etc/openxpki/log.conf -F perm=wa -F key=openxpki
-a always,exit -F arch=b64 -F path=/etc/openxpki/log.conf -F perm=wa -F key=openxpki

-a always,exit -F arch=b32 -F dir=/etc/openxpki/local/ -F perm=wra -F key=openxpki
-a always,exit -F arch=b64 -F dir=/etc/openxpki/local/ -F perm=wra -F key=openxpki

-a always,exit -F arch=b32 -F dir=/etc/openxpki/tls/private/ -F perm=wra -F key=openxpki
-a always,exit -F arch=b64 -F dir=/etc/openxpki/tls/private/ -F perm=wra -F key=openxpki

-a always,exit -F arch=b32 -F dir=/etc/openxpki/ -F perm=wra -F key=openxpki
-a always,exit -F arch=b64 -F dir=/etc/openxpki/ -F perm=wra -F key=openxpki

-a always,exit -F arch=b32 -F path=/home/pkiadm/userdb.yaml -F perm=wa -F key=openxpki
-a always,exit -F arch=b64 -F path=/home/pkiadm/userdb.yaml -F perm=wa -F key=openxpki

-a always,exit -F arch=b32 -F path=/home/pkiadm/config.oxi -F perm=wa -F key=openxpki
-a always,exit -F arch=b64 -F path=/home/pkiadm/config.oxi -F perm=wa -F key=openxpki

-a always,exit -F arch=b32 -F dir=/usr/bin/openxpki/ -F perm=x -F key=openxpki
-a always,exit -F arch=b64 -F dir=/usr/bin/openxpki/ -F perm=x -F key=openxpki

# eperi components
## eperi
-a always,exit -F arch=b32 -F dir=/etc/eperi/ -F perm=wa -F key=eperi
-a always,exit -F arch=b64 -F dir=/etc/eperi/ -F perm=wa -F key=eperi

## eperi gateway
-a always,exit -F arch=b32 -F dir=/opt/eperi/gateway/ -F perm=x -F key=eperi
-a always,exit -F arch=b64 -F dir=/opt/eperi/gateway/ -F perm=x -F key=eperi

-a always,exit -F arch=b32 -F dir=/home/eperi/ -F perm=x -F key=eperi
-a always,exit -F arch=b64 -F dir=/home/eperi/ -F perm=x -F key=eperi

## eperi milter
-a always,exit -F arch=b32 -F dir=/etc/eperi/milter/ -F perm=wa -F key=eperi
-a always,exit -F arch=b64 -F dir=/etc/eperi/milter/ -F perm=wa -F key=eperi

-a always,exit -F arch=b32 -F path=/opt/eperi/milter/java/jre/bin/keytool -F perm=x -F key=eperi
-a always,exit -F arch=b64 -F path=/opt/eperi/milter/java/jre/bin/keytool -F perm=x -F key=eperi

## eperi postfix
-a always,exit -F arch=b32 -F path=/etc/postfix/master.cf -F perm=wa -F key=eperi
-a always,exit -F arch=b64 -F path=/etc/postfix/master.cf -F perm=wa -F key=eperi

-a always,exit -F arch=b32 -F path=/etc/postfix/main.cf -F perm=wa -F key=eperi
-a always,exit -F arch=b64 -F path=/etc/postfix/main.cf -F perm=wa -F key=eperi

-a always,exit -F arch=b32 -F path=/etc/postfix/relay_domains.db -F perm=x -F key=eperi
-a always,exit -F arch=b64 -F path=/etc/postfix/relay_domains.db -F perm=x -F key=eperi

-a always,exit -F arch=b32 -F path=/etc/postfix/transport.db -F perm=x -F key=eperi
-a always,exit -F arch=b64 -F path=/etc/postfix/transport.db -F perm=x -F key=eperi

-a always,exit -F arch=b32 -F path=/etc/postfix/user_map.db -F perm=x -F key=eperi
-a always,exit -F arch=b64 -F path=/etc/postfix/user_map.db -F perm=x -F key=eperi

-a always,exit -F arch=b32 -F dir=/etc/postfix/ -F perm=wa -F key=eperi
-a always,exit -F arch=b64 -F dir=/etc/postfix/ -F perm=wa -F key=eperi

### eperi dkim
-a always,exit -F arch=b32 -F path=/etc/opendkim.conf -F perm=wa -F key=dkim
-a always,exit -F arch=b64 -F path=/etc/opendkim.conf -F perm=wa -F key=dkim

-a always,exit -F arch=b32 -F path=/etc/default/opendkim -F perm=wa -F key=dkim
-a always,exit -F arch=b64 -F path=/etc/default/opendkim -F perm=wa -F key=dkim

-a always,exit -F arch=b32 -F dir=/etc/opendkim/ -F perm=wa -F key=dkim
-a always,exit -F arch=b64 -F dir=/etc/opendkim/ -F perm=wa -F key=dkim

-a always,exit -F arch=b32 -F path=/etc/opendkim/TrustedHosts -F perm=wa -F key=dkim
-a always,exit -F arch=b64 -F path=/etc/opendkim/TrustedHosts -F perm=wa -F key=dkim

-a always,exit -F arch=b32 -F path=/etc/opendkim/KeyTable -F perm=wa -F key=dkim
-a always,exit -F arch=b64 -F path=/etc/opendkim/KeyTable -F perm=wa -F key=dkim

-a always,exit -F arch=b32 -F path=/etc/opendkim/SigningTable -F perm=wa -F key=dkim
-a always,exit -F arch=b64 -F path=/etc/opendkim/SigningTable -F perm=wa -F key=dkim

-a always,exit -F arch=b32 -F dir=/etc/opendkim/keys/ -F perm=wa -F key=dkim
-a always,exit -F arch=b64 -F dir=/etc/opendkim/keys/ -F perm=wa -F key=dkim

-a always,exit -F arch=b32 -F dir=/etc/dkimkeys/ -F perm=wa -F key=dkim
-a always,exit -F arch=b64 -F dir=/etc/dkimkeys/ -F perm=wa -F key=dkim

## eperi mariadb
-a always,exit -F arch=b32 -F dir=/etc/mysql/conf.d/ -F perm=wa -F key=mysql
-a always,exit -F arch=b64 -F dir=/etc/mysql/conf.d/ -F perm=wa -F key=mysql

-a always,exit -F arch=b32 -F path=/etc/mysql/my.cnf -F perm=wa -F key=mysql
-a always,exit -F arch=b64 -F path=/etc/mysql/my.cnf -F perm=wa -F key=mysql

### Galera Config File
-a always,exit -F arch=b32 -F path=/etc/mysql/conf.d/galera.conf -F perm=wa -F key=mysql
-a always,exit -F arch=b64 -F path=/etc/mysql/conf.d/galera.conf -F perm=wa -F key=mysql

### Galera WSREP API provider library path
-a always,exit -F arch=b32 -F path=/usr/lib/galera/libgalera_smm.so -F perm=x -F key=mysql
-a always,exit -F arch=b64 -F path=/usr/lib/galera/libgalera_smm.so -F perm=x -F key=mysql

# kanidm
## https://kanidm.com/
-a always,exit -F arch=b32 -F dir=/etc/kanidm/ -F perm=wa -F key=kanidm
-a always,exit -F arch=b64 -F dir=/etc/kanidm/ -F perm=wa -F key=kanidm

-a always,exit -F arch=b32 -F dir=/usr/bin/kanidmd/ -F perm=x -F key=kanidm
-a always,exit -F arch=b64 -F dir=/usr/bin/kanidmd/ -F perm=x -F key=kanidm

-a always,exit -F arch=b32 -F dir=/usr/sbin/kanidmd/ -F perm=x -F key=kanidm
-a always,exit -F arch=b64 -F dir=/usr/sbin/kanidmd/ -F perm=x -F key=kanidm

-a always,exit -F arch=b32 -F dir=/usr/bin/kanidm-ipa-sync/ -F perm=x -F key=kanidm
-a always,exit -F arch=b64 -F dir=/usr/bin/kanidm-ipa-sync/ -F perm=x -F key=kanidm

-a always,exit -F arch=b32 -F dir=/usr/sbin/kanidm-ipa-sync/ -F perm=x -F key=kanidm
-a always,exit -F arch=b64 -F dir=/usr/sbin/kanidm-ipa-sync/ -F perm=x -F key=kanidm

# Proxmox VE
-a always,exit -F arch=b32 -F dir=/etc/pve/ -F perm=wa -F key=pve
-a always,exit -F arch=b64 -F dir=/etc/pve/ -F perm=wa -F key=pve

-a always,exit -F arch=b32 -F path=/etc/default/pveproxy -F perm=wa -F key=pve
-a always,exit -F arch=b64 -F path=/etc/default/pveproxy -F perm=wa -F key=pve

-a always,exit -F arch=b32 -F path=/etc/sysctl.conf -F perm=wa -F key=pve
-a always,exit -F arch=b64 -F path=/etc/sysctl.conf -F perm=wa -F key=pve

-a always,exit -F arch=b32 -F path=/etc/sysctl.d/pve.conf -F perm=wa -F key=pve
-a always,exit -F arch=b64 -F path=/etc/sysctl.d/pve.conf -F perm=wa -F key=pve

-a always,exit -F arch=b32 -F path=/usr/lib/sysctl.d/10-pve-ct-inotify-limits.conf -F perm=wa -F key=pve
-a always,exit -F arch=b64 -F path=/usr/lib/sysctl.d/10-pve-ct-inotify-limits.conf -F perm=wa -F key=pve

-a always,exit -F arch=b32 -F path=/usr/lib/sysctl.d/50-pid-max.conf -F perm=wa -F key=pve
-a always,exit -F arch=b64 -F path=/usr/lib/sysctl.d/50-pid-max.conf -F perm=wa -F key=pve

-a always,exit -F arch=b32 -F path=/usr/lib/sysctl.d/protect-links.conf -F perm=wa -F key=pve
-a always,exit -F arch=b64 -F path=/usr/lib/sysctl.d/protect-links.conf -F perm=wa -F key=pve

-a always,exit -F arch=b32 -F path=/usr/lib/sysctl.d/pve-firewall.conf -F perm=wa -F key=pve
-a always,exit -F arch=b64 -F path=/usr/lib/sysctl.d/pve-firewall.conf -F perm=wa -F key=pve

-a always,exit -F arch=b32 -F dir=/usr/bin/pveupdate/ -F perm=x -F key=pve
-a always,exit -F arch=b64 -F dir=/usr/bin/pveupdate/ -F perm=x -F key=pve

-a always,exit -F arch=b32 -F dir=/usr/bin/pveupgrade/ -F perm=x -F key=pve
-a always,exit -F arch=b64 -F dir=/usr/bin/pveupgrade/ -F perm=x -F key=pve

## ZFS
-a always,exit -F arch=b32 -F path=/etc/pve/storage.cfg -F perm=wa -F key=pve
-a always,exit -F arch=b64 -F path=/etc/pve/storage.cfg -F perm=wa -F key=pve

# Ceph Storage
-a always,exit -F arch=b32 -F dir=/etc/ceph/ -F perm=wa -F key=Ceph
-a always,exit -F arch=b64 -F dir=/etc/ceph/ -F perm=wa -F key=Ceph

## On FreeBSD systems only, /usr/local/etc/ceph/$cluster.conf
## https://docs.ceph.com/en/latest/rados/configuration/ceph-conf/
-a always,exit -F arch=b32 -F dir=/usr/local/etc/ceph/ -F perm=wa -F key=Ceph
-a always,exit -F arch=b64 -F dir=/usr/local/etc/ceph/ -F perm=wa -F key=Ceph

-a always,exit -F arch=b32 -F dir=/var/log/ceph/ -F perm=wa -F key=Ceph
-a always,exit -F arch=b64 -F dir=/var/log/ceph/ -F perm=wa -F key=Ceph

# HashiCorp Vault
## Monitoring Vault CLI and Server Executions
-a always,exit -F arch=b32 -S execve -F path=/usr/bin/vault -F "auid>=500" -F "auid!=-1" -F key=HashiCorp_vault
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/vault -F "auid>=500" -F "auid!=-1" -F key=HashiCorp_vault

-a always,exit -F arch=b32 -S execve -F path=/usr/sbin/vault -F "auid>=500" -F "auid!=-1" -F key=HashiCorp_vault
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/vault -F "auid>=500" -F "auid!=-1" -F key=HashiCorp_vault

-a always,exit -F arch=b32 -S execve -F path=/usr/local/bin/vault -F "auid>=500" -F "auid!=-1" -F key=HashiCorp_vault
-a always,exit -F arch=b64 -S execve -F path=/usr/local/bin/vault -F "auid>=500" -F "auid!=-1" -F key=HashiCorp_vault

-a always,exit -F arch=b32 -S execve -F path=/usr/local/sbin/vault -F "auid>=500" -F "auid!=-1" -F key=HashiCorp_vault
-a always,exit -F arch=b64 -S execve -F path=/usr/local/sbin/vault -F "auid>=500" -F "auid!=-1" -F key=HashiCorp_vault

### Monitoring Changes to Vault Configuration and Data Files
-a always,exit -F arch=b32 -F dir=/etc/vault/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=HashiCorp_vault
-a always,exit -F arch=b64 -F dir=/etc/vault/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=HashiCorp_vault

-a always,exit -F arch=b32 -F dir=/opt/vault/data/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=HashiCorp_vault
-a always,exit -F arch=b64 -F dir=/opt/vault/data/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=HashiCorp_vault

# OpenBao
## Monitoring OpenBao CLI and Server Executions
-a always,exit -F arch=b32 -F path=/usr/bin/openbao -S execve -F "auid>=500" -F "auid!=-1" -F key=OpenBao_vault
-a always,exit -F arch=b64 -F path=/usr/bin/openbao -S execve -F "auid>=500" -F "auid!=-1" -F key=OpenBao_vault

-a always,exit -F arch=b32 -F path=/usr/sbin/openbao -S execve -F "auid>=500" -F "auid!=-1" -F key=OpenBao_vault
-a always,exit -F arch=b64 -F path=/usr/sbin/openbao -S execve -F "auid>=500" -F "auid!=-1" -F key=OpenBao_vault

-a always,exit -F arch=b32 -F path=/usr/local/bin/openbao -S execve -F "auid>=500" -F "auid!=-1" -F key=OpenBao_vault
-a always,exit -F arch=b64 -F path=/usr/local/bin/openbao -S execve -F "auid>=500" -F "auid!=-1" -F key=OpenBao_vault

-a always,exit -F arch=b32 -F path=/usr/local/sbin/openbao -S execve -F "auid>=500" -F "auid!=-1" -F key=OpenBao_vault
-a always,exit -F arch=b64 -F path=/usr/local/sbin/openbao -S execve -F "auid>=500" -F "auid!=-1" -F key=OpenBao_vault

## Monitoring Changes to OpenBao Configuration and Data Files
-a always,exit -F arch=b32 -F dir=/etc/openbao/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=OpenBao_vault
-a always,exit -F arch=b64 -F dir=/etc/openbao/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=OpenBao_vault

-a always,exit -F arch=b32 -F dir=/opt/openbao/data/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=OpenBao_vault
-a always,exit -F arch=b64 -F dir=/opt/openbao/data/ -S open,openat,creat,unlink,unlinkat,rename,renameat,chmod,fchmod,fchmodat,chown,fchown,fchownat -F "auid>=500" -F "auid!=-1" -F key=OpenBao_vault

# Axway
## https://www.axway.com
## Axway Secure Transport
### https://www.axway.com/en/products/managed-file-transfer/securetransport
-a always,exit -F arch=b32 -F dir=/opt/axway/st/SecureTransport/conf/ -F perm=wa -F key=Axway_Secure_Transport_Configuration
-a always,exit -F arch=b64 -F dir=/opt/axway/st/SecureTransport/conf/ -F perm=wa -F key=Axway_Secure_Transport_Configuration

-a always,exit -F arch=b32 -F dir=/opt/axway/st/SecureTransport/tomcat/admin/conf/ -F perm=wa -F key=Axway_Secure_Transport_Configuration
-a always,exit -F arch=b64 -F dir=/opt/axway/st/SecureTransport/tomcat/admin/conf/ -F perm=wa -F key=Axway_Secure_Transport_Configuration

-a always,exit -F arch=b32 -F dir=/opt/axway/st/SecureTransport/var/logs/admin/ -F perm=wa -F key=Axway_Secure_Transport_Logs
-a always,exit -F arch=b64 -F dir=/opt/axway/st/SecureTransport/var/logs/admin/ -F perm=wa -F key=Axway_Secure_Transport_Logs

-a always,exit -F arch=b32 -F dir=/opt/axway/st/SecureTransport/var/logs/ -F perm=wa -F key=Axway_Secure_Transport_Logs
-a always,exit -F arch=b64 -F dir=/opt/axway/st/SecureTransport/var/logs/ -F perm=wa -F key=Axway_Secure_Transport_Logs

-a always,exit -F arch=b32 -F dir=/opt/axway/st/SecureTransport/tomcat/admin/logs/ -F perm=wa -F key=Axway_Secure_Transport_Logs
-a always,exit -F arch=b64 -F dir=/opt/axway/st/SecureTransport/tomcat/admin/logs/ -F perm=wa -F key=Axway_Secure_Transport_Logs

## Axway B2Bi
### https://www.axway.com/de/products/b2b-integration
-a always,exit -F arch=b32 -F dir=/opt/axway/b2bi/Interchange/conf/ -F perm=wa -F key=Axway_B2Bi_Configuration
-a always,exit -F arch=b64 -F dir=/opt/axway/b2bi/Interchange/conf/ -F perm=wa -F key=Axway_B2Bi_Configuration

-a always,exit -F arch=b32 -F dir=/opt/axway/b2bi/Interchange/logs/ -F perm=wa -F key=Axway_B2Bi_Logs
-a always,exit -F arch=b64 -F dir=/opt/axway/b2bi/Interchange/logs/ -F perm=wa -F key=Axway_B2Bi_Logs

-a always,exit -F arch=b32 -F dir=/opt/axway/b2bi/Integrator/config/java/ -F perm=wa -F key=Axway_B2Bi_Configuration
-a always,exit -F arch=b64 -F dir=/opt/axway/b2bi/Integrator/config/java/ -F perm=wa -F key=Axway_B2Bi_Configuration

-a always,exit -F arch=b32 -F dir=/opt/axway/b2bi/Integrator/data//log/ -F perm=wa -F key=Axway_B2Bi_Logs
-a always,exit -F arch=b64 -F dir=/opt/axway/b2bi/Integrator/data//log/ -F perm=wa -F key=Axway_B2Bi_Logs

-a always,exit -F arch=b32 -F dir=/opt/axway/b2bi/Integrator/data/trace/ -F perm=wa -F key=Axway_B2Bi_Logs
-a always,exit -F arch=b64 -F dir=/opt/axway/b2bi/Integrator/data/trace/ -F perm=wa -F key=Axway_B2Bi_Logs

-a always,exit -F arch=b32 -F dir=/opt/axway/b2bi/Integrator/data/ -F perm=wa -F key=Axway_B2Bi_Logs
-a always,exit -F arch=b64 -F dir=/opt/axway/b2bi/Integrator/data/ -F perm=wa -F key=Axway_B2Bi_Logs

# GOSS
## https://github.com/goss-org/goss
-a always,exit -F arch=b32 -F path=/usr/bin/goss -F perm=wa -F key=goos_binary_modifications
-a always,exit -F arch=b64 -F path=/usr/bin/goss -F perm=wa -F key=goos_binary_modifications

-a always,exit -F arch=b32 -F path=/usr/sbin/goss -F perm=wa -F key=goos_binary_modifications
-a always,exit -F arch=b64 -F path=/usr/sbin/goss -F perm=wa -F key=goos_binary_modifications

-a always,exit -F arch=b32 -F path=/usr/local/bin/goss -F perm=wa -F key=goos_binary_modifications
-a always,exit -F arch=b64 -F path=/usr/local/bin/goss -F perm=wa -F key=goos_binary_modifications

-a always,exit -F arch=b32 -F path=/usr/local/sbin/goss -F perm=wa -F key=goos_binary_modifications
-a always,exit -F arch=b64 -F path=/usr/bin/goss -F perm=wa -F key=goos_binary_modifications

# GOSS
## Monitor Go binary installations and modifications

-a always,exit -F arch=b32 -F dir=/usr/local/go/bin/ -F perm=wa -F key=goos_binary_modifications
-a always,exit -F arch=b64 -F dir=/usr/local/go/bin/ -F perm=wa -F key=goos_binary_modifications

## Monitor Go source files and packages
-a always,exit -F arch=b32 -F dir=/usr/local/go/src/ -F perm=wa -F key=goos_source_modifications
-a always,exit -F arch=b64 -F dir=/usr/local/go/src/ -F perm=wa -F key=goos_source_modifications

## Monitor Go workspace modifications (GOPATH)
-a always,exit -F arch=b32 -F dir=/go/ -F perm=wa -F key=goos_workspace_modifications
-a always,exit -F arch=b64 -F dir=/go/ -F perm=wa -F key=goos_workspace_modifications

## Monitor Go-specific system calls
-a always,exit -F arch=b32 -S mmap -S mprotect -F exe=/usr/local/go/bin/go -F key=goos_syscalls
-a always,exit -F arch=b64 -S mmap -S mprotect -F exe=/usr/local/go/bin/go -F key=goos_syscalls

# RustDesk
## hbbs - RustDesk ID/Rendezvous server
## hbbr - RustDesk Relay server
-a always,exit -F arch=b32 -F dir=/var/lib/rustdesk-server/ -F perm=wa -F key=RustDesk
-a always,exit -F arch=b64 -F dir=/var/lib/rustdesk-server/ -F perm=wa -F key=RustDesk

# Camunda
## https://github.com/camunda/camunda
-a always,exit -F arch=b32 -F dir=/opt/camunda/server/deployments/ -F perm=wa -F key=camunda
-a always,exit -F arch=b64 -F dir=/opt/camunda/server/deployments/ -F perm=wa -F key=camunda

-a always,exit -F arch=b32 -F path=/opt/camunda/bin/start-camunda.sh -F perm=wa -F key=camunda_config
-a always,exit -F arch=b64 -F path=/opt/camunda/bin/start-camunda.sh -F perm=wa -F key=camunda_config

# vCenter
# https://knowledge.broadcom.com/external/article/312194/location-of-vcenter-server-log-files.html
# https://www.nakivo.com/blog/vmware-logs-analysis-for-troubleshooting/
#
# the original audit.rules from vCenter Server
# -w /usr/sbin/useradd -p x -k useradd
# -w /usr/sbin/groupadd -p x -k groupadd
# -a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -F key=execpriv
# -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -F key=execpriv
# -a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -F key=execpriv
# -a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -F key=execpriv
# -a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid>=1000 -F auid!=-1 -F key=perm_mod
# -a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid=0 -F key=perm_mod
# -a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid>=1000 -F auid!=-1 -F key=perm_mod
# -a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid=0 -F key=perm_mod
# -w /usr/sbin/usermod -p x -k usermod
# -w /usr/sbin/groupmod -p x -k groupmod
# -w /usr/sbin/userdel -p x -k userdel
# -w /usr/sbin/groupdel -p x -k groupdel
# -a always,exit -S all -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/chfn -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/expiry -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/fusermount -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/lockfile -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/newgidmap -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/newuidmap -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/ping -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/procmail -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/libexec/dbus-daemon-launch-helper -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/libexec/ssh-keysign -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/sbin/mount.nfs -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/sbin/sendmail -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/usr/sbin/usernetctl -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -a always,exit -S all -F path=/var/lib/rpm/.rpm.lock -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged
# -w /var/log/faillog -p wa -k logons
# -w /var/log/lastlog -p wa -k logons
# -w /var/log/tallylog -p wa -k logons
# -a always,exit -F arch=b32 -S init_module -F key=modules
# -a always,exit -F arch=b64 -S init_module -F key=modules
# -w /etc/passwd -p wa -k passwd
# -w /etc/shadow -p wa -k shadow
# -w /etc/group -p wa -k group
# -w /etc/gshadow -p wa -k gshadow
# -w /etc/security/opasswd -p wa -k opasswd
#
# end of the original audit.rules from vCenter Server
#
## vpxd.log: The main vCenter Server log, consisting of all vSphere Client
## and WebServices connections, internal tasks and events, and communication
## with the vCenter Server Agent (vpxa) on managed ESXi hosts.
-a always,exit -F arch=b32 -F path=/var/log/vmware/vpxd.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/vpxd.log -F perm=wa -F key=VMware_vCenter

## vpxd-profiler.log, profiler.log, and scoreboard.log: Profiled metrics
## for operations performed in vCenter Server. Used by the VPX Operational Dashboard (VOD)
## accessible at https://VCHostnameOrIPAddress/vod/index.html.
-a always,exit -F arch=b32 -F path=/var/log/vmware/vpxd-profiler.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/vpxd-profiler.log -F perm=wa -F key=VMware_vCenter

## vpxd-alert.log: Non-fatal information logged about the vpxd process
## (no longer present in 6.7/7.0/8.0)
-a always,exit -F arch=b32 -F path=/var/log/vmware/vpxd-alert.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/vpxd-alert.log -F perm=wa -F key=VMware_vCenter

## cim-diag.log and vws.log: Common Information Model monitoring information,
## including communication between vCenter Server and managed hosts' CIM interface.
-a always,exit -F arch=b32 -F path=/var/log/vmware/cim-diag.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/cim-diag.log -F perm=wa -F key=VMware_vCenter

## drmdump: Actions proposed and taken by VMware Distributed Resource Scheduler (DRS),
## grouped by the DRS-enabled cluster managed by vCenter Server.
## These logs are compressed.
-a always,exit -F arch=b32 -F path=/var/log/vmware/drmdump -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/drmdump -F perm=wa -F key=VMware_vCenter

## ls.log: Health reports for the Licensing Services extension, connectivity logs
## to vCenter Server.
-a always,exit -F arch=b32 -F path=/var/log/vmware/ls.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/ls.log -F perm=wa -F key=VMware_vCenter

## vimtool.log: Dump of string used during the installation of vCenter Server
# with hashed information for DNS, username and output for JDBC creation.
-a always,exit -F arch=b32 -F path=/var/log/vmware/vimtool.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/vimtool.log -F perm=wa -F key=VMware_vCenter

## stats.log: Provides information about the historical performance data collection
-a always,exit -F arch=b32 -F path=/var/log/vmware/stats.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/stats.log -F perm=wa -F key=VMware_vCenter

-a always,exit -F arch=b32 -F path=/var/log/vmware/perfcharts/stats.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/perfcharts/stats.log -F perm=wa -F key=VMware_vCenter

-a always,exit -F arch=b32 -F dir=/var/log/vmware/perfcharts/ -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F dir=/var/log/vmware/perfcharts/ -F perm=wa -F key=VMware_vCenter

## sms.log: Health reports for the Storage Monitoring Service extension,
## connectivity logs to vCenter Server
-a always,exit -F arch=b32 -F path=/var/log/vmware/sms.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/sms.log -F perm=wa -F key=VMware_vCenter

-a always,exit -F arch=b32 -F path=/var/log/vmware/sms/sms.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/sms/sms.log -F perm=wa -F key=VMware_vCenter

## eam.log: Health reports for the ESXi Agent Monitor extension,
## connectivity logs to vCenter Server
-a always,exit -F arch=b32 -F path=/var/log/vmware/eam.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/eam.log -F perm=wa -F key=VMware_vCenter

## catalina.date.log and localhost.date.log: Connectivity information
## and status of the VMware Webmanagement Services
-a always,exit -F arch=b32 -F path=/var/log/vmware/catalina.date.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/catalina.date.log -F perm=wa -F key=VMware_vCenter

## jointool.log: Health status of the VMwareVCMSDS service and individual ADAM
## database objects, internal tasks and events, and replication logs between linked-mode vCenter Servers.
-a always,exit -F arch=b32 -F path=/var/log/vmware/jointool.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/jointool.log -F perm=wa -F key=VMware_vCenter

## vpxd.log
-a always,exit -F arch=b32 -F path=/var/log/vmware/vpxd/vpxd.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/vpxd/vpxd.log -F perm=wa -F key=VMware_vCenter

## vpxd-alert.log
-a always,exit -F arch=b32 -F path=/var/log/vmware/vpxd/vpxd-alert.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/vpxd/vpxd-alert.log -F perm=wa -F key=VMware_vCenter

## vmware-vpostgres.log
-a always,exit -F arch=b32 -F dir=/var/log/vmware/vpostgres/ -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F dir=/var/log/vmware/vpostgres/ -F perm=wa -F key=VMware_vCenter

## invsvc.log
-a always,exit -F arch=b32 -F path=/var/log/vmware/invsvc/invsvc.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/invsvc/invsvc.log -F perm=wa -F key=VMware_vCenter

-a always,exit -F arch=b32 -F dir=/var/log/vmware/invsvc/ -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F dir=/var/log/vmware/invsvc/ -F perm=wa -F key=VMware_vCenter

## applmgmt.log
-a always,exit -F arch=b32 -F path=/var/log/vmware/applmgmt/applmgmt.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/applmgmt/applmgmt.log -F perm=wa -F key=VMware_vCenter

-a always,exit -F arch=b32 -F dir=/var/log/vmware/applmgmt/ -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F dir=/var/log/vmware/applmgmt/ -F perm=wa -F key=VMware_vCenter

## vmware-sts-idmd.log
-a always,exit -F arch=b32 -F path=/var/log/vmware/sso/vmware-sts-idmd.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/sso/vmware-sts-idmd.log -F perm=wa -F key=VMware_vCenter

-a always,exit -F arch=b32 -F dir=/var/log/vmware/sso/ -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F dir=/var/log/vmware/sso/ -F perm=wa -F key=VMware_vCenter

## Additional log files:
### manager.date.log
-a always,exit -F arch=b32 -F path=/var/log/vmware/manager.date.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/manager.date.log -F perm=wa -F key=VMware_vCenter

### host-manager.date.log
-a always,exit -F arch=b32 -F path=/var/log/vmware/host-manager.date.log -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/vmware/host-manager.date.log -F perm=wa -F key=VMware_vCenter

## https://williamlam.com/2019/04/enhanced-vcenter-server-audit-event-logging-in-vsphere-6-7-update-2.html
-a always,exit -F arch=b32 -F path=/var/log/audit/sso-events/audit_events.log  -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F path=/var/log/audit/sso-events/audit_events.log  -F perm=wa -F key=VMware_vCenter

## cover hopefully the rest
-a always,exit -F arch=b32 -F dir=/var/log/vmware/ -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F dir=/var/log/vmware/ -F perm=wa -F key=VMware_vCenter

### vpxd
-a always,exit -F arch=b32 -F dir=/var/log/vmware/vpxd/ -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F dir=/var/log/vmware/vpxd/ -F perm=wa -F key=VMware_vCenter

-a always,exit -F arch=b32 -F dir=/var/log/audit/sso-events/ -F perm=wa -F key=VMware_vCenter
-a always,exit -F arch=b64 -F dir=/var/log/audit/sso-events/ -F perm=wa -F key=VMware_vCenter

# Antivirus Software
## Bitdefender
-a always,exit -F arch=b32 -F dir=/etc/bitdefender/ -F perm=wa -F key=bitdefender_config
-a always,exit -F arch=b64 -F dir=/etc/bitdefender/ -F perm=wa -F key=bitdefender_config

-a always,exit -F arch=b32 -F path=/opt/bitdefender/bin/bdscan -F perm=x -F key=bitdefender_activity
-a always,exit -F arch=b64 -F path=/opt/bitdefender/bin/bdscan -F perm=x -F key=bitdefender_activity

-a always,exit -F arch=b32 -F path=/opt/bitdefender/bin/bdgui -F perm=x -F key=bitdefender_activity
-a always,exit -F arch=b64 -F path=/opt/bitdefender/bin/bdgui -F perm=x -F key=bitdefender_activity

-a always,exit -F arch=b32 -F dir=/opt/bitdefender/ -F perm=x -F key=bitdefender_activity
-a always,exit -F arch=b64 -F dir=/opt/bitdefender/ -F perm=x -F key=bitdefender_activity

## ClamAV
-a always,exit -F arch=b32 -F path=/usr/bin/clamd -F perm=x -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/bin/clamd -F perm=x -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/usr/bin/freshclam -F perm=x -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/bin/freshclam -F perm=x -F key=clamav_activity

## Monitor ClamAV daemon/service executables
-a always,exit -F arch=b32 -F path=/usr/bin/clamd -S execve -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/bin/clamd -S execve -S execve -F key=clamav_activity

-a always,exit -F arch=b64 -F path=/usr/sbin/clamd -S execve -F key=clamav_activity
-a always,exit -F arch=b32 -F path=/usr/sbin/clamd -S execve -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/usr/local/bin/clamd -S execve -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/local/bin/clamd -S execve -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/usr/local/sbin/clamd -S execve -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/local/sbin/clamd -S execve -F key=clamav_activity

## Monitor ClamAV scanner executables
-a always,exit -F arch=b32 -F path=/usr/bin/clamscan -S execve -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/bin/clamscan -S execve -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/usr/bin/clamdscan -S execve -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/bin/clamdscan -S execve -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/usr/local/bin/clamscan -S execve -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/local/bin/clamscan -S execve -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/usr/local/bin/clamdscan -S execve -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/local/bin/clamdscan -S execve -F key=clamav_activity

## Monitor ClamAV update utilities
-a always,exit -F arch=b32 -F path=/usr/bin/freshclam -S execve -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/bin/freshclam -S execve -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/usr/sbin/freshclam -S execve -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/sbin/freshclam -S execve -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/usr/local/bin/freshclam -S execve -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/local/bin/freshclam -S execve -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/usr/local/sbin/freshclam -S execve -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/local/sbin/freshclam -S execve -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/usr/bin/clamav-unofficial-sigs -S execve -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/usr/bin/clamav-unofficial-sigs -S execve -F key=clamav_activity

## Monitor ClamAV configuration directory
-a always,exit -F arch=b32 -F dir=/etc/clamav/ -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F dir=/etc/clamav/ -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F dir=/etc/clamav/ -S unlink,unlinkat,rename,renameat -F key=clamav_config
-a always,exit -F arch=b64 -F dir=/etc/clamav/ -S unlink,unlinkat,rename,renameat -F key=clamav_config

-a always,exit -F arch=b32 -F dir=/etc/clamav/ -S chmod,fchmod,fchmodat -F key=clamav_config
-a always,exit -F arch=b64 -F dir=/etc/clamav/ -S chmod,fchmod,fchmodat -F key=clamav_config

-a always,exit -F arch=b32 -F dir=/etc/clamav/ -S chown,fchown,lchown,fchownat -F key=clamav_config
-a always,exit -F arch=b64 -F dir=/etc/clamav/ -S chown,fchown,lchown,fchownat -F key=clamav_config

## Monitor specific ClamAV configuration files
-a always,exit -F arch=b32 -F path=/etc/clamav/clamd.conf -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/clamav/clamd.conf -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/clamav/freshclam.conf -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/clamav/freshclam.conf -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/clamav/clamav-milter.conf -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/clamav/clamav-milter.conf -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/clamav/clamd.conf -S unlink,unlinkat,rename,renameat -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/clamav/clamd.conf -S unlink,unlinkat,rename,renameat -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/clamav/freshclam.conf -S unlink,unlinkat,rename,renameat -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/clamav/freshclam.conf -S unlink,unlinkat,rename,renameat -F key=clamav_config

## Monitor systemd service files for ClamAV
-a always,exit -F arch=b32 -F path=/etc/systemd/system/clamav-daemon.service -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/systemd/system/clamav-daemon.service -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/systemd/system/clamav-freshclam.service -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/systemd/system/clamav-freshclam.service -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F path=/lib/systemd/system/clamav-daemon.service -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F path=/lib/systemd/system/clamav-daemon.service -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F path=/lib/systemd/system/clamav-freshclam.service -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F path=/lib/systemd/system/clamav-freshclam.service -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/systemd/system/clamav-daemon.service -S chmod,fchmod,fchmodat -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/systemd/system/clamav-daemon.service -S chmod,fchmod,fchmodat -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/systemd/system/clamav-freshclam.service -S chmod,fchmod,fchmodat -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/systemd/system/clamav-freshclam.service -S chmod,fchmod,fchmodat -F key=clamav_config

## Monitor SELinux contexts (if SELinux is enabled)
-a always,exit -F arch=b32 -F dir=/etc/selinux/ -S open,openat -F perm=wa -F key=MAC-policy
-a always,exit -F arch=b64 -F dir=/etc/selinux/ -S open,openat -F perm=wa -F key=MAC-policy

-a always,exit -F arch=b32 -F dir=/etc/selinux/ -S chmod,fchmod,fchmodat -F key=MAC-policy
-a always,exit -F arch=b64 -F dir=/etc/selinux/ -S chmod,fchmod,fchmodat -F key=MAC-policy

## Monitor AppArmor profiles for ClamAV (if AppArmor is enabled)
-a always,exit -F arch=b32 -F path=/etc/apparmor.d/usr.sbin.clamd -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/apparmor.d/usr.sbin.clamd -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/apparmor.d/usr.bin.freshclam -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/apparmor.d/usr.bin.freshclam -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/apparmor.d/usr.sbin.clamd -S unlink,unlinkat,rename,renameat -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/apparmor.d/usr.sbin.clamd -S unlink,unlinkat,rename,renameat -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/apparmor.d/usr.bin.freshclam -S unlink,unlinkat,rename,renameat -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/apparmor.d/usr.bin.freshclam -S unlink,unlinkat,rename,renameat -F key=clamav_config

## Monitor ClamAV cron jobs
-a always,exit -F arch=b32 -F path=/etc/cron.d/clamav -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/cron.d/clamav -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/cron.daily/clamav -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/cron.daily/clamav -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/cron.hourly/clamav -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/cron.hourly/clamav -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F path=/var/spool/cron/clamav -S open,openat -F perm=wa -F key=clamav_config
-a always,exit -F arch=b64 -F path=/var/spool/cron/clamav -S open,openat -F perm=wa -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/cron.d/clamav -S unlink,unlinkat,rename,renameat -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/cron.d/clamav -S unlink,unlinkat,rename,renameat -F key=clamav_config

-a always,exit -F arch=b32 -F path=/etc/cron.d/clamav -S chmod,fchmod,fchmodat -F key=clamav_config
-a always,exit -F arch=b64 -F path=/etc/cron.d/clamav -S chmod,fchmod,fchmodat -F key=clamav_config

## Monitor ClamAV database/signature directories
-a always,exit -F arch=b32 -F dir=/var/lib/clamav/ -S open,openat,creat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/lib/clamav/ -S open,openat,creat -F perm=wa -F key=clamav_activity

-a always,exit -F arch=b32 -F dir=/var/lib/clamav/ -S unlink,unlinkat,rename,renameat -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/lib/clamav/ -S unlink,unlinkat,rename,renameat -F key=clamav_activity

-a always,exit -F arch=b32 -F dir=/var/lib/clamav/ -S chmod,fchmod,fchmodat -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/lib/clamav/ -S chmod,fchmod,fchmodat -F key=clamav_activity

-a always,exit -F arch=b32 -F dir=/var/lib/clamav/ -S chown,fchown,lchown,fchownat -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/lib/clamav/ -S chown,fchown,lchown,fchownat -F key=clamav_activity

## Monitor specific signature files
-a always,exit -F arch=b32 -F path=/var/lib/clamav/daily.cvd -S open,openat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/lib/clamav/daily.cvd -S open,openat -F perm=wa -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/var/lib/clamav/daily.cld -S open,openat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/lib/clamav/daily.cld -S open,openat -F perm=wa -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/var/lib/clamav/main.cvd -S open,openat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/lib/clamav/main.cvd -S open,openat -F perm=wa -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/var/lib/clamav/main.cld -S open,openat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/lib/clamav/main.cld -S open,openat -F perm=wa -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/var/lib/clamav/bytecode.cvd -S open,openat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/lib/clamav/bytecode.cvd -S open,openat -F perm=wa -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/var/lib/clamav/bytecode.cld -S open,openat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/lib/clamav/bytecode.cld -S open,openat -F perm=wa -F key=clamav_activity

## Monitor ClamAV log files
-a always,exit -F arch=b32 -F dir=/var/log/clamav/ -S open,openat,creat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/log/clamav/ -S open,openat,creat -F perm=wa -F key=clamav_activity

-a always,exit -F arch=b32 -F dir=/var/log/clamav/ -S unlink,unlinkat,rename,renameat -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/log/clamav/ -S unlink,unlinkat,rename,renameat -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/var/log/clamav/clamav.log -S open,openat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/log/clamav/clamav.log -S open,openat -F perm=wa -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/var/log/clamav/freshclam.log -S open,openat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/log/clamav/freshclam.log -S open,openat -F perm=wa -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/var/log/clamav/clamd.log -S open,openat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/log/clamav/clamd.log -S open,openat -F perm=wa -F key=clamav_activity

## Monitor ClamAV quarantine directory (all operations)
-a always,exit -F arch=b32 -F dir=/var/lib/clamav/quarantine/ -S open,openat,creat -F perm=rwxa -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/lib/clamav/quarantine/ -S open,openat,creat -F perm=rwxa -F key=clamav_activity

-a always,exit -F arch=b32 -F dir=/var/lib/clamav/quarantine/ -S unlink,unlinkat,rename,renameat -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/lib/clamav/quarantine/ -S unlink,unlinkat,rename,renameat -F key=clamav_activity

-a always,exit -F arch=b32 -F dir=/var/lib/clamav/quarantine/ -S chmod,fchmod,fchmodat -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/lib/clamav/quarantine/ -S chmod,fchmod,fchmodat -F key=clamav_activity

-a always,exit -F arch=b32 -F dir=/var/lib/clamav/quarantine/ -S chown,fchown,lchown,fchownat -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/lib/clamav/quarantine/ -S chown,fchown,lchown,fchownat -F key=clamav_activity

-a always,exit -F arch=b32 -F dir=/var/lib/clamav/quarantine/ -S execve -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/lib/clamav/quarantine/ -S execve -F key=clamav_activity

## Alternative quarantine locations
-a always,exit -F arch=b32 -F dir=/var/quarantine/ -S open,openat,creat -F perm=rwxa -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/quarantine/ -S open,openat,creat -F perm=rwxa -F key=clamav_activity

-a always,exit -F arch=b32 -F dir=/var/quarantine/ -S unlink,unlinkat,rename,renameat -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/quarantine/ -S unlink,unlinkat,rename,renameat -F key=clamav_activity

-a always,exit -F arch=b32 -F dir=/opt/clamav/quarantine/ -S open,openat,creat -F perm=rwxa -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/opt/clamav/quarantine/ -S open,openat,creat -F perm=rwxa -F key=clamav_activity

-a always,exit -F arch=b32 -F dir=/opt/clamav/quarantine/ -S unlink,unlinkat,rename,renameat -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/opt/clamav/quarantine/ -S unlink,unlinkat,rename,renameat -F key=clamav_activity

## Monitor ClamAV PID files
-a always,exit -F arch=b32 -F dir=/var/run/clamav/ -S open,openat,creat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/run/clamav/ -S open,openat,creat -F perm=wa -F key=clamav_activity

-a always,exit -F arch=b32 -F dir=/var/run/clamav/ -S unlink,unlinkat -F key=clamav_activity
-a always,exit -F arch=b64 -F dir=/var/run/clamav/ -S unlink,unlinkat -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/var/run/clamav/clamd.pid -S open,openat,creat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/run/clamav/clamd.pid -S open,openat,creat -F perm=wa -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/var/run/clamav/freshclam.pid -S open,openat,creat -F perm=wa -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/run/clamav/freshclam.pid -S open,openat,creat -F perm=wa -F key=clamav_activity

## Monitor ClamAV socket files
-a always,exit -F arch=b32 -F path=/var/run/clamav/clamd.sock -S bind,connect -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/run/clamav/clamd.sock -S bind,connect -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/var/run/clamav/clamd.ctl -S bind,connect -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/run/clamav/clamd.ctl -S bind,connect -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/tmp/clamd.socket -S bind,connect -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/tmp/clamd.socket -S bind,connect -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/var/run/clamav/clamd.sock -S unlink,unlinkat -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/run/clamav/clamd.sock -S unlink,unlinkat -F key=clamav_activity

-a always,exit -F arch=b32 -F path=/var/run/clamav/clamd.ctl -S unlink,unlinkat -F key=clamav_activity
-a always,exit -F arch=b64 -F path=/var/run/clamav/clamd.ctl -S unlink,unlinkat -F key=clamav_activity

## Monitor file operations by ClamAV user (UID: 502)
-a always,exit -F arch=b32 -S open,openat -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S open,openat -F "auid=502" -F key=clamav_activity

-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F "auid=502" -F key=clamav_activity

-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F "auid=502" -F key=clamav_activity

-a always,exit -F arch=b32 -S chown,fchown,lchown,fchownat -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F "auid=502" -F key=clamav_activity

## Monitor network connections by ClamAV user (UID: 502)
-a always,exit -F arch=b32 -S connect -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S connect -F "auid=502" -F key=clamav_activity

-a always,exit -F arch=b32 -S socket -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S socket -F "auid=502" -F key=clamav_activity

-a always,exit -F arch=b32 -S bind -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S bind -F "auid=502" -F key=clamav_activity

-a always,exit -F arch=b64 -S listen -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S accept,accept4 -F "auid=502" -F key=clamav_activity

## Monitor process execution by ClamAV user (UID: 502)
-a always,exit -F arch=b32 -S execve -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S execve -F "auid=502" -F key=clamav_activity

-a always,exit -F arch=b32 -S execveat -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S execveat -F "auid=502" -F key=clamav_activity

## Monitor privilege escalation attempts by ClamAV user (UID: 502)
-a always,exit -F arch=b32 -S setuid,setgid,setreuid,setregid -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S setuid,setgid,setreuid,setregid -F "auid=502" -F key=clamav_activity

-a always,exit -F arch=b32 -S setresuid32,setresgid32,setfsuid32,setfsgid32 -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S setresuid,setresgid,setfsuid,setfsgid -F "auid=502" -F key=clamav_activity

## Monitor capability changes by ClamAV user (UID: 502)
-a always,exit -F arch=b32 -S capset -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S capset -F "auid=502" -F key=clamav_activity

## Monitor module loading attempts by ClamAV user (UID: 502)
-a always,exit -F arch=b32 -S init_module,finit_module -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S init_module,finit_module -F "auid=502" -F key=clamav_activity

-a always,exit -F arch=b64 -S delete_module -F "auid=502" -F key=clamav_activity

## Monitor mount operations by ClamAV user (UID: 502)
-a always,exit -F arch=b32 -S mount,umount,umount2 -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S mount,umount2 -F "auid=502" -F key=clamav_activity

## Monitor memory protection changes by ClamAV user (UID: 502)
-a always,exit -F arch=b32 -S mprotect -F "auid=502" -F key=clamav_activity
-a always,exit -F arch=b64 -S mprotect,pkey_mprotect -F "auid=502" -F key=clamav_activity

## Monitor file operations by ClamAV user (UID: 104)
-a always,exit -F arch=b32 -S open,openat -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S open,openat -F "auid=104" -F key=clamav_activity

-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F "auid=104" -F key=clamav_activity

-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F "auid=104" -F key=clamav_activity

-a always,exit -F arch=b32 -S chown,fchown,lchown,fchownat -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F "auid=104" -F key=clamav_activity

## Monitor network connections by ClamAV user (UID: 104)
-a always,exit -F arch=b32 -S connect -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S connect -F "auid=104" -F key=clamav_activity

-a always,exit -F arch=b32 -S socket -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S socket -F "auid=104" -F key=clamav_activity

-a always,exit -F arch=b32 -S bind -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S bind -F "auid=104" -F key=clamav_activity

-a always,exit -F arch=b32 -S listen -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S listen -F "auid=104" -F key=clamav_activity

-a always,exit -F arch=b32 -S accept,accept4 -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S accept,accept4 -F "auid=104" -F key=clamav_activity

## Monitor process execution by ClamAV user (UID: 104)
-a always,exit -F arch=b32 -S execve -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S execve -F "auid=104" -F key=clamav_activity

-a always,exit -F arch=b32 -S execveat -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S execveat -F "auid=104" -F key=clamav_activity

## Monitor privilege escalation attempts by ClamAV user (UID: 104)
-a always,exit -F arch=b32 -S setuid,setgid,setreuid,setregid -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S setuid,setgid,setreuid,setregid -F "auid=104" -F key=clamav_activity

-a always,exit -F arch=b32 -S setresuid32,setresgid32,setfsuid32,setfsgid32 -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S setresuid,setresgid,setfsuid,setfsgid -F "auid=104" -F key=clamav_activity

## Monitor capability changes by ClamAV user (UID: 104)
-a always,exit -F arch=b32 -S capset -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S capset -F "auid=104" -F key=clamav_activity

## Monitor module loading attempts by ClamAV user (UID: 104)
-a always,exit -F arch=b32 -S init_module,finit_module -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S init_module,finit_module -F "auid=104" -F key=clamav_activity

-a always,exit -F arch=b32 -S delete_module -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S delete_module -F "auid=104" -F key=clamav_activity

## Monitor mount operations by ClamAV user (UID: 104)
-a always,exit -F arch=b32 -S mount,umount,umount2 -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S mount,umount2 -F "auid=104" -F key=clamav_activity

## Monitor memory protection changes by ClamAV user (UID: 104)
-a always,exit -F arch=b32 -S mprotect -F "auid=104" -F key=clamav_activity
-a always,exit -F arch=b64 -S mprotect,pkey_mprotect -F "auid=104" -F key=clamav_activity

## Monitor ptrace attempts (debugging/injection attempts)
-a always,exit -F arch=b32 -S ptrace -F a0=0x10 -F key=clamav_activity
-a always,exit -F arch=b64 -S ptrace -F a0=0x10 -F key=clamav_activity

-a always,exit -F arch=b32 -S ptrace -F a0=0x11 -F key=clamav_activity
-a always,exit -F arch=b64 -S ptrace -F a0=0x11 -F key=clamav_activity

## Kaspersky
-a always,exit -F arch=b32 -F dir=/etc/kaspersky/ -F perm=wa -F key=kaspersky_config
-a always,exit -F arch=b64 -F dir=/etc/kaspersky/ -F perm=wa -F key=kaspersky_config

-a always,exit -F arch=b32 -F path=/opt/kaspersky/kavdaemon -F perm=x -F key=kaspersky_activity
-a always,exit -F arch=b64 -F path=/opt/kaspersky/kavdaemon -F perm=x -F key=kaspersky_activity

-a always,exit -F arch=b32 -F path=/opt/kaspersky/kavgui -F perm=x -F key=kaspersky_activity
-a always,exit -F arch=b64 -F path=/opt/kaspersky/kavgui -F perm=x -F key=kaspersky_activity

-a always,exit -F arch=b32 -F dir=/opt/kaspersky/ -F perm=x -F key=kaspersky_activity
-a always,exit -F arch=b64 -F dir=/opt/kaspersky/ -F perm=x -F key=kaspersky_activity

-a always,exit -F arch=b32 -F dir=/opt/kaspersky/bin/ -F perm=x -F key=kaspersky_activity
-a always,exit -F arch=b64 -F dir=/opt/kaspersky/bin/ -F perm=x -F key=kaspersky_activity

-a always,exit -F arch=b32 -F dir=/opt/kaspersky/kav4fs/ -F perm=x -F key=kaspersky_activity
-a always,exit -F arch=b64 -F dir=/opt/kaspersky/kav4fs/ -F perm=x -F key=kaspersky_activity

## McAfee
-a always,exit -F arch=b32 -F dir=/etc/mcafee/ -F perm=wa -F key=mcafee_config
-a always,exit -F arch=b64 -F dir=/etc/mcafee/ -F perm=wa -F key=mcafee_config

-a always,exit -F arch=b32 -F path=/opt/mcafee/vstcl -F perm=x -F key==mcafee_activity
-a always,exit -F arch=b64 -F path=/opt/mcafee/vstcl -F perm=x -F key==mcafee_activity

-a always,exit -F arch=b32 -F path=/opt/mcafee/naresh -F perm=x -F key==mcafee_activity
-a always,exit -F arch=b64 -F path=/opt/mcafee/naresh -F perm=x -F key==mcafee_activity

-a always,exit -F arch=b32 -F dir=/opt/mcafee/ -F perm=x -F key=mcafee_activity
-a always,exit -F arch=b64 -F dir=/opt/mcafee/ -F perm=x -F key=mcafee_activity

## Norton:
-a always,exit -F arch=b32 -F dir=/etc/norton/ -F perm=wa -F key=norton_config
-a always,exit -F arch=b64 -F dir=/etc/norton/ -F perm=wa -F key=norton_config

-a always,exit -F arch=b32 -F path=/opt/norton/nortonav -F perm=x -F key=norton_activity
-a always,exit -F arch=b64 -F path=/opt/norton/nortonav -F perm=x -F key=norton_activity

-a always,exit -F arch=b32 -F path=/opt/norton/nortongui -F perm=x -F key=norton_activity
-a always,exit -F arch=b64 -F path=/opt/norton/nortongui -F perm=x -F key=norton_activity

-a always,exit -F arch=b32 -F dir=/opt/norton/ -F perm=x -F key=norton_activity
-a always,exit -F arch=b64 -F dir=/opt/norton/ -F perm=x -F key=norton_activity

## Panda
-a always,exit -F arch=b32 -F dir=/etc/panda/ -F perm=wa -F key=panda_config
-a always,exit -F arch=b64 -F dir=/etc/panda/ -F perm=wa -F key=panda_config

-a always,exit -F arch=b32 -F path=/opt/panda/pavdaemon -F perm=x -F key=panda_activity
-a always,exit -F arch=b64 -F path=/opt/panda/pavdaemon -F perm=x -F key=panda_activity

-a always,exit -F arch=b32 -F path=/opt/panda/pavgui -F perm=x -F key=panda_activity
-a always,exit -F arch=b64 -F path=/opt/panda/pavgui -F perm=x -F key=panda_activity

-a always,exit -F arch=b32 -F dir=/opt/panda/ -F perm=x -F key=panda_activity
-a always,exit -F arch=b64 -F dir=/opt/panda/ -F perm=x -F key=panda_activity

## Sophos
-a always,exit -F arch=b32 -F dir=/etc/sophos/ -F perm=wa -F key=sophos_config
-a always,exit -F arch=b64 -F dir=/etc/sophos/ -F perm=wa -F key=sophos_config

-a always,exit -F arch=b32 -F path=/opt/sophos/savd -F perm=x -F key=sophos_activity
-a always,exit -F arch=b64 -F path=/opt/sophos/savd -F perm=x -F key=sophos_activity

-a always,exit -F arch=b32 -F path=/opt/sophos/savgui -F perm=x -F key=sophos_activity
-a always,exit -F arch=b64 -F path=/opt/sophos/savgui -F perm=x -F key=sophos_activity

-a always,exit -F arch=b32 -F dir=/opt/sophos/ -F perm=x -F key=sophos_activity
-a always,exit -F arch=b64 -F dir=/opt/sophos/ -F perm=x -F key=sophos_activity

Symantec
-a always,exit -F arch=b32 -F dir=/etc/mcafee/ -F perm=wa -F key=symantec_config
-a always,exit -F arch=b64 -F dir=/etc/mcafee/ -F perm=wa -F key=symantec_config

-a always,exit -F arch=b32 -F path=/opt/symantec/sep/bin/SymantecEndpointProtection -F perm=x -F key=symantec_activity
-a always,exit -F arch=b64 -F path=/opt/symantec/sep/bin/SymantecEndpointProtection -F perm=x -F key=symantec_activity

-a always,exit -F arch=b32 -F path=/opt/symantec/sep/bin/SymantecEndpointProtectionGUI -F perm=x -F key=symantec_activity
-a always,exit -F arch=b64 -F path=/opt/symantec/sep/bin/SymantecEndpointProtectionGUI -F perm=x -F key=symantec_activity

-a always,exit -F arch=b32 -F dir=/opt/symantec/ -F perm=x -F key=symantec_activity
-a always,exit -F arch=b64 -F dir=/opt/symantec/ -F perm=x -F key=symantec_activity

## Trend Micro
-a always,exit -F arch=b32 -F dir=/etc/trendmicro/officeScan/ -F perm=wa -F key=trendmicro_config
-a always,exit -F arch=b64 -F dir=/etc/trendmicro/officeScan/ -F perm=wa -F key=trendmicro_config

-a always,exit -F arch=b32 -F dir=/etc/trendmicro/ -F perm=wa -F key=trendmicro_config
-a always,exit -F arch=b64 -F dir=/etc/trendmicro/ -F perm=wa -F key=trendmicro_config

-a always,exit -F arch=b32 -F path=/opt/trendmicro/officeScan/bin/officescan -F perm=x -F key=trendmicro_activity
-a always,exit -F arch=b64 -F path=/opt/trendmicro/officeScan/bin/officescan -F perm=x -F key=trendmicro_activity

-a always,exit -F arch=b32 -F path=/opt/trendmicro/officeScan/bin/officescanGUI -F perm=x -F key=trendmicro_activity
-a always,exit -F arch=b64 -F path=/opt/trendmicro/officeScan/bin/officescanGUI -F perm=x -F key=trendmicro_activity

-a always,exit -F arch=b32 -F dir=/opt/trendmicro/ -F perm=x -F key=trendmicro_activity
-a always,exit -F arch=b64 -F dir=/opt/trendmicro/ -F perm=x -F key=trendmicro_activity

## ESET
-a always,exit -F arch=b32 -F dir=/etc/eset/ -F perm=wa -F key=eset_config
-a always,exit -F arch=b64 -F dir=/etc/eset/ -F perm=wa -F key=eset_config

-a always,exit -F arch=b32 -F path=/opt/eset/esets_daemon -F perm=x -F key=eset_activity
-a always,exit -F arch=b64 -F path=/opt/eset/esets_daemon -F perm=x -F key=eset_activity

-a always,exit -F arch=b32 -F path=/opt/eset/esets_gui -F perm=x -F key=eset_activity
-a always,exit -F arch=b64 -F path=/opt/eset/esets_gui -F perm=x -F key=eset_activity

-a always,exit -F arch=b32 -F dir=/opt/eset/ -F perm=x -F key=eset_activity
-a always,exit -F arch=b64 -F dir=/opt/eset/ -F perm=x -F key=eset_activity

## F-Secure
-a always,exit -F arch=b32 -F dir=/etc/f-secure/fsav/ -F perm=wa -F key=fsecure_config
-a always,exit -F arch=b64 -F dir=/etc/f-secure/fsav/ -F perm=wa -F key=fsecure_config

-a always,exit -F arch=b32 -F dir=/etc/f-secure/ -F perm=wa -F key=fsecure_config
-a always,exit -F arch=b64 -F dir=/etc/f-secure/ -F perm=wa -F key=fsecure_config

-a always,exit -F arch=b32 -F dir=/etc/fsecure/fsav/ -F perm=wa -F key=fsecure_config
-a always,exit -F arch=b64 -F dir=/etc/fsecure/fsav/ -F perm=wa -F key=fsecure_config

-a always,exit -F arch=b32 -F dir=/etc/fsecure/ -F perm=wa -F key=fsecure_config
-a always,exit -F arch=b64 -F dir=/etc/fsecure/ -F perm=wa -F key=fsecure_config

-a always,exit -F arch=b32 -F path=/opt/f-secure/fsav/bin/fsav -F perm=x -F key=fsecure_activity
-a always,exit -F arch=b64 -F path=/opt/f-secure/fsav/bin/fsav -F perm=x -F key=fsecure_activity

-a always,exit -F arch=b32 -F path=/opt/f-secure/fsav/bin/fsavgui -F perm=x -F key=fsecure_activity
-a always,exit -F arch=b64 -F path=/opt/f-secure/fsav/bin/fsavgui -F perm=x -F key=fsecure_activity

-a always,exit -F arch=b32 -F dir=/opt/f-secure/ -F perm=x -F key=fsecure_activity
-a always,exit -F arch=b64 -F dir=/opt/f-secure/ -F perm=x -F key=fsecure_activity

-a always,exit -F arch=b32 -F dir=/opt/fsecure/ -F perm=x -F key=fsecure_activity
-a always,exit -F arch=b64 -F dir=/opt/fsecure/ -F perm=x -F key=fsecure_activity

## Avast
-a always,exit -F arch=b32 -F dir=/etc/avast/ -F perm=wa -F key=avast_config
-a always,exit -F arch=b64 -F dir=/etc/avast/ -F perm=wa -F key=avast_config

-a always,exit -F arch=b32 -F path=/opt/avast/avastd -F perm=x -F key=avast_activity
-a always,exit -F arch=b64 -F path=/opt/avast/avastd -F perm=x -F key=avast_activity

-a always,exit -F arch=b32 -F path=/opt/avast/avastgui -F perm=x -F key=avast_activity
-a always,exit -F arch=b64 -F path=/opt/avast/avastgui -F perm=x -F key=avast_activity

-a always,exit -F arch=b32 -F dir=/opt/avast/ -F perm=x -F key=avast_activity
-a always,exit -F arch=b64 -F dir=/opt/avast/ -F perm=x -F key=avast_activity

## AVG
-a always,exit -F arch=b32 -F dir=/etc/avg/ -F perm=wa -F key=avg_config
-a always,exit -F arch=b64 -F dir=/etc/avg/ -F perm=wa -F key=avg_config

-a always,exit -F arch=b32 -F path=/opt/avg/avgd -F perm=x -F key=avg_activity
-a always,exit -F arch=b64 -F path=/opt/avg/avgd -F perm=x -F key=avg_activity

-a always,exit -F arch=b32 -F path=/opt/avg/avggui -F perm=x -F key=avg_activity
-a always,exit -F arch=b64 -F path=/opt/avg/avggui -F perm=x -F key=avg_activity

-a always,exit -F arch=b32 -F dir=/opt/avg/ -F perm=x -F key=avg_activity
-a always,exit -F arch=b64 -F dir=/opt/avg/ -F perm=x -F key=avg_activity

## MS Defender
-a always,exit -F arch=b32 -F dir=/etc/microsoft/defender/ -F perm=wa -F key=msdefender_config
-a always,exit -F arch=b64 -F dir=/etc/microsoft/defender/ -F perm=wa -F key=msdefender_config

-a always,exit -F arch=b32 -F dir=/etc/opt/microsoft/ -F perm=wa -F key=msdefender_config
-a always,exit -F arch=b64 -F dir=/etc/opt/microsoft/ -F perm=wa -F key=msdefender_config

-a always,exit -F arch=b32 -F path=/opt/microsoft/defender/md -F perm=x -F key=msdefender_activity
-a always,exit -F arch=b64 -F path=/opt/microsoft/defender/md -F perm=x -F key=msdefender_activity

-a always,exit -F arch=b32 -F path=/opt/microsoft/defender/mdgui -F perm=x -F key=msdefender_activity
-a always,exit -F arch=b64 -F path=/opt/microsoft/defender/mdgui -F perm=x -F key=msdefender_activity

-a always,exit -F arch=b32 -F dir=/opt/microsoft/mdatp/ -F perm=x -F key=msdefender_activity
-a always,exit -F arch=b64 -F dir=/opt/microsoft/mdatp/ -F perm=x -F key=msdefender_activity

-a always,exit -F arch=b32 -F dir=/opt/microsoft/ -F perm=x -F key=msdefender_activity
-a always,exit -F arch=b64 -F dir=/opt/microsoft/ -F perm=x -F key=msdefender_activity

## Mandiant
-a always,exit -F arch=b32 -F path=/etc/mandiant/mdr.conf -F perm=wa -F key=mandiant_config
-a always,exit -F arch=b64 -F path=/etc/mandiant/mdr.conf -F perm=wa -F key=mandiant_config

-a always,exit -F arch=b32 -F dir=/etc/mandiant/ -F perm=wa -F key=mmandiant_config
-a always,exit -F arch=b64 -F dir=/etc/mandiant/ -F perm=wa -F key=mandiant_config

-a always,exit -F arch=b32 -F path=/opt/mandiant/mdr -F perm=x -F key=mandiant_activity
-a always,exit -F arch=b64 -F path=/opt/mandiant/mdr -F perm=x -F key=mandiant_activity

-a always,exit -F arch=b32 -F path=/opt/mandiant/mdr_gui -F perm=x -F key=mandiant_activity
-a always,exit -F arch=b64 -F path=/opt/mandiant/mdr_gui -F perm=x -F key=mandiant_activity

-a always,exit -F arch=b32 -F dir=/opt/mandiant/ -F perm=x -F key=mandiant_activity
-a always,exit -F arch=b64 -F dir=/opt/mandiant/ -F perm=x -F key=mandiant_activity

# CrowdStrike Falcon
# Identify CrowdStrike Falcon Sensor updates
-a always,exit -F arch=b32 -F path=/etc/crowdstrike/falcon-sensor.conf -F perm=wa -F key=falcon_sensor_update
-a always,exit -F arch=b64 -F path=/etc/crowdstrike/falcon-sensor.conf -F perm=wa -F key=falcon_sensor_update

-a always,exit -F arch=b32 -F path=/usr/lib/crowdstrike/falcon-sensor.conf -F perm=wa -F key=falcon_sensor_update
-a always,exit -F arch=b64 -F path=/usr/lib/crowdstrike/falcon-sensor.conf -F perm=wa -F key=falcon_sensor_update

# Identify CrowdStrike Falcon Sensor
-a always,exit -F arch=b32 -F dir=/etc/crowdstrike/ -F perm=wa -F key=falcon_sensor
-a always,exit -F arch=b64 -F dir=/etc/crowdstrike/ -F perm=wa -F key=falcon_sensor

-a always,exit -F arch=b32 -F dir=/usr/lib/crowdstrike/ -F perm=wa -F key=falcon_sensor
-a always,exit -F arch=b64 -F dir=/usr/lib/crowdstrike/ -F perm=wa -F key=falcon_sensor

-a always,exit -F arch=b32 -F dir=/opt/CrowdStrike/ -F perm=wa -F key=falcon_sensor
-a always,exit -F arch=b64 -F dir=/opt/CrowdStrike/ -F perm=wa -F key=falcon_sensor

-a always,exit -F arch=b32 -F dir=/var/log/crowdstrike/ -F perm=wa -F key=falcon_sensor
-a always,exit -F arch=b64 -F dir=/var/log/crowdstrike/ -F perm=wa -F key=falcon_sensor

# Identify CrowdStrike Falcon Agent activity
-a always,exit -F arch=b32 -F path=/usr/bin/falcon-scout -F perm=x -F key=falcon_agent
-a always,exit -F arch=b64 -F path=/usr/bin/falcon-scout -F perm=x -F key=falcon_agent

-a always,exit -F arch=b32 -F path=/usr/bin/falcon-agent -F perm=x -F key=falcon_agent
-a always,exit -F arch=b64 -F path=/usr/bin/falcon-agent -F perm=x -F key=falcon_agent

# Identify CrowdStrike Falcon Sensor network
-a always,exit -F arch=b32 -S connect -F dir=+ -F obj=/opt/CrowdStrike/falcon-sensor -F key=crowdstrike_network
-a always,exit -F arch=b64 -S connect -F dir=+ -F obj=/opt/CrowdStrike/falcon-sensor -F key=crowdstrike_network

# ============================================================================
# TEMPLATE: Safe AV monitoring for production
# Replace UID_HERE with actual UID from your system
# ============================================================================

# For each AV, monitor only critical syscalls
# Example for a generic AV with UID 502

# Network activity (should be minimal for AV)
-a always,exit -F arch=b32 -F euid=502 -S socket -S connect -S bind -F key=av502_network
-a always,exit -F arch=b64 -F euid=502 -S socket -S connect -S bind -F key=av502_network

# Process execution (monitor what AV spawns)
-a always,exit -F arch=b32 -F euid=502 -S execve -F key=av502_exec
-a always,exit -F arch=b64 -F euid=502 -S execve -F key=av502_exec

# Privilege operations (should never happen)
-a always,exit -F arch=b32 -F euid=502 -S setuid -S setgid -F key=av502_privilege
-a always,exit -F arch=b64 -F euid=502 -S setuid -S setgid -F key=av502_privilege

# Module loading (very suspicious for AV)
-a always,exit -F arch=b32 -F euid=502 -S init_module -S finit_module -F key=av502_module
-a always,exit -F arch=b64 -F euid=502 -S init_module -S finit_module -F key=av502_module

#
# --- Explanation of UID-Based Auditd Rules ---
#
# What is auditd and UID Monitoring?
# auditd is the Linux Auditing System. It watches for specific actions on your system (called "syscalls") and logs them for security analysis.
# One of its most powerful features is monitoring actions based on the User ID (UID) of the person or service performing the action.
# Each user on a Linux system has a unique UID. Monitoring by UID helps answer questions like:
#   - Is a low-privilege user trying to do something only an administrator should do?
#   - Is a new, unexpected user account being used?
#   - Are regular users trying to escalate their privileges?
#
# --- Breakdown of the UID Rules ---
#
# 1. UID `nobody` (UIDs 98, 65534):
#    - Why: The `nobody` user is a special, unprivileged account used to run services with minimal permissions. It should NOT be performing sensitive actions.
#    - What it covers: These rules watch for highly suspicious behavior from the `nobody` user, such as:
#        - `socket`: Creating raw network sockets, which can be used for network attacks.
#        - `execve`: Executing new programs.
#        - `setuid`, `setgid`: Attempting to change its own user/group ID to gain more privileges.
#        - `init_module`: Trying to load a kernel module, which is a very high-privilege operation.
#
# 2. UID `65535`:
#    - Why: This UID often represents an "invalid" or "unmapped" user, frequently seen in network file systems (like NFS) when permissions don't line up.
#    - What it covers: Similar to `nobody`, it monitors for suspicious privilege escalation, socket creation, and kernel module loading.
#
# 3. Unused UID Ranges:
#    - Why: Linux systems have defined ranges for different types of users. The ranges marked as "unused" should ideally never have active accounts.
#    - What it covers: These rules are designed to alert you if an account is suddenly created or used within these dormant ranges, which could be a sign of a compromise.
#      To avoid excessive noise, they only monitor for critical events like process execution (`execve`) and privilege changes (`setuid`).
#
# 4. Regular and System User Ranges:
#    - Why: This covers all other user types, from system services (UIDs 1-999) to regular human users (1000+), dynamic users, and `systemd-homed` users.
#    - What it covers: For these accounts, the primary concern is privilege escalation. The rules watch for any use of `setuid`, `setgid`, `setreuid`, and `setregid`,
#      which are system calls used to change a process's user or group identity. An unexpected event here could indicate an attacker is trying to gain root access.
#
# 5. Container UID Ranges (524288+):
#    - Why: Containers run in isolated environments but use the host system's kernel. A compromised container might try to "escape" to gain control of the host.
#    - What it covers: These rules specifically monitor for actions that are highly indicative of a container escape attempt, such as:
#        - `mount`: Trying to mount a new filesystem from within the container.
#        - `init_module`: Attempting to load a kernel module.
#
# UID
## UID nobody
## noisy
# -a always,exit -F arch=b32 -F euid=98 -S all -F key=user_nobody_activity
# -a always,exit -F arch=b64 -F euid=98 -S all -F key=user_nobody_activity

# -a always,exit -F arch=b32 -F euid=65534 -S all -F key=user_nobody_activity
# -a always,exit -F arch=b64 -F euid=65534 -S all -F key=user_nobody_activity

## Monitor nobody creating raw sockets (suspicious)
-a always,exit -F arch=b32 -F euid=98 -S socket -F a1=3 -F key=user_nobody_activity
-a always,exit -F arch=b64 -F euid=98 -S socket -F a1=3 -F key=user_nobody_activity

-a always,exit -F arch=b32 -F euid=65534 -S socket -F a1=3 -F key=user_nobody_activity
-a always,exit -F arch=b64 -F euid=65534 -S socket -F a1=3 -F key=user_nobody_activity

## Monitor nobody executing new processes (unusual)
-a always,exit -F arch=b32 -F euid=98 -S execve -F key=user_nobody_activity
-a always,exit -F arch=b64 -F euid=98 -S execve -F key=user_nobody_activity

-a always,exit -F arch=b32 -F euid=65534 -S execve -F key=user_nobody_activity
-a always,exit -F arch=b64 -F euid=65534 -S execve -F key=user_nobody_activity

## Monitor nobody privilege escalation attempts
-a always,exit -F arch=b32 -F euid=98 -S setuid -S setgid -S setreuid -S setregid -F key=user_nobody_activity
-a always,exit -F arch=b64 -F euid=98 -S setuid -S setgid -S setreuid -S setregid -F key=user_nobody_activity

-a always,exit -F arch=b32 -F euid=65534 -S setuid -S setgid -S setreuid -S setregid -F key=user_nobody_activity
-a always,exit -F arch=b64 -F euid=65534 -S setuid -S setgid -S setreuid -S setregid -F key=user_nobody_activity

## Monitor nobody loading kernel modules (very suspicious)
-a always,exit -F arch=b32 -F euid=98 -S init_module -S finit_module -F key=user_nobody_activity
-a always,exit -F arch=b64 -F euid=98 -S init_module -S finit_module -F key=user_nobody_activity

-a always,exit -F arch=b32 -F euid=65534 -S init_module -S finit_module -F key=user_nobody_activity
-a always,exit -F arch=b64 -F euid=65534 -S init_module -S finit_module -F key=user_nobody_activity

### euid=65535
-a always,exit -F arch=b32 -F euid=65535 -S all -F key=uid_65535_activity
-a always,exit -F arch=b64 -F euid=65535 -S all -F key=uid_65535_activity

-a always,exit -F arch=b32 -F euid=65535 -S socket -F a1=3 -F key=uid_65535_activity
-a always,exit -F arch=b64 -F euid=65535 -S socket -F a1=3 -F key=uid_65535_activity

-a always,exit -F arch=b32 -F euid=65535 -S setuid -S setgid -S setreuid -S setregid -F key=uid_65535_activity
-a always,exit -F arch=b64 -F euid=65535 -S setuid -S setgid -S setreuid -S setregid -F key=uid_65535_activity

-a always,exit -F arch=b32 -F euid=65535 -S socket -F a1=3 -F key=uid_65535_activity
-a always,exit -F arch=b64 -F euid=65535 -S socket -F a1=3 -F key=uid_65535_activity

-a always,exit -F arch=b32 -F euid=65535 -S init_module -S finit_module -F key=uid_65535_activity
-a always,exit -F arch=b64 -F euid=65535 -S init_module -S finit_module -F key=uid_65535_activity

## UID unused
### https://systemd.io/UIDS-GIDS/
### noisy
# -a always,exit -F arch=b32 -F "uid>=60578" -F "uid<=61183" -S all -F key=uid_range_60578_61183_activity
# -a always,exit -F arch=b64 -F "uid>=60578" -F "uid<=61183" -S all -F key=uid_range_60578_61183_activity

# -a always,exit -F arch=b32 -F "uid>=65520" -F "uid<=65533" -S all -F key=uid_range_65520_65533_activity
# -a always,exit -F arch=b64 -F "uid>=65520" -F "uid<=65533" -S all -F key=uid_range_65520_65533_activity

# -a always,exit -F arch=b32 -F "uid>=65536" -F "uid<=524287" -S all -F key=uid_range_65536_524287_activity
# -a always,exit -F arch=b64 -F "uid>=65536" -F "uid<=524287" -S all -F key=uid_range_65536_524287_activity

# -a always,exit -F arch=b32 -F "uid>=1879048192" -F "uid<=2147483647" -S all -F key=uid_range_1879048192_2147483647_activity
# -a always,exit -F arch=b64 -F "uid>=1879048192" -F "uid<=2147483647" -S all -F key=uid_range_1879048192_2147483647_activity

### Monitor when these UIDs are first used (account creation)
-a always,exit -F arch=b32 -S setuid -F "a0>=60578" -F "a0<=61183" -F key=uid_range_60578_61183_activity
-a always,exit -F arch=b64 -S setuid -F "a0>=60578" -F "a0<=61183" -F key=uid_range_60578_61183_activity

### Monitor execve from specific suspicious ranges only
-a always,exit -F arch=b32 -F "uid>=65520" -F "uid<=65533" -S execve -F key=uid_range_65520_65533_activity
-a always,exit -F arch=b64 -F "uid>=65520" -F "uid<=65533" -S execve -F key=uid_range_65520_65533_activity

-a always,exit -F arch=b32 -F "uid>=65520" -F "uid<=65533" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_65520_65533_activity
-a always,exit -F arch=b64 -F "uid>=65520" -F "uid<=65533" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_65520_65533_activity

### For very large ranges, monitor only critical operations
-a always,exit -F arch=b32 -F "uid>=65520" -F "uid<=65533" -S execve -S socket -F key=uid_range_65520_65533_activity
-a always,exit -F arch=b64 -F "uid>=65520" -F "uid<=65533" -S execve -S socket -F key=uid_range_65520_65533_activity

-a always,exit -F arch=b32 -F "uid>=1879048192" -F "uid<=2147483647" -S execve -S socket -F key=uid_range_1879048192_2147483647_activity
-a always,exit -F arch=b64 -F "uid>=1879048192" -F "uid<=2147483647" -S execve -S socket -F key=uid_range_1879048192_2147483647_activity

## UID Everything else, i.e. regular (human) users
### https://systemd.io/UIDS-GIDS/
-a always,exit -F arch=b32 -S setuid -F "a0>=499" -F "a0<=999" -F key=uid_range_499_999_activity
-a always,exit -F arch=b64 -S setuid -F "a0>=499" -F "a0<=999" -F key=uid_range_499_999_activity

-a always,exit -F arch=b32 -F "uid>=499" -F "uid<=999" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_499_999_activity
-a always,exit -F arch=b64 -F "uid>=499" -F "uid<=999" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_499_999_activity

-a always,exit -F arch=b32 -S setuid -F "a0>=1000" -F "a0<=65533" -F key=uid_range_1000_65533_activity
-a always,exit -F arch=b64 -S setuid -F "a0>=1000" -F "a0<=65533" -F key=uid_range_1000_65533_activity

-a always,exit -F arch=b32 -F "uid>=1000" -F "uid<=65533" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_1000_65533_activity
-a always,exit -F arch=b64 -F "uid>=1000" -F "uid<=65533" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_1000_65533_activity

-a always,exit -F arch=b32 -S setuid -F "a0>=65536" -F "a0<=4294967294" -F key=uid_range_65536_4294967294_activity
-a always,exit -F arch=b64 -S setuid -F "a0>=65536" -F "a0<=4294967294" -F key=uid_range_65536_4294967294_activity

-a always,exit -F arch=b32 -F "uid>=65536" -F "uid<=4294967294" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_65536_4294967294_activity
-a always,exit -F arch=b64 -F "uid>=65536" -F "uid<=4294967294" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_65536_4294967294_activity

## UIDs for home directories managed by systemd-homed.service(8)
-a always,exit -F arch=b32 -S setuid -F "a0>=60001" -F "a0<=60513" -F key=uid_range_60001_60513_activity
-a always,exit -F arch=b64 -S setuid -F "a0>=60001" -F "a0<=60513" -F key=uid_range_60001_60513_activity

-a always,exit -F arch=b32 -F "uid>=60001" -F "uid<=60513" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_60001_60513_activity
-a always,exit -F arch=b64 -F "uid>=60001" -F "uid<=60513" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_60001_60513_activity

## UIDs for dynamic users are allocated from this range (see the DynamicUser= documentation in systemd.exec(5))
-a always,exit -F arch=b32 -S setuid -F "a0>=61184" -F "a0<=65519" -F key=uid_range_61184_65519_activity
-a always,exit -F arch=b64 -S setuid -F "a0>=61184" -F "a0<=65519" -F key=uid_range_61184_65519_activity

-a always,exit -F arch=b32 -F "uid>=61184" -F "uid<=65519" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_61184_65519_activity
-a always,exit -F arch=b64 -F "uid>=61184" -F "uid<=65519" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_61184_65519_activity

## UID System users
### https://systemd.io/UIDS-GIDS/
-a always,exit -F arch=b32 -S setuid -F "a0>=1" -F "a0<=498" -F key=uid_range_1_498_activity
-a always,exit -F arch=b64 -S setuid -F "a0>=1" -F "a0<=498" -F key=uid_range_1_498_activity

-a always,exit -F arch=b32 -F "uid>=1" -F "uid<=498" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_1_498_activity
-a always,exit -F arch=b64 -F "uid>=1" -F "uid<=498" -S setuid -S setgid -S setreuid -S setregid -F key=uid_range_1_498_activity

## UID Container UID ranges
### https://systemd.io/UIDS-GIDS/
# -a always,exit -F arch=b32 -F "uid>=524288" -F "uid<=1879048191" -S all -F key=uid_range_524288_1879048191_activity
# -a always,exit -F arch=b64 -F "uid>=524288" -F "uid<=1879048191" -S all -F key=uid_range_524288_1879048191_activity

-a always,exit -F arch=b32 -F "uid>=524288" -F "uid<=525288" -S mount -F key=container_mount_attempt
-a always,exit -F arch=b64 -F "uid>=524288" -F "uid<=525288" -S mount -F key=container_mount_attempt

-a always,exit -F arch=b32 -F "uid>=524288" -F "uid<=525288" -S init_module -S finit_module -F key=container_mount_attempt
-a always,exit -F arch=b64 -F "uid>=524288" -F "uid<=525288" -S init_module -S finit_module -F key=container_mount_attempt

## Istio
### https://istio.io/latest/docs/reference/config/analysis/ist0144/
### noisy
# -a always,exit -F arch=b32 -F euid=1337 -S all -F key=user_1337_activity
# -a always,exit -F arch=b64 -F euid=1337 -S all -F key=user_1337_activity

# -a always,exit -F arch=b32 -F euid=1338 -S all -F key=user_1338_activity
# -a always,exit -F arch=b64 -F euid=1338 -S all -F key=user_1338_activity

-a always,exit -F arch=b32 -F euid=1337 -S execve -F key=user_1337_activity
-a always,exit -F arch=b64 -F euid=1337 -S execve -F key=user_1337_activity

-a always,exit -F arch=b32 -F euid=1338 -S execve -F key=user_1338_activity
-a always,exit -F arch=b64 -F euid=1338 -S execve -F key=user_1338_activity

## Linux UIDs for the anti-virus programs
## Note: The UIDs used below are examples and may vary depending
## on the specific installation and configuration of the anti-virus software.

### Bitdefender: UID: 501/403 (bitdefender)
-a always,exit -F arch=b32 -F euid=403 -S all -F key=bitdefender_activity
-a always,exit -F arch=b64 -F euid=403 -S all -F key=bitdefender_activity

-a always,exit -F arch=b32 -F euid=501 -S all -F key=bitdefender_activity
-a always,exit -F arch=b64 -F euid=501 -S all -F key=bitdefender_activity

### ClamAV: UID: 502/104 (clamav)
-a always,exit -F arch=b32 -F euid=104 -S all -F key=clamav_activity
-a always,exit -F arch=b64 -F euid=104 -S all -F key=clamav_activity

-a always,exit -F arch=b32 -F euid=502 -S all -F key=clamav_activity
-a always,exit -F arch=b64 -F euid=502 -S all -F key=clamav_activity

### Kaspersky: UID: 503/450 (kaspersky)
-a always,exit -F arch=b32 -F euid=450 -S all -F key=kaspersky_activity
-a always,exit -F arch=b64 -F euid=450 -S all -F key=kaspersky_activity

-a always,exit -F arch=b32 -F euid=503 -S all -F key=kaspersky_activity
-a always,exit -F arch=b64 -F euid=503 -S all -F key=kaspersky_activity

### McAfee: UID: 504/452 (mcafee)
-a always,exit -F arch=b32 -F euid=452 -S all -F key=mcafee_activity
-a always,exit -F arch=b64 -F euid=452 -S all -F key=mcafee_activity

-a always,exit -F arch=b32 -F euid=504 -S all -F key=mcafee_activity
-a always,exit -F arch=b64 -F euid=504 -S all -F key=mcafee_activity

### Norton: UID: 505 (norton)
-a always,exit -F arch=b32 -F euid=505 -S all -F key=norton_activity
-a always,exit -F arch=b64 -F euid=505 -S all -F key=norton_activity

### Panda: UID: 506/499 (panda)
-a always,exit -F arch=b32 -F euid=499 -S all -F key=panda_activity
-a always,exit -F arch=b64 -F euid=499 -S all -F key=panda_activity

-a always,exit -F arch=b32 -F euid=506 -S all -F key=panda_activity
-a always,exit -F arch=b64 -F euid=506 -S all -F key=panda_activity

### Sophos: UID: 507/444 (sophos)
-a always,exit -F arch=b32 -F euid=444 -S all -F key=sophos_activity
-a always,exit -F arch=b64 -F euid=444 -S all -F key=sophos_activity

-a always,exit -F arch=b32 -F euid=507 -S all -F key=sophos_activity
-a always,exit -F arch=b64 -F euid=507 -S all -F key=sophos_activity

### Symantec: UID: 508/456 (symantec)
-a always,exit -F arch=b32 -F euid=456 -S all -F key=symantec_activity
-a always,exit -F arch=b64 -F euid=456 -S all -F key=symantec_activity

-a always,exit -F arch=b32 -F euid=508 -S all -F key=symantec_activity
-a always,exit -F arch=b64 -F euid=508 -S all -F key=symantec_activity

### Trend Micro: UID: 509/457 (trendmicro)
-a always,exit -F arch=b32 -F euid=457 -S all -F key=trendmicro_activity
-a always,exit -F arch=b64 -F euid=457 -S all -F key=trendmicro_activity

-a always,exit -F arch=b32 -F euid=509 -S all -F key=trendmicro_activity
-a always,exit -F arch=b64 -F euid=509 -S all -F key=trendmicro_activity

### ESET: UID: 510/459 (eset)
-a always,exit -F arch=b32 -F euid=459 -S all -F key=eset_activity
-a always,exit -F arch=b64 -F euid=459 -S all -F key=eset_activity

-a always,exit -F arch=b32 -F euid=510 -S all -F key=eset_activity
-a always,exit -F arch=b64 -F euid=510 -S all -F key=eset_activity

### F-Secure: UID: 511/458 (fsecure)
-a always,exit -F arch=b32 -F euid=458 -S all -F key=fsecure_activity
-a always,exit -F arch=b64 -F euid=458 -S all -F key=fsecure_activity

-a always,exit -F arch=b32 -F euid=511 -S all -F key=fsecure_activity
-a always,exit -F arch=b64 -F euid=511 -S all -F key=fsecure_activity

### Avast: UID: 512/459 (avast)
-a always,exit -F arch=b32 -F euid=459 -S all -F key=avast_activity
-a always,exit -F arch=b64 -F euid=459 -S all -F key=avast_activity

-a always,exit -F arch=b32 -F euid=512 -S all -F key=avast_activity
-a always,exit -F arch=b64 -F euid=512 -S all -F key=avast_activity

### AVG: UID: 513/450 (avg)
-a always,exit -F arch=b32 -F euid=450 -S all -F key=avg_activity
-a always,exit -F arch=b64 -F euid=450 -S all -F key=avg_activity

-a always,exit -F arch=b32 -F euid=513 -S all -F key=avg_activity
-a always,exit -F arch=b64 -F euid=513 -S all -F key=avg_activity

### MS Defender: UID: 514/456 (msdefender)
### MS tries to shuffle the UID
-a always,exit -F arch=b32 -F euid=456 -S all -F key=msdefender_activity
-a always,exit -F arch=b64 -F euid=456 -S all -F key=msdefender_activity

-a always,exit -F arch=b32 -F euid=514 -S all -F key=msdefender_activity
-a always,exit -F arch=b64 -F euid=514 -S all -F key=msdefender_activity

# DHCP Server

## ============================================================
## DHCP Configuration Files and Directories
## ============================================================

## Monitor all file operations on DHCP configuration
-a always,exit -F arch=b32 -F path=/etc/dhcp/dhcpd.conf -S open -S openat -S creat -F perm=war -F key=dhcp_config
-a always,exit -F arch=b64 -F path=/etc/dhcp/dhcpd.conf -S open -S openat -S creat -F perm=war -F key=dhcp_config

-a always,exit -F arch=b32 -F path=/etc/dhcp/dhcpd6.conf -S open -S openat -S creat -F perm=war -F key=dhcp_config
-a always,exit -F arch=b64 -F path=/etc/dhcp/dhcpd6.conf -S open -S openat -S creat -F perm=war -F key=dhcp_config

-a always,exit -F arch=b32 -F path=/etc/dhcpd.conf -S open -S openat -S creat -F perm=war -F key=dhcp_config
-a always,exit -F arch=b64 -F path=/etc/dhcpd.conf -S open -S openat -S creat -F perm=war -F key=dhcp_config

-a always,exit -F arch=b32 -F path=/etc/dhcp3/dhcpd.conf -S open -S openat -S creat -F perm=war -F key=dhcp_config
-a always,exit -F arch=b64 -F path=/etc/dhcp3/dhcpd.conf -S open -S openat -S creat -F perm=war -F key=dhcp_config

-a always,exit -F arch=b32 -F path=/etc/dnsmasq.conf -S open -S openat -S creat -F perm=war -F key=dnsmasq_config
-a always,exit -F arch=b64 -F path=/etc/dnsmasq.conf -S open -S openat -S creat -F perm=war -F key=dnsmasq_config

## Monitor directory operations
-a always,exit -F arch=b32 -F dir=/etc/dhcp/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=dhcp_config_dir
-a always,exit -F arch=b64 -F dir=/etc/dhcp/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=dhcp_config_dir

-a always,exit -F arch=b32 -F dir=/etc/dnsmasq.d/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=dnsmasq_config_dir
-a always,exit -F arch=b64 -F dir=/etc/dnsmasq.d/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=dnsmasq_config_dir

## ============================================================
## DHCP Lease Files and Databases
## ============================================================

-a always,exit -F arch=b32 -F path=/var/lib/dhcp/dhcpd.leases -S open -S openat -S write -S truncate -S ftruncate -F perm=wa -F key=dhcp_leases
-a always,exit -F arch=b64 -F path=/var/lib/dhcp/dhcpd.leases -S open -S openat -S write -S truncate -S ftruncate -F perm=wa -F key=dhcp_leases

-a always,exit -F arch=b32 -F path=/var/lib/dhcp/dhcpd6.leases -S open -S openat -S write -S truncate -S ftruncate -F perm=wa -F key=dhcp_leases
-a always,exit -F arch=b64 -F path=/var/lib/dhcp/dhcpd6.leases -S open -S openat -S write -S truncate -S ftruncate -F perm=wa -F key=dhcp_leases

-a always,exit -F arch=b32 -F path=/var/lib/dhcpd/dhcpd.leases -S open -S openat -S write -S truncate -S ftruncate -F perm=wa -F key=dhcp_leases
-a always,exit -F arch=b64 -F path=/var/lib/dhcpd/dhcpd.leases -S open -S openat -S write -S truncate -S ftruncate -F perm=wa -F key=dhcp_leases

-a always,exit -F arch=b32 -F path=/var/state/dhcp/dhcpd.leases -S open -S openat -S write -S truncate -S ftruncate -F perm=wa -F key=dhcp_leases
-a always,exit -F arch=b64 -F path=/var/state/dhcp/dhcpd.leases -S open -S openat -S write -S truncate -S ftruncate -F perm=wa -F key=dhcp_leases

-a always,exit -F arch=b32 -F path=/var/lib/misc/dnsmasq.leases -S open -S openat -S write -S truncate -S ftruncate -F perm=wa -F key=dnsmasq_leases
-a always,exit -F arch=b64 -F path=/var/lib/misc/dnsmasq.leases -S open -S openat -S write -S truncate -S ftruncate -F perm=wa -F key=dnsmasq_leases

## ============================================================
## DHCP Server Binary Execution
## ============================================================

-a always,exit -F arch=b32 -F path=/usr/sbin/dhcpd -S execve -F key=dhcp_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/dhcpd -S execve -F key=dhcp_exec

-a always,exit -F arch=b32 -F path=/usr/sbin/dhcpd6 -S execve -F key=dhcp_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/dhcpd6 -S execve -F key=dhcp_exec

-a always,exit -F arch=b32 -F path=/usr/sbin/dnsmasq -S execve -F key=dnsmasq_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/dnsmasq -S execve -F key=dnsmasq_exec

-a always,exit -F arch=b32 -F path=/usr/sbin/in.dhcpd -S execve -F key=dhcp_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/in.dhcpd -S execve -F key=dhcp_exec

## ============================================================
## Network Socket Monitoring
## ============================================================

## Monitor DHCP server port bindings (port 67 for IPv4, port 547 for IPv6)
-a always,exit -F arch=b32 -S bind -F a0=67 -F key=dhcp_bind
-a always,exit -F arch=b64 -S bind -F a0=67 -F key=dhcp_bind

-a always,exit -F arch=b32 -S bind -F a0=547 -F key=dhcp_bind
-a always,exit -F arch=b64 -S bind -F a0=547 -F key=dhcp_bind

## Monitor socket operations
-a always,exit -F arch=b32 -S socket -S connect -S sendmsg -S recvmsg -S bind -S listen -S accept -F key=dhcp_network
-a always,exit -F arch=b64 -S socket -S connect -S sendmsg -S recvmsg -S bind -S listen -S accept -S accept4 -F key=dhcp_network

-a always,exit -F arch=b32 -S socketpair -S sendto -S recvfrom -S shutdown -S getsockname -S getpeername -F key=dhcp_network
-a always,exit -F arch=b64 -S socketpair -S sendto -S recvfrom -S shutdown -S getsockname -S getpeername -F key=dhcp_network

## ============================================================
## Service Management
## ============================================================

## SystemD service management - dhcpd
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=dhcpd -F key=dhcp_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=dhcpd -F key=dhcp_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=dhcpd6 -F key=dhcp_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=dhcpd6 -F key=dhcp_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=isc-dhcp-server -F key=dhcp_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=isc-dhcp-server -F key=dhcp_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=isc-dhcp-server6 -F key=dhcp_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=isc-dhcp-server6 -F key=dhcp_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=dnsmasq -F key=dhcp_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=dnsmasq -F key=dhcp_service_mgmt

## Legacy service management
-a always,exit -F arch=b32 -F path=/sbin/service -S execve -F key=service_mgmt
-a always,exit -F arch=b64 -F path=/sbin/service -S execve -F key=service_mgmt

-a always,exit -F arch=b32 -F path=/etc/init.d/dhcpd -S execve -F key=dhcp_service_mgmt
-a always,exit -F arch=b64 -F path=/etc/init.d/dhcpd -S execve -F key=dhcp_service_mgmt

-a always,exit -F arch=b32 -F path=/etc/init.d/isc-dhcp-server -S execve -F key=dhcp_service_mgmt
-a always,exit -F arch=b64 -F path=/etc/init.d/isc-dhcp-server -S execve -F key=dhcp_service_mgmt

## ============================================================
## DHCP-Related Commands and Utilities
## ============================================================

-a always,exit -F arch=b32 -F path=/usr/sbin/dhcp-lease-list -S execve -F key=dhcp_utilities
-a always,exit -F arch=b64 -F path=/usr/sbin/dhcp-lease-list -S execve -F key=dhcp_utilities

-a always,exit -F arch=b32 -F path=/usr/bin/dhcp-lease-list -S execve -F key=dhcp_utilities
-a always,exit -F arch=b64 -F path=/usr/bin/dhcp-lease-list -S execve -F key=dhcp_utilities

-a always,exit -F arch=b32 -F path=/usr/sbin/omshell -S execve -F key=dhcp_omapi
-a always,exit -F arch=b64 -F path=/usr/sbin/omshell -S execve -F key=dhcp_omapi

## Configuration test utilities
-a always,exit -F arch=b32 -F path=/usr/sbin/dhcpd -S execve -F a1=-t -F key=dhcp_config_test
-a always,exit -F arch=b64 -F path=/usr/sbin/dhcpd -S execve -F a1=-t -F key=dhcp_config_test

-a always,exit -F arch=b32 -F path=/usr/sbin/dhcpd -S execve -F a1=-T -F key=dhcp_config_test
-a always,exit -F arch=b64 -F path=/usr/sbin/dhcpd -S execve -F a1=-T -F key=dhcp_config_test

## ============================================================
## File Operations
## ============================================================

## Monitor file attribute changes
-a always,exit -F arch=b32 -F dir=/etc/dhcp/ -S chmod -S fchmod -S fchmodat -F key=dhcp_file_attr
-a always,exit -F arch=b64 -F dir=/etc/dhcp/ -S chmod -S fchmod -S fchmodat -F key=dhcp_file_attr

-a always,exit -F arch=b32 -F dir=/etc/dhcp/ -S chown -S fchown -S lchown -S fchownat -F key=dhcp_file_attr
-a always,exit -F arch=b64 -F dir=/etc/dhcp/ -S chown -S fchown -S lchown -S fchownat -F key=dhcp_file_attr

-a always,exit -F arch=b32 -F dir=/etc/dhcp/ -S chown32 -S fchown32 -S lchown32 -F key=dhcp_file_attr

-a always,exit -F arch=b32 -F dir=/etc/dhcp/ -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F key=dhcp_file_attr
-a always,exit -F arch=b64 -F dir=/etc/dhcp/ -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F key=dhcp_file_attr

## Monitor file operations
-a always,exit -F arch=b32 -F dir=/etc/dhcp/ -S open -S openat -S creat -S truncate -S ftruncate -F perm=wa -F key=dhcp_file_ops
-a always,exit -F arch=b64 -F dir=/etc/dhcp/ -S open -S openat -S creat -S truncate -S ftruncate -F perm=wa -F key=dhcp_file_ops

-a always,exit -F arch=b32 -F dir=/etc/dhcp/ -S write -S writev -S pwrite -S pwritev -F key=dhcp_file_write
-a always,exit -F arch=b64 -F dir=/etc/dhcp/ -S write -S writev -S pwrite -S pwritev -S pwritev2 -F key=dhcp_file_write

## Monitor file deletions
-a always,exit -F arch=b32 -F dir=/etc/dhcp/ -S unlink -S unlinkat -S rename -S renameat -F key=dhcp_file_delete
-a always,exit -F arch=b64 -F dir=/etc/dhcp/ -S unlink -S unlinkat -S rename -S renameat -S renameat2 -F key=dhcp_file_delete

## ============================================================
## DHCP Failover Configuration
## ============================================================

-a always,exit -F arch=b32 -F path=/etc/dhcp/dhcpd.conf.failover -S open -S openat -S creat -F perm=war -F key=dhcp_failover
-a always,exit -F arch=b64 -F path=/etc/dhcp/dhcpd.conf.failover -S open -S openat -S creat -F perm=war -F key=dhcp_failover

-a always,exit -F arch=b32 -F path=/etc/dhcp/failover.conf -S open -S openat -S creat -F perm=war -F key=dhcp_failover
-a always,exit -F arch=b64 -F path=/etc/dhcp/failover.conf -S open -S openat -S creat -F perm=war -F key=dhcp_failover

## ============================================================
## DHCP Integration Files
## ============================================================

## DNS update keys
-a always,exit -F arch=b32 -F path=/etc/dhcp/ddns-keys -S open -S openat -S creat -F perm=war -F key=dhcp_ddns
-a always,exit -F arch=b64 -F path=/etc/dhcp/ddns-keys -S open -S openat -S creat -F perm=war -F key=dhcp_ddns

-a always,exit -F arch=b32 -F path=/etc/bind/rndc.key -S open -S openat -S read -F perm=r -F key=dhcp_ddns
-a always,exit -F arch=b64 -F path=/etc/bind/rndc.key -S open -S openat -S read -F perm=r -F key=dhcp_ddns

-a always,exit -F arch=b32 -F path=/etc/dhcp/ddns.key -S open -S openat -S creat -F perm=war -F key=dhcp_ddns
-a always,exit -F arch=b64 -F path=/etc/dhcp/ddns.key -S open -S openat -S creat -F perm=war -F key=dhcp_ddns

## DHCP options
-a always,exit -F arch=b32 -F dir=/etc/dhcp/dhcpd.d/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=dhcp_options
-a always,exit -F arch=b64 -F dir=/etc/dhcp/dhcpd.d/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=dhcp_options

-a always,exit -F arch=b32 -F path=/etc/dhcp/dhcp6.options -S open -S openat -S creat -F perm=war -F key=dhcp_options
-a always,exit -F arch=b64 -F path=/etc/dhcp/dhcp6.options -S open -S openat -S creat -F perm=war -F key=dhcp_options

## ============================================================
## Logging and PID Files
## ============================================================

## PID files
-a always,exit -F arch=b32 -F path=/var/run/dhcpd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=dhcp_runtime
-a always,exit -F arch=b64 -F path=/var/run/dhcpd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=dhcp_runtime

-a always,exit -F arch=b32 -F path=/var/run/dhcpd6.pid -S open -S openat -S write -S truncate -F perm=wa -F key=dhcp_runtime
-a always,exit -F arch=b64 -F path=/var/run/dhcpd6.pid -S open -S openat -S write -S truncate -F perm=wa -F key=dhcp_runtime

-a always,exit -F arch=b32 -F path=/run/dhcp-server/dhcpd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=dhcp_runtime
-a always,exit -F arch=b64 -F path=/run/dhcp-server/dhcpd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=dhcp_runtime

## Log files
-a always,exit -F arch=b32 -F path=/var/log/dhcpd.log -S open -S openat -S write -S truncate -F perm=wa -F key=dhcp_logs
-a always,exit -F arch=b64 -F path=/var/log/dhcpd.log -S open -S openat -S write -S truncate -F perm=wa -F key=dhcp_logs

-a always,exit -F arch=b32 -F path=/var/log/dhcp.log -S open -S openat -S write -S truncate -F perm=wa -F key=dhcp_logs
-a always,exit -F arch=b64 -F path=/var/log/dhcp.log -S open -S openat -S write -S truncate -F perm=wa -F key=dhcp_logs

## ============================================================
## Security Policy Files
## ============================================================

-a always,exit -F arch=b32 -F path=/etc/apparmor.d/usr.sbin.dhcpd -S open -S openat -S creat -F perm=war -F key=dhcp_apparmor
-a always,exit -F arch=b64 -F path=/etc/apparmor.d/usr.sbin.dhcpd -S open -S openat -S creat -F perm=war -F key=dhcp_apparmor

-a always,exit -F arch=b32 -F path=/etc/selinux/targeted/contexts/files/file_contexts.local -S open -S openat -S creat -F perm=war -F key=dhcp_selinux
-a always,exit -F arch=b64 -F path=/etc/selinux/targeted/contexts/files/file_contexts.local -S open -S openat -S creat -F perm=war -F key=dhcp_selinux

## ============================================================
## Privileged Operations
## ============================================================

-a always,exit -F arch=b32 -S execve -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=dhcp_privileged_exec
-a always,exit -F arch=b64 -S execve -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=dhcp_privileged_exec

-a always,exit -F arch=b32 -S setuid -S setgid -S setreuid -S setregid -S setresuid -S setresgid -F key=dhcp_privilege_change
-a always,exit -F arch=b64 -S setuid -S setgid -S setreuid -S setregid -S setresuid -S setresgid -F key=dhcp_privilege_change

-a always,exit -F arch=b32 -S setuid32 -S setgid32 -S setreuid32 -S setregid32 -S setresuid32 -S setresgid32 -F key=dhcp_privilege_change
-a always,exit -F arch=b64 -S setfsuid -S setfsgid -S capset -F key=dhcp_privilege_change

## ============================================================
## Process and Module Operations
## ============================================================

## Process operations
-a always,exit -F arch=b32 -S fork -S vfork -S clone -F key=dhcp_process_creation
-a always,exit -F arch=b64 -S fork -S vfork -S clone -S clone3 -F key=dhcp_process_creation

-a always,exit -F arch=b32 -S kill -S tkill -S tgkill -F key=dhcp_process_kill
-a always,exit -F arch=b64 -S kill -S tkill -S tgkill -F key=dhcp_process_kill

## Module operations
-a always,exit -F arch=b32 -S init_module -S delete_module -S finit_module -F key=dhcp_modules
-a always,exit -F arch=b64 -S init_module -S delete_module -S finit_module -F key=dhcp_modules

-a always,exit -F arch=b32 -S create_module -S query_module -F key=dhcp_modules
-a always,exit -F arch=b64 -S kexec_load -S kexec_file_load -F key=dhcp_modules

## ============================================================
## System Configuration
## ============================================================

## Time changes
-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -S clock_settime -F key=dhcp_time_change
-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -F key=dhcp_time_change

## Hostname changes
-a always,exit -F arch=b32 -S sethostname -S setdomainname -F key=dhcp_system_info
-a always,exit -F arch=b64 -S sethostname -S setdomainname -F key=dhcp_system_info

## ============================================================
## IPC Operations
## ============================================================

-a always,exit -F arch=b32 -S msgctl -S msgget -S msgrcv -S msgsnd -F key=dhcp_ipc_msg
-a always,exit -F arch=b64 -S msgctl -S msgget -S msgrcv -S msgsnd -F key=dhcp_ipc_msg

-a always,exit -F arch=b32 -S semctl -S semget -S semop -S semtimedop -F key=dhcp_ipc_sem
-a always,exit -F arch=b64 -S semctl -S semget -S semop -S semtimedop -F key=dhcp_ipc_sem

-a always,exit -F arch=b32 -S shmctl -S shmget -S shmat -S shmdt -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmctl -S shmget -S shmat -S shmdt -F key=T1559_Inter-Process_Communication

## ============================================================
## Mount Operations
## ============================================================

-a always,exit -F arch=b32 -S mount -S umount -S umount2 -F key=dhcp_mount
-a always,exit -F arch=b64 -S mount -S umount2 -F key=dhcp_mount

## ============================================================
## Memory Management
## ============================================================

-a always,exit -F arch=b32 -S mmap -S mmap2 -S munmap -S mprotect -S mremap -F key=dhcp_memory
-a always,exit -F arch=b64 -S mmap -S munmap -S mprotect -S mremap -F key=dhcp_memory

-a always,exit -F arch=b32 -S setrlimit -S getrlimit -F key=dhcp_resource_limits
-a always,exit -F arch=b64 -S setrlimit -S getrlimit -S prlimit64 -F key=dhcp_resource_limits

# DNS Server

## ============================================================
## DNS Configuration Files - BIND/Named
## ============================================================

## Main BIND configuration
-a always,exit -F arch=b32 -F path=/etc/named.conf -S open -S openat -S creat -F perm=war -F key=dns_config
-a always,exit -F arch=b64 -F path=/etc/named.conf -S open -S openat -S creat -F perm=war -F key=dns_config

-a always,exit -F arch=b32 -F path=/etc/bind/named.conf -S open -S openat -S creat -F perm=war -F key=dns_config
-a always,exit -F arch=b64 -F path=/etc/bind/named.conf -S open -S openat -S creat -F perm=war -F key=dns_config

## BIND local configuration
-a always,exit -F arch=b32 -F path=/etc/bind/named.conf.local -S open -S openat -S creat -F perm=war -F key=dns_config
-a always,exit -F arch=b64 -F path=/etc/bind/named.conf.local -S open -S openat -S creat -F perm=war -F key=dns_config

-a always,exit -F arch=b32 -F path=/etc/bind/named.conf.options -S open -S openat -S creat -F perm=war -F key=dns_config
-a always,exit -F arch=b64 -F path=/etc/bind/named.conf.options -S open -S openat -S creat -F perm=war -F key=dns_config

-a always,exit -F arch=b32 -F path=/etc/bind/named.conf.default-zones -S open -S openat -S creat -F perm=war -F key=dns_config
-a always,exit -F arch=b64 -F path=/etc/bind/named.conf.default-zones -S open -S openat -S creat -F perm=war -F key=dns_config

## BIND directories
-a always,exit -F arch=b32 -F dir=/etc/bind/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=dns_config_dir
-a always,exit -F arch=b64 -F dir=/etc/bind/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=dns_config_dir

-a always,exit -F arch=b32 -F dir=/etc/named/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=dns_config_dir
-a always,exit -F arch=b64 -F dir=/etc/named/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=dns_config_dir

## ============================================================
## DNS Configuration Files - Unbound
## ============================================================

-a always,exit -F arch=b32 -F path=/etc/unbound/unbound.conf -S open -S openat -S creat -F perm=war -F key=unbound_config
-a always,exit -F arch=b64 -F path=/etc/unbound/unbound.conf -S open -S openat -S creat -F perm=war -F key=unbound_config

-a always,exit -F arch=b32 -F dir=/etc/unbound/unbound.conf.d/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=unbound_config_dir
-a always,exit -F arch=b64 -F dir=/etc/unbound/unbound.conf.d/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=unbound_config_dir

## ============================================================
## DNS Configuration Files - PowerDNS
## ============================================================

-a always,exit -F arch=b32 -F path=/etc/powerdns/pdns.conf -S open -S openat -S creat -F perm=war -F key=pdns_config
-a always,exit -F arch=b64 -F path=/etc/powerdns/pdns.conf -S open -S openat -S creat -F perm=war -F key=pdns_config

-a always,exit -F arch=b32 -F path=/etc/powerdns/recursor.conf -S open -S openat -S creat -F perm=war -F key=pdns_config
-a always,exit -F arch=b64 -F path=/etc/powerdns/recursor.conf -S open -S openat -S creat -F perm=war -F key=pdns_config

-a always,exit -F arch=b32 -F dir=/etc/powerdns/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=pdns_config_dir
-a always,exit -F arch=b64 -F dir=/etc/powerdns/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=pdns_config_dir

## ============================================================
## DNS Configuration Files - dnsmasq
## ============================================================

-a always,exit -F arch=b32 -F path=/etc/dnsmasq.conf -S open -S openat -S creat -F perm=war -F key=dnsmasq_config
-a always,exit -F arch=b64 -F path=/etc/dnsmasq.conf -S open -S openat -S creat -F perm=war -F key=dnsmasq_config

-a always,exit -F arch=b32 -F dir=/etc/dnsmasq.d/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=dnsmasq_config_dir
-a always,exit -F arch=b64 -F dir=/etc/dnsmasq.d/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=dnsmasq_config_dir

## ============================================================
## DNS Zone Files
## ============================================================

## BIND zone files
-a always,exit -F arch=b32 -F dir=/var/named/ -S open -S openat -S creat -S unlink -F perm=wa -F key=dns_zones
-a always,exit -F arch=b64 -F dir=/var/named/ -S open -S openat -S creat -S unlink -F perm=wa -F key=dns_zones

-a always,exit -F arch=b32 -F dir=/var/cache/bind/ -S open -S openat -S creat -S unlink -F perm=wa -F key=dns_zones
-a always,exit -F arch=b64 -F dir=/var/cache/bind/ -S open -S openat -S creat -S unlink -F perm=wa -F key=dns_zones

-a always,exit -F arch=b32 -F dir=/etc/bind/zones/ -S open -S openat -S creat -S unlink -F perm=wa -F key=dns_zones
-a always,exit -F arch=b64 -F dir=/etc/bind/zones/ -S open -S openat -S creat -S unlink -F perm=wa -F key=dns_zones

-a always,exit -F arch=b32 -F dir=/var/lib/bind/ -S open -S openat -S creat -S unlink -F perm=wa -F key=dns_zones
-a always,exit -F arch=b64 -F dir=/var/lib/bind/ -S open -S openat -S creat -S unlink -F perm=wa -F key=dns_zones

## PowerDNS zone files
-a always,exit -F arch=b32 -F dir=/etc/powerdns/zones/ -S open -S openat -S creat -S unlink -F perm=wa -F key=pdns_zones
-a always,exit -F arch=b64 -F dir=/etc/powerdns/zones/ -S open -S openat -S creat -S unlink -F perm=wa -F key=pdns_zones

## ============================================================
## DNS Server Binaries
## ============================================================

## BIND/Named binaries
-a always,exit -F arch=b32 -F path=/usr/sbin/named -S execve -F key=dns_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/named -S execve -F key=dns_exec

-a always,exit -F arch=b32 -F path=/usr/sbin/named-checkconf -S execve -F key=dns_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/named-checkconf -S execve -F key=dns_exec

-a always,exit -F arch=b32 -F path=/usr/sbin/named-checkzone -S execve -F key=dns_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/named-checkzone -S execve -F key=dns_exec

-a always,exit -F arch=b32 -F path=/usr/sbin/named-compilezone -S execve -F key=dns_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/named-compilezone -S execve -F key=dns_exec

## Unbound binaries
-a always,exit -F arch=b32 -F path=/usr/sbin/unbound -S execve -F key=unbound_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/unbound -S execve -F key=unbound_exec

-a always,exit -F arch=b32 -F path=/usr/sbin/unbound-control -S execve -F key=unbound_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/unbound-control -S execve -F key=unbound_exec

-a always,exit -F arch=b32 -F path=/usr/sbin/unbound-checkconf -S execve -F key=unbound_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/unbound-checkconf -S execve -F key=unbound_exec

## PowerDNS binaries
-a always,exit -F arch=b32 -F path=/usr/sbin/pdns_server -S execve -F key=pdns_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/pdns_server -S execve -F key=pdns_exec

-a always,exit -F arch=b32 -F path=/usr/sbin/pdns_recursor -S execve -F key=pdns_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/pdns_recursor -S execve -F key=pdns_exec

-a always,exit -F arch=b32 -F path=/usr/bin/pdnsutil -S execve -F key=pdns_exec
-a always,exit -F arch=b64 -F path=/usr/bin/pdnsutil -S execve -F key=pdns_exec

## dnsmasq binary
-a always,exit -F arch=b32 -F path=/usr/sbin/dnsmasq -S execve -F key=dnsmasq_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/dnsmasq -S execve -F key=dnsmasq_exec

## ============================================================
## Network Socket Monitoring
## ============================================================

## Monitor DNS port bindings (port 53 TCP/UDP)
-a always,exit -F arch=b32 -S bind -F a0=53 -F key=dns_bind
-a always,exit -F arch=b64 -S bind -F a0=53 -F key=dns_bind

## Monitor RNDC control port (port 953)
-a always,exit -F arch=b32 -S bind -F a0=953 -F key=dns_rndc_bind
-a always,exit -F arch=b64 -S bind -F a0=953 -F key=dns_rndc_bind

## Monitor DNS over TLS port (port 853)
-a always,exit -F arch=b32 -S bind -F a0=853 -F key=dns_dot_bind
-a always,exit -F arch=b64 -S bind -F a0=853 -F key=dns_dot_bind

## Monitor socket operations
-a always,exit -F arch=b32 -S socket -S connect -S sendmsg -S recvmsg -S bind -S listen -S accept -F key=dns_network
-a always,exit -F arch=b64 -S socket -S connect -S sendmsg -S recvmsg -S bind -S listen -S accept -S accept4 -F key=dns_network

-a always,exit -F arch=b32 -S socketpair -S sendto -S recvfrom -S shutdown -S getsockname -S getpeername -F key=dns_network
-a always,exit -F arch=b64 -S socketpair -S sendto -S recvfrom -S shutdown -S getsockname -S getpeername -F key=dns_network

## ============================================================
## DNS Control and Management Tools
## ============================================================

## RNDC (BIND Remote Name Daemon Control)
-a always,exit -F arch=b32 -F path=/usr/sbin/rndc -S execve -F key=dns_rndc
-a always,exit -F arch=b64 -F path=/usr/sbin/rndc -S execve -F key=dns_rndc

-a always,exit -F arch=b32 -F path=/usr/sbin/rndc-confgen -S execve -F key=dns_rndc
-a always,exit -F arch=b64 -F path=/usr/sbin/rndc-confgen -S execve -F key=dns_rndc

## nsupdate (Dynamic DNS updates)
-a always,exit -F arch=b32 -F path=/usr/bin/nsupdate -S execve -F key=dns_nsupdate
-a always,exit -F arch=b64 -F path=/usr/bin/nsupdate -S execve -F key=dns_nsupdate

## dig, nslookup, host utilities
-a always,exit -F arch=b32 -F path=/usr/bin/dig -S execve -F key=dns_query_tools
-a always,exit -F arch=b64 -F path=/usr/bin/dig -S execve -F key=dns_query_tools

-a always,exit -F arch=b32 -F path=/usr/bin/nslookup -S execve -F key=dns_query_tools
-a always,exit -F arch=b64 -F path=/usr/bin/nslookup -S execve -F key=dns_query_tools

-a always,exit -F arch=b32 -F path=/usr/bin/host -S execve -F key=dns_query_tools
-a always,exit -F arch=b64 -F path=/usr/bin/host -S execve -F key=dns_query_tools

## ============================================================
## DNSSEC Key Files and Materials
## ============================================================

## BIND DNSSEC keys
-a always,exit -F arch=b32 -F dir=/etc/bind/keys/ -S open -S openat -S creat -S unlink -F perm=war -F key=dnssec_keys
-a always,exit -F arch=b64 -F dir=/etc/bind/keys/ -S open -S openat -S creat -S unlink -F perm=war -F key=dnssec_keys

-a always,exit -F arch=b32 -F dir=/var/named/keys/ -S open -S openat -S creat -S unlink -F perm=war -F key=dnssec_keys
-a always,exit -F arch=b64 -F dir=/var/named/keys/ -S open -S openat -S creat -S unlink -F perm=war -F key=dnssec_keys

## DNSSEC utilities
-a always,exit -F arch=b32 -F path=/usr/sbin/dnssec-keygen -S execve -F key=dnssec_tools
-a always,exit -F arch=b64 -F path=/usr/sbin/dnssec-keygen -S execve -F key=dnssec_tools

-a always,exit -F arch=b32 -F path=/usr/sbin/dnssec-signzone -S execve -F key=dnssec_tools
-a always,exit -F arch=b64 -F path=/usr/sbin/dnssec-signzone -S execve -F key=dnssec_tools

-a always,exit -F arch=b32 -F path=/usr/sbin/dnssec-dsfromkey -S execve -F key=dnssec_tools
-a always,exit -F arch=b64 -F path=/usr/sbin/dnssec-dsfromkey -S execve -F key=dnssec_tools

-a always,exit -F arch=b32 -F path=/usr/sbin/dnssec-verify -S execve -F key=dnssec_tools
-a always,exit -F arch=b64 -F path=/usr/sbin/dnssec-verify -S execve -F key=dnssec_tools

## ============================================================
## RNDC Keys and Control Files
## ============================================================

-a always,exit -F arch=b32 -F path=/etc/rndc.key -S open -S openat -S creat -F perm=war -F key=dns_rndc_key
-a always,exit -F arch=b64 -F path=/etc/rndc.key -S open -S openat -S creat -F perm=war -F key=dns_rndc_key

-a always,exit -F arch=b32 -F path=/etc/bind/rndc.key -S open -S openat -S creat -F perm=war -F key=dns_rndc_key
-a always,exit -F arch=b64 -F path=/etc/bind/rndc.key -S open -S openat -S creat -F perm=war -F key=dns_rndc_key

-a always,exit -F arch=b32 -F path=/etc/rndc.conf -S open -S openat -S creat -F perm=war -F key=dns_rndc_conf
-a always,exit -F arch=b64 -F path=/etc/rndc.conf -S open -S openat -S creat -F perm=war -F key=dns_rndc_conf

## ============================================================
## Service Management
## ============================================================

## SystemD service management - BIND
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=named -F key=dns_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=named -F key=dns_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=bind9 -F key=dns_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=bind9 -F key=dns_service_mgmt

## SystemD service management - Unbound
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=unbound -F key=dns_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=unbound -F key=dns_service_mgmt

## SystemD service management - PowerDNS
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=pdns -F key=dns_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=pdns -F key=dns_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=pdns-recursor -F key=dns_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=pdns-recursor -F key=dns_service_mgmt

## SystemD service management - dnsmasq
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=dnsmasq -F key=dns_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=dnsmasq -F key=dns_service_mgmt

## Legacy service management
-a always,exit -F arch=b32 -F path=/sbin/service -S execve -F key=service_mgmt
-a always,exit -F arch=b64 -F path=/sbin/service -S execve -F key=service_mgmt

-a always,exit -F arch=b32 -F path=/etc/init.d/named -S execve -F key=dns_service_mgmt
-a always,exit -F arch=b64 -F path=/etc/init.d/named -S execve -F key=dns_service_mgmt

-a always,exit -F arch=b32 -F path=/etc/init.d/bind9 -S execve -F key=dns_service_mgmt
-a always,exit -F arch=b64 -F path=/etc/init.d/bind9 -S execve -F key=dns_service_mgmt

## ============================================================
## DNS Cache and Journal Files
## ============================================================

## BIND cache and journal files
-a always,exit -F arch=b32 -F dir=/var/cache/bind/ -S open -S openat -S write -S truncate -F perm=wa -F key=dns_cache
-a always,exit -F arch=b64 -F dir=/var/cache/bind/ -S open -S openat -S write -S truncate -F perm=wa -F key=dns_cache

-a always,exit -F arch=b32 -F dir=/var/named/dynamic/ -S open -S openat -S write -S truncate -F perm=wa -F key=dns_dynamic
-a always,exit -F arch=b64 -F dir=/var/named/dynamic/ -S open -S openat -S write -S truncate -F perm=wa -F key=dns_dynamic

## Unbound cache
-a always,exit -F arch=b32 -F dir=/var/lib/unbound/ -S open -S openat -S write -S truncate -F perm=wa -F key=unbound_cache
-a always,exit -F arch=b64 -F dir=/var/lib/unbound/ -S open -S openat -S write -S truncate -F perm=wa -F key=unbound_cache

## ============================================================
## DNS Statistics and Dump Files
## ============================================================

-a always,exit -F arch=b32 -F path=/var/named/data/named_stats.txt -S open -S openat -S write -F perm=wa -F key=dns_stats
-a always,exit -F arch=b64 -F path=/var/named/data/named_stats.txt -S open -S openat -S write -F perm=wa -F key=dns_stats

-a always,exit -F arch=b32 -F path=/var/named/data/named_dump.db -S open -S openat -S write -F perm=wa -F key=dns_dump
-a always,exit -F arch=b64 -F path=/var/named/data/named_dump.db -S open -S openat -S write -F perm=wa -F key=dns_dump

-a always,exit -F arch=b32 -F path=/var/named/data/cache_dump.db -S open -S openat -S write -F perm=wa -F key=dns_cache_dump
-a always,exit -F arch=b64 -F path=/var/named/data/cache_dump.db -S open -S openat -S write -F perm=wa -F key=dns_cache_dump

## ============================================================
## Logging and PID Files
## ============================================================

## PID files
-a always,exit -F arch=b32 -F path=/var/run/named/named.pid -S open -S openat -S write -S truncate -F perm=wa -F key=dns_runtime
-a always,exit -F arch=b64 -F path=/var/run/named/named.pid -S open -S openat -S write -S truncate -F perm=wa -F key=dns_runtime

-a always,exit -F arch=b32 -F path=/var/run/named.pid -S open -S openat -S write -S truncate -F perm=wa -F key=dns_runtime
-a always,exit -F arch=b64 -F path=/var/run/named.pid -S open -S openat -S write -S truncate -F perm=wa -F key=dns_runtime

-a always,exit -F arch=b32 -F path=/var/run/unbound/unbound.pid -S open -S openat -S write -S truncate -F perm=wa -F key=unbound_runtime
-a always,exit -F arch=b64 -F path=/var/run/unbound/unbound.pid -S open -S openat -S write -S truncate -F perm=wa -F key=unbound_runtime

-a always,exit -F arch=b32 -F path=/var/run/pdns.pid -S open -S openat -S write -S truncate -F perm=wa -F key=pdns_runtime
-a always,exit -F arch=b64 -F path=/var/run/pdns.pid -S open -S openat -S write -S truncate -F perm=wa -F key=pdns_runtime

## Log files
-a always,exit -F arch=b32 -F path=/var/log/named.log -S open -S openat -S write -S truncate -F perm=wa -F key=dns_logs
-a always,exit -F arch=b64 -F path=/var/log/named.log -S open -S openat -S write -S truncate -F perm=wa -F key=dns_logs

-a always,exit -F arch=b32 -F dir=/var/log/named/ -S open -S openat -S write -S truncate -F perm=wa -F key=dns_logs
-a always,exit -F arch=b64 -F dir=/var/log/named/ -S open -S openat -S write -S truncate -F perm=wa -F key=dns_logs

-a always,exit -F arch=b32 -F path=/var/log/unbound.log -S open -S openat -S write -S truncate -F perm=wa -F key=unbound_logs
-a always,exit -F arch=b64 -F path=/var/log/unbound.log -S open -S openat -S write -S truncate -F perm=wa -F key=unbound_logs

## ============================================================
## Root Hints and Trust Anchors
## ============================================================

-a always,exit -F arch=b32 -F path=/var/named/named.ca -S open -S openat -S creat -F perm=war -F key=dns_root_hints
-a always,exit -F arch=b64 -F path=/var/named/named.ca -S open -S openat -S creat -F perm=war -F key=dns_root_hints

-a always,exit -F arch=b32 -F path=/etc/unbound/root.hints -S open -S openat -S creat -F perm=war -F key=dns_root_hints
-a always,exit -F arch=b64 -F path=/etc/unbound/root.hints -S open -S openat -S creat -F perm=war -F key=dns_root_hints

-a always,exit -F arch=b32 -F path=/var/lib/unbound/root.key -S open -S openat -S creat -F perm=war -F key=dns_trust_anchor
-a always,exit -F arch=b64 -F path=/var/lib/unbound/root.key -S open -S openat -S creat -F perm=war -F key=dns_trust_anchor

## ============================================================
## Security Policy Files
## ============================================================

-a always,exit -F arch=b32 -F path=/etc/apparmor.d/usr.sbin.named -S open -S openat -S creat -F perm=war -F key=dns_apparmor
-a always,exit -F arch=b64 -F path=/etc/apparmor.d/usr.sbin.named -S open -S openat -S creat -F perm=war -F key=dns_apparmor

-a always,exit -F arch=b32 -F path=/etc/apparmor.d/usr.sbin.unbound -S open -S openat -S creat -F perm=war -F key=dns_apparmor
-a always,exit -F arch=b64 -F path=/etc/apparmor.d/usr.sbin.unbound -S open -S openat -S creat -F perm=war -F key=dns_apparmor

-a always,exit -F arch=b32 -F path=/etc/selinux/targeted/contexts/files/file_contexts.local -S open -S openat -S creat -F perm=war -F key=dns_selinux
-a always,exit -F arch=b64 -F path=/etc/selinux/targeted/contexts/files/file_contexts.local -S open -S openat -S creat -F perm=war -F key=dns_selinux

## ============================================================
## File Operations on DNS Directories
## ============================================================

## Monitor file attribute changes
-a always,exit -F arch=b32 -F dir=/etc/bind/ -S chmod -S fchmod -S fchmodat -F key=dns_file_attr
-a always,exit -F arch=b64 -F dir=/etc/bind/ -S chmod -S fchmod -S fchmodat -F key=dns_file_attr

-a always,exit -F arch=b32 -F dir=/etc/bind/ -S chown -S fchown -S lchown -S fchownat -F key=dns_file_attr
-a always,exit -F arch=b64 -F dir=/etc/bind/ -S chown -S fchown -S lchown -S fchownat -F key=dns_file_attr

-a always,exit -F arch=b32 -F dir=/etc/bind/ -S chown32 -S fchown32 -S lchown32 -F key=dns_file_attr

-a always,exit -F arch=b32 -F dir=/etc/bind/ -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F key=dns_file_attr
-a always,exit -F arch=b64 -F dir=/etc/bind/ -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F key=dns_file_attr

## Monitor file operations
-a always,exit -F arch=b32 -F dir=/etc/bind/ -S open -S openat -S creat -S truncate -S ftruncate -F perm=wa -F key=dns_file_ops
-a always,exit -F arch=b64 -F dir=/etc/bind/ -S open -S openat -S creat -S truncate -S ftruncate -F perm=wa -F key=dns_file_ops

-a always,exit -F arch=b32 -F dir=/etc/bind/ -S write -S writev -S pwrite -S pwritev -F key=dns_file_write
-a always,exit -F arch=b64 -F dir=/etc/bind/ -S write -S writev -S pwrite -S pwritev -S pwritev2 -F key=dns_file_write

## Monitor file deletions
-a always,exit -F arch=b32 -F dir=/etc/bind/ -S unlink -S unlinkat -S rename -S renameat -F key=dns_file_delete
-a always,exit -F arch=b64 -F dir=/etc/bind/ -S unlink -S unlinkat -S rename -S renameat -S renameat2 -F key=dns_file_delete

## ============================================================
## Privileged Operations
## ============================================================

-a always,exit -F arch=b32 -S execve -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=dns_privileged_exec
-a always,exit -F arch=b64 -S execve -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=dns_privileged_exec

-a always,exit -F arch=b32 -S setuid -S setgid -S setreuid -S setregid -S setresuid -S setresgid -F key=dns_privilege_change
-a always,exit -F arch=b64 -S setuid -S setgid -S setreuid -S setregid -S setresuid -S setresgid -F key=dns_privilege_change

-a always,exit -F arch=b32 -S setuid32 -S setgid32 -S setreuid32 -S setregid32 -S setresuid32 -S setresgid32 -F key=dns_privilege_change
-a always,exit -F arch=b64 -S setfsuid -S setfsgid -S capset -F key=dns_privilege_change

## ============================================================
## Process and Module Operations
## ============================================================

## Process operations
-a always,exit -F arch=b32 -S fork -S vfork -S clone -F key=dns_process_creation
-a always,exit -F arch=b64 -S fork -S vfork -S clone -S clone3 -F key=dns_process_creation

-a always,exit -F arch=b32 -S kill -S tkill -S tgkill -F key=dns_process_kill
-a always,exit -F arch=b64 -S kill -S tkill -S tgkill -F key=dns_process_kill

## Module operations
-a always,exit -F arch=b32 -S init_module -S delete_module -S finit_module -F key=dns_modules
-a always,exit -F arch=b64 -S init_module -S delete_module -S finit_module -F key=dns_modules

-a always,exit -F arch=b32 -S create_module -S query_module -F key=dns_modules
-a always,exit -F arch=b64 -S kexec_load -S kexec_file_load -F key=dns_modules

## ============================================================
## System Configuration
## ============================================================

## Time changes
-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -S clock_settime -F key=dns_time_change
-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -F key=dns_time_change

## Hostname changes
-a always,exit -F arch=b32 -S sethostname -S setdomainname -F key=dns_system_info
-a always,exit -F arch=b64 -S sethostname -S setdomainname -F key=dns_system_info

## ============================================================
## IPC Operations
## ============================================================

-a always,exit -F arch=b32 -S msgctl -S msgget -S msgrcv -S msgsnd -F key=dns_ipc_msg
-a always,exit -F arch=b64 -S msgctl -S msgget -S msgrcv -S msgsnd -F key=dns_ipc_msg

-a always,exit -F arch=b32 -S semctl -S semget -S semop -S semtimedop -F key=dns_ipc_sem
-a always,exit -F arch=b64 -S semctl -S semget -S semop -S semtimedop -F key=dns_ipc_sem

-a always,exit -F arch=b32 -S shmctl -S shmget -S shmat -S shmdt -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmctl -S shmget -S shmat -S shmdt -F key=T1559_Inter-Process_Communication

## ============================================================
## Mount Operations
## ============================================================

-a always,exit -F arch=b32 -S mount -S umount -S umount2 -F key=dns_mount
-a always,exit -F arch=b64 -S mount -S umount2 -F key=dns_mount

## ============================================================
## Memory Management
## ============================================================

-a always,exit -F arch=b32 -S mmap -S mmap2 -S munmap -S mprotect -S mremap -F key=dns_memory
-a always,exit -F arch=b64 -S mmap -S munmap -S mprotect -S mremap -F key=dns_memory

-a always,exit -F arch=b32 -S setrlimit -S getrlimit -F key=dns_resource_limits
-a always,exit -F arch=b64 -S setrlimit -S getrlimit -S prlimit64 -F key=dns_resource_limits

# CUPS — Printing system for managing printers

## ============================================================
## CUPS Configuration Files
## ============================================================

## Main CUPS configuration
-a always,exit -F arch=b32 -F path=/etc/cups/cupsd.conf -S open -S openat -S creat -F perm=war -F key=cups_config
-a always,exit -F arch=b64 -F path=/etc/cups/cupsd.conf -S open -S openat -S creat -F perm=war -F key=cups_config

## CUPS files configuration
-a always,exit -F arch=b32 -F path=/etc/cups/cups-files.conf -S open -S openat -S creat -F perm=war -F key=cups_config
-a always,exit -F arch=b64 -F path=/etc/cups/cups-files.conf -S open -S openat -S creat -F perm=war -F key=cups_config

## Printers configuration
-a always,exit -F arch=b32 -F path=/etc/cups/printers.conf -S open -S openat -S creat -F perm=war -F key=cups_printers
-a always,exit -F arch=b64 -F path=/etc/cups/printers.conf -S open -S openat -S creat -F perm=war -F key=cups_printers

## Classes configuration
-a always,exit -F arch=b32 -F path=/etc/cups/classes.conf -S open -S openat -S creat -F perm=war -F key=cups_classes
-a always,exit -F arch=b64 -F path=/etc/cups/classes.conf -S open -S openat -S creat -F perm=war -F key=cups_classes

## Client configuration
-a always,exit -F arch=b32 -F path=/etc/cups/client.conf -S open -S openat -S creat -F perm=war -F key=cups_client
-a always,exit -F arch=b64 -F path=/etc/cups/client.conf -S open -S openat -S creat -F perm=war -F key=cups_client

## Subscriptions configuration
-a always,exit -F arch=b32 -F path=/etc/cups/subscriptions.conf -S open -S openat -S creat -F perm=war -F key=cups_subscriptions
-a always,exit -F arch=b64 -F path=/etc/cups/subscriptions.conf -S open -S openat -S creat -F perm=war -F key=cups_subscriptions

## SNMP configuration
-a always,exit -F arch=b32 -F path=/etc/cups/snmp.conf -S open -S openat -S creat -F perm=war -F key=cups_snmp
-a always,exit -F arch=b64 -F path=/etc/cups/snmp.conf -S open -S openat -S creat -F perm=war -F key=cups_snmp

## CUPS directories
-a always,exit -F arch=b32 -F dir=/etc/cups/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=cups_config_dir
-a always,exit -F arch=b64 -F dir=/etc/cups/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=cups_config_dir

## ============================================================
## PPD Files (PostScript Printer Description)
## ============================================================

## PPD directories
-a always,exit -F arch=b32 -F dir=/etc/cups/ppd/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_ppd
-a always,exit -F arch=b64 -F dir=/etc/cups/ppd/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_ppd

-a always,exit -F arch=b32 -F dir=/usr/share/cups/model/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_ppd_model
-a always,exit -F arch=b64 -F dir=/usr/share/cups/model/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_ppd_model

-a always,exit -F arch=b32 -F dir=/usr/share/ppd/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_ppd_shared
-a always,exit -F arch=b64 -F dir=/usr/share/ppd/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_ppd_shared

## ============================================================
## CUPS Server Binaries
## ============================================================

## Main CUPS daemon
-a always,exit -F arch=b32 -F path=/usr/sbin/cupsd -S execve -F key=cups_exec
-a always,exit -F arch=b64 -F path=/usr/sbin/cupsd -S execve -F key=cups_exec

## CUPS helper programs
-a always,exit -F arch=b32 -F path=/usr/sbin/cupsfilter -S execve -F key=cups_filter
-a always,exit -F arch=b64 -F path=/usr/sbin/cupsfilter -S execve -F key=cups_filter

-a always,exit -F arch=b32 -F path=/usr/sbin/cups-deviced -S execve -F key=cups_devices
-a always,exit -F arch=b64 -F path=/usr/sbin/cups-deviced -S execve -F key=cups_devices

-a always,exit -F arch=b32 -F path=/usr/sbin/cups-driverd -S execve -F key=cups_drivers
-a always,exit -F arch=b64 -F path=/usr/sbin/cups-driverd -S execve -F key=cups_drivers

## ============================================================
## CUPS Administration Commands
## ============================================================

## lpadmin - printer administration
-a always,exit -F arch=b32 -F path=/usr/sbin/lpadmin -S execve -F key=cups_admin
-a always,exit -F arch=b64 -F path=/usr/sbin/lpadmin -S execve -F key=cups_admin

## lpc - line printer control
-a always,exit -F arch=b32 -F path=/usr/sbin/lpc -S execve -F key=cups_control
-a always,exit -F arch=b64 -F path=/usr/sbin/lpc -S execve -F key=cups_control

## cupsctl - CUPS control
-a always,exit -F arch=b32 -F path=/usr/sbin/cupsctl -S execve -F key=cups_control
-a always,exit -F arch=b64 -F path=/usr/sbin/cupsctl -S execve -F key=cups_control

## cupsaccept/cupsreject - accept/reject print jobs
-a always,exit -F arch=b32 -F path=/usr/sbin/cupsaccept -S execve -F key=cups_queue_mgmt
-a always,exit -F arch=b64 -F path=/usr/sbin/cupsaccept -S execve -F key=cups_queue_mgmt

-a always,exit -F arch=b32 -F path=/usr/sbin/cupsreject -S execve -F key=cups_queue_mgmt
-a always,exit -F arch=b64 -F path=/usr/sbin/cupsreject -S execve -F key=cups_queue_mgmt

## cupsenable/cupsdisable - enable/disable printers
-a always,exit -F arch=b32 -F path=/usr/sbin/cupsenable -S execve -F key=cups_queue_mgmt
-a always,exit -F arch=b64 -F path=/usr/sbin/cupsenable -S execve -F key=cups_queue_mgmt

-a always,exit -F arch=b32 -F path=/usr/sbin/cupsdisable -S execve -F key=cups_queue_mgmt
-a always,exit -F arch=b64 -F path=/usr/sbin/cupsdisable -S execve -F key=cups_queue_mgmt

## ============================================================
## CUPS User Commands
## ============================================================

## lp - print files
-a always,exit -F arch=b32 -F path=/usr/bin/lp -S execve -F key=cups_print
-a always,exit -F arch=b64 -F path=/usr/bin/lp -S execve -F key=cups_print

## lpr - print files (BSD style)
-a always,exit -F arch=b32 -F path=/usr/bin/lpr -S execve -F key=cups_print
-a always,exit -F arch=b64 -F path=/usr/bin/lpr -S execve -F key=cups_print

## lpstat - print status information
-a always,exit -F arch=b32 -F path=/usr/bin/lpstat -S execve -F key=cups_status
-a always,exit -F arch=b64 -F path=/usr/bin/lpstat -S execve -F key=cups_status

## lpq - show print queue
-a always,exit -F arch=b32 -F path=/usr/bin/lpq -S execve -F key=cups_status
-a always,exit -F arch=b64 -F path=/usr/bin/lpq -S execve -F key=cups_status

## lprm - cancel print jobs
-a always,exit -F arch=b32 -F path=/usr/bin/lprm -S execve -F key=cups_cancel
-a always,exit -F arch=b64 -F path=/usr/bin/lprm -S execve -F key=cups_cancel

## cancel - cancel print jobs
-a always,exit -F arch=b32 -F path=/usr/bin/cancel -S execve -F key=cups_cancel
-a always,exit -F arch=b64 -F path=/usr/bin/cancel -S execve -F key=cups_cancel

## lpoptions - display/set printer options
-a always,exit -F arch=b32 -F path=/usr/bin/lpoptions -S execve -F key=cups_options
-a always,exit -F arch=b64 -F path=/usr/bin/lpoptions -S execve -F key=cups_options

## lpinfo - show available devices and drivers
-a always,exit -F arch=b32 -F path=/usr/sbin/lpinfo -S execve -F key=cups_info
-a always,exit -F arch=b64 -F path=/usr/sbin/lpinfo -S execve -F key=cups_info

## ============================================================
## Network Socket Monitoring
## ============================================================

## Monitor IPP port (port 631)
-a always,exit -F arch=b32 -S bind -F a0=631 -F key=cups_ipp_bind
-a always,exit -F arch=b64 -S bind -F a0=631 -F key=cups_ipp_bind

## Monitor LPD port (port 515) if cups-lpd is enabled
-a always,exit -F arch=b32 -S bind -F a0=515 -F key=cups_lpd_bind
-a always,exit -F arch=b64 -S bind -F a0=515 -F key=cups_lpd_bind

## Monitor socket operations
-a always,exit -F arch=b32 -S socket -S connect -S sendmsg -S recvmsg -S bind -S listen -S accept -F key=cups_network
-a always,exit -F arch=b64 -S socket -S connect -S sendmsg -S recvmsg -S bind -S listen -S accept -S accept4 -F key=cups_network

-a always,exit -F arch=b32 -S socketpair -S sendto -S recvfrom -S shutdown -S getsockname -S getpeername -F key=cups_network
-a always,exit -F arch=b64 -S socketpair -S sendto -S recvfrom -S shutdown -S getsockname -S getpeername -F key=cups_network

## ============================================================
## Print Spool and Queue Directories
## ============================================================

## Main spool directory
-a always,exit -F arch=b32 -F dir=/var/spool/cups/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_spool
-a always,exit -F arch=b64 -F dir=/var/spool/cups/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_spool

## Temporary files
-a always,exit -F arch=b32 -F dir=/var/spool/cups/tmp/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_temp
-a always,exit -F arch=b64 -F dir=/var/spool/cups/tmp/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_temp

## Cache directory
-a always,exit -F arch=b32 -F dir=/var/cache/cups/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_cache
-a always,exit -F arch=b64 -F dir=/var/cache/cups/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_cache

## ============================================================
## CUPS Backend Programs
## ============================================================

## Backend directory monitoring
-a always,exit -F arch=b32 -F dir=/usr/lib/cups/backend/ -S execve -F key=cups_backend
-a always,exit -F arch=b64 -F dir=/usr/lib/cups/backend/ -S execve -F key=cups_backend

## Common backends
-a always,exit -F arch=b32 -F path=/usr/lib/cups/backend/ipp -S execve -F key=cups_backend_ipp
-a always,exit -F arch=b64 -F path=/usr/lib/cups/backend/ipp -S execve -F key=cups_backend_ipp

-a always,exit -F arch=b32 -F path=/usr/lib/cups/backend/lpd -S execve -F key=cups_backend_lpd
-a always,exit -F arch=b64 -F path=/usr/lib/cups/backend/lpd -S execve -F key=cups_backend_lpd

-a always,exit -F arch=b32 -F path=/usr/lib/cups/backend/usb -S execve -F key=cups_backend_usb
-a always,exit -F arch=b64 -F path=/usr/lib/cups/backend/usb -S execve -F key=cups_backend_usb

-a always,exit -F arch=b32 -F path=/usr/lib/cups/backend/parallel -S execve -F key=cups_backend_parallel
-a always,exit -F arch=b64 -F path=/usr/lib/cups/backend/parallel -S execve -F key=cups_backend_parallel

-a always,exit -F arch=b32 -F path=/usr/lib/cups/backend/serial -S execve -F key=cups_backend_serial
-a always,exit -F arch=b64 -F path=/usr/lib/cups/backend/serial -S execve -F key=cups_backend_serial

-a always,exit -F arch=b32 -F path=/usr/lib/cups/backend/socket -S execve -F key=cups_backend_socket
-a always,exit -F arch=b64 -F path=/usr/lib/cups/backend/socket -S execve -F key=cups_backend_socket

-a always,exit -F arch=b32 -F path=/usr/lib/cups/backend/smb -S execve -F key=cups_backend_smb
-a always,exit -F arch=b64 -F path=/usr/lib/cups/backend/smb -S execve -F key=cups_backend_smb

## ============================================================
## CUPS Filter Programs
## ============================================================

## Filter directory monitoring
-a always,exit -F arch=b32 -F dir=/usr/lib/cups/filter/ -S execve -F key=cups_filter
-a always,exit -F arch=b64 -F dir=/usr/lib/cups/filter/ -S execve -F key=cups_filter

## ============================================================
## CUPS Certificates and Authentication
## ============================================================

## SSL/TLS certificates
-a always,exit -F arch=b32 -F dir=/etc/cups/ssl/ -S open -S openat -S creat -S unlink -F perm=war -F key=cups_ssl
-a always,exit -F arch=b64 -F dir=/etc/cups/ssl/ -S open -S openat -S creat -S unlink -F perm=war -F key=cups_ssl

## Kerberos keytab if used
-a always,exit -F arch=b32 -F path=/etc/cups/krb5.keytab -S open -S openat -S creat -F perm=war -F key=cups_kerberos
-a always,exit -F arch=b64 -F path=/etc/cups/krb5.keytab -S open -S openat -S creat -F perm=war -F key=cups_kerberos

## Password files
-a always,exit -F arch=b32 -F path=/etc/cups/passwd.md5 -S open -S openat -S creat -F perm=war -F key=cups_passwd
-a always,exit -F arch=b64 -F path=/etc/cups/passwd.md5 -S open -S openat -S creat -F perm=war -F key=cups_passwd

## ============================================================
## Service Management
## ============================================================

## SystemD service management
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=cups -F key=cups_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=cups -F key=cups_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=cups.service -F key=cups_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=cups.service -F key=cups_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=cups.socket -F key=cups_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=cups.socket -F key=cups_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=cups.path -F key=cups_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=cups.path -F key=cups_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=cups-browsed -F key=cups_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=cups-browsed -F key=cups_service_mgmt

## Legacy service management
-a always,exit -F arch=b32 -F path=/sbin/service -S execve -F key=service_mgmt
-a always,exit -F arch=b64 -F path=/sbin/service -S execve -F key=service_mgmt

-a always,exit -F arch=b32 -F path=/etc/init.d/cups -S execve -F key=cups_service_mgmt
-a always,exit -F arch=b64 -F path=/etc/init.d/cups -S execve -F key=cups_service_mgmt

-a always,exit -F arch=b32 -F path=/etc/init.d/cupsys -S execve -F key=cups_service_mgmt
-a always,exit -F arch=b64 -F path=/etc/init.d/cupsys -S execve -F key=cups_service_mgmt

## ============================================================
## Logging and PID Files
## ============================================================

## PID files
-a always,exit -F arch=b32 -F path=/var/run/cups/cupsd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=cups_runtime
-a always,exit -F arch=b64 -F path=/var/run/cups/cupsd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=cups_runtime

-a always,exit -F arch=b32 -F path=/var/run/cupsd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=cups_runtime
-a always,exit -F arch=b64 -F path=/var/run/cupsd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=cups_runtime

## Log files
-a always,exit -F arch=b32 -F path=/var/log/cups/error_log -S open -S openat -S write -S truncate -F perm=wa -F key=cups_logs
-a always,exit -F arch=b64 -F path=/var/log/cups/error_log -S open -S openat -S write -S truncate -F perm=wa -F key=cups_logs

-a always,exit -F arch=b32 -F path=/var/log/cups/access_log -S open -S openat -S write -S truncate -F perm=wa -F key=cups_logs
-a always,exit -F arch=b64 -F path=/var/log/cups/access_log -S open -S openat -S write -S truncate -F perm=wa -F key=cups_logs

-a always,exit -F arch=b32 -F path=/var/log/cups/page_log -S open -S openat -S write -S truncate -F perm=wa -F key=cups_logs
-a always,exit -F arch=b64 -F path=/var/log/cups/page_log -S open -S openat -S write -S truncate -F perm=wa -F key=cups_logs

-a always,exit -F arch=b32 -F dir=/var/log/cups/ -S open -S openat -S write -S truncate -F perm=wa -F key=cups_logs
-a always,exit -F arch=b64 -F dir=/var/log/cups/ -S open -S openat -S write -S truncate -F perm=wa -F key=cups_logs

## ============================================================
## CUPS Web Interface Files
## ============================================================

## Web interface templates and data
-a always,exit -F arch=b32 -F dir=/usr/share/cups/templates/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_web_templates
-a always,exit -F arch=b64 -F dir=/usr/share/cups/templates/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_web_templates

-a always,exit -F arch=b32 -F dir=/usr/share/cups/www/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_web_content
-a always,exit -F arch=b64 -F dir=/usr/share/cups/www/ -S open -S openat -S creat -S unlink -F perm=wa -F key=cups_web_content

## ============================================================
## User and Group Files
## ============================================================

## CUPS group membership
-a always,exit -F arch=b32 -F path=/etc/group -S open -S openat -S write -F perm=wa -F key=cups_group
-a always,exit -F arch=b64 -F path=/etc/group -S open -S openat -S write -F perm=wa -F key=cups_group

-a always,exit -F arch=b32 -F path=/etc/passwd -S open -S openat -S write -F perm=wa -F key=cups_passwd_file
-a always,exit -F arch=b64 -F path=/etc/passwd -S open -S openat -S write -F perm=wa -F key=cups_passwd_file

## ============================================================
## Security Policy Files
## ============================================================

-a always,exit -F arch=b32 -F path=/etc/apparmor.d/usr.sbin.cupsd -S open -S openat -S creat -F perm=war -F key=cups_apparmor
-a always,exit -F arch=b64 -F path=/etc/apparmor.d/usr.sbin.cupsd -S open -S openat -S creat -F perm=war -F key=cups_apparmor

-a always,exit -F arch=b32 -F path=/etc/selinux/targeted/contexts/files/file_contexts.local -S open -S openat -S creat -F perm=war -F key=cups_selinux
-a always,exit -F arch=b64 -F path=/etc/selinux/targeted/contexts/files/file_contexts.local -S open -S openat -S creat -F perm=war -F key=cups_selinux

## ============================================================
## File Operations on CUPS Directories
## ============================================================

## Monitor file attribute changes
-a always,exit -F arch=b32 -F dir=/etc/cups/ -S chmod -S fchmod -S fchmodat -F key=cups_file_attr
-a always,exit -F arch=b64 -F dir=/etc/cups/ -S chmod -S fchmod -S fchmodat -F key=cups_file_attr

-a always,exit -F arch=b32 -F dir=/etc/cups/ -S chown -S fchown -S lchown -S fchownat -F key=cups_file_attr
-a always,exit -F arch=b64 -F dir=/etc/cups/ -S chown -S fchown -S lchown -S fchownat -F key=cups_file_attr

-a always,exit -F arch=b32 -F dir=/etc/cups/ -S chown32 -S fchown32 -S lchown32 -F key=cups_file_attr

-a always,exit -F arch=b32 -F dir=/etc/cups/ -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F key=cups_file_attr
-a always,exit -F arch=b64 -F dir=/etc/cups/ -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F key=cups_file_attr

## Monitor file operations
-a always,exit -F arch=b32 -F dir=/etc/cups/ -S open -S openat -S creat -S truncate -S ftruncate -F perm=wa -F key=cups_file_ops
-a always,exit -F arch=b64 -F dir=/etc/cups/ -S open -S openat -S creat -S truncate -S ftruncate -F perm=wa -F key=cups_file_ops

-a always,exit -F arch=b32 -F dir=/etc/cups/ -S write -S writev -S pwrite -S pwritev -F key=cups_file_write
-a always,exit -F arch=b64 -F dir=/etc/cups/ -S write -S writev -S pwrite -S pwritev -S pwritev2 -F key=cups_file_write

## Monitor file deletions
-a always,exit -F arch=b32 -F dir=/etc/cups/ -S unlink -S unlinkat -S rename -S renameat -F key=cups_file_delete
-a always,exit -F arch=b64 -F dir=/etc/cups/ -S unlink -S unlinkat -S rename -S renameat -S renameat2 -F key=cups_file_delete

## ============================================================
## Privileged Operations
## ============================================================

-a always,exit -F arch=b32 -S execve -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=cups_privileged_exec
-a always,exit -F arch=b64 -S execve -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=cups_privileged_exec

-a always,exit -F arch=b32 -S setuid -S setgid -S setreuid -S setregid -S setresuid -S setresgid -F key=cups_privilege_change
-a always,exit -F arch=b64 -S setuid -S setgid -S setreuid -S setregid -S setresuid -S setresgid -F key=cups_privilege_change

-a always,exit -F arch=b32 -S setuid32 -S setgid32 -S setreuid32 -S setregid32 -S setresuid32 -S setresgid32 -F key=cups_privilege_change
-a always,exit -F arch=b64 -S setfsuid -S setfsgid -S capset -F key=cups_privilege_change

## ============================================================
## Process and Module Operations
## ============================================================

## Process operations
-a always,exit -F arch=b32 -S fork -S vfork -S clone -F key=cups_process_creation
-a always,exit -F arch=b64 -S fork -S vfork -S clone -S clone3 -F key=cups_process_creation

-a always,exit -F arch=b32 -S kill -S tkill -S tgkill -F key=cups_process_kill
-a always,exit -F arch=b64 -S kill -S tkill -S tgkill -F key=cups_process_kill

## Module operations
-a always,exit -F arch=b32 -S init_module -S delete_module -S finit_module -F key=cups_modules
-a always,exit -F arch=b64 -S init_module -S delete_module -S finit_module -F key=cups_modules

-a always,exit -F arch=b32 -S create_module -S query_module -F key=cups_modules
-a always,exit -F arch=b64 -S kexec_load -S kexec_file_load -F key=cups_modules

## ============================================================
## System Configuration
## ============================================================

## Time changes
-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -S clock_settime -F key=cups_time_change
-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -F key=cups_time_change

## Hostname changes
-a always,exit -F arch=b32 -S sethostname -S setdomainname -F key=cups_system_info
-a always,exit -F arch=b64 -S sethostname -S setdomainname -F key=cups_system_info

## ============================================================
## IPC Operations
## ============================================================

-a always,exit -F arch=b32 -S msgctl -S msgget -S msgrcv -S msgsnd -F key=cups_ipc_msg
-a always,exit -F arch=b64 -S msgctl -S msgget -S msgrcv -S msgsnd -F key=cups_ipc_msg

-a always,exit -F arch=b32 -S semctl -S semget -S semop -S semtimedop -F key=cups_ipc_sem
-a always,exit -F arch=b64 -S semctl -S semget -S semop -S semtimedop -F key=cups_ipc_sem

-a always,exit -F arch=b32 -S shmctl -S shmget -S shmat -S shmdt -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmctl -S shmget -S shmat -S shmdt -F key=T1559_Inter-Process_Communication

## ============================================================
## Mount Operations
## ============================================================

-a always,exit -F arch=b32 -S mount -S umount -S umount2 -F key=cups_mount
-a always,exit -F arch=b64 -S mount -S umount2 -F key=cups_mount

## ============================================================
## Memory Management
## ============================================================

-a always,exit -F arch=b32 -S mmap -S mmap2 -S munmap -S mprotect -S mremap -F key=cups_memory
-a always,exit -F arch=b64 -S mmap -S munmap -S mprotect -S mremap -F key=cups_memory

-a always,exit -F arch=b32 -S setrlimit -S getrlimit -F key=cups_resource_limits
-a always,exit -F arch=b64 -S setrlimit -S getrlimit -S prlimit64 -F key=cups_resource_limits

## cancel
-a always,exit -F arch=b32 -F path=/bin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/bin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/sbin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/sbin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/bin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/bin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/sbin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/sbin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/local/bin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/local/bin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/usr/local/sbin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/usr/local/sbin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/snap/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/snap/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

-a always,exit -F arch=b32 -F path=/snap/bin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools
-a always,exit -F arch=b64 -F path=/snap/bin/cancel -F perm=x -F key=T1562.001_Impair_Defenses_Disable_or_Modify_Tools

# GlusterFS — Scalable network file system.
## ============================================================
## GlusterFS Configuration Files
## ============================================================

## Main GlusterFS configuration
-a always,exit -F arch=b32 -F path=/etc/glusterfs/glusterd.vol -S open -S openat -S creat -F perm=war -F key=gluster_config
-a always,exit -F arch=b64 -F path=/etc/glusterfs/glusterd.vol -S open -S openat -S creat -F perm=war -F key=gluster_config

-a always,exit -F arch=b32 -F path=/etc/glusterfs/glusterfsd.vol -S open -S openat -S creat -F perm=war -F key=gluster_config
-a always,exit -F arch=b64 -F path=/etc/glusterfs/glusterfsd.vol -S open -S openat -S creat -F perm=war -F key=gluster_config

## Logger configuration
-a always,exit -F arch=b32 -F path=/etc/glusterfs/logger.conf -S open -S openat -S creat -F perm=war -F key=gluster_logger
-a always,exit -F arch=b64 -F path=/etc/glusterfs/logger.conf -S open -S openat -S creat -F perm=war -F key=gluster_logger

## Group configuration for NFS-Ganesha
-a always,exit -F arch=b32 -F path=/etc/glusterfs/group -S open -S openat -S creat -F perm=war -F key=gluster_group
-a always,exit -F arch=b64 -F path=/etc/glusterfs/group -S open -S openat -S creat -F perm=war -F key=gluster_group

## GlusterFS directories
-a always,exit -F arch=b32 -F dir=/etc/glusterfs/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=gluster_config_dir
-a always,exit -F arch=b64 -F dir=/etc/glusterfs/ -S open -S openat -S creat -S mkdir -S rmdir -F perm=wa -F key=gluster_config_dir

## ============================================================
## GlusterFS Volume Configuration
## ============================================================

## Volume info directory
-a always,exit -F arch=b32 -F dir=/var/lib/glusterd/vols/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_volumes
-a always,exit -F arch=b64 -F dir=/var/lib/glusterd/vols/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_volumes

## Peer configuration
-a always,exit -F arch=b32 -F dir=/var/lib/glusterd/peers/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_peers
-a always,exit -F arch=b64 -F dir=/var/lib/glusterd/peers/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_peers

## GlusterFS state directory
-a always,exit -F arch=b32 -F dir=/var/lib/glusterd/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_state
-a always,exit -F arch=b64 -F dir=/var/lib/glusterd/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_state

## Glusterd info file
-a always,exit -F arch=b32 -F path=/var/lib/glusterd/glusterd.info -S open -S openat -S creat -F perm=war -F key=gluster_info
-a always,exit -F arch=b64 -F path=/var/lib/glusterd/glusterd.info -S open -S openat -S creat -F perm=war -F key=gluster_info

## ============================================================
## GlusterFS Server Binaries
## ============================================================

## Main GlusterFS daemon
-a always,exit -F arch=b32 -F path=/usr/sbin/glusterd -S execve -F key=gluster_daemon
-a always,exit -F arch=b64 -F path=/usr/sbin/glusterd -S execve -F key=gluster_daemon

-a always,exit -F arch=b32 -F path=/usr/sbin/glusterfsd -S execve -F key=gluster_daemon
-a always,exit -F arch=b64 -F path=/usr/sbin/glusterfsd -S execve -F key=gluster_daemon

-a always,exit -F arch=b32 -F path=/usr/sbin/glusterfs -S execve -F key=gluster_daemon
-a always,exit -F arch=b64 -F path=/usr/sbin/glusterfs -S execve -F key=gluster_daemon

## GlusterFS event daemon
-a always,exit -F arch=b32 -F path=/usr/sbin/glustereventsd -S execve -F key=gluster_events
-a always,exit -F arch=b64 -F path=/usr/sbin/glustereventsd -S execve -F key=gluster_events

## ============================================================
## GlusterFS Management Commands
## ============================================================

## Gluster CLI command
-a always,exit -F arch=b32 -F path=/usr/sbin/gluster -S execve -F key=gluster_cli
-a always,exit -F arch=b64 -F path=/usr/sbin/gluster -S execve -F key=gluster_cli

## Volume management commands
-a always,exit -F arch=b32 -F path=/usr/sbin/gluster -S execve -F a1=volume -F key=gluster_volume_mgmt
-a always,exit -F arch=b64 -F path=/usr/sbin/gluster -S execve -F a1=volume -F key=gluster_volume_mgmt

## Peer management commands
-a always,exit -F arch=b32 -F path=/usr/sbin/gluster -S execve -F a1=peer -F key=gluster_peer_mgmt
-a always,exit -F arch=b64 -F path=/usr/sbin/gluster -S execve -F a1=peer -F key=gluster_peer_mgmt

## Pool management commands
-a always,exit -F arch=b32 -F path=/usr/sbin/gluster -S execve -F a1=pool -F key=gluster_pool_mgmt
-a always,exit -F arch=b64 -F path=/usr/sbin/gluster -S execve -F a1=pool -F key=gluster_pool_mgmt

## System commands
-a always,exit -F arch=b32 -F path=/usr/sbin/gluster -S execve -F a1=system -F key=gluster_system_mgmt
-a always,exit -F arch=b64 -F path=/usr/sbin/gluster -S execve -F a1=system -F key=gluster_system_mgmt

## ============================================================
## GlusterFS Mount Operations
## ============================================================

## Mount helper
-a always,exit -F arch=b32 -F path=/sbin/mount.glusterfs -S execve -F key=gluster_mount
-a always,exit -F arch=b64 -F path=/sbin/mount.glusterfs -S execve -F key=gluster_mount

-a always,exit -F arch=b32 -F path=/usr/sbin/mount.glusterfs -S execve -F key=gluster_mount
-a always,exit -F arch=b64 -F path=/usr/sbin/mount.glusterfs -S execve -F key=gluster_mount

## FUSE mount operations
-a always,exit -F arch=b32 -F path=/usr/bin/fusermount -S execve -F key=gluster_fuse
-a always,exit -F arch=b64 -F path=/usr/bin/fusermount -S execve -F key=gluster_fuse

-a always,exit -F arch=b32 -F path=/usr/bin/fusermount3 -S execve -F key=gluster_fuse
-a always,exit -F arch=b64 -F path=/usr/bin/fusermount3 -S execve -F key=gluster_fuse

## ============================================================
## Network Socket Monitoring
## ============================================================

## Monitor GlusterFS management port (24007)
-a always,exit -F arch=b32 -S bind -F a0=24007 -F key=gluster_mgmt_bind
-a always,exit -F arch=b64 -S bind -F a0=24007 -F key=gluster_mgmt_bind

## Monitor GlusterFS brick ports (49152-49251 typically)
-a always,exit -F arch=b32 -S bind -F a0>=49152 -F a0<=49251 -F key=gluster_brick_bind
-a always,exit -F arch=b64 -S bind -F a0>=49152 -F a0<=49251 -F key=gluster_brick_bind

## Monitor Gluster Daemon port (24008)
-a always,exit -F arch=b32 -S bind -F a0=24008 -F key=gluster_daemon_bind
-a always,exit -F arch=b64 -S bind -F a0=24008 -F key=gluster_daemon_bind

## Monitor NFS port if Gluster NFS is enabled (38465-38467)
-a always,exit -F arch=b32 -S bind -F a0=38465 -F key=gluster_nfs_bind
-a always,exit -F arch=b64 -S bind -F a0=38465 -F key=gluster_nfs_bind

-a always,exit -F arch=b32 -S bind -F a0=38466 -F key=gluster_nfs_bind
-a always,exit -F arch=b64 -S bind -F a0=38466 -F key=gluster_nfs_bind

-a always,exit -F arch=b32 -S bind -F a0=38467 -F key=gluster_nfs_bind
-a always,exit -F arch=b64 -S bind -F a0=38467 -F key=gluster_nfs_bind

## Monitor socket operations
-a always,exit -F arch=b32 -S socket -S connect -S sendmsg -S recvmsg -S bind -S listen -S accept -F key=gluster_network
-a always,exit -F arch=b64 -S socket -S connect -S sendmsg -S recvmsg -S bind -S listen -S accept -S accept4 -F key=gluster_network

-a always,exit -F arch=b32 -S socketpair -S sendto -S recvfrom -S shutdown -S getsockname -S getpeername -F key=gluster_network
-a always,exit -F arch=b64 -S socketpair -S sendto -S recvfrom -S shutdown -S getsockname -S getpeername -F key=gluster_network

## ============================================================
## GlusterFS Brick Directories
## ============================================================

## Common brick mount points (adjust paths as needed)
-a always,exit -F arch=b32 -F dir=/data/glusterfs/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_bricks
-a always,exit -F arch=b64 -F dir=/data/glusterfs/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_bricks

-a always,exit -F arch=b32 -F dir=/bricks/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_bricks
-a always,exit -F arch=b64 -F dir=/bricks/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_bricks

-a always,exit -F arch=b32 -F dir=/gluster/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_bricks
-a always,exit -F arch=b64 -F dir=/gluster/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_bricks

## Brick metadata
-a always,exit -F arch=b32 -F dir=/var/lib/glusterd/bitd/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_bitrot
-a always,exit -F arch=b64 -F dir=/var/lib/glusterd/bitd/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_bitrot

-a always,exit -F arch=b32 -F dir=/var/lib/glusterd/scrub/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_scrub
-a always,exit -F arch=b64 -F dir=/var/lib/glusterd/scrub/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_scrub

## ============================================================
## GlusterFS Geo-replication
## ============================================================

## Geo-replication configuration
-a always,exit -F arch=b32 -F dir=/var/lib/glusterd/geo-replication/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_georep
-a always,exit -F arch=b64 -F dir=/var/lib/glusterd/geo-replication/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_georep

## Geo-replication commands
-a always,exit -F arch=b32 -F path=/usr/libexec/glusterfs/gsyncd -S execve -F key=gluster_gsyncd
-a always,exit -F arch=b64 -F path=/usr/libexec/glusterfs/gsyncd -S execve -F key=gluster_gsyncd

-a always,exit -F arch=b32 -F path=/usr/libexec/glusterfs/python/syncdaemon/gsyncd.py -S execve -F key=gluster_gsyncd
-a always,exit -F arch=b64 -F path=/usr/libexec/glusterfs/python/syncdaemon/gsyncd.py -S execve -F key=gluster_gsyncd

## ============================================================
## GlusterFS Quota and Limits
## ============================================================

## Quota configuration
-a always,exit -F arch=b32 -F dir=/var/lib/glusterd/quotad/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_quota
-a always,exit -F arch=b64 -F dir=/var/lib/glusterd/quotad/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_quota

## Quota daemon
-a always,exit -F arch=b32 -F path=/usr/sbin/glusterfs -F a1=quotad -S execve -F key=gluster_quotad
-a always,exit -F arch=b64 -F path=/usr/sbin/glusterfs -F a1=quotad -S execve -F key=gluster_quotad

## ============================================================
## GlusterFS Snapshot Management
## ============================================================

## Snapshot directory
-a always,exit -F arch=b32 -F dir=/var/lib/glusterd/snaps/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_snapshots
-a always,exit -F arch=b64 -F dir=/var/lib/glusterd/snaps/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_snapshots

## Snapshot daemon
-a always,exit -F arch=b32 -F path=/usr/sbin/glusterfsd -F a1=snapd -S execve -F key=gluster_snapd
-a always,exit -F arch=b64 -F path=/usr/sbin/glusterfsd -F a1=snapd -S execve -F key=gluster_snapd

## ============================================================
## GlusterFS Healing and Self-heal
## ============================================================

## Self-heal daemon
-a always,exit -F arch=b32 -F path=/usr/sbin/glusterfs -F a1=glustershd -S execve -F key=gluster_shd
-a always,exit -F arch=b64 -F path=/usr/sbin/glusterfs -F a1=glustershd -S execve -F key=gluster_shd

## Healing info
-a always,exit -F arch=b32 -F dir=/var/lib/glusterd/glustershd/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_healing
-a always,exit -F arch=b64 -F dir=/var/lib/glusterd/glustershd/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_healing

## ============================================================
## GlusterFS Hooks
## ============================================================

## Hook scripts directory
-a always,exit -F arch=b32 -F dir=/var/lib/glusterd/hooks/ -S open -S openat -S creat -S execve -F perm=wax -F key=gluster_hooks
-a always,exit -F arch=b64 -F dir=/var/lib/glusterd/hooks/ -S open -S openat -S creat -S execve -F perm=wax -F key=gluster_hooks

## ============================================================
## GlusterFS SSL/TLS Configuration
## ============================================================

## SSL certificates and keys
-a always,exit -F arch=b32 -F dir=/etc/ssl/glusterfs/ -S open -S openat -S creat -S unlink -F perm=war -F key=gluster_ssl
-a always,exit -F arch=b64 -F dir=/etc/ssl/glusterfs/ -S open -S openat -S creat -S unlink -F perm=war -F key=gluster_ssl

-a always,exit -F arch=b32 -F path=/var/lib/glusterd/secure-access -S open -S openat -S creat -F perm=war -F key=gluster_secure
-a always,exit -F arch=b64 -F path=/var/lib/glusterd/secure-access -S open -S openat -S creat -F perm=war -F key=gluster_secure

## ============================================================
## Service Management
## ============================================================

## SystemD service management
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=glusterd -F key=gluster_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=glusterd -F key=gluster_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=glusterfsd -F key=gluster_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=glusterfsd -F key=gluster_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=glusterfs-server -F key=gluster_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=glusterfs-server -F key=gluster_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=glustereventsd -F key=gluster_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=glustereventsd -F key=gluster_service_mgmt

## Legacy service management
-a always,exit -F arch=b32 -F path=/sbin/service -S execve -F key=service_mgmt
-a always,exit -F arch=b64 -F path=/sbin/service -S execve -F key=service_mgmt

-a always,exit -F arch=b32 -F path=/etc/init.d/glusterd -S execve -F key=gluster_service_mgmt
-a always,exit -F arch=b64 -F path=/etc/init.d/glusterd -S execve -F key=gluster_service_mgmt

-a always,exit -F arch=b32 -F path=/etc/init.d/glusterfsd -S execve -F key=gluster_service_mgmt
-a always,exit -F arch=b64 -F path=/etc/init.d/glusterfsd -S execve -F key=gluster_service_mgmt

## ============================================================
## Logging and PID Files
## ============================================================

## PID files
-a always,exit -F arch=b32 -F path=/var/run/glusterd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=gluster_runtime
-a always,exit -F arch=b64 -F path=/var/run/glusterd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=gluster_runtime

-a always,exit -F arch=b32 -F path=/var/run/gluster/ -S open -S openat -S write -S truncate -F perm=wa -F key=gluster_runtime
-a always,exit -F arch=b64 -F path=/var/run/gluster/ -S open -S openat -S write -S truncate -F perm=wa -F key=gluster_runtime

## Log files and directories
-a always,exit -F arch=b32 -F dir=/var/log/glusterfs/ -S open -S openat -S write -S truncate -F perm=wa -F key=gluster_logs
-a always,exit -F arch=b64 -F dir=/var/log/glusterfs/ -S open -S openat -S write -S truncate -F perm=wa -F key=gluster_logs

-a always,exit -F arch=b32 -F path=/var/log/glusterfs/glusterd.log -S open -S openat -S write -S truncate -F perm=wa -F key=gluster_logs
-a always,exit -F arch=b64 -F path=/var/log/glusterfs/glusterd.log -S open -S openat -S write -S truncate -F perm=wa -F key=gluster_logs

## CLI logs
-a always,exit -F arch=b32 -F path=/var/log/glusterfs/cli.log -S open -S openat -S write -S truncate -F perm=wa -F key=gluster_cli_logs
-a always,exit -F arch=b64 -F path=/var/log/glusterfs/cli.log -S open -S openat -S write -S truncate -F perm=wa -F key=gluster_cli_logs

## ============================================================
## GlusterFS NFS-Ganesha Integration
## ============================================================

## NFS-Ganesha configuration
-a always,exit -F arch=b32 -F dir=/var/lib/glusterd/nfs-ganesha/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_ganesha
-a always,exit -F arch=b64 -F dir=/var/lib/glusterd/nfs-ganesha/ -S open -S openat -S creat -S unlink -F perm=wa -F key=gluster_ganesha

-a always,exit -F arch=b32 -F path=/etc/ganesha/ganesha.conf -S open -S openat -S creat -F perm=war -F key=gluster_ganesha_conf
-a always,exit -F arch=b64 -F path=/etc/ganesha/ganesha.conf -S open -S openat -S creat -F perm=war -F key=gluster_ganesha_conf

## ============================================================
## Security Policy Files
## ============================================================

-a always,exit -F arch=b32 -F path=/etc/selinux/targeted/contexts/files/file_contexts.local -S open -S openat -S creat -F perm=war -F key=gluster_selinux
-a always,exit -F arch=b64 -F path=/etc/selinux/targeted/contexts/files/file_contexts.local -S open -S openat -S creat -F perm=war -F key=gluster_selinux

## ============================================================
## File Operations on GlusterFS Directories
## ============================================================

## Monitor file attribute changes
-a always,exit -F arch=b32 -F dir=/etc/glusterfs/ -S chmod -S fchmod -S fchmodat -F key=gluster_file_attr
-a always,exit -F arch=b64 -F dir=/etc/glusterfs/ -S chmod -S fchmod -S fchmodat -F key=gluster_file_attr

-a always,exit -F arch=b32 -F dir=/etc/glusterfs/ -S chown -S fchown -S lchown -S fchownat -F key=gluster_file_attr
-a always,exit -F arch=b64 -F dir=/etc/glusterfs/ -S chown -S fchown -S lchown -S fchownat -F key=gluster_file_attr

-a always,exit -F arch=b32 -F dir=/etc/glusterfs/ -S chown32 -S fchown32 -S lchown32 -F key=gluster_file_attr

-a always,exit -F arch=b32 -F dir=/etc/glusterfs/ -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F key=gluster_file_attr
-a always,exit -F arch=b64 -F dir=/etc/glusterfs/ -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F key=gluster_file_attr

## Monitor file operations
-a always,exit -F arch=b32 -F dir=/etc/glusterfs/ -S open -S openat -S creat -S truncate -S ftruncate -F perm=wa -F key=gluster_file_ops
-a always,exit -F arch=b64 -F dir=/etc/glusterfs/ -S open -S openat -S creat -S truncate -S ftruncate -F perm=wa -F key=gluster_file_ops

-a always,exit -F arch=b32 -F dir=/etc/glusterfs/ -S write -S writev -S pwrite -S pwritev -F key=gluster_file_write
-a always,exit -F arch=b64 -F dir=/etc/glusterfs/ -S write -S writev -S pwrite -S pwritev -S pwritev2 -F key=gluster_file_write

## Monitor file deletions
-a always,exit -F arch=b32 -F dir=/etc/glusterfs/ -S unlink -S unlinkat -S rename -S renameat -F key=gluster_file_delete
-a always,exit -F arch=b64 -F dir=/etc/glusterfs/ -S unlink -S unlinkat -S rename -S renameat -S renameat2 -F key=gluster_file_delete

## ============================================================
## Privileged Operations
## ============================================================

-a always,exit -F arch=b32 -S execve -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=gluster_privileged_exec
-a always,exit -F arch=b64 -S execve -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=gluster_privileged_exec

-a always,exit -F arch=b32 -S setuid -S setgid -S setreuid -S setregid -S setresuid -S setresgid -F key=gluster_privilege_change
-a always,exit -F arch=b64 -S setuid -S setgid -S setreuid -S setregid -S setresuid -S setresgid -F key=gluster_privilege_change

-a always,exit -F arch=b32 -S setuid32 -S setgid32 -S setreuid32 -S setregid32 -S setresuid32 -S setresgid32 -F key=gluster_privilege_change
-a always,exit -F arch=b64 -S setfsuid -S setfsgid -S capset -F key=gluster_privilege_change

## ============================================================
## Process and Module Operations
## ============================================================

## Process operations
-a always,exit -F arch=b32 -S fork -S vfork -S clone -F key=gluster_process_creation
-a always,exit -F arch=b64 -S fork -S vfork -S clone -S clone3 -F key=gluster_process_creation

-a always,exit -F arch=b32 -S kill -S tkill -S tgkill -F key=gluster_process_kill
-a always,exit -F arch=b64 -S kill -S tkill -S tgkill -F key=gluster_process_kill

## Module operations
-a always,exit -F arch=b32 -S init_module -S delete_module -S finit_module -F key=gluster_modules
-a always,exit -F arch=b64 -S init_module -S delete_module -S finit_module -F key=gluster_modules

-a always,exit -F arch=b32 -S create_module -S query_module -F key=gluster_modules
-a always,exit -F arch=b64 -S kexec_load -S kexec_file_load -F key=gluster_modules

## ============================================================
## System Configuration
## ============================================================

## Time changes
-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -S clock_settime -F key=gluster_time_change
-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -F key=gluster_time_change

## Hostname changes
-a always,exit -F arch=b32 -S sethostname -S setdomainname -F key=gluster_system_info
-a always,exit -F arch=b64 -S sethostname -S setdomainname -F key=gluster_system_info

## ============================================================
## IPC Operations
## ============================================================

-a always,exit -F arch=b32 -S msgctl -S msgget -S msgrcv -S msgsnd -F key=gluster_ipc_msg
-a always,exit -F arch=b64 -S msgctl -S msgget -S msgrcv -S msgsnd -F key=gluster_ipc_msg

-a always,exit -F arch=b32 -S semctl -S semget -S semop -S semtimedop -F key=gluster_ipc_sem
-a always,exit -F arch=b64 -S semctl -S semget -S semop -S semtimedop -F key=gluster_ipc_sem

-a always,exit -F arch=b32 -S shmctl -S shmget -S shmat -S shmdt -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmctl -S shmget -S shmat -S shmdt -F key=T1559_Inter-Process_Communication

## ============================================================
## Mount Operations
## ============================================================

-a always,exit -F arch=b32 -S mount -S umount -S umount2 -F key=gluster_mount
-a always,exit -F arch=b64 -S mount -S umount2 -F key=gluster_mount

## ============================================================
## Memory Management
## ============================================================

-a always,exit -F arch=b32 -S mmap -S mmap2 -S munmap -S mprotect -S mremap -F key=gluster_memory
-a always,exit -F arch=b64 -S mmap -S munmap -S mprotect -S mremap -F key=gluster_memory

-a always,exit -F arch=b32 -S setrlimit -S getrlimit -F key=gluster_resource_limits
-a always,exit -F arch=b64 -S setrlimit -S getrlimit -S prlimit64 -F key=gluster_resource_limits

# NFS (Network File System) — File sharing over network for Unix systems.

## ============================================================
## NFS Configuration Files
## ============================================================

## Main NFS exports configuration
-a always,exit -F arch=b32 -F path=/etc/exports -S open -S openat -S creat -F perm=war -F key=nfs_exports
-a always,exit -F arch=b64 -F path=/etc/exports -S open -S openat -S creat -F perm=war -F key=nfs_exports

## NFS exports directory
-a always,exit -F arch=b32 -F dir=/etc/exports.d/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_exports_dir
-a always,exit -F arch=b64 -F dir=/etc/exports.d/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_exports_dir

## NFS configuration file
-a always,exit -F arch=b32 -F path=/etc/nfs.conf -S open -S openat -S creat -F perm=war -F key=nfs_config
-a always,exit -F arch=b64 -F path=/etc/nfs.conf -S open -S openat -S creat -F perm=war -F key=nfs_config

-a always,exit -F arch=b32 -F path=/etc/nfsmount.conf -S open -S openat -S creat -F perm=war -F key=nfs_mount_config
-a always,exit -F arch=b64 -F path=/etc/nfsmount.conf -S open -S openat -S creat -F perm=war -F key=nfs_mount_config

## Legacy NFS configuration
-a always,exit -F arch=b32 -F path=/etc/sysconfig/nfs -S open -S openat -S creat -F perm=war -F key=nfs_sysconfig
-a always,exit -F arch=b64 -F path=/etc/sysconfig/nfs -S open -S openat -S creat -F perm=war -F key=nfs_sysconfig

-a always,exit -F arch=b32 -F path=/etc/default/nfs-kernel-server -S open -S openat -S creat -F perm=war -F key=nfs_defaults
-a always,exit -F arch=b64 -F path=/etc/default/nfs-kernel-server -S open -S openat -S creat -F perm=war -F key=nfs_defaults

-a always,exit -F arch=b32 -F path=/etc/default/nfs-common -S open -S openat -S creat -F perm=war -F key=nfs_defaults
-a always,exit -F arch=b64 -F path=/etc/default/nfs-common -S open -S openat -S creat -F perm=war -F key=nfs_defaults

## ============================================================
## NFS Server Daemons
## ============================================================

## NFS kernel server daemon
-a always,exit -F arch=b32 -F path=/usr/sbin/rpc.nfsd -S execve -F key=nfs_daemon
-a always,exit -F arch=b64 -F path=/usr/sbin/rpc.nfsd -S execve -F key=nfs_daemon

## Mount daemon
-a always,exit -F arch=b32 -F path=/usr/sbin/rpc.mountd -S execve -F key=nfs_mountd
-a always,exit -F arch=b64 -F path=/usr/sbin/rpc.mountd -S execve -F key=nfs_mountd

## Status monitor daemon
-a always,exit -F arch=b32 -F path=/usr/sbin/rpc.statd -S execve -F key=nfs_statd
-a always,exit -F arch=b64 -F path=/usr/sbin/rpc.statd -S execve -F key=nfs_statd

-a always,exit -F arch=b32 -F path=/sbin/rpc.statd -S execve -F key=nfs_statd
-a always,exit -F arch=b64 -F path=/sbin/rpc.statd -S execve -F key=nfs_statd

## Lock daemon
-a always,exit -F arch=b32 -F path=/usr/sbin/rpc.lockd -S execve -F key=nfs_lockd
-a always,exit -F arch=b64 -F path=/usr/sbin/rpc.lockd -S execve -F key=nfs_lockd

## Quota daemon
-a always,exit -F arch=b32 -F path=/usr/sbin/rpc.rquotad -S execve -F key=nfs_quotad
-a always,exit -F arch=b64 -F path=/usr/sbin/rpc.rquotad -S execve -F key=nfs_quotad

## ============================================================
## NFSv4 Specific Components
## ============================================================

## ID mapping daemon
-a always,exit -F arch=b32 -F path=/usr/sbin/rpc.idmapd -S execve -F key=nfs_idmapd
-a always,exit -F arch=b64 -F path=/usr/sbin/rpc.idmapd -S execve -F key=nfs_idmapd

## NFSv4 callback daemon
-a always,exit -F arch=b32 -F path=/usr/sbin/nfscbd -S execve -F key=nfs_callback
-a always,exit -F arch=b64 -F path=/usr/sbin/nfscbd -S execve -F key=nfs_callback

## GSS daemon for Kerberos
-a always,exit -F arch=b32 -F path=/usr/sbin/rpc.gssd -S execve -F key=nfs_gssd
-a always,exit -F arch=b64 -F path=/usr/sbin/rpc.gssd -S execve -F key=nfs_gssd

-a always,exit -F arch=b32 -F path=/usr/sbin/rpc.svcgssd -S execve -F key=nfs_svcgssd
-a always,exit -F arch=b64 -F path=/usr/sbin/rpc.svcgssd -S execve -F key=nfs_svcgssd

## ============================================================
## RPC and Portmapper Services
## ============================================================

## Portmapper/rpcbind
-a always,exit -F arch=b32 -F path=/sbin/rpcbind -S execve -F key=rpcbind
-a always,exit -F arch=b64 -F path=/sbin/rpcbind -S execve -F key=rpcbind

-a always,exit -F arch=b32 -F path=/usr/sbin/rpcbind -S execve -F key=rpcbind
-a always,exit -F arch=b64 -F path=/usr/sbin/rpcbind -S execve -F key=rpcbind

-a always,exit -F arch=b32 -F path=/sbin/portmap -S execve -F key=portmap
-a always,exit -F arch=b64 -F path=/sbin/portmap -S execve -F key=portmap

## RPC info commands
-a always,exit -F arch=b32 -F path=/usr/sbin/rpcinfo -S execve -F key=rpc_info
-a always,exit -F arch=b64 -F path=/usr/sbin/rpcinfo -S execve -F key=rpc_info

-a always,exit -F arch=b32 -F path=/usr/bin/rpcinfo -S execve -F key=rpc_info
-a always,exit -F arch=b64 -F path=/usr/bin/rpcinfo -S execve -F key=rpc_info

## ============================================================
## NFS Management Commands
## ============================================================

## Export management
-a always,exit -F arch=b32 -F path=/usr/sbin/exportfs -S execve -F key=nfs_exportfs
-a always,exit -F arch=b64 -F path=/usr/sbin/exportfs -S execve -F key=nfs_exportfs

## Show mount information
-a always,exit -F arch=b32 -F path=/usr/sbin/showmount -S execve -F key=nfs_showmount
-a always,exit -F arch=b64 -F path=/usr/sbin/showmount -S execve -F key=nfs_showmount

## NFS statistics
-a always,exit -F arch=b32 -F path=/usr/sbin/nfsstat -S execve -F key=nfs_stats
-a always,exit -F arch=b64 -F path=/usr/sbin/nfsstat -S execve -F key=nfs_stats

-a always,exit -F arch=b32 -F path=/usr/bin/nfsstat -S execve -F key=nfs_stats
-a always,exit -F arch=b64 -F path=/usr/bin/nfsstat -S execve -F key=nfs_stats

## NFS I/O statistics
-a always,exit -F arch=b32 -F path=/usr/sbin/nfsiostat -S execve -F key=nfs_iostats
-a always,exit -F arch=b64 -F path=/usr/sbin/nfsiostat -S execve -F key=nfs_iostats

-a always,exit -F arch=b32 -F path=/usr/bin/nfsiostat -S execve -F key=nfs_iostats
-a always,exit -F arch=b64 -F path=/usr/bin/nfsiostat -S execve -F key=nfs_iostats

## ============================================================
## Mount Operations
## ============================================================

## NFS mount helper
#-a always,exit -F arch=b32 -F path=/sbin/mount.nfs -S execve -F key=nfs_mount
#-a always,exit -F arch=b64 -F path=/sbin/mount.nfs -S execve -F key=nfs_mount

#-a always,exit -F arch=b32 -F path=/sbin/mount.nfs4 -S execve -F key=nfs_mount
#-a always,exit -F arch=b64 -F path=/sbin/mount.nfs4 -S execve -F key=nfs_mount

#-a always,exit -F arch=b32 -F path=/sbin/umount.nfs -S execve -F key=nfs_umount
#-a always,exit -F arch=b64 -F path=/sbin/umount.nfs -S execve -F key=nfs_umount

#-a always,exit -F arch=b32 -F path=/sbin/umount.nfs4 -S execve -F key=nfs_umount
#-a always,exit -F arch=b64 -F path=/sbin/umount.nfs4 -S execve -F key=nfs_umount

## ============================================================
## Network Socket Monitoring
## ============================================================

## Monitor RPC portmapper (port 111)
-a always,exit -F arch=b32 -S bind -F a0=111 -F key=rpc_portmap_bind
-a always,exit -F arch=b64 -S bind -F a0=111 -F key=rpc_portmap_bind

## Monitor NFS port (port 2049)
-a always,exit -F arch=b32 -S bind -F a0=2049 -F key=nfs_bind
-a always,exit -F arch=b64 -S bind -F a0=2049 -F key=nfs_bind

## Monitor mount daemon port (varies, often 20048)
-a always,exit -F arch=b32 -S bind -F a0=20048 -F key=nfs_mountd_bind
-a always,exit -F arch=b64 -S bind -F a0=20048 -F key=nfs_mountd_bind

## Monitor status daemon port (varies, often 32765-32768)
-a always,exit -F arch=b32 -S bind -F a0=32765 -F key=nfs_statd_bind
-a always,exit -F arch=b64 -S bind -F a0=32765 -F key=nfs_statd_bind

-a always,exit -F arch=b32 -S bind -F a0=32766 -F key=nfs_statd_bind
-a always,exit -F arch=b64 -S bind -F a0=32766 -F key=nfs_statd_bind

-a always,exit -F arch=b32 -S bind -F a0=32767 -F key=nfs_statd_bind
-a always,exit -F arch=b64 -S bind -F a0=32767 -F key=nfs_statd_bind

-a always,exit -F arch=b32 -S bind -F a0=32768 -F key=nfs_statd_bind
-a always,exit -F arch=b64 -S bind -F a0=32768 -F key=nfs_statd_bind

## Monitor lock daemon port (varies, often 32803)
-a always,exit -F arch=b32 -S bind -F a0=32803 -F key=nfs_lockd_bind
-a always,exit -F arch=b64 -S bind -F a0=32803 -F key=nfs_lockd_bind

## Monitor socket operations
-a always,exit -F arch=b32 -S socket -S connect -S sendmsg -S recvmsg -S bind -S listen -S accept -F key=nfs_network
-a always,exit -F arch=b64 -S socket -S connect -S sendmsg -S recvmsg -S bind -S listen -S accept -S accept4 -F key=nfs_network

-a always,exit -F arch=b32 -S socketpair -S sendto -S recvfrom -S shutdown -S getsockname -S getpeername -F key=nfs_network
-a always,exit -F arch=b64 -S socketpair -S sendto -S recvfrom -S shutdown -S getsockname -S getpeername -F key=nfs_network

## ============================================================
## NFS State and Lock Files
## ============================================================

## NFS state directory
-a always,exit -F arch=b32 -F dir=/var/lib/nfs/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_state
-a always,exit -F arch=b64 -F dir=/var/lib/nfs/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_state

## Export state files
-a always,exit -F arch=b32 -F path=/var/lib/nfs/etab -S open -S openat -S write -F perm=wa -F key=nfs_etab
-a always,exit -F arch=b64 -F path=/var/lib/nfs/etab -S open -S openat -S write -F perm=wa -F key=nfs_etab

-a always,exit -F arch=b32 -F path=/var/lib/nfs/xtab -S open -S openat -S write -F perm=wa -F key=nfs_xtab
-a always,exit -F arch=b64 -F path=/var/lib/nfs/xtab -S open -S openat -S write -F perm=wa -F key=nfs_xtab

## RPC state files
-a always,exit -F arch=b32 -F path=/var/lib/nfs/rmtab -S open -S openat -S write -F perm=wa -F key=nfs_rmtab
-a always,exit -F arch=b64 -F path=/var/lib/nfs/rmtab -S open -S openat -S write -F perm=wa -F key=nfs_rmtab

## Status monitoring
-a always,exit -F arch=b32 -F dir=/var/lib/nfs/statd/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_statd_state
-a always,exit -F arch=b64 -F dir=/var/lib/nfs/statd/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_statd_state

-a always,exit -F arch=b32 -F dir=/var/lib/nfs/sm/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_sm_state
-a always,exit -F arch=b64 -F dir=/var/lib/nfs/sm/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_sm_state

-a always,exit -F arch=b32 -F dir=/var/lib/nfs/sm.bak/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_sm_backup
-a always,exit -F arch=b64 -F dir=/var/lib/nfs/sm.bak/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_sm_backup

## ============================================================
## NFSv4 State and Recovery
## ============================================================

## NFSv4 recovery directory
-a always,exit -F arch=b32 -F dir=/var/lib/nfs/v4recovery/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfsv4_recovery
-a always,exit -F arch=b64 -F dir=/var/lib/nfs/v4recovery/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfsv4_recovery

## NFSv4 state
-a always,exit -F arch=b32 -F dir=/var/lib/nfs/nfsdcltrack/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfsv4_cltrack
-a always,exit -F arch=b64 -F dir=/var/lib/nfs/nfsdcltrack/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfsv4_cltrack

## ============================================================
## ID Mapping Configuration
## ============================================================

## ID mapping configuration
-a always,exit -F arch=b32 -F path=/etc/idmapd.conf -S open -S openat -S creat -F perm=war -F key=nfs_idmap_conf
-a always,exit -F arch=b64 -F path=/etc/idmapd.conf -S open -S openat -S creat -F perm=war -F key=nfs_idmap_conf

## Request-key configuration
-a always,exit -F arch=b32 -F path=/etc/request-key.conf -S open -S openat -S creat -F perm=war -F key=nfs_request_key
-a always,exit -F arch=b64 -F path=/etc/request-key.conf -S open -S openat -S creat -F perm=war -F key=nfs_request_key

-a always,exit -F arch=b32 -F dir=/etc/request-key.d/ -S open -S openat -S creat -F perm=war -F key=nfs_request_key_dir
-a always,exit -F arch=b64 -F dir=/etc/request-key.d/ -S open -S openat -S creat -F perm=war -F key=nfs_request_key_dir

## ============================================================
## Kerberos/GSSAPI Configuration
## ============================================================

## Kerberos keytab for NFS
-a always,exit -F arch=b32 -F path=/etc/krb5.keytab -S open -S openat -S creat -F perm=war -F key=nfs_krb5_keytab
-a always,exit -F arch=b64 -F path=/etc/krb5.keytab -S open -S openat -S creat -F perm=war -F key=nfs_krb5_keytab

## GSSAPI mech configuration
-a always,exit -F arch=b32 -F path=/etc/gssapi_mech.conf -S open -S openat -S creat -F perm=war -F key=nfs_gssapi
-a always,exit -F arch=b64 -F path=/etc/gssapi_mech.conf -S open -S openat -S creat -F perm=war -F key=nfs_gssapi

## ============================================================
## Service Management
## ============================================================

## SystemD service management - NFS server
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=nfs-server -F key=nfs_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=nfs-server -F key=nfs_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=nfs-kernel-server -F key=nfs_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=nfs-kernel-server -F key=nfs_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=nfsd -F key=nfs_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=nfsd -F key=nfs_service_mgmt

## SystemD service management - NFS client
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=nfs-client -F key=nfs_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=nfs-client -F key=nfs_service_mgmt

## SystemD service management - RPC services
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=rpcbind -F key=nfs_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=rpcbind -F key=nfs_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=rpc-statd -F key=nfs_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=rpc-statd -F key=nfs_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=rpc-mountd -F key=nfs_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=rpc-mountd -F key=nfs_service_mgmt

-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=nfs-idmapd -F key=nfs_service_mgmt
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=nfs-idmapd -F key=nfs_service_mgmt

## Legacy service management
-a always,exit -F arch=b32 -F path=/sbin/service -S execve -F key=service_mgmt
-a always,exit -F arch=b64 -F path=/sbin/service -S execve -F key=service_mgmt

-a always,exit -F arch=b32 -F path=/etc/init.d/nfs -S execve -F key=nfs_service_mgmt
-a always,exit -F arch=b64 -F path=/etc/init.d/nfs -S execve -F key=nfs_service_mgmt

-a always,exit -F arch=b32 -F path=/etc/init.d/nfs-kernel-server -S execve -F key=nfs_service_mgmt
-a always,exit -F arch=b64 -F path=/etc/init.d/nfs-kernel-server -S execve -F key=nfs_service_mgmt

-a always,exit -F arch=b32 -F path=/etc/init.d/rpcbind -S execve -F key=nfs_service_mgmt
-a always,exit -F arch=b64 -F path=/etc/init.d/rpcbind -S execve -F key=nfs_service_mgmt

## ============================================================
## Logging and PID Files
## ============================================================

## PID files
-a always,exit -F arch=b32 -F path=/var/run/rpc.statd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=nfs_runtime
-a always,exit -F arch=b64 -F path=/var/run/rpc.statd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=nfs_runtime

-a always,exit -F arch=b32 -F path=/var/run/rpc.mountd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=nfs_runtime
-a always,exit -F arch=b64 -F path=/var/run/rpc.mountd.pid -S open -S openat -S write -S truncate -F perm=wa -F key=nfs_runtime

-a always,exit -F arch=b32 -F path=/var/run/rpcbind.pid -S open -S openat -S write -S truncate -F perm=wa -F key=nfs_runtime
-a always,exit -F arch=b64 -F path=/var/run/rpcbind.pid -S open -S openat -S write -S truncate -F perm=wa -F key=nfs_runtime

## Lock files
-a always,exit -F arch=b32 -F path=/var/run/rpcbind.lock -S open -S openat -S write -S truncate -F perm=wa -F key=nfs_locks
-a always,exit -F arch=b64 -F path=/var/run/rpcbind.lock -S open -S openat -S write -S truncate -F perm=wa -F key=nfs_locks

## ============================================================
## NFS Exported Directories (Examples - Customize as needed)
## ============================================================

## Common NFS export paths
-a always,exit -F arch=b32 -F dir=/srv/nfs/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_exports_data
-a always,exit -F arch=b64 -F dir=/srv/nfs/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_exports_data

-a always,exit -F arch=b32 -F dir=/export/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_exports_data
-a always,exit -F arch=b64 -F dir=/export/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_exports_data

-a always,exit -F arch=b32 -F dir=/nfs/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_exports_data
-a always,exit -F arch=b64 -F dir=/nfs/ -S open -S openat -S creat -S unlink -F perm=wa -F key=nfs_exports_data

## ============================================================
## Security Policy Files
## ============================================================

-a always,exit -F arch=b32 -F path=/etc/selinux/targeted/contexts/files/file_contexts.local -S open -S openat -S creat -F perm=war -F key=nfs_selinux
-a always,exit -F arch=b64 -F path=/etc/selinux/targeted/contexts/files/file_contexts.local -S open -S openat -S creat -F perm=war -F key=nfs_selinux

## ============================================================
## File Operations on NFS Configuration
## ============================================================

## Monitor file attribute changes
-a always,exit -F arch=b32 -F dir=/etc/exports.d/ -S chmod -S fchmod -S fchmodat -F key=nfs_file_attr
-a always,exit -F arch=b64 -F dir=/etc/exports.d/ -S chmod -S fchmod -S fchmodat -F key=nfs_file_attr

-a always,exit -F arch=b32 -F dir=/etc/exports.d/ -S chown -S fchown -S lchown -S fchownat -F key=nfs_file_attr
-a always,exit -F arch=b64 -F dir=/etc/exports.d/ -S chown -S fchown -S lchown -S fchownat -F key=nfs_file_attr

-a always,exit -F arch=b32 -F dir=/etc/exports.d/ -S chown32 -S fchown32 -S lchown32 -F key=nfs_file_attr

-a always,exit -F arch=b32 -F dir=/etc/exports.d/ -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F key=nfs_file_attr
-a always,exit -F arch=b64 -F dir=/etc/exports.d/ -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F key=nfs_file_attr

## Monitor file operations
-a always,exit -F arch=b32 -F dir=/var/lib/nfs/ -S open -S openat -S creat -S truncate -S ftruncate -F perm=wa -F key=nfs_file_ops
-a always,exit -F arch=b64 -F dir=/var/lib/nfs/ -S open -S openat -S creat -S truncate -S ftruncate -F perm=wa -F key=nfs_file_ops

-a always,exit -F arch=b32 -F dir=/var/lib/nfs/ -S write -S writev -S pwrite -S pwritev -F key=nfs_file_write
-a always,exit -F arch=b64 -F dir=/var/lib/nfs/ -S write -S writev -S pwrite -S pwritev -S pwritev2 -F key=nfs_file_write

## Monitor file deletions
-a always,exit -F arch=b32 -F dir=/var/lib/nfs/ -S unlink -S unlinkat -S rename -S renameat -F key=nfs_file_delete
-a always,exit -F arch=b64 -F dir=/var/lib/nfs/ -S unlink -S unlinkat -S rename -S renameat -S renameat2 -F key=nfs_file_delete

## ============================================================
## Privileged Operations
## ============================================================

-a always,exit -F arch=b32 -S execve -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=nfs_privileged_exec
-a always,exit -F arch=b64 -S execve -F euid=0 -F "auid>=500" -F "auid!=-1" -F key=nfs_privileged_exec

-a always,exit -F arch=b32 -S setuid -S setgid -S setreuid -S setregid -S setresuid -S setresgid -F key=nfs_privilege_change
-a always,exit -F arch=b64 -S setuid -S setgid -S setreuid -S setregid -S setresuid -S setresgid -F key=nfs_privilege_change

-a always,exit -F arch=b32 -S setuid32 -S setgid32 -S setreuid32 -S setregid32 -S setresuid32 -S setresgid32 -F key=nfs_privilege_change
-a always,exit -F arch=b64 -S setfsuid -S setfsgid -S capset -F key=nfs_privilege_change

## ============================================================
## Process and Module Operations
## ============================================================

## Process operations
-a always,exit -F arch=b32 -S fork -S vfork -S clone -F key=nfs_process_creation
-a always,exit -F arch=b64 -S fork -S vfork -S clone -S clone3 -F key=nfs_process_creation

-a always,exit -F arch=b32 -S kill -S tkill -S tgkill -F key=nfs_process_kill
-a always,exit -F arch=b64 -S kill -S tkill -S tgkill -F key=nfs_process_kill

## Module operations
-a always,exit -F arch=b32 -S init_module -S delete_module -S finit_module -F key=nfs_modules
-a always,exit -F arch=b64 -S init_module -S delete_module -S finit_module -F key=nfs_modules

-a always,exit -F arch=b32 -S create_module -S query_module -F key=nfs_modules
-a always,exit -F arch=b64 -S kexec_load -S kexec_file_load -F key=nfs_modules

## ============================================================
## System Configuration
## ============================================================

## Time changes
-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -S clock_settime -F key=nfs_time_change
-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -F key=nfs_time_change

## Hostname changes
-a always,exit -F arch=b32 -S sethostname -S setdomainname -F key=nfs_system_info
-a always,exit -F arch=b64 -S sethostname -S setdomainname -F key=nfs_system_info

## ============================================================
## IPC Operations
## ============================================================

-a always,exit -F arch=b32 -S msgctl -S msgget -S msgrcv -S msgsnd -F key=nfs_ipc_msg
-a always,exit -F arch=b64 -S msgctl -S msgget -S msgrcv -S msgsnd -F key=nfs_ipc_msg

-a always,exit -F arch=b32 -S semctl -S semget -S semop -S semtimedop -F key=nfs_ipc_sem
-a always,exit -F arch=b64 -S semctl -S semget -S semop -S semtimedop -F key=nfs_ipc_sem

-a always,exit -F arch=b32 -S shmctl -S shmget -S shmat -S shmdt -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmctl -S shmget -S shmat -S shmdt -F key=T1559_Inter-Process_Communication

## ============================================================
## Mount Operations
## ============================================================

-a always,exit -F arch=b32 -S mount -S umount -S umount2 -F key=nfs_mount_ops
-a always,exit -F arch=b64 -S mount -S umount2 -F key=nfs_mount_ops

## ============================================================
## Memory Management
## ============================================================

-a always,exit -F arch=b32 -S mmap -S mmap2 -S munmap -S mprotect -S mremap -F key=nfs_memory
-a always,exit -F arch=b64 -S mmap -S munmap -S mprotect -S mremap -F key=nfs_memory

-a always,exit -F arch=b32 -S setrlimit -S getrlimit -F key=nfs_resource_limits
-a always,exit -F arch=b64 -S setrlimit -S getrlimit -S prlimit64 -F key=nfs_resource_limits

# unclear
# -a always,exit -F socket=udp -F sport=443 -F key=quic_traffic

# Basic BPF Syscall Monitoring

## Monitor all bpf() syscalls (syscall number 321 on x86_64)
-a always,exit -F arch=b64 -S bpf -F key=ebpf_syscall
-a always,exit -F arch=b32 -S bpf -F key=ebpf_syscall

## Monitor specific BPF commands (using a0 for cmd argument)
## BPF_PROG_LOAD = 5
-a always,exit -F arch=b64 -S bpf -F a0=5 -F key=ebpf_prog_load

## BPF_MAP_CREATE = 0
-a always,exit -F arch=b64 -S bpf -F a0=0 -F key=ebpf_map_create

## BPF_OBJ_PIN = 6 (pin objects to BPF filesystem)
-a always,exit -F arch=b64 -S bpf -F a0=6 -F key=ebpf_obj_pin

## BPF_OBJ_GET = 7 (get pinned objects)
-a always,exit -F arch=b64 -S bpf -F a0=7 -F key=ebpf_obj_get

## BPF_PROG_ATTACH = 8 (attach programs)
-a always,exit -F arch=b64 -S bpf -F a0=8 -F key=ebpf_prog_attach

## BPF_PROG_DETACH = 9
-a always,exit -F arch=b64 -S bpf -F a0=9 -F key=ebpf_prog_detach

# BPF Filesystem Monitoring Using Syscalls
# Monitor open operations on BPF filesystem
-a always,exit -F arch=b32 -S open,openat -F dir=/sys/fs/bpf/ -F key=bpffs_open
-a always,exit -F arch=b64 -S open,openat -F dir=/sys/fs/bpf/ -F key=bpffs_open

# Monitor file creation in BPF filesystem
-a always,exit -F arch=b64 -S openat,open -F dir=/sys/fs/bpf/ -F perm=w -F key=bpffs_create

-a always,exit -F arch=b64 -S creat -F dir=/sys/fs/bpf/ -F key=bpffs_create

# Monitor read operations on BPF filesystem
-a always,exit -F arch=b64 -S read,pread64,readv,preadv -F dir=/sys/fs/bpf/ -F key=bpffs_read

# Monitor write operations on BPF filesystem
-a always,exit -F arch=b64 -S write,pwrite64,writev,pwritev -F dir=/sys/fs/bpf/ -F key=bpffs_write

# Monitor directory operations on BPF filesystem
-a always,exit -F arch=b64 -S mkdir,mkdirat -F dir=/sys/fs/bpf/ -F key=bpffs_mkdir
-a always,exit -F arch=b64 -S rmdir -F dir=/sys/fs/bpf/ -F key=bpffs_rmdir
-a always,exit -F arch=b64 -S unlink,unlinkat -F dir=/sys/fs/bpf/ -F key=bpffs_unlink

# Monitor attribute changes on BPF filesystem
-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F dir=/sys/fs/bpf/ -F key=bpffs_chmod
-a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F dir=/sys/fs/bpf/ -F key=bpffs_chown

# Monitor mount operations for BPF filesystem
-a always,exit -F arch=b64 -S mount -F a1=/sys/fs/bpf -F key=bpffs_mount
-a always,exit -F arch=b64 -S umount2 -F dir=/sys/fs/bpf/ -F key=bpffs_umount

# XDP-Specific Monitoring
## Monitor XDP program loads (BPF_PROG_TYPE_XDP = 6)
## This requires checking both command and prog_type
-a always,exit -F arch=b64 -S bpf -F a0=5 -F key=xdp_prog_load

## Monitor network interface operations that might involve XDP
-a always,exit -F arch=b64 -S setsockopt -F a2=49 -F key=xdp_setsockopt

# Failed eBPF Operations
## Monitor failed BPF syscalls
-a always,exit -F arch=b64 -S bpf -F exit=-EPERM -F key=ebpf_denied_perm

-a always,exit -F arch=b64 -S bpf -F exit=-EACCES -F key=ebpf_denied_access

-a always,exit -F arch=b64 -S bpf -F exit=-EINVAL -F key=ebpf_invalid

-a always,exit -F arch=b64 -S bpf -F exit=-E2BIG -F key=ebpf_too_big

-a always,exit -F arch=b64 -S bpf -F exit=-ENOMEM -F key=ebpf_no_memory

-a always,exit -F arch=b64 -S bpf -F exit=-ENOSPC -F key=ebpf_no_space

# Advanced eBPF Monitoring
## Monitor BPF program test runs (BPF_PROG_TEST_RUN = 10)
-a always,exit -F arch=b64 -S bpf -F a0=10 -F key=ebpf_test_run

## Monitor BPF program queries (BPF_PROG_QUERY = 16)
-a always,exit -F arch=b64 -S bpf -F a0=16 -F key=ebpf_prog_query

## Monitor BPF BTF operations (BPF_BTF_LOAD = 18)
-a always,exit -F arch=b64 -S bpf -F a0=18 -F key=ebpf_btf_load

## Monitor BPF iterator operations (BPF_LINK_CREATE = 28)
-a always,exit -F arch=b64 -S bpf -F a0=28 -F key=ebpf_link_create

# Privilege Escalation Detection
## Monitor potential privilege escalation via eBPF
-a always,exit -F arch=b64 -S bpf -F "uid!=0" -F euid=0 -F key=ebpf_priv_escalation
-a always,exit -F arch=b64 -S bpf -F auid!=0 -F uid=0 -F key=ebpf_sudo_usage

## Monitor capability changes that affect eBPF
-a always,exit -F arch=b64 -S capset -F key=capability_change_ebpf

# Network-Related eBPF/XDP
## Monitor TC (Traffic Control) BPF operations
-a always,exit -F arch=b64 -S bpf -F a0=8 -F key=tc_bpf_attach

## Monitor socket-related BPF operations
-a always,exit -F arch=b64 -S bpf -F a0=8 -F key=socket_bpf_attach

## Monitor cgroup BPF operations
-a always,exit -F arch=b64 -S bpf -F a0=8 -F key=cgroup_bpf_attach

# Advanced eBPF Operations
## BPF_PROG_TEST_RUN = 10
-a always,exit -F arch=b64 -S bpf -F a0=10 -F key=ebpf_test_run

## BPF_PROG_GET_NEXT_ID = 11
-a always,exit -F arch=b64 -S bpf -F a0=11 -F key=ebpf_get_next_id

## BPF_MAP_GET_NEXT_ID = 12
-a always,exit -F arch=b64 -S bpf -F a0=12 -F key=ebpf_map_next_id

## BPF_PROG_GET_FD_BY_ID = 13
-a always,exit -F arch=b64 -S bpf -F a0=13 -F key=ebpf_prog_get_fd

## BPF_MAP_GET_FD_BY_ID = 14
-a always,exit -F arch=b64 -S bpf -F a0=14 -F key=ebpf_map_get_fd

## BPF_OBJ_GET_INFO_BY_FD = 15
-a always,exit -F arch=b64 -S bpf -F a0=15 -F key=ebpf_get_info

## BPF_PROG_QUERY = 16
-a always,exit -F arch=b64 -S bpf -F a0=16 -F key=ebpf_prog_query

## BPF_BTF_LOAD = 18
-a always,exit -F arch=b64 -S bpf -F a0=18 -F key=ebpf_btf_load

## BPF_MAP_FREEZE = 22
-a always,exit -F arch=b64 -S bpf -F a0=22 -F key=ebpf_map_freeze

## BPF_LINK_CREATE = 28
-a always,exit -F arch=b64 -S bpf -F a0=28 -F key=ebpf_link_create

## BPF_LINK_UPDATE = 29
-a always,exit -F arch=b64 -S bpf -F a0=29 -F key=ebpf_link_update

# Process and Memory Operations
## Monitor process operations that load eBPF
-a always,exit -F arch=b64 -S execve -F exe=/usr/bin/bpftool -F key=bpftool_exec
-a always,exit -F arch=b64 -S execve -F exe=/usr/sbin/tc -F key=tc_exec
-a always,exit -F arch=b64 -S execve -F exe=/usr/sbin/ip -F key=ip_exec

## Monitor memory operations for eBPF
-a always,exit -F arch=b64 -S mmap,mmap2 -F perm=x -F key=ebpf_mmap_exec
-a always,exit -F arch=b64 -S mprotect -F a2&0x4 -F key=ebpf_mprotect_exec

## Monitor perf event operations (often used with eBPF)
-a always,exit -F arch=b64 -S perf_event_open -F key=perf_event_ebpf

# Audit Rules for Udev Rules Monitoring (MITRE ATT&CK T1546.017)
# Monitor /etc/udev/rules.d/
## File creation and modification
-a always,exit -F arch=b32 -F dir=/etc/udev/rules.d/ -S open,openat,openat2 -F perm=wa -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/etc/udev/rules.d/ -S open,openat,openat2 -F perm=wa -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

## File writes
-a always,exit -F arch=b32 -F dir=/etc/udev/rules.d/ -S write,pwrite64,writev,pwritev,pwritev2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/etc/udev/rules.d/ -S write,pwrite64,writev,pwritev,pwritev2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

## File deletion
-a always,exit -F arch=b32 -F dir=/etc/udev/rules.d/ -S unlink,unlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/etc/udev/rules.d/ -S unlink,unlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

## File renaming/moving
-a always,exit -F arch=b32 -F dir=/etc/udev/rules.d/ -S rename,renameat,renameat2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/etc/udev/rules.d/ -S rename,renameat,renameat2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

## Permission and ownership changes
-a always,exit -F arch=b32 -F dir=/etc/udev/rules.d/ -S chmod,fchmod,fchmodat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/etc/udev/rules.d/ -S chmod,fchmod,fchmodat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b32 -F dir=/etc/udev/rules.d/ -S chown,fchown,lchown,fchownat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/etc/udev/rules.d/ -S chown,fchown,lchown,fchownat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

## Symbolic link creation
-a always,exit -F arch=b32 -F dir=/etc/udev/rules.d/ -S symlink,symlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/etc/udev/rules.d/ -S symlink,symlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

## Hard link creation
-a always,exit -F arch=b32 -F dir=/etc/udev/rules.d/ -S link,linkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/etc/udev/rules.d/ -S link,linkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

## Directory operations
-a always,exit -F arch=b32 -F dir=/etc/udev/rules.d/ -S mkdir,mkdirat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/etc/udev/rules.d/ -S mkdir,mkdirat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b32 -F dir=/etc/udev/rules.d/ -S rmdir -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/etc/udev/rules.d/ -S rmdir -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

## Monitor /run/udev/rules.d/
-a always,exit -F arch=b32 -F dir=/run/udev/rules.d/ -S open,openat,openat2 -F perm=wa -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/run/udev/rules.d/ -S open,openat,openat2 -F perm=wa -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/run/udev/rules.d/ -S write,pwrite64,writev,pwritev,pwritev2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/run/udev/rules.d/ -S write,pwrite64,writev,pwritev,pwritev2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/run/udev/rules.d/ -S unlink,unlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/run/udev/rules.d/ -S unlink,unlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/run/udev/rules.d/ -S rename,renameat,renameat2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/run/udev/rules.d/ -S rename,renameat,renameat2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/run/udev/rules.d/ -S chmod,fchmod,fchmodat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/run/udev/rules.d/ -S chmod,fchmod,fchmodat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/run/udev/rules.d/ -S chown,fchown,lchown,fchownat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/run/udev/rules.d/ -S chown,fchown,lchown,fchownat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/run/udev/rules.d/ -S symlink,symlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/run/udev/rules.d/ -S symlink,symlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/run/udev/rules.d/ -S link,linkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/run/udev/rules.d/ -S link,linkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/run/udev/rules.d/ -S mkdir,mkdirat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/run/udev/rules.d/ -S mkdir,mkdirat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/run/udev/rules.d/ -S rmdir -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/run/udev/rules.d/ -S rmdir -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

## Monitor /usr/lib/udev/rules.d/
-a always,exit -F arch=b32 -F dir=/usr/lib/udev/rules.d/ -S open,openat,openat2 -F perm=wa -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/lib/udev/rules.d/ -S open,openat,openat2 -F perm=wa -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/lib/udev/rules.d/ -S write,pwrite64,writev,pwritev,pwritev2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/lib/udev/rules.d/ -S write,pwrite64,writev,pwritev,pwritev2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/lib/udev/rules.d/ -S unlink,unlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/lib/udev/rules.d/ -S unlink,unlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/lib/udev/rules.d/ -S rename,renameat,renameat2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/lib/udev/rules.d/ -S rename,renameat,renameat2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/lib/udev/rules.d/ -S chmod,fchmod,fchmodat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/lib/udev/rules.d/ -S chmod,fchmod,fchmodat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/lib/udev/rules.d/ -S chown,fchown,lchown,fchownat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/lib/udev/rules.d/ -S chown,fchown,lchown,fchownat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/lib/udev/rules.d/ -S symlink,symlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/lib/udev/rules.d/ -S symlink,symlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/lib/udev/rules.d/ -S link,linkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/lib/udev/rules.d/ -S link,linkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/lib/udev/rules.d/ -S mkdir,mkdirat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/lib/udev/rules.d/ -S mkdir,mkdirat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/lib/udev/rules.d/ -S rmdir -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/lib/udev/rules.d/ -S rmdir -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

## Monitor /usr/local/lib/udev/rules.d/
-a always,exit -F arch=b32 -F dir=/usr/local/lib/udev/rules.d/ -S open,openat,openat2 -F perm=wa -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/local/lib/udev/rules.d/ -S open,openat,openat2 -F perm=wa -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/local/lib/udev/rules.d/ -S write,pwrite64,writev,pwritev,pwritev2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/local/lib/udev/rules.d/ -S write,pwrite64,writev,pwritev,pwritev2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/local/lib/udev/rules.d/ -S unlink,unlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/local/lib/udev/rules.d/ -S unlink,unlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/local/lib/udev/rules.d/ -S rename,renameat,renameat2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/local/lib/udev/rules.d/ -S rename,renameat,renameat2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/local/lib/udev/rules.d/ -S chmod,fchmod,fchmodat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/local/lib/udev/rules.d/ -S chmod,fchmod,fchmodat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/local/lib/udev/rules.d/ -S chown,fchown,lchown,fchownat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/local/lib/udev/rules.d/ -S chown,fchown,lchown,fchownat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/local/lib/udev/rules.d/ -S symlink,symlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/local/lib/udev/rules.d/ -S symlink,symlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/local/lib/udev/rules.d/ -S link,linkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/local/lib/udev/rules.d/ -S link,linkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/local/lib/udev/rules.d/ -S mkdir,mkdirat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/local/lib/udev/rules.d/ -S mkdir,mkdirat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/local/lib/udev/rules.d/ -S rmdir -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/local/lib/udev/rules.d/ -S rmdir -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

## Monitor /lib/udev/rules.d/
-a always,exit -F arch=b32 -F dir=/lib/udev/rules.d/ -S open,openat,openat2 -F perm=wa -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/lib/udev/rules.d/ -S open,openat,openat2 -F perm=wa -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/lib/udev/rules.d/ -S write,pwrite64,writev,pwritev,pwritev2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/lib/udev/rules.d/ -S write,pwrite64,writev,pwritev,pwritev2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/lib/udev/rules.d/ -S unlink,unlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/lib/udev/rules.d/ -S unlink,unlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/lib/udev/rules.d/ -S rename,renameat,renameat2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/lib/udev/rules.d/ -S rename,renameat,renameat2 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/lib/udev/rules.d/ -S chmod,fchmod,fchmodat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/lib/udev/rules.d/ -S chmod,fchmod,fchmodat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/lib/udev/rules.d/ -S chown,fchown,lchown,fchownat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/lib/udev/rules.d/ -S chown,fchown,lchown,fchownat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/lib/udev/rules.d/ -S symlink,symlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/lib/udev/rules.d/ -S symlink,symlinkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/lib/udev/rules.d/ -S link,linkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/lib/udev/rules.d/ -S link,linkat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/lib/udev/rules.d/ -S mkdir,mkdirat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/lib/udev/rules.d/ -S mkdir,mkdirat -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/lib/udev/rules.d/ -S rmdir -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/lib/udev/rules.d/ -S rmdir -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

## Monitor Udev Control Commands
### Monitor udevadm execution
-a always,exit -F arch=b32 -F path=/usr/bin/udevadm -S execve -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F path=/usr/bin/udevadm -S execve -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F path=/sbin/udevadm -S execve -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F path=/sbin/udevadm -S execve -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

### Monitor systemctl udev commands
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F path=/bin/systemctl -S execve -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F path=/bin/systemctl -S execve -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

## Enhanced Rules with User Tracking
### Track non-root users modifying udev rules (suspicious activity)
-a always,exit -F arch=b32 -F dir=/etc/udev/rules.d/ -S open,openat -F perm=wa -F "uid!=0" -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/etc/udev/rules.d/ -S open,openat -F perm=wa -F "uid!=0" -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/run/udev/rules.d/ -S open,openat -F perm=wa -F "uid!=0" -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/run/udev/rules.d/ -S open,openat -F perm=wa -F "uid!=0" -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/lib/udev/rules.d/ -S open,openat -F perm=wa -F "uid!=0" -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/lib/udev/rules.d/ -S open,openat -F perm=wa -F "uid!=0" -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/usr/local/lib/udev/rules.d/ -S open,openat -F perm=wa -F "uid!=0" -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/usr/local/lib/udev/rules.d/ -S open,openat -F perm=wa -F "uid!=0" -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

-a always,exit -F arch=b32 -F dir=/lib/udev/rules.d/ -S open,openat -F perm=wa -F "uid!=0" -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/lib/udev/rules.d/ -S open,openat -F perm=wa -F "uid!=0" -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

### Track privilege escalation attempts
-a always,exit -F arch=b32 -F dir=/etc/udev/rules.d/ -S open,openat -F perm=wa -F "uid!=0" -F euid=0 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules
-a always,exit -F arch=b64 -F dir=/etc/udev/rules.d/ -S open,openat -F perm=wa -F "uid!=0" -F euid=0 -F key=T1546.017_Event_Triggered_Execution_Udev_Rules

# ====================================================================================
# Auditd Ruleset to Detect TTPs of the North Korean LKM Rootkit
# Based on threat intelligence from Phrack Magazine, Issue #72
# https://sandflysecurity.com/blog/leaked-north-korean-linux-stealth-rootkit-analysis
#
# Syntax: All rules use the explicit '-a always,exit' syscall syntax for
#         maximum clarity, precision, and consistency.
# ====================================================================================
# to prevent duplicates we commented some rules out
# ------------------------------------------------------------------------------------
# Tactic: Kernel Module Loading & Hiding (LKM Activity)
# The rootkit is a Loadable Kernel Module based on 'khook'. We must monitor
# all attempts to insert modules into the kernel.
# ------------------------------------------------------------------------------------

# 1.1 Monitor the syscalls responsible for loading kernel modules.
-a always,exit -F arch=b32 -S init_module,finit_module,delete_module -F key=nk_rootkit_lkm_activity
-a always,exit -F arch=b64 -S init_module,finit_module,delete_module -F key=nk_rootkit_lkm_activity

# 1.2 Monitor the user-space tools used to load kernel modules.
# -a always,exit -F arch=b32 -F path=/sbin/insmod -S execve -F perm=x -F key=nk_rootkit_lkm_activity
# -a always,exit -F arch=b64 -F path=/sbin/insmod -S execve -F perm=x -F key=nk_rootkit_lkm_activity

# -a always,exit -F arch=b32 -F path=/sbin/modprobe -S execve -F perm=x -F key=nk_rootkit_lkm_activity
# -a always,exit -F arch=b64 -F path=/sbin/modprobe -S execve -F perm=x -F key=nk_rootkit_lkm_activity

# 1.3 Monitor log files for evidence of unsigned modules causing kernel "taint".
# -a always,exit -F arch=b32 -F dir=/var/log/ -S open,openat,truncate,ftruncate -F path=/var/log/kern.log -F perm=wa -F key=nk_rootkit_taint_log
# -a always,exit -F arch=b64 -F dir=/var/log/ -S open,openat,truncate,ftruncate -F path=/var/log/kern.log -F perm=wa -F key=nk_rootkit_taint_log

# -a always,exit -F arch=b32 -F dir=/var/log/ -S open,openat,truncate,ftruncate -F path=/var/log/dmesg -F perm=wa -F key=nk_rootkit_taint_log
# -a always,exit -F arch=b64 -F dir=/var/log/ -S open,openat,truncate,ftruncate -F path=/var/log/dmesg -F perm=wa -F key=nk_rootkit_taint_log

# -a always,exit -F arch=b32 -F dir=/var/log/ -S open,openat,truncate,ftruncate -F path=/var/log/syslog -F perm=wa -F key=nk_rootkit_taint_log
# -a always,exit -F arch=b64 -F dir=/var/log/ -S open,openat,truncate,ftruncate -F path=/var/log/syslog -F perm=wa -F key=nk_rootkit_taint_log


# ------------------------------------------------------------------------------
# Tactic: Persistence Mechanisms
# The rootkit drops hidden files in init.d and rc.d directories to survive
# reboots. It may also use systemd.
# ------------------------------------------------------------------------------

# 2.1 Monitor classic SysV init directories for any new or modified startup scripts.
# -a always,exit -F arch=b32 -F dir=/etc/init.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence
# -a always,exit -F arch=b64 -F dir=/etc/init.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence
# -a always,exit -F arch=b32 -F dir=/etc/init.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence
# -a always,exit -F arch=b64 -F dir=/etc/init.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence
-a always,exit -F arch=b32 -F dir=/etc/rc0.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence
-a always,exit -F arch=b64 -F dir=/etc/rc0.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence

-a always,exit -F arch=b32 -F dir=/etc/rc1.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence
-a always,exit -F arch=b64 -F dir=/etc/rc1.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence

-a always,exit -F arch=b32 -F dir=/etc/rc2.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence
-a always,exit -F arch=b64 -F dir=/etc/rc2.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence

-a always,exit -F arch=b32 -F dir=/etc/rc3.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence
-a always,exit -F arch=b64 -F dir=/etc/rc3.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence

-a always,exit -F arch=b32 -F dir=/etc/rc4.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence
-a always,exit -F arch=b64 -F dir=/etc/rc4.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence

-a always,exit -F arch=b32 -F dir=/etc/rc5.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence
-a always,exit -F arch=b64 -F dir=/etc/rc5.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence

-a always,exit -F arch=b32 -F dir=/etc/rc6.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence
-a always,exit -F arch=b64 -F dir=/etc/rc6.d/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence

# 2.2 Monitor systemd service directories for new or modified service units.
-a always,exit -F arch=b32 -F dir=/etc/systemd/system/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence
-a always,exit -F arch=b64 -F dir=/etc/systemd/system/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence

-a always,exit -F arch=b32 -F dir=/usr/lib/systemd/system/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence
-a always,exit -F arch=b64 -F dir=/usr/lib/systemd/system/ -S open,openat,truncate,ftruncate,creat,mkdir -F perm=wa -F key=nk_rootkit_persistence

# ------------------------------------------------------------------------------
# Tactic: Backdoor Activity & Network Communication
# The backdoor executes shells, proxies traffic, and communicates over sockets.
# ------------------------------------------------------------------------------

# 3.1 Monitor for outbound network connections, which could indicate C2 activity,
#     lateral movement, or proxying.
# -a always,exit -F arch=b32 -S connect -F key=nk_rootkit_network_connect
# -a always,exit -F arch=b64 -S connect -F key=nk_rootkit_network_connect

# 3.2 Monitor for the creation of sockets, especially in unusual locations.
# -a always,exit -F arch=b32 -S socket -F key=nk_rootkit_network_socket
# -a always,exit -F arch=b64 -S socket -F key=nk_rootkit_network_socket

# 3.3 Monitor for the execution of common shells, which could be spawned by the backdoor.
# -a always,exit -F arch=b32 -F path=/bin/sh -S execve -F perm=x -F key=nk_rootkit_shell_spawn
# -a always,exit -F arch=b64 -S execve -F path=/bin/sh -S execve -F perm=x -F key=nk_rootkit_shell_spawn

# -a always,exit -F arch=b32 -F path=/bin/bash -S execve -F perm=x -F key=nk_rootkit_shell_spawn
# -a always,exit -F arch=b64 -F path=/bin/bash -S execve -F perm=x -F key=nk_rootkit_shell_spawn

# -a always,exit -F arch=b32 -F path=/bin/dash -S execve -F perm=x -F key=nk_rootkit_shell_spawn
# -a always,exit -F arch=b64 -F path=/bin/dash -S execve -F perm=x -F key=nk_rootkit_shell_spawn

# ------------------------------------------------------------------------------
# Tactic: Anti-Forensics & Evasion
# The rootkit hides files and processes, and attempts to prevent command logging.
# ------------------------------------------------------------------------------

# 4.1 The backdoor sets history files to /dev/null. Monitor for any process
#     writing to or modifying common shell history files.
-a always,exit -F arch=b32 -F path=/root/.bash_history -S open,openat,truncate,ftruncate -F perm=wa -F key=nk_rootkit_antiforensics
-a always,exit -F arch=b64 -F path=/root/.bash_history -S open,openat,truncate,ftruncate -F perm=wa -F key=nk_rootkit_antiforensics

-a always,exit -F arch=b32 -F dir=/home/ -F path,regex=/\.bash_history$ -S open,openat,truncate,ftruncate -F perm=wa -F key=nk_rootkit_antiforensics
-a always,exit -F arch=b64 -F dir=/home/ -F path,regex=/\.bash_history$ -S open,openat,truncate,ftruncate -F perm=wa -F key=nk_rootkit_antiforensics

# ------------------------------------------------------------------------------
# High-Fidelity Indicators of Compromise (IOCs)
# These are the specific file paths mentioned in the Phrack article. An alert
# on these is a very strong signal of compromise by this specific variant.
# ------------------------------------------------------------------------------

# 5.1 Monitor the specific known locations for the LKM and backdoor binary.
-a always,exit -F arch=b32 -S all -F path=/usr/lib64/tracker-fs -F perm=warx -F key=nk_rootkit_ioc_file
-a always,exit -F arch=b64 -S all -F path=/usr/lib64/tracker-fs -F perm=warx -F key=nk_rootkit_ioc_file

-a always,exit -F arch=b32 -S all -F dir=/usr/include/tracker-fs/ -F perm=wa -F key=nk_rootkit_ioc_file
-a always,exit -F arch=b64 -S all -F dir=/usr/include/tracker-fs/ -F perm=wa -F key=nk_rootkit_ioc_file

-a always,exit -F arch=b64 -S all -F path=/usr/include/tracker-fs/tracker-efs -F perm=warx -F key=nk_rootkit_ioc_file
-a always,exit -F arch=b32 -S all -F path=/usr/include/tracker-fs/tracker-efs -F perm=warx -F key=nk_rootkit_ioc_file

# 5.2 Monitor the specific known persistence files.
-a always,exit -F arch=b32 -S all -F path=/etc/init.d/tracker-fs -F perm=warx -F key=nk_rootkit_ioc_file
-a always,exit -F arch=b64 -S all -F path=/etc/init.d/tracker-fs -F perm=warx -F key=nk_rootkit_ioc_file

-a always,exit -F arch=b32 -S all -F path=/etc/rc2.d/S55tracker-fs -F perm=warx -F key=nk_rootkit_ioc_file
-a always,exit -F arch=b64 -S all -F path=/etc/rc2.d/S55tracker-fs -F perm=warx -F key=nk_rootkit_ioc_file

-a always,exit -F arch=b32 -S all -F path=/etc/rc3.d/S55tracker-fs -F perm=warx -F key=nk_rootkit_ioc_file
-a always,exit -F arch=b64 -S all -F path=/etc/rc3.d/S55tracker-fs -F perm=warx -F key=nk_rootkit_ioc_file

-a always,exit -F arch=b64 -S all -F path=/etc/rc5.d/S55tracker-fs -F perm=warx -F key=nk_rootkit_ioc_file
-a always,exit -F arch=b32 -S all -F path=/etc/rc5.d/S55tracker-fs -F perm=warx -F key=nk_rootkit_ioc_file

# 5.3 Monitor the specific known communication socket path.
-a always,exit -F arch=b32 -S all -F path=/proc/acpi/pcicard -F perm=warx -F key=nk_rootkit_ioc_file
-a always,exit -F arch=b64 -S all -F path=/proc/acpi/pcicard -F perm=warx -F key=nk_rootkit_ioc_file

# ================================================================================
# Auditd Ruleset to Detect TTPs of the Medusa LD_PRELOAD Rootkit
#
# This ruleset targets the BEHAVIORS of LD_PRELOAD hijacking, focusing on
# persistence, library loading, and the use of static binaries for evasion.
# https://sandflysecurity.com/blog/linux-medusa-rootkit-detection-and-de-cloaking
# ================================================================================
# to prevent duplicates we commented some rules out
# --------------------------------------------------------------------------------
# Tactic: Hijack Execution Flow via LD_PRELOAD (Persistence & Execution)
# The rootkit's primary mechanism is abusing the LD_PRELOAD environment variable
# and the ld.so.preload file to force its malicious library to load first.
# --------------------------------------------------------------------------------

# 1.1 Monitor for any modifications to the system-wide library preload file.
#     This is the most common and powerful persistence method for this attack.
# -a always,exit -F arch=b32 -S open,openat,truncate,ftruncate -F path=/etc/ld.so.preload -F perm=wa -F key=medusa_ld_preload_file
# -a always,exit -F arch=b64 -S open,openat,truncate,ftruncate -F path=/etc/ld.so.preload -F perm=wa -F key=medusa_ld_preload_file

# 1.2 Monitor for modifications to the dynamic linker's configuration directories.
#     Attackers may place malicious .conf files here to alter library search paths.
# -a always,exit -F arch=b32 -S open,openat,truncate,ftruncate,creat,mkdir -F dir=/etc/ld.so.conf.d/ -F perm=wa -F key=medusa_ld_config
# -a always,exit -F arch=b64 -S open,openat,truncate,ftruncate,creat,mkdir -F dir=/etc/ld.so.conf.d/ -F perm=wa -F key=medusa_ld_config

# 1.3 Monitor for the execution of ldconfig, which is used to update the
#     dynamic linker cache. Attackers must run this to make their changes effective.
-a always,exit -F arch=b32 -S execve -F path=/bin/ldconfig -F perm=x -F key=medusa_ld_config_update
-a always,exit -F arch=b64 -S execve -F path=/bin/ldconfig -F perm=x -F key=medusa_ld_config_update

-a always,exit -F arch=b32 -S execve -F path=/sbin/ldconfig -F perm=x -F key=medusa_ld_config_update
-a always,exit -F arch=b64 -S execve -F path=/sbin/ldconfig -F perm=x -F key=medusa_ld_config_update

# ------------------------------------------------------------------------------
# Tactic: Evasion & Defense Evasion (Static Binaries)
# The article highlights that attackers and defenders both use static binaries
# (like busybox-static) to bypass the rootkit's library hijacking.
# Monitoring their execution is a high-value signal.
# ------------------------------------------------------------------------------

# 2.1 Monitor for the execution of statically linked busybox in common locations.
-a always,exit -F arch=b32 -S execve -F path=/bin/busybox.static -F perm=x -F key=medusa_static_binary_exec
-a always,exit -F arch=b64 -S execve -F path=/bin/busybox.static -F perm=x -F key=medusa_static_binary_exec

-a always,exit -F arch=b32 -S execve -F path=/sbin/busybox.static -F perm=x -F key=medusa_static_binary_exec
-a always,exit -F arch=b64 -S execve -F path=/sbin/busybox.static -F perm=x -F key=medusa_static_binary_exec

# 2.2 Broaden the rule to catch any execution of a standard busybox binary.
-a always,exit -F arch=b32 -S execve -F path=/bin/busybox -F perm=x -F key=medusa_static_binary_exec
-a always,exit -F arch=b64 -S execve -F path=/bin/busybox -F perm=x -F key=medusa_static_binary_exec

-a always,exit -F arch=b32 -S execve -F path=/sbin/busybox -F perm=x -F key=medusa_static_binary_exec
-a always,exit -F arch=b64 -S execve -F path=/sbin/busybox -F perm=x -F key=medusa_static_binary_exec

for conveniant to look for busybox
# -a always,exit -F arch=b32 -S execve -F path=/bin/busybox -F perm=x -F key=busybox
# -a always,exit -F arch=b64 -S execve -F path=/bin/busybox -F perm=x -F key=busybox

# -a always,exit -F arch=b32 -S execve -F path=/sbin/busybox -F perm=x -F key=busybox
# -a always,exit -F arch=b64 -S execve -F path=/sbin/busybox -F perm=x -F key=busybox

# ------------------------------------------------------------------------------
# Tactic: Hiding Artifacts (File & Directory Hiding)
# The rootkit drops its malicious shared library into a system directory.
# The article mentions `/lib/libseconf` as an example.
# ------------------------------------------------------------------------------

# 3.1 Monitor for any new files being created or modified within critical
#     system library directories. This is a noisy but powerful rule.
# -a always,exit -F arch=b32 -S open,openat,creat -F dir=/lib/ -F perm=wa -F key=medusa_lib_hijack
# -a always,exit -F arch=b64 -S open,openat,creat -F dir=/lib/ -F perm=wa -F key=medusa_lib_hijack

# -a always,exit -F arch=b32 -S open,openat,creat -F dir=/lib64/ -F perm=wa -F key=medusa_lib_hijack
# -a always,exit -F arch=b64 -S open,openat,creat -F dir=/lib64/ -F perm=wa -F key=medusa_lib_hijack

# -a always,exit -F arch=b32 -S open,openat,creat -F dir=/usr/lib/ -F perm=wa -F key=medusa_lib_hijack
# -a always,exit -F arch=b64 -S open,openat,creat -F dir=/usr/lib/ -F perm=wa -F key=medusa_lib_hijack

# -a always,exit -F arch=b32 -S open,openat,creat -F dir=/usr/local/lib/ -F perm=wa -F key=medusa_lib_hijack
# -a always,exit -F arch=b64 -S open,openat,creat -F dir=/usr/local/lib/ -F perm=wa -F key=medusa_lib_hijack

# 3.2 Specifically monitor the example IOC path mentioned in the article.
#     While fragile, a hit on this is a high-confidence indicator.
-a always,exit -F arch=b32 -S all -F dir=/lib/libseconf/ -F perm=warx -F key=medusa_ioc_file
-a always,exit -F arch=b64 -S all -F dir=/lib/libseconf/ -F perm=warx -F key=medusa_ioc_file


# ------------------------------------------------------------------------------
# Tactic: Anti-Forensics (Concealing High CPU Usage)
# The article mentions these rootkits can fake process data to hide things
# like cryptominers. This often involves hooking syscalls related to /proc.
# ------------------------------------------------------------------------------

# 4.1 Monitor for the ptrace syscall, which is used to inspect and manipulate
#     another process's memory and is a key component of process hiding.
# -a always,exit -F arch=b32 -S ptrace -F key=medusa_process_hiding
# -a always,exit -F arch=b64 -S ptrace -F key=medusa_process_hiding

# ==============================================================================
# Auditd Ruleset to Detect TTPs of SCTP-based Backdoors (e.g., Medusa)
#
# Based on threat intelligence regarding the abuse of the SCTP protocol on Linux.
#
# This ruleset targets the core behaviors of SCTP abuse: socket creation,
# use of specific tools, reconnaissance, and configuration manipulation.
# ==============================================================================
# to prevent duplicates we commented some rules out
# ------------------------------------------------------------------------------
# Tactic: Command and Control via Non-Standard Protocol (SCTP)
# The primary TTP is the creation and use of SCTP sockets for communication.
# Monitoring the socket() syscall for the SCTP protocol number (132) is the
# most direct and reliable method of detection.
# ------------------------------------------------------------------------------

# 1.1 Monitor for any process creating an SCTP socket. This is a high-fidelity
#     indicator on non-telecom systems.
-a always,exit -F arch=b32 -S socket -F a2=132 -F key=sctp_socket_activity
-a always,exit -F arch=b64 -S socket -F a2=132 -F key=sctp_socket_activity


# ------------------------------------------------------------------------------
# Tactic: Execution of Known Hijacking/Pivoting Tools
# The article explicitly mentions 'socat' as a tool used to create the SCTP
# listener and execute commands. Monitoring its execution is critical.
# ------------------------------------------------------------------------------

# 2.1 Monitor for the execution of the 'socat' binary, which can be used to
#     create SCTP and other types of backdoors.
# -a always,exit -F arch=b32 -S execve -F path=/usr/bin/socat -F perm=x -F key=sctp_socat_execution
# -a always,exit -F arch=b64 -S execve -F path=/usr/bin/socat -F perm=x -F key=sctp_socat_execution


# ------------------------------------------------------------------------------
# Tactic: System Reconnaissance & Discovery
# An attacker or investigator will need to use specific commands and inspect
# /proc files to understand the SCTP state of a system.
# ------------------------------------------------------------------------------

# 3.1 Monitor for the execution of commands used to view network and module status.
# -a always,exit -F arch=b32 -S execve -F path=/usr/bin/ss -F perm=x -F key=sctp_recon
# -a always,exit -F arch=b64 -S execve -F path=/usr/bin/ss -F perm=x -F key=sctp_recon

# -a always,exit -F arch=b32 -S execve -F path=/usr/sbin/ss -F perm=x -F key=sctp_recon
# -a always,exit -F arch=b64 -S execve -F path=/usr/sbin/ss -F perm=x -F key=sctp_recon

# -a always,exit -F arch=b32 -S execve -F path=/usr/bin/netstat -F perm=x -F key=sctp_recon
# -a always,exit -F arch=b64 -S execve -F path=/usr/bin/netstat -F perm=x -F key=sctp_recon

# -a always,exit -F arch=b32 -S execve -F path=/usr/sbin/netstat -F perm=x -F key=sctp_recon
# -a always,exit -F arch=b64 -S execve -F path=/usr/sbin/netstat -F perm=x -F key=sctp_recon

# -a always,exit -F arch=b32 -S execve -F path=/usr/bin/lsmod -F perm=x -F key=sctp_recon
# -a always,exit -F arch=b64 -S execve -F path=/usr/bin/lsmod -F perm=x -F key=sctp_recon

# -a always,exit -F arch=b32 -S execve -F path=/usr/sbin/lsmod -F perm=x -F key=sctp_recon
# -a always,exit -F arch=b64 -S execve -F path=/usr/sbin/lsmod -F perm=x -F key=sctp_recon

# 3.2 Monitor for read access to the specific /proc files that reveal SCTP status.
-a always,exit -F arch=b32 -S open,openat -F path=/proc/net/protocols -F perm=r -F key=sctp_recon_proc
-a always,exit -F arch=b64 -S open,openat -F path=/proc/net/protocols -F perm=r -F key=sctp_recon_proc

-a always,exit -F arch=b32 -S open,openat -F path=/proc/net/sctp/eps -F perm=r -F key=sctp_recon_proc
-a always,exit -F arch=b64 -S open,openat -F path=/proc/net/sctp/eps -F perm=r -F key=sctp_recon_proc

# ------------------------------------------------------------------------------
# Tactic: Defense Evasion via Module Configuration
# The article mentions blacklisting the SCTP module as a defense. An attacker
# might try to modify or remove these blacklisting files to ensure the module loads.
# ------------------------------------------------------------------------------

# 4.1 Monitor for any write or attribute changes within the modprobe.d directory,
#     which could indicate tampering with module blacklists.
-a always,exit -F arch=b32 -F dir=/etc/modprobe.d/ -S open,openat,truncate,ftruncate,creat,mkdir,chmod,chown -F perm=wa -F key=sctp_modprobe_config
-a always,exit -F arch=b64 -F dir=/etc/modprobe.d/ -S open,openat,truncate,ftruncate,creat,mkdir,chmod,chown -F perm=wa -F key=sctp_modprobe_config

# Monitor SCTP (Stream Control Transmission Protocol) traffic
# https://en.wikipedia.org/wiki/Stream_Control_Transmission_Protocol
# QUIET - Rarely triggered
-a always,exit -F arch=b32 -S socket -F a2=132 -F key=sctp_traffic
-a always,exit -F arch=b64 -S socket -F a2=132 -F key=sctp_traffic

# ==============================================================================
# Monitor DCCP (Datagram Congestion Control Protocol) traffic
# DCCP is a less common transport layer protocol. Its use on a server that
# doesn't explicitly require it can be a sign of a covert communication
# channel attempting to evade firewalls or monitoring focused on TCP/UDP.
# ==============================================================================
## https://en.wikipedia.org/wiki/Datagram_Congestion_Control_Protocol
# QUIET - Rarely triggered
-a always,exit -F arch=b32 -S socket -F a2=33 -F key=dccp_traffic
-a always,exit -F arch=b64 -S socket -F a2=33 -F key=dccp_traffic

# ==============================================================================
# Monitor UDPLite (Lightweight User Datagram Protocol) traffic
# UDPLite is a variant of UDP that allows for partially damaged payloads,
# which is useful for some streaming media but highly unusual in most
# enterprise environments. Monitoring for it can detect non-standard or
# evasive C2 (Command and Control) channels.
# ==============================================================================
## https://en.wikipedia.org/wiki/UDP-Lite
# QUIET - Rarely triggered
-a always,exit -F arch=b32 -S socket -F a2=136 -F key=udplite_traffic
-a always,exit -F arch=b64 -S socket -F a2=136 -F key=udplite_traffic

# AppleTalk (legacy protocol, rarely used today)
## https://en.wikipedia.org/wiki/AppleTalk
## Usually Family: AF_APPLETALK = 16 (deprecated)
-a always,exit -F arch=b32 -S socket -F a2=16 -F key=appletalk_traffic
-a always,exit -F arch=b64 -S socket -F a2=16 -F key=appletalk_traffic

# Netlink
## https://en.wikipedia.org/wiki/Netlink
-a always,exit -F arch=b32 -S socket -F a2=16 -F key=netlink_traffic
-a always,exit -F arch=b64 -S socket -F a2=16 -F key=netlink_traffic

# RSVP (Resource Reservation Protocol)
## https://en.wikipedia.org/wiki/Resource_Reservation_Protocol
## Auditing RSVP traffic Unfortunately, the auditd kernel module doesn't natively
## support RSVP protocol filtering. RSVP is a control protocol that uses
## IP protocol number 46, but auditd doesn't provide a specific filter for it.
##
## Workaround using IP protocol number One possible workaround is to use the
## proto filter with the IP protocol number 46, which corresponds to RSVP:
##
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=3 -F key=rsvp_traffic
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=3 -F key=rsvp_traffic

# IPsec
## https://en.wikipedia.org/wiki/IPsec
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=2 -F key=ipsec_traffic
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=2 -F key=ipsec_traffic

## ESP (Protocol 50) - IPsec Encapsulating Security Payload
## MODERATE - Occasional legitimate use
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=3 -F a2=50 -F key=ipsec_esp
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=3 -F a2=50 -F key=ipsec_esp

## AH (Protocol 51) - IPsec Authentication Header
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=3 -F a2=51 -F key=ipsec_ah
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=3 -F a2=51 -F key=ipsec_ah

# ICMP (Protocol 1) - Internet Control Message Protocol noisy
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=3 -F a2=1 -F key=icmp_raw
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=3 -F a2=1 -F key=icmp_raw

# IGMP (Protocol 2) - Internet Group Management Protocol
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=3 -F a2=2 -F key=igmp
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=3 -F a2=2 -F key=igmp

# GRE (Protocol 47) - Generic Routing Encapsulation
# MODERATE - Occasional legitimate use
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=3 -F a2=47 -F key=gre_tunnel
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=3 -F a2=47 -F key=gre_tunnel

# OSPF (Protocol 89) - Open Shortest Path First
# MODERATE - Occasional legitimate use
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=3 -F a2=89 -F key=ospf_routing
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=3 -F a2=89 -F key=ospf_routing

# PIM (Protocol 103) - Protocol Independent Multicast
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=3 -F a2=103 -F key=pim_multicast
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=3 -F a2=103 -F key=pim_multicast

# VRRP (Protocol 112) - Virtual Router Redundancy Protocol
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=3 -F a2=112 -F key=vrrp
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=3 -F a2=112 -F key=vrrp

# L2TP (Protocol 115) - Layer 2 Tunneling Protocol
-a always,exit -F arch=b32 -S socket -F a0=2 -F a1=3 -F a2=115 -F key=l2tp_tunnel
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=3 -F a2=115 -F key=l2tp_tunnel

# Monitor all raw socket creation (catches many unusual protocols)
# NOISY - Frequent legitimate use
#-a always,exit -F arch=b32 -S socket -F a1=3 -F key=raw_sockets
#-a always,exit -F arch=b64 -S socket -F a1=3 -F key=raw_sockets

# Monitor packet socket creation (used for packet capture)
# NOISY - Frequent legitimate use
#-a always,exit -F arch=b32 -S socket -F a0=17 -F key=packet_sockets
#-a always,exit -F arch=b64 -S socket -F a0=17 -F key=packet_sockets

# ============================================================================
# PRODUCTION-READY COMBINED MONITORING
# Balances security detection with performance
# ============================================================================

# 1. Catch any non-root raw socket creation (medium priority alert)
-a always,exit -F arch=b32 -S socket -F a1=3 -F "uid!=0" -F success=1 -F key=non_root_raw
-a always,exit -F arch=b64 -S socket -F a1=3 -F "uid!=0" -F success=1 -F key=non_root_raw

# 2. High-priority monitoring for service accounts that should NEVER use raw sockets
-a always,exit -F arch=b32 -S socket -F a1=3 -F uid=33 -F key=CRITICAL_webserver_raw
-a always,exit -F arch=b64 -S socket -F a1=3 -F uid=33 -F key=CRITICAL_webserver_raw

-a always,exit -F arch=b32 -S socket -F a1=3 -F uid=27 -F key=CRITICAL_database_raw
-a always,exit -F arch=b64 -S socket -F a1=3 -F uid=27 -F key=CRITICAL_database_raw

# 3. Monitor packet socket creation by any non-root user (possible sniffer)
-a always,exit -F arch=b32 -S socket -F a0=17 -F "uid!=0" -F key=ALERT_packet_sniffer
-a always,exit -F arch=b64 -S socket -F a0=17 -F "uid!=0" -F key=ALERT_packet_sniffer

# 4. Detect unusual tunneling protocols by regular users
-a always,exit -F arch=b32 -S socket -F "uid>=500" -F a0=2 -F a1=3 -F a2=47 -F key=user_gre_tunnel
-a always,exit -F arch=b64 -S socket -F "uid>=500" -F a0=2 -F a1=3 -F a2=47 -F key=user_gre_tunnel

-a always,exit -F arch=b32 -S socket -F "uid>=500" -F a0=2 -F a1=3 -F a2=4 -F key=user_ipip_tunnel
-a always,exit -F arch=b64 -S socket -F "uid>=500" -F a0=2 -F a1=3 -F a2=4 -F key=user_ipip_tunnel

## C2 Releated Events
# Log 64 bit processes (a2!=6e filters local unix socket calls)

-a always,exit -F arch=b64 -S connect -F "a2!=110" -F key=T1043_Commonly_Used_Port

# Log 32 bit processes (a0=3 means only outbound sys_connect calls)

-a always,exit -F arch=b32 -S socketcall -F a0=3 -F key=T1043_Commonly_Used_Port

##| --------------------------------------------------------------------------------
##| MISC OS:
##|
##| init_module - Initialize a loadable module entry
##|		-EPERM The user must have administrator module modification capabilities.
##| delete_module - Delete a loadable module
##|		-EPERM The user must have administrator module modification capabilities.
##| pivot_root - change the root file system
##| 	-EPERM The calling process does not have the CAP_SYS_ADMIN capability.
##| mount: -EACCES A component of a dir was not searchable;
##| mknod: -EPERM mode requested creation of something other than a regular file, FIFO (named pipe), or Unix domain socket
##|
##| --------------------------------------------------------------------------------
-a always,exit -F arch=b32 -S init_module -S delete_module -S mount -S pivot_root -S chroot -S mknod -F exit=-EPERM -F key=SYS_OS_ERR
-a always,exit -F arch=b64 -S init_module -S delete_module -S mount -S pivot_root -S chroot -S mknod -F exit=-EPERM -F key=SYS_OS_ERR

-a always,exit -F arch=b32 -S init_module -S delete_module -S mount -S pivot_root -S chroot -S mknod -F key=SYS_OS
-a always,exit -F arch=b64 -S init_module -S delete_module -S mount -S pivot_root -S chroot -S mknod -F key=SYS_OS

# socketcall system call
# The socketcall system call is a multiplexed system call. Multiplexed means
# that there is only one system call for all possible calls and that libc
# passes the actual system call to use as the first argument (a0). Check the
# manual page of socketcall for possible system calls and refer to
# /usr/src/linux/include/linux/net.h for a list of possible argument values
# and system call names. Audit supports filtering for specific system calls
# using a -F a0=SYSCALL_NUMBER.

## Audit the socket(PF_INET6) system call. The -F a0=1 filter matches all
## socket system calls and the -F a1=10 filter narrows the matches down to
## socket system calls carrying the IPv6 protocol family domain parameter
## (PF_INET6). Check /usr/include/linux/net.h for the first argument (a0) and
## /usr/src/linux/include/linux/socket.h for the second parameter (a1).
## 64-bit platforms, like AMD64/Intel 64, do not use multiplexing on
## socketcall system calls. For these platforms, comment the rule and add the
## plain system call rules with a filter on PF_INET6.

# -a always,exit -S socketcall -F a0=1 -F a1=10 -F key=T1043_Commonly_Used_Port
## Use this line on x86_64, ia64 instead
# -a always,exit -S socket -F a0=10 -F key=T1043_Commonly_Used_Port

## Audit the socketcall system call. The filter flag is set to filter for
## a0=5 as the first argument to socketcall, which translates to the accept
## system call if you check /usr/include/linux/net.h. 64-bit platforms,
## like AMD64/Intel 64, do not use multiplexing on socketcall system calls.
## For these platforms, comment the rule and add the plain system call rule
## without argument filtering.

# -a always,exit -S socketcall -F a0=5 -F key=T1043_Commonly_Used_Port
## Use this line on x86_64, ia64 instead
# -a always,exit -S accept -F key=T1043_Commonly_Used_Port

# ipc system call
# /usr/include/linux/ipc.h
# The ipc system call is another example of multiplexed system calls. The
# actual call to invoke is determined by the first argument passed to the
# ipc system call. Filtering for these arguments helps you focus on those
# IPC calls of interest to you. Check /usr/include/linux/ipc.h for
# possible argument values.

## Audit system calls related to IPC SYSV message queues. In this case,
## the a0 values specify that auditing is added for the msgctl and
## msgget system calls (14 and 13). 64-bit platforms, like AMD64/Intel 64,
## do not use multiplexing on ipc system calls. For these platforms,
## comment the first two rules and add the plain system call rules
## without argument filtering.

## msgctl
# -a always,exit -S ipc -F a0=14 -F key=T1559_Inter-Process_Communication
## msgget
# -a always,exit -S ipc -F a0=13 -F key=T1559_Inter-Process_Communication
## Use these lines on x86_64, ia64 instead
-a always,exit -F arch=b32 -S msgctl -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S msgctl -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -S msgget -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S msgget -F key=T1559_Inter-Process_Communication

## Audit system calls related to IPC SYSV message semaphores. In this case,
## the a0 values specify that auditing is added for the
## semctl, semget, semop, and semtimedop system calls (3, 2, 1, and 4).
## 64-bit platforms, like AMD64/Intel 64, do not use multiplexing on
## ipc system calls. For these platforms, comment the first four rules and
## add the plain system call rules without argument filtering.

## semctl
# -a always,exit -S ipc -F a0=3 -F key=T1559_Inter-Process_Communication
## semget
# -a always,exit -S ipc -F a0=2 -F key=T1559_Inter-Process_Communication
## semop
# -a always,exit -S ipc -F a0=1 -F key=T1559_Inter-Process_Communication
## semtimedop
# -a always,exit -S ipc -F a0=4 -F key=T1559_Inter-Process_Communication
## Use these lines on x86_64, ia64 instead
-a always,exit -F arch=b32 -S semctl -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S semctl -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -S semget -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S semget -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -S semop -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S semop -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -S semtimedop -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S semtimedop -F key=T1559_Inter-Process_Communication

## Audit system calls related to IPC SYSV shared memory. In this case, the
## a0 values specify that auditing is added for the shmctl and shmget
## system calls (24, 23). 64-bit platforms, like AMD64/Intel 64, do not use
## multiplexing on ipc system calls. For these platforms, comment the first
## two rules and add the plain system call rules without argument filtering.

## shmctl
# -a always,exit -S ipc -F a0=24 -F key=T1559_Inter-Process_Communication
## shmget
# -a always,exit -S ipc -F a0=23 -F key=T1559_Inter-Process_Communication
## Use these lines on x86_64, ia64 instead
-a always,exit -F arch=b32 -S shmctl -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmctl -F key=T1559_Inter-Process_Communication

-a always,exit -F arch=b32 -S shmget -F key=T1559_Inter-Process_Communication
-a always,exit -F arch=b64 -S shmget -F key=T1559_Inter-Process_Communication

# dirtypipe
## CVE-2022-084
## https://dirtypipe.cm4all.com

-a always,exit -F arch=b32 -S splice -F a0=0x3 -F a2=0x5 -F a3=0x0 -F key=dirtypipe_CVE-2022-084
-a always,exit -F arch=b64 -S splice -F a0=0x3 -F a2=0x5 -F a3=0x0 -F key=dirtypipe_CVE-2022-084

## System policy rules
### This is an example set of rules that point to chrome/chromium and firefox's policy files.
### It logs every instance a process attempts to write to the directories/files, or modify their attributes.
### To enable them, uncomment the lines of the policy files you have on your system.

### chrome/chromium
-a always,exit -F arch=b32 -F dir=/etc/opt/chrome/ -F perm=wa -F key=chrome-policy
-a always,exit -F arch=b64 -F dir=/etc/opt/chrome/ -F perm=wa -F key=chrome-policy

-a always,exit -F arch=b32 -F dir=/etc/chromium/ -F perm=wa -F key=chrome-policy
-a always,exit -F arch=b64 -F dir=/etc/chromium/ -F perm=wa -F key=chrome-policy

-a always,exit -F arch=b32 -F dir=/etc/chromium-browser/ -F perm=wa -F key=chrome-policy
-a always,exit -F arch=b64 -F dir=/etc/chromium-browser/ -F perm=wa -F key=chrome-policy

### firefox
-a always,exit -F arch=b32 -F path=/usr/lib64/firefox/distribution/policies.json -F perm=wa -F key=firefox-policy
-a always,exit -F arch=b64 -F path=/usr/lib64/firefox/distribution/policies.json -F perm=wa -F key=firefox-policy

-a always,exit -F arch=b32 -F path=/usr/lib64/firefox/defaults/pref/autoconfig.js -F perm=wa -F key=firefox-policy
-a always,exit -F arch=b64 -F path=/usr/lib64/firefox/defaults/pref/autoconfig.js -F perm=wa -F key=firefox-policy

-a always,exit -F arch=b32 -F path=/usr/lib64/firefox/firefox.cfg -F perm=wa -F key=firefox-policy
-a always,exit -F arch=b64 -F path=/usr/lib64/firefox/firefox.cfg -F perm=wa -F key=firefox-policy

-a always,exit -F arch=b32 -F path=/usr/lib/firefox/distribution/policies.json -F perm=wa -F key=firefox-policy
-a always,exit -F arch=b64 -F path=/usr/lib/firefox/distribution/policies.json -F perm=wa -F key=firefox-policy

-a always,exit -F arch=b32 -F path=/usr/lib/firefox/defaults/pref/autoconfig.js -F perm=wa -F key=firefox-policy
-a always,exit -F arch=b64 -F path=/usr/lib/firefox/defaults/pref/autoconfig.js -F perm=wa -F key=firefox-policy

-a always,exit -F arch=b32 -F path=/usr/lib/firefox/firefox.cfg -F perm=wa -F key=firefox-policy
-a always,exit -F arch=b64 -F path=/usr/lib/firefox/firefox.cfg -F perm=wa -F key=firefox-policy

-a always,exit -F arch=b32 -F path=/usr/lib/firefox-esr/distribution/policies.json -F perm=wa -F key=firefox-policy
-a always,exit -F arch=b64 -F path=/usr/lib/firefox-esr/distribution/policies.json -F perm=wa -F key=firefox-policy

-a always,exit -F arch=b32 -F path=/usr/lib/firefox-esr/defaults/pref/autoconfig.js -F perm=wa -F key=firefox-policy
-a always,exit -F arch=b64 -F path=/usr/lib/firefox-esr/defaults/pref/autoconfig.js -F perm=wa -F key=firefox-policy

-a always,exit -F arch=b32 -F path=/usr/lib/firefox-esr/firefox-esr.cfg -F perm=wa -F key=firefox-policy
-a always,exit -F arch=b64 -F path=/usr/lib/firefox-esr/firefox-esr.cfg -F perm=wa -F key=firefox-policy

## Auditd Rules for Service Creation, Modification, and Deletion Detection
## Using syscall-based rules only (no -w watch rules)
## Place these rules in /etc/audit/rules.d/services.rules or append to /etc/audit/audit.rules
#
## Monitor systemd service directories for any changes
## These monitor system calls for file operations in service directories

# Monitor file creation and opening in systemd directories
-a always,exit -F arch=b32 -F dir=/etc/systemd/system/ -S open,openat,creat -F perm=wa -F key=service_changes
-a always,exit -F arch=b64 -F dir=/etc/systemd/system/ -S open,openat,creat -F perm=wa -F key=service_changes

-a always,exit -F arch=b32 -F dir=/usr/lib/systemd/system/ -S open,openat,creat -F perm=wa -F key=service_changes
-a always,exit -F arch=b64 -F dir=/usr/lib/systemd/system/ -S open,openat,creat -F perm=wa -F key=service_changes

-a always,exit -F arch=b32 -F dir=/lib/systemd/system/ -S open,openat,creat -F perm=wa -F key=service_changes
-a always,exit -F arch=b64 -F dir=/lib/systemd/system/ -S open,openat,creat -F perm=wa -F key=service_changes

# Monitor file deletion and renaming in systemd directories
-a always,exit -F arch=b32 -F dir=/etc/systemd/system/ -S unlink,unlinkat,rename,renameat -F key=service_deletion
-a always,exit -F arch=b64 -F dir=/etc/systemd/system/ -S unlink,unlinkat,rename,renameat,renameat2 -F key=service_deletion

-a always,exit -F arch=b32 -F dir=/usr/lib/systemd/system/ -S unlink,unlinkat,rename,renameat -F key=service_deletion
-a always,exit -F arch=b64 -F dir=/usr/lib/systemd/system/ -S unlink,unlinkat,rename,renameat,renameat2 -F key=service_deletion

-a always,exit -F arch=b32 -F dir=/lib/systemd/system/ -S unlink,unlinkat,rename,renameat -F key=service_deletion
-a always,exit -F arch=b64 -F dir=/lib/systemd/system/ -S unlink,unlinkat,rename,renameat,renameat2 -F key=service_deletion

# Monitor attribute changes in systemd directories
-a always,exit -F arch=b32 -F dir=/etc/systemd/system/ -S chmod,fchmod,fchmodat -F key=service_attr_changes
-a always,exit -F arch=b64 -F dir=/etc/systemd/system/ -S chmod,fchmod,fchmodat -F key=service_attr_changes

-a always,exit -F arch=b32 -F dir=/etc/systemd/system/ -S chown,fchown,fchownat,lchown -F key=service_attr_changes
-a always,exit -F arch=b64 -F dir=/etc/systemd/system/ -S chown,fchown,fchownat,lchown -F key=service_attr_changes

-a always,exit -F arch=b32 -F dir=/etc/systemd/system/ -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F key=service_attr_changes
-a always,exit -F arch=b64 -F dir=/etc/systemd/system/ -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F key=service_attr_changes

# Monitor symbolic link operations (for enabled/disabled services)
-a always,exit -F arch=b32 -F dir=/etc/systemd/system/ -S symlink,symlinkat -F key=service_symlink_creation
-a always,exit -F arch=b64 -F dir=/etc/systemd/system/ -S symlink,symlinkat -F key=service_symlink_creation

# Monitor directory operations in systemd
-a always,exit -F arch=b32 -F dir=/etc/systemd/system/ -S mkdir,mkdirat,rmdir -F key=service_dir_changes
-a always,exit -F arch=b64 -F dir=/etc/systemd/system/ -S mkdir,mkdirat,rmdir -F key=service_dir_changes

# Monitor systemd runtime and state directories
-a always,exit -F arch=b32 -F dir=/run/systemd/system/ -S open,openat,creat,unlink,unlinkat,rename,renameat -F perm=wa -F key=service_runtime_changes
-a always,exit -F arch=b64 -F dir=/run/systemd/system/ -S open,openat,creat,unlink,unlinkat,rename,renameat,renameat2 -F perm=wa -F key=service_runtime_changes

-a always,exit -F arch=b32 -F dir=/run/systemd/generator/ -S open,openat,creat,unlink,unlinkat,rename,renameat -F perm=wa -F key=service_generator_changes
-a always,exit -F arch=b64 -F dir=/run/systemd/generator/ -S open,openat,creat,unlink,unlinkat,rename,renameat,renameat2 -F perm=wa -F key=service_generator_changes

-a always,exit -F arch=b32 -F dir=/run/systemd/generator.early/ -S open,openat,creat,unlink,unlinkat,rename,renameat -F perm=wa -F key=service_generator_changes
-a always,exit -F arch=b64 -F dir=/run/systemd/generator.early/ -S open,openat,creat,unlink,unlinkat,rename,renameat,renameat2 -F perm=wa -F key=service_generator_changes

-a always,exit -F arch=b32 -F dir=/run/systemd/generator.late/ -S open,openat,creat,unlink,unlinkat,rename,renameat -F perm=wa -F key=service_generator_changes
-a always,exit -F arch=b64 -F dir=/run/systemd/generator.late/ -S open,openat,creat,unlink,unlinkat,rename,renameat,renameat2 -F perm=wa -F key=service_generator_changes

# Monitor SysV init scripts
-a always,exit -F arch=b32 -F dir=/etc/init.d/ -S open,openat,creat -F perm=wa -F key=sysv_service_changes
-a always,exit -F arch=b64 -F dir=/etc/init.d/ -S open,openat,creat -F perm=wa -F key=sysv_service_changes

-a always,exit -F arch=b32 -F dir=/etc/init.d/ -S unlink,unlinkat,rename,renameat -F key=sysv_service_deletion
-a always,exit -F arch=b64 -F dir=/etc/init.d/ -S unlink,unlinkat,rename,renameat,renameat2 -F key=sysv_service_deletion

-a always,exit -F arch=b32 -F dir=/etc/init.d/ -S chmod,fchmod,fchmodat -F key=sysv_service_attr_changes
-a always,exit -F arch=b64 -F dir=/etc/init.d/ -S chmod,fchmod,fchmodat -F key=sysv_service_attr_changes

# Monitor rc.d init scripts (RHEL/CentOS)
-a always,exit -F arch=b32 -F dir=/etc/rc.d/init.d/ -S open,openat,creat,unlink,unlinkat,rename,renameat -F perm=wa -F key=sysv_service_changes
-a always,exit -F arch=b64 -F dir=/etc/rc.d/init.d/ -S open,openat,creat,unlink,unlinkat,rename,renameat,renameat2 -F perm=wa -F key=sysv_service_changes

# Monitor Upstart configurations
-a always,exit -F arch=b32 -F dir=/etc/init/ -S open,openat,creat,unlink,unlinkat,rename,renameat -F perm=wa -F key=upstart_service_changes
-a always,exit -F arch=b64 -F dir=/etc/init/ -S open,openat,creat,unlink,unlinkat,rename,renameat,renameat2 -F perm=wa -F key=upstart_service_changes

# Monitor service configuration directories
-a always,exit -F arch=b32 -F dir=/etc/default/ -S open,openat,creat,unlink,unlinkat,rename,renameat -F perm=wa -F key=service_defaults
-a always,exit -F arch=b64 -F dir=/etc/default/ -S open,openat,creat,unlink,unlinkat,rename,renameat,renameat2 -F perm=wa -F key=service_defaults

-a always,exit -F arch=b32 -F dir=/etc/sysconfig/ -S open,openat,creat,unlink,unlinkat,rename,renameat -F perm=wa -F key=service_sysconfig
-a always,exit -F arch=b64 -F dir=/etc/sysconfig/ -S open,openat,creat,unlink,unlinkat,rename,renameat,renameat2 -F perm=wa -F key=service_sysconfig

# Monitor systemd preset directories
-a always,exit -F arch=b32 -F dir=/etc/systemd/system-preset/ -S open,openat,creat,unlink,unlinkat,rename,renameat -F perm=wa -F key=systemd_preset_changes
-a always,exit -F arch=b64 -F dir=/etc/systemd/system-preset/ -S open,openat,creat,unlink,unlinkat,rename,renameat,renameat2 -F perm=wa -F key=systemd_preset_changes

-a always,exit -F arch=b32 -F dir=/usr/lib/systemd/system-preset/ -S open,openat,creat,unlink,unlinkat,rename,renameat -F perm=wa -F key=systemd_preset_changes
-a always,exit -F arch=b64 -F dir=/usr/lib/systemd/system-preset/ -S open,openat,creat,unlink,unlinkat,rename,renameat,renameat2 -F perm=wa -F key=systemd_preset_changes

# Monitor systemctl command execution
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F key=systemctl_execution
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F key=systemctl_execution

-a always,exit -F arch=b32 -F path=/bin/systemctl -S execve -F key=systemctl_execution
-a always,exit -F arch=b64 -F path=/bin/systemctl -S execve -F key=systemctl_execution

# Monitor systemd daemon-reload
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=daemon-reload -F key=systemd_reload
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=daemon-reload -F key=systemd_reload

-a always,exit -F arch=b32 -F path=/bin/systemctl -S execve -F a1=daemon-reload -F key=systemd_reload
-a always,exit -F arch=b64 -F path=/bin/systemctl -S execve -F a1=daemon-reload -F key=systemd_reload

# Monitor systemd enable/disable operations
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=enable -F key=service_enable
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=enable -F key=service_enable

-a always,exit -F arch=b32 -F path=/bin/systemctl -S execve -F a1=enable -F key=service_enable
-a always,exit -F arch=b64 -F path=/bin/systemctl -S execve -F a1=enable -F key=service_enable

# Monitor systemd disable operations
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=disable -F key=service_disable
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=disable -F key=service_disable

-a always,exit -F arch=b32 -F path=/bin/systemctl -S execve -F a1=disable -F key=service_disable
-a always,exit -F arch=b64 -F path=/bin/systemctl -S execve -F a1=disable -F key=service_disable

# Monitor systemd mask/unmask operations
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=mask -F key=service_mask
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=mask -F key=service_mask

-a always,exit -F arch=b32 -F path=/bin/systemctl -S execve -F a1=mask -F key=service_mask
-a always,exit -F arch=b64 -F path=/bin/systemctl -S execve -F a1=mask -F key=service_mask

# Monitor systemd unmask operations
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=unmask -F key=service_unmask
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=unmask -F key=service_unmask

-a always,exit -F arch=b32 -F path=/bin/systemctl -S execve -F a1=unmask -F key=service_unmask
-a always,exit -F arch=b64 -F path=/bin/systemctl -S execve -F a1=unmask -F key=service_unmask

# Monitor systemd start operations
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=start -F key=service_start
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=start -F key=service_start

-a always,exit -F arch=b32 -F path=/bin/systemctl -S execve -F a1=start -F key=service_start
-a always,exit -F arch=b64 -F path=/bin/systemctl -S execve -F a1=start -F key=service_start

# Monitor systemd stop operations
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=stop -F key=service_stop
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=stop -F key=service_stop

-a always,exit -F arch=b32 -F path=/bin/systemctl -S execve -F a1=stop -F key=service_stop
-a always,exit -F arch=b64 -F path=/bin/systemctl -S execve -F a1=stop -F key=service_stop

# Monitor systemd restart operations
-a always,exit -F arch=b32 -F path=/usr/bin/systemctl -S execve -F a1=restart -F key=service_restart
-a always,exit -F arch=b64 -F path=/usr/bin/systemctl -S execve -F a1=restart -F key=service_restart

-a always,exit -F arch=b32 -F path=/bin/systemctl -S execve -F a1=restart -F key=service_restart
-a always,exit -F arch=b64 -F path=/bin/systemctl -S execve -F a1=restart -F key=service_restart

# Monitor service command execution

# IO_URING RULES
## Io_uring rules do not take an arch field. It is implicit in the specification of the filter. The following example rule watches for file opens through the io_uring subsystem:

-a always,io_uring -S openat,openat2 -F key=access

# Monitor all io_uring system calls
# io_uring_setup (syscall number 425 on x86_64)
-a always,exit -F arch=b32 -S io_uring_setup -F key=io_uring_ops
-a always,exit -F arch=b64 -S io_uring_setup -F key=io_uring_ops

# io_uring_enter (syscall number 426 on x86_64)
-a always,exit -F arch=b32 -S io_uring_register -F key=io_uring_ops
-a always,exit -F arch=b64 -S io_uring_enter -F key=io_uring_ops

# io_uring_register (syscall number 427 on x86_64)
-a always,exit -F arch=b32 -S io_uring_register -F key=io_uring_ops
-a always,exit -F arch=b64 -S io_uring_register -F key=io_uring_ops

# Monitor io_uring with more context
# Track setup with ring parameters
-a always,exit -F arch=b32 -S io_uring_setup -F "a0>=0" -F key=io_uring_setup_details
-a always,exit -F arch=b64 -S io_uring_setup -F "a0>=0" -F key=io_uring_setup_details

# Monitor high-frequency operations (be careful with performance impact)
-a always,exit -F arch=b32 -S io_uring_enter -F "a1>=100" -F key=io_uring_high_ops
-a always,exit -F arch=b64 -S io_uring_enter -F "a1>=100" -F key=io_uring_high_ops

# Monitor specific io_uring_register operations
# IORING_REGISTER_BUFFERS = 0
-a always,exit -F arch=b32 -S io_uring_register -F "a1=0" -F key=io_uring_register_buffers
-a always,exit -F arch=b64 -S io_uring_register -F "a1=0" -F key=io_uring_register_buffers

# IORING_REGISTER_FILES = 2
-a always,exit -F arch=b32 -S io_uring_register -F "a1=2" -F key=io_uring_register_files
-a always,exit -F arch=b64 -S io_uring_register -F "a1=2" -F key=io_uring_register_files

# Monitor potential privilege escalation attempts
-a always,exit -F arch=b32 -S io_uring_setup -F "uid!=0" -F euid=0 -F key=io_uring_priv_escalation
-a always,exit -F arch=b64 -S io_uring_setup -F "uid!=0" -F euid=0 -F key=io_uring_priv_escalation

-a always,exit -F arch=b32 -S io_uring_enter -F "uid!=0" -F euid=0 -F key=io_uring_priv_escalation
-a always,exit -F arch=b64 -S io_uring_enter -F "uid!=0" -F euid=0 -F key=io_uring_priv_escalation

-a always,exit -F arch=b32 -S io_uring_register -F "uid!=0" -F euid=0 -F key=io_uring_priv_escalation
-a always,exit -F arch=b64 -S io_uring_register -F "uid!=0" -F euid=0 -F key=io_uring_priv_escalation

## Critical elements access failures

## /etc/
### Failed File Access Operations (read/open)
-a always,exit -F arch=b32 -F dir=/etc/ -S open,openat -F success=0 -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/etc/ -S open,openat -F success=0 -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/etc/ -S mkdir -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/etc/ -S mkdir -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/etc/ -S mkdirat -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/etc/ -S mkdirat -F key=unauthorizedfileaccess

### Failed File Modification Operations (write/change)
-a always,exit -F arch=b32 -F dir=/etc/ -S openat,open -F perm=wa -F success=0 -F key=etc_file_modify_failed
-a always,exit -F arch=b64 -F dir=/etc/ -S openat,open -F perm=wa -F success=0 -F key=etc_file_modify_failed
-a always,exit -F arch=b32 -F dir=/etc/ -S rename,renameat,truncate -F success=0 -F key=etc_file_modify_failed
-a always,exit -F arch=b64 -F dir=/etc/ -S rename,renameat,truncate -F success=0 -F key=etc_file_modify_failed

### Failed File Permission/Ownership Changes
-a always,exit -F arch=b32 -F dir=/etc/ -S chmod,fchmod,fchmodat,chown,fchown,fchownat,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F success=0 -F key=etc_file_attr_failed
-a always,exit -F arch=b64 -F dir=/etc/ -S chmod,fchmod,fchmodat,chown,fchown,fchownat,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F success=0 -F key=etc_file_attr_failed

### Failed File Deletion Operations
-a always,exit -F arch=b32 -F dir=/etc/ -S unlink,unlinkat,rmdir -F success=0 -F key=etc_file_delete_failed
-a always,exit -F arch=b64 -F dir=/etc/ -S unlink,unlinkat,rmdir -F success=0 -F key=etc_file_delete_failed

## other
-a always,exit -F arch=b32 -F dir=/bin/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/bin/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/sbin/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/sbin/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/usr/bin/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/usr/bin/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/usr/sbin/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/usr/sbin/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/usr/local/bin/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/usr/local/bin/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/usr/local/sbin/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/usr/local/sbin/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/var/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/var/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/home/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/home/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/home/ -S open -S openat -S creat -F success=1 -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/home/ -S open -S openat -S creat -F success=1 -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/home/ -S mkdir -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/home/ -S mkdir -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/home/ -S mkdirat -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/home/ -S mkdirat -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/home/vagrant/ -S open -S openat -S creat -F success=1 -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/home/vagrant/ -S open -S openat -S creat -F success=1 -F key=unauthorizedfileaccess

-a always,exit -F arch=b32 -F dir=/srv/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess
-a always,exit -F arch=b64 -F dir=/srv/ -S open -S openat -S creat -F success=0 -F key=unauthorizedfileaccess

# Linux Distro specific
## NixOS
-a always,exit -F arch=b32 -F path=/etc/nix/nix.conf -F perm=wa -F key=NixOS
-a always,exit -F arch=b64 -F path=/etc/nix/nix.conf -F perm=wa -F key=NixOS

# filesystem

-a always,exit -F arch=b32 -F dir=/usr/include/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/include/ -F perm=wa -F key=binaries

## GoboLinux:
### Depot
### Mount
### System
### Files
### Programs
### Users
-a always,exit -F arch=b32 -F dir=/System/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/System/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/Programs/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/Programs/ -F perm=wa -F key=binaries

## snap
-a always,exit -F arch=b32 -F dir=/snap/bin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/snap/bin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/snap/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/snap/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/var/lib/snapd/snaps/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/var/lib/snapd/snaps/ -F perm=wa -F key=binaries

## nix/nixos
-a always,exit -F arch=b32 -F dir=/nix/store/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/nix/store/ -F perm=wa -F key=binaries

## guix
-a always,exit -F arch=b32 -F dir=/gnu/store/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/gnu/store/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/srv/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/srv/ -F perm=wa -F key=binaries

## pkgin (NetBSD)
-a always,exit -F arch=b32 -F dir=/usr/pkg/bin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/pkg/bin/ -F perm=wa -F key=binaries

# Changes to programs (common locations)
-a always,exit -F arch=b32 -F dir=/bin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/bin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/sbin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/sbin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/bin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/bin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/sbin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/sbin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/local/bin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/local/bin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/local/sbin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/local/sbin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/local/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/local/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/share/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/share/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/opt/bin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/opt/bin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/opt/sbin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/opt/sbin/ -F perm=wa -F key=binaries

## /etc/opt Configuration files for add-on packages stored in /opt.
-a always,exit -F arch=b32 -F dir=/etc/opt/ -F perm=wa -F key=configuration
-a always,exit -F arch=b64 -F dir=/etc/opt/ -F perm=wa -F key=configuration

## /etc/sgml Configuration files, such as catalogs, for software that processes SGML.
-a always,exit -F arch=b32 -F dir=/etc/sgml/ -F perm=wa -F key=configuration
-a always,exit -F arch=b64 -F dir=/etc/sgml/ -F perm=wa -F key=configuration

## /etc/X11	Configuration files for the X Window System, version 11.
-a always,exit -F arch=b32 -F dir=/etc/X11/ -F perm=wa -F key=configuration
-a always,exit -F arch=b64 -F dir=/etc/X11/ -F perm=wa -F key=configuration

## /etc/xml	Configuration files, such as catalogs, for software that processes XML.
-a always,exit -F arch=b32 -F dir=/etc/xml/ -F perm=wa -F key=configuration
-a always,exit -F arch=b64 -F dir=/etc/xml/ -F perm=wa -F key=configuration

# Changes to binaries (common locations, catching the rest)
## binaries

-a always,exit -F arch=b32 -F dir=/bin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/bin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/sbin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/sbin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/bin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/bin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/sbin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/sbin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/local/bin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/local/bin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/local/sbin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/local/sbin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/local/sbin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/local/sbin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/snap/bin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/snap/bin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/snap/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/snap/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/var/lib/flatpak/exports/bin/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/var/lib/flatpak/exports/bin/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/srv/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/srv/ -F perm=wa -F key=binaries

# Changes to libraries (common locations)
-a always,exit -F arch=b32 -F dir=/lib/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/lib/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/lib32/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/lib32/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/lib64/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/lib64/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/lib/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/lib/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/lib32/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/lib32/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/lib64/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/lib64/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/local/lib/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/local/lib/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/local/lib32/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/local/lib32/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/local/lib64/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/local/lib64/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/libexec/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/libexec/ -F perm=wa -F key=binaries

-a always,exit -F arch=b32 -F dir=/usr/local/libexec/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/local/libexec/ -F perm=wa -F key=binaries

### arm
-a always,exit -F arch=b64 -F dir=/usr/lib/aarch64-linux-gnu/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/lib/arm-linux-gnueabi/ -F perm=wa -F key=binaries
-a always,exit -F arch=b64 -F dir=/usr/lib/arm-linux-gnueabihf/ -F perm=wa -F key=binaries

-a always,exit -F dir=/usr/lib/aarch64-linux-gnu/ -F perm=wa -F key=binaries
-a always,exit -F dir=/usr/lib/arm-linux-gnueabi/ -F perm=wa -F key=binaries
-a always,exit -F dir=/usr/lib/arm-linux-gnueabihf/ -F perm=wa -F key=binaries

### powerpc
-a always,exit -F arch=b64 -F dir=/usr/lib/powerpc64le-linux-gnu/ -F perm=wa -F key=binaries

-a always,exit -F dir=/usr/lib/powerpc64le-linux-gnu/ -F perm=wa -F key=binaries

# catch File Integrity Monitoring
-a always,exit -F arch=b32 -F dir=/root/ -S writev -S open -S openat -S write -S lseek -S unlink -S unlinkat -S fchown -S fchownat -S fchmod -S fchmodat -F success=1 -F key=files_ops_root
-a always,exit -F arch=b64 -F dir=/root/ -S writev -S open -S openat -S write -S lseek -S unlink -S unlinkat -S fchown -S fchownat -S fchmod -S fchmodat -F success=1 -F key=files_ops_root

### Successful IPv4 Connections (Noisy)

# -a always,exit -F arch=b32 -S connect -F a2=16 -F success=1 -F key=network_connect_4
# -a always,exit -F arch=b64 -S connect -F a2=16 -F success=1 -F key=network_connect_4

### Successful IPv6 Connections (Noisy)

# -a always,exit -F arch=b32 -S connect -F a2=28 -F success=1 -F key=network_connect_6
# -a always,exit -F arch=b64 -S connect -F a2=28 -F success=1 -F key=network_connect_6

## osquery noisy
# -a always,exit -F arch=b32 -F dir=/var/osquery/ -F perm=wa -F key=osquery
# -a always,exit -F arch=b64 -F dir=/var/osquery/ -F perm=wa -F key=osquery

# Log all commands (Noisy)
# -a always,exit -F arch=b32 -S execve -F key=T1059_Command_and_Scripting_Interpreter
# -a always,exit -F arch=b64 -S execve -F key=T1059_Command_and_Scripting_Interpreter

## alternative
-a always,exit -F arch=b32 -F euid>=500 -S execve -F key=T1059_Command_and_Scripting_Interpreter
-a always,exit -F arch=b64 -F euid>=500 -S execve -F key=T1059_Command_and_Scripting_Interpreter

# Kill Process
## Note: bash (and many other shells) has a built-in “kill” command which doesn’t
## actually run /usr/bin/kill. So if the built-in command is run instead,
## comm=bash is correct. There is no way to force the system to use the
## /usr/bin/kill external program. comm=kill is not going to happen in all cases,
## because shells can call the syscall directly without running the external
## program named “kill”

-a always,exit -F arch=b32 -S kill -F key=Kill_Process
-a always,exit -F arch=b64 -S kill -F key=Kill_Process

-a always,exit -F arch=b32 -S tkill -F key=Kill_Process
-a always,exit -F arch=b64 -S tkill -F key=Kill_Process

-a always,exit -F arch=b32 -S tgkill -F key=Kill_Process
-a always,exit -F arch=b64 -S tgkill -F key=Kill_Process

-a always,exit -F arch=b32 -F path=/bin/pkill -F perm=x -F key=Kill_Process
-a always,exit -F arch=b64 -F path=/bin/pkill -F perm=x -F key=Kill_Process

-a always,exit -F arch=b32 -F path=/sbin/pkill -F perm=x -F key=Kill_Process
-a always,exit -F arch=b64 -F path=/sbin/pkill -F perm=x -F key=Kill_Process

-a always,exit -F arch=b32 -F path=/usr/bin/pkill -F perm=x -F key=Kill_Process
-a always,exit -F arch=b64 -F path=/usr/bin/pkill -F perm=x -F key=Kill_Process

-a always,exit -F arch=b32 -F path=/usr/sbin/pkill -F perm=x -F key=Kill_Process
-a always,exit -F arch=b64 -F path=/usr/sbin/pkill -F perm=x -F key=Kill_Process

-a always,exit -F arch=b32 -F path=/bin/killall -F perm=x -F key=Kill_Process
-a always,exit -F arch=b64 -F path=/bin/killall -F perm=x -F key=Kill_Process

-a always,exit -F arch=b32 -F path=/sbin/killall -F perm=x -F key=Kill_Process
-a always,exit -F arch=b64 -F path=/sbin/killall -F perm=x -F key=Kill_Process

-a always,exit -F arch=b32 -F path=/usr/bin/killall -F perm=x -F key=Kill_Process
-a always,exit -F arch=b64 -F path=/usr/bin/killall -F perm=x -F key=Kill_Process

-a always,exit -F arch=b32 -F path=/usr/sbin/killall -F perm=x -F key=Kill_Process
-a always,exit -F arch=b64 -F path=/usr/sbin/killall -F perm=x -F key=Kill_Process

## These are rules are to locate poorly written programs.
## Its never planned to waste time on a syscall with incorrect parameters
## This is more of a debugging step than something people should run with
## in production.
### https://github.com/linux-audit/audit-userspace/blob/master/rules/70-einval.rules

# -a never,exit -F arch=b64 -S rt_sigreturn
# -a always,exit -S all -F exit=-EINVAL -F key=einval-retcode

# Make the configuration immutable - reboot is required to change audit rules
## auditctl -e 0 - Temporarily disable auditing
## auditctl -e 1 - Re-enable auditing
## auditctl -e 2 - Lock auditing to enabled, reboot to change configuration.

# -e 2
