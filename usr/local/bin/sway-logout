#!/usr/bin/env bash
###
# File: sway-logout
# Author: Leopold Meinel (leo@meinel.dev)
# -----
# Copyright (c) 2025 Leopold Meinel & contributors
# SPDX ID: MIT
# URL: https://opensource.org/licenses/MIT
# -----
###

# Fail on error
set -e

# Stop ssh-agent if it is started
[[ -n "${SSH_AUTH_SOCK}" ]] &&
    eval "$(ssh-agent -k)"

# Kill remaining unnecessary processes with SIGTERM
PROCESSES=("systemd" "sd-pam" "usbguard-notifier" "ssh-agent" "dbus-daemon" "gnome-keyring-d" "gpg-agent" "dconf-service" "at-spi-bus-laun" "gvfsd" "at-spi2-registr" "aa-notify" "pipewire" "wireplumber")
for process in "${PROCESSES[@]}"; do
    pkill -u ${UID} "${process}"
done

# Execute swaymsg exit
exec swaymsg exit
